<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>ä¸œé£å¾®é¸£ Blog - k8s</title><link>https://www.EWhisper.cn/</link><description>Focus on Python/Java/DevOps/Observability</description><lastBuildDate>Fri, 03 May 2019 16:51:34 +0800</lastBuildDate><item><title>OpenShift å’Œ Kubernetes æœ‰ä»€ä¹ˆåŒºåˆ«?</title><link>https://www.EWhisper.cn/openshift-and-kubernetes-whats-difference.html</link><description>&lt;p&gt;OpenShift 3ä»¥å, æ¶æ„å®Œå…¨åŸºäºK8Sè¿›è¡Œäº†é‡æ„, ä½†æ˜¯åˆæœ‰ä¸€äº›å·®å¼‚. ä»Šå¤©, æˆ‘ä»¬å°±æ·±å…¥ç ”ç©¶ä¸€ä¸‹.&lt;/p&gt;
&lt;h2 id="k8s"&gt;K8S æ˜¯"å†…æ ¸"&lt;a class="headerlink" href="#k8s" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;K8Så¯ä»¥è®¤ä¸ºæ˜¯å½“ä»£åˆ†å¸ƒå¼ç³»ç»Ÿçš„"å†…æ ¸". æˆ‘ä»¬æ„è¯†åˆ°, ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„ä½œä¸šè°ƒåº¦ç¨‹åº, è·¨å¤šå°åŠå…¶è¿è¡Œ, èƒ½å¤Ÿåè°ƒæ‰˜ç®¡åœ¨éª‘ä¸Šçš„å·¥ä½œè´Ÿè½½çš„çŠ¶æ€, è‡ªç„¶å°±ä¼šä¿ƒè¿›å†™ä½œ, å°±åƒLinuxå†…æ ¸ä¸ºå•ä¸ªä¸»æœºä¸Šè°ƒåº¦å·¥ä½œè´Ÿè½½æ‰€åšçš„é‚£æ ·. éµå¾ªè¿™ä¸€é€»è¾‘, æˆ‘ä»¬çŸ¥é“ä¸åŒçš„äº§å“ä¼šæ ¹æ®é’ˆå¯¹ç”¨æˆ·çš„ä¸åŒè€Œå·®å¼‚åŒ–åœ°æ‰“é€ .&lt;/p&gt;
&lt;p&gt;åœ¨å¾ˆå¤šæ‰‹æœº, ç”µè„‘, æœåŠ¡å™¨, ç”šè‡³æ˜¯æ ‘è“æ´¾ä¸Š, è¿è¡Œçš„éƒ½æ˜¯ç›¸åŒçš„Linux å†…æ ¸, ä½†æ˜¯é€šè¿‡ä¸åŒçš„ä¸å®šæ¥æ”¯æŒå¤šç§å¤šæ ·çš„ç¡¬ä»¶.&lt;/p&gt;
&lt;p&gt;K8Så’Œå„ç§å„æ ·çš„K8Så‘è¡Œç‰ˆä¹Ÿé€‚ç”¨äºåŒæ ·çš„æ¨¡å‹, é€šè¿‡ä¸åŒç±»å‹çš„è¡¥ä¸, æ¥æ”¯æŒåœ¨K8Sä¸Šé¢çš„ä¸€å±‚. &lt;/p&gt;
&lt;h2 id="openshift"&gt;OpenShift æ˜¯å‘è¡Œç‰ˆ&lt;a class="headerlink" href="#openshift" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªå¼ºæœ‰åŠ›çš„åŒºåˆ«ã€‚OpenShiftå°±æ˜¯Kubernetesçš„å‘è¡Œç‰ˆï¼Œä¸“æ³¨äºå¼€å‘äººå‘˜çš„ä½“éªŒï¼Œè€Œå¼€å‘äººå‘˜éœ€è¦å¼€å‘ä¸‹ä¸€ä»£äº‘åŸç”Ÿåº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ä»»ä½•äººéƒ½å¯ä»¥é€šè¿‡é€‰æ‹©æ¯1ä¸ªéƒ¨åˆ†å¹¶æŒ‰ç…§æ¯ä¸ªç”¨æˆ·é€‰æ‹©çš„å®šåˆ¶æ–¹å¼ç»„è£…å®ƒä»¬æ¥&lt;a href="http://www.linuxfromscratch.org/"&gt;ä»Scratch &lt;/a&gt;æ„å»º&lt;a href="http://www.linuxfromscratch.org/"&gt;Linux&lt;/a&gt;ï¼Œä½†å¤§å¤šæ•°äººéƒ½æ²¡æœ‰ã€‚å¤§å¤šæ•°ç”¨æˆ·é€‰æ‹©çš„æŠ½è±¡çº§åˆ«æ„å‘³ç€ä»–ä»¬ä¸ä¼šä»ç®¡ç†ï¼ˆç”šè‡³äº†è§£ï¼‰Util-Linuxç‰ˆæœ¬2.31å’Œ2.33ä¹‹é—´çš„å·®å¼‚ä¸­è·å¾—å¾ˆå¤šä»·å€¼ã€‚ä¸ºäº†æ›´è¿›ä¸€æ­¥ï¼Œç”¨æˆ·å…³å¿ƒæœ€ä½çº§åˆ«çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œåªè¦è¶…è¿‡æœ€å°ç‰ˆæœ¬å·ï¼Œä»–ä»¬å°±çŸ¥é“å“ªäº›å‘½ä»¤/ APIå¯ç”¨ï¼‰ï¼Œç„¶åæä¾›æ‰€æä¾›åŠŸèƒ½çš„åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸OpenShiftéå¸¸ç›¸ä¼¼ã€‚OpenShiftå°†Kubernetesæ‰“åŒ…å¹¶åŒ…å«å…¶ä»–å·¥å…·ä½œä¸ºOpenShiftè®¤ä¸ºé‡è¦ä¸”OpenShiftçš„ç”¨æˆ·éœ€æ±‚çš„åŠŸèƒ½ã€‚å°±åƒCoreOSå’ŒCentOSåŒ…å«ä¸åŒçš„å·¥å…·é›†ä¸€æ ·ï¼Œè¿åˆä¸åŒçš„ç”¨æˆ·ï¼Œå› æ­¤Kuberneteså‘è¡Œç‰ˆä¹Ÿæ˜¯å¦‚æ­¤ã€‚&lt;/p&gt;
&lt;h2 id="openshiftk8s"&gt;OpenShiftå’ŒK8Sçš„å…·ä½“åŒºåˆ«&lt;a class="headerlink" href="#openshiftk8s" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="openshift_1"&gt;OpenShift æ¶æ„æ¦‚è¿°&lt;a class="headerlink" href="#openshift_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;OpenShiftå®¹å™¨å¹³å°æ˜¯ä¸€ç³»åˆ—æµè¡Œçš„ç»„ä»¶å’ŒæœåŠ¡çš„é›†åˆä½“, æ„å»ºäºRed Hat Enterprise Linux, Docker, å’ŒK8Sä¹‹ä¸Š. OpenShifté’ˆå¯¹å¼€å‘äººå‘˜, å¢å¼ºäº†ä»¥ä¸‹åŠŸèƒ½: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿œç¨‹ç®¡ç†&lt;/li&gt;
&lt;li&gt;å¤šç§Ÿæˆ·&lt;/li&gt;
&lt;li&gt;å®‰å…¨æ€§å¢å¼º&lt;/li&gt;
&lt;li&gt;åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†&lt;/li&gt;
&lt;li&gt;è‡ªæœåŠ¡æ¥å£&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="OpenShift æ¶æ„" src="./images/openshift-architecture-overview.png"&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šå›¾ä¸­, ä»ä¸‹è‡³ä¸Š, ä»å·¦è‡³å³, å±•ç¤ºäº†ç»è¿‡Red Hat åœ¨åŸºæœ¬çš„å®¹å™¨æ¶æ„åŸºç¡€ä¸Šè¿›ä¸€æ­¥é›†æˆã€å¢å¼ºçš„æ¶æ„:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºæœ¬OSæ˜¯Red Hat Enterprise Linux (RHEL)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Docker&lt;/strong&gt;  æä¾›äº†åŸºæœ¬çš„å®¹å™¨ç®¡ç†APIå’Œå®¹å™¨é•œåƒæ–‡ä»¶æ ¼å¼&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kubernetes&lt;/strong&gt; ç®¡ç†è¿è¡Œå®¹å™¨çš„ä¸»æœºé›†ç¾¤(å®ä½“çš„æˆ–è™šæ‹Ÿçš„). å®ƒé€šè¿‡èµ„æº(resources)æ¥æè¿°å¤šå®¹å™¨åº”ç”¨æ˜¯ç”±å¤šä¸ªèµ„æºç»„æˆçš„, ä»¥åŠä»–ä»¬é—´å¦‚ä½•äº¤äº’&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Etcd&lt;/strong&gt; æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ key-value å­˜å‚¨, Kubernetes é€šè¿‡å®ƒæ¥å­˜å‚¨é›†ç¾¤å†…çš„å…³äºå®¹å™¨å’Œå…¶ä»–èµ„æºçš„é…ç½®å’ŒçŠ¶æ€ä¿¡æ¯.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨Docker + Kubernetes ä¹‹ä¸Š, OpenShiftå¢åŠ äº†å®¹å™¨å¹³å°æ‰€éœ€è¦çš„å…¶ä»–åŠŸèƒ½. å…·ä½“åŒ…æ‹¬:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;OpenShift-Kubernetes æ‰©å±•&lt;/strong&gt; æ˜¯å­˜å‚¨åœ¨Etcdä¸­, ç”±Kubernetesç®¡ç†çš„é¢å¤–çš„èµ„æºç±»å‹(resource types). è¿™äº›é¢å¤–çš„èµ„æºç±»å‹ç»„æˆäº†OpenShift å†…éƒ¨çŠ¶æ€å’Œé…ç½®, è¿˜æœ‰åº”ç”¨çš„èµ„æº.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹å™¨åŒ–æœåŠ¡&lt;/strong&gt; å……å®äº†å¾ˆå¤šåŸºç¡€æ¶æ„åŠŸèƒ½, æ¯”å¦‚ç½‘ç»œå’Œè®¤è¯. è¿™äº›åŠŸèƒ½æœ‰äº›æ˜¯ä¸€ç›´è¿è¡Œçš„, æœ‰äº›æ˜¯æŒ‰éœ€å¯åŠ¨çš„. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶å’ŒxPaaS&lt;/strong&gt; æ˜¯ä¸ºå¼€å‘è€…å‡†å¤‡å¥½çš„å®¹å™¨é•œåƒ, æ¯ä¸ªéƒ½é¢„é…ç½®äº†ç‰¹å®šçš„è¯­è¨€è¿è¡Œæ—¶æˆ–æ•°æ®åº“. å¯ä»¥è¢«ç”¨ä½œé•œåƒæµ(Image Stream)æˆ–åœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ ä¸åŒçš„æ¡†æ¶, åº“, ç”šè‡³æ˜¯ä¸­é—´ä»¶æ¥è¿›è¡Œæ‰©å±•. xPaaS æä¾›äº†ä¸€ç³»åˆ—JBossä¸­é—´ä»¶äº§å“çš„åŸºç¡€é•œåƒ, å¦‚: JBoss EAP å’Œ ActiveMQ.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DevOps å·¥å…·é›†å’Œç”¨æˆ·ä½“éªŒ&lt;/strong&gt;: OpenShift ä¸ºå¼€å‘äººå‘˜å’Œç³»ç»Ÿç®¡ç†å‘˜æä¾›äº†ä¸€ä¸ªWeb UIå’ŒCLI ç®¡ç†å·¥å…·, å…è®¸é…ç½®å’Œç›‘æ§åº”ç”¨å’ŒOpenShiftçš„æœåŠ¡å’Œèµ„æº. Webå’Œ CLI éƒ½æ˜¯åŸºäºç›¸åŒçš„REST API, è¿™ä¸ªAPIä¹Ÿå¯ä»¥è¢«å¤–éƒ¨å·¥å…·(å¦‚: IDEå’ŒCIå¹³å°)æ•´åˆ. OpenShiftä¹Ÿå¯ä»¥è®¿é—®å¤–éƒ¨SCMåº“å’Œå®¹å™¨é•œåƒåº“.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; å¤‡æ³¨:&lt;/p&gt;
&lt;p&gt;OpenShift å›¢é˜Ÿ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¸®åŠ©K8S å®Œæˆäº†Namespace å’Œ quotaåŠŸèƒ½çš„å¼€å‘;&lt;/li&gt;
&lt;li&gt;æ¨åŠ¨äº†RBAC æˆæƒè®¤è¯çš„å¼€å‘&lt;/li&gt;
&lt;li&gt;å¸®åŠ©K8Sè¿è¡Œæ›´å¤šç±»å‹çš„åº”ç”¨, å¹¶ä¸ºå…¶å¼€å‘äº†ä¸€äº›å·æ’ä»¶(Volume Plugin)&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å¤šäº†Deployment Config(DC) resource. ä½¿ç”¨è¯¥èµ„æºå¯ä»¥è¿›è¡Œå‚æ•°åŒ–éƒ¨ç½², æ‰§è¡Œæ»šåŠ¨éƒ¨ç½²å’Œå›æ»šç­‰.&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å¤šäº†Route resource. è€ŒRouterä¹Ÿæ˜¯K8Sçš„IngressåŠŸèƒ½çš„å‰èº«.&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, é»˜è®¤é›†æˆäº†SDN (Open vSwitch)&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å®ç°äº†å¼€å‘è¿ç»´ä¸€ä½“åŒ–.&lt;/li&gt;
&lt;li&gt;çº³å…¥CoreOS&lt;/li&gt;
&lt;li&gt;OpenShift 3.11, é›†æˆäº†Prometheuså’ŒGrafana&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å¢å¼ºäº†ç®¡ç†ç‰©ç†èŠ‚ç‚¹çš„èƒ½åŠ›&lt;/li&gt;
&lt;li&gt;ç›®å‰, OpenShiftè¿˜å’ŒNVåˆä½œ, æœªæ¥ä¼šæä¾›åŸºäºGPUè¿ç®—èƒ½åŠ›çš„æ”¯æŒ.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h3 id="_1"&gt;èµ„æºç±»å‹å·®å¼‚&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Kubernetes èµ„æºç±»å‹&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Pods&lt;/li&gt;
&lt;li&gt;Services&lt;/li&gt;
&lt;li&gt;Replication Controllers&lt;/li&gt;
&lt;li&gt;Persistent Volume (PV)&lt;/li&gt;
&lt;li&gt;Persistent Volume Claims (PVC)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;OpenShift èµ„æºç±»å‹&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;é™¤äº†ä»¥ä¸Šèµ„æºç±»å‹, OpenShift è¿˜å¢åŠ äº†ä»¥ä¸‹ä¸»è¦çš„èµ„æºç±»å‹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Deployment Configurations (DC) - ç”¨äº æŒç»­äº¤ä»˜(CD)å·¥ä½œæµ&lt;/li&gt;
&lt;li&gt;Build Configurations (BC) - ç”¨äº æŒç»­é›†æˆ(CI) å·¥ä½œæµ&lt;/li&gt;
&lt;li&gt;Routes - åŸºäºHAProxy, ä½œç”¨ç±»ä¼¼äºK8S Ingress, ä½†æ—©äºIngress.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="openshift-s2i"&gt;OpenShift ç‰¹æœ‰çš„S2I åŠŸèƒ½&lt;a class="headerlink" href="#openshift-s2i" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;OpenShiftä¸­çš„Source-to-Image (S2I) è¿›ç¨‹ä¼šä»SCMä»“åº“ä¸­æ‹‰å–ä»£ç , è‡ªåŠ¨åŒ–ç›‘æµ‹ä»£ç éœ€è¦å“ªç§ç±»å‹çš„è¿è¡Œæ—¶, å¹¶ä»ç‰¹å®šè¿è¡Œæ—¶çš„åŸºç¡€é•œåƒå¯åŠ¨ä¸€ä¸ªpod. åœ¨è¿™ä¸ªpod ä¸­, OpenShift ä»¥å¼€å‘äººå‘˜ç›¸åŒçš„æ–¹å¼æ¥æ„å»ºè¯¥åº”ç”¨(å¦‚, ä½¿ç”¨&lt;strong&gt;maven&lt;/strong&gt;æ¥æ„å»ºjavaç¨‹åº). å¦‚æœæ„å»ºæˆåŠŸ, å¦ä¸€ä¸ªé•œåƒä¼šè¢«åˆ›å»º, æŠŠåº”ç”¨äºŒè¿›åˆ¶é™„åŠ åˆ°è¿è¡Œæ—¶å±‚ä¹‹ä¸Š, å¹¶æŠŠè¿™ä¸ªæ–°é•œåƒæ¨é€åˆ°OpenShiftçš„å†…éƒ¨é•œåƒä»“åº“ä¸­. æ¥ä¸‹æ¥, å¯ä»¥ä»è¿™ä¸ªæ–°é•œåƒåˆ›å»ºä¸€ä¸ªpodæ¥è¿è¡Œè¯¥åº”ç”¨. S2I å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªåµŒå…¥åˆ°OpenShiftå¹³å°ä¸­çš„ CI/CD pipeline.&lt;/p&gt;
&lt;p&gt;CI/CD pipelines ä¼šæœ‰å¾ˆå¤šç§å˜å¼‚, è¿™ä¸ªpipelineä¼šæš´éœ²åœ¨è¿™ä¸ªé¡¹ç›®(project, å°±æ˜¯K8Sçš„namespace)ä¸­, é‚£ä¹ˆå®ƒå°±å¯ä»¥è¢«è°ƒèŠ‚æ¥æ»¡è¶³å¼€å‘äººå‘˜çš„éœ€æ±‚. ä¾‹å¦‚, å¤–éƒ¨CIå·¥å…·(å¦‚Jenkins)å¯ä»¥ç”¨äºæ¥å¯åŠ¨å’Œè¿è¡Œæµ‹è¯•, ç„¶åç»™æ–°é•œåƒæ‰“ä¸Š"æˆåŠŸ"æˆ–"å¤±è´¥"çš„æ ‡ç­¾(label), å¹¶æ¨é€åˆ°QAæˆ–ç”Ÿäº§ç¯å¢ƒ. éšç€æ—¶é—´æ¨ç§», ä¸€ä¸ªç»„ç»‡ä¸€ä¸ªéƒ¨é—¨ä¸€ä¸ªå…¬å¸å¯ä»¥åˆ›å»ºä»–ä»¬è‡ªå·±çš„pipelineæ¨¡æ¿, åŒ…æ‹¬è‡ªå®šä¹‰çš„æ„å»ºå™¨å’Œéƒ¨ç½²å™¨.&lt;/p&gt;
&lt;h2 id="_2"&gt;æ€»ç»“&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;OpenShift å¹³å°ç›¸æ¯”K8S, å…·æœ‰ä»¥ä¸‹ç‰¹æ€§:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªæœåŠ¡å¹³å°;&lt;/li&gt;
&lt;li&gt;å¤šè¯­è¨€, å¤šä¸­é—´ä»¶, æ•°æ®åº“æ”¯æŒ&lt;/li&gt;
&lt;li&gt;é«˜å¯ç”¨, å¯ä¼¸ç¼©æ€§&lt;/li&gt;
&lt;li&gt;ä¹Ÿæ˜¯å¼€æºçš„(Red Hatæ”¶å–æœåŠ¡è´¹)&lt;/li&gt;
&lt;li&gt;å®‰å…¨ (åŸºäº: RBAC, LDAP, ä¸»æœº, ç½‘ç»œ, å®¹å™¨å„ä¸ªå±‚é¢çš„åŠ å›º)&lt;/li&gt;
&lt;li&gt;åŠ¨æ€å­˜å‚¨ç®¡ç†&lt;/li&gt;
&lt;li&gt;ä¼ä¸šçº§&lt;/li&gt;
&lt;li&gt;æ—¥å¿—æ•´åˆ/ ç›‘æ§æ•´åˆ&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Fri, 03 May 2019 16:51:34 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-05-03:/openshift-and-kubernetes-whats-difference.html</guid><category>docker</category><category>openshift</category><category>k8s</category><category>containers</category><category>PAAS</category></item></channel></rss>