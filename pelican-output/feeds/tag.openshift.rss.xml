<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>ä¸œé£å¾®é¸£ Blog - openshift</title><link>https://www.EWhisper.cn/</link><description>Focus on Python/Java/DevOps/Observability</description><lastBuildDate>Wed, 08 May 2019 18:41:34 +0800</lastBuildDate><item><title>ä½¿ç”¨OpenShiftè¿›è¡ŒäºŒè¿›åˆ¶æ„å»º</title><link>https://www.EWhisper.cn/binary-builds-with-openshift.html</link><description>&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#_1"&gt;ä»‹ç»&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#_2"&gt;ç”¨ä¾‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_3"&gt;é™åˆ¶&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#_4"&gt;æ•™ç¨‹æ¦‚è¿°&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#_5"&gt;æ•™ç¨‹ï¼šæ„å»ºæœ¬åœ°ä»£ç æ›´æ”¹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_6"&gt;æ•™ç¨‹ï¼šæ„å»ºç§æœ‰ä»£ç &lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#pipeline"&gt;æ•™ç¨‹ï¼šæ¥è‡ª pipeline çš„äºŒè¿›åˆ¶å·¥ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id="_1"&gt;ä»‹ç»&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;OpenShift æ¨èå’Œå¸¸ç”¨çš„æ„å»ºæ–¹å¼æ˜¯: ç›´æ¥ä»ä»£ç ä»“åº“(å¦‚GIT æˆ–SVN)ä¸­æ‹‰å–æºç è¿›è¡Œæ„å»º(å³æºç æ„å»º). ä½†æ˜¯è¿™ä¸€ç§æ„å»ºæ–¹å¼å¹¶ä¸èƒ½æ»¡è¶³æ‰€æœ‰çš„éœ€æ±‚, æ‰€ä»¥è¿˜æœ‰ä¸€ç§æ„å»ºæ–¹å¼å°±æ˜¯: äºŒè¿›åˆ¶æ„å»º. äºŒè¿›åˆ¶æ„å»ºé€‚ç”¨äºä»¥ä¸‹2ä¸ªåœºæ™¯:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¼€å‘äººå‘˜æœ¬åœ°å¼€å‘è°ƒè¯•ä»£ç å¹¶æ„å»º;&lt;/li&gt;
&lt;li&gt;OpenShiftå’Œ CI/CDçš„pipelineè¿›è¡Œæ•´åˆ, è·å–ä»å‰è¾¹å¹³å°(å¦‚è‡ªåŠ¨åŒ–å¼€å‘å¹³å°æˆ–æµ‹è¯•å¹³å°)ä¼ è¿‡æ¥çš„å·¥ä»¶(å³äºŒè¿›åˆ¶åŒ…)å¹¶æ„å»ºä¸ºé•œåƒ.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;OpenShiftä¸­çš„äºŒè¿›åˆ¶æ„å»ºåŠŸèƒ½å…è®¸å¼€å‘äººå‘˜å°†æºä»£ç æˆ–å·¥ä»¶ç›´æ¥ä¸Šä¼ åˆ°æ„å»º(build)ï¼Œè€Œä¸æ˜¯ä»Gitå­˜å‚¨åº“URL pulléœ€è¦æ„å»ºçš„æºã€‚é€šè¿‡æºä»£ç ï¼ŒDockeræˆ–è‡ªå®šä¹‰æ„å»ºç­–ç•¥çš„ BuildConfig éƒ½å¯ä»¥ä½œä¸ºäºŒè¿›åˆ¶æ„å»ºå¯åŠ¨ã€‚ä»æœ¬åœ°å·¥ä»¶å¯åŠ¨æ„å»ºæ—¶ï¼Œç°æœ‰æºå¼•ç”¨å°†æ›¿æ¢ä¸ºæ¥è‡ªæœ¬åœ°ç”¨æˆ·è®¡ç®—æœºçš„æºã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨å‡ ç§æ–¹å¼æä¾›æºï¼Œè¿™äº›æ–¹å¼å¯¹åº”äºä½¿ç”¨&lt;code&gt;start-build&lt;/code&gt;å‘½ä»¤æ—¶å¯ç”¨çš„å‚æ•°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»æ–‡ä»¶ï¼ˆ&lt;code&gt;--from-file&lt;/code&gt;ï¼‰ï¼šå½“æ„å»ºçš„æ•´ä¸ªæºåŒ…å«å•ä¸ªæ–‡ä»¶æ—¶å°±æ˜¯è¿™ç§æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½æ˜¯ç”¨äºDockeræ„å»ºçš„&lt;code&gt;Dockerfile&lt;/code&gt;ï¼Œç”¨äºJavaåº”ç”¨æ„å»ºçš„&lt;code&gt;pom.xml&lt;/code&gt;ï¼Œæˆ–ç”¨äºRubyæ„å»ºçš„&lt;code&gt;Gemfile&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä»ç›®å½•ï¼ˆ&lt;code&gt;--from-directory&lt;/code&gt;ï¼‰ï¼šå½“æºåœ¨æœ¬åœ°ç›®å½•ä¸­å¹¶ä¸”æœªæäº¤åˆ°Gitå­˜å‚¨åº“æ—¶ä½¿ç”¨æ­¤ç›®å½•ã€‚&lt;code&gt;start-build&lt;/code&gt; å‘½ä»¤å°†åˆ›å»ºç»™å®šç›®å½•çš„å­˜æ¡£ï¼Œå¹¶å°†å…¶ä½œä¸ºæºä¸Šä¼ åˆ°æ„å»ºå™¨(builder)ã€‚&lt;/li&gt;
&lt;li&gt;ä»å­˜æ¡£ï¼ˆ&lt;code&gt;--from-archive&lt;/code&gt;ï¼‰ï¼šå½“å…·æœ‰æºçš„å­˜æ¡£å·²å­˜åœ¨æ—¶ä½¿ç”¨æ­¤é€‰é¡¹ã€‚è¯¥å­˜æ¡£å¯ä»¥æ˜¯&lt;code&gt;tar&lt;/code&gt;ï¼Œ&lt;code&gt;tar.gz&lt;/code&gt;æˆ–&lt;code&gt;zip&lt;/code&gt;æ ¼å¼ã€‚&lt;/li&gt;
&lt;li&gt;ä»Gitå­˜å‚¨åº“ï¼ˆ&lt;code&gt;--from-repo&lt;/code&gt;ï¼‰ï¼šæºæ˜¯å½“å‰ç”¨æˆ·æœ¬åœ°è®¡ç®—æœºä¸Šçš„Gitå­˜å‚¨åº“çš„ä¸€éƒ¨åˆ†ã€‚å½“å‰å­˜å‚¨åº“çš„HEAD commitå°†è¢«å­˜æ¡£å¹¶å‘é€åˆ°OpenShiftè¿›è¡Œæ„å»ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="_2"&gt;ç”¨ä¾‹&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;äºŒè¿›åˆ¶æ„å»ºé€‚ç”¨äºæ— æ³•ä»ç°æœ‰Gitå­˜å‚¨åº“ä¸­æå–æºçš„éœ€æ±‚ã€‚ä½¿ç”¨äºŒè¿›åˆ¶æ„å»ºçš„åŸå› åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ„å»ºå’Œæµ‹è¯•æœ¬åœ°ä»£ç çš„å˜æ›´ã€‚å…‹éš†æ¥è‡ªå…¬å…±å­˜å‚¨åº“çš„æºï¼Œå¹¶å°†æœ¬åœ°å˜æ›´ä¸Šä¼ åˆ°OpenShiftè¿›è¡Œæ„å»ºã€‚è€Œæ— éœ€åœ¨ä»»ä½•åœ°æ–¹æäº¤æˆ–æ¨é€æœ¬åœ°æ›´æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;æ„å»ºç§æœ‰ä»£ç ã€‚æ–°æ„å»ºå¯ä»¥ä½œä¸ºäºŒè¿›åˆ¶æ„å»ºä»å¤´å¼€å§‹ã€‚ç„¶åå¯ä»¥å°†æºç›´æ¥ä»æœ¬åœ°å·¥ä½œç«™ä¸Šä¼ åˆ°OpenShiftï¼Œè€Œæ— éœ€å°†å…¶ç­¾å…¥SCMã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å…¶ä»–æ¥æºçš„å·¥ä»¶æ„å»ºé•œåƒã€‚é€šè¿‡Jenkins pipelineï¼ŒäºŒè¿›åˆ¶æ„å»ºå¯ä»¥ç”¨äºæ•´åˆä½¿ç”¨Mavenæˆ–Cç¼–è¯‘å™¨ç­‰å·¥å…·æ„å»ºçš„å·¥ä»¶ï¼Œä»¥åŠä½¿ç”¨è¿™äº›æ„å»ºçš„è¿è¡Œæ—¶é•œåƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="_3"&gt;é™åˆ¶&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;äºŒè¿›åˆ¶æ„å»ºæ— æ³•é‡å¤ã€‚ç”±äºäºŒè¿›åˆ¶æ„å»ºä¾èµ–äºåœ¨æ„å»ºå¼€å§‹æ—¶ç”¨æˆ·ä¸Šä¼ å·¥ä»¶ï¼Œå› æ­¤OpenShiftæ— æ³•é‡å¤ç›¸åŒçš„æ„å»ºè€Œæ— éœ€ç”¨æˆ·æ¯æ¬¡éƒ½é‡å¤ç›¸åŒçš„ä¸Šè½½ã€‚&lt;/li&gt;
&lt;li&gt;æ— æ³•è‡ªåŠ¨è§¦å‘äºŒè¿›åˆ¶ç”Ÿæˆã€‚å®ƒä»¬åªèƒ½åœ¨ç”¨æˆ·ä¸Šä¼ æ‰€éœ€çš„äºŒè¿›åˆ¶å·¥ä»¶æ—¶æ‰‹åŠ¨å¯åŠ¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;&lt;/p&gt;
&lt;p&gt;ä»¥äºŒè¿›åˆ¶æ„å»ºæ–¹å¼å¯åŠ¨çš„æ„å»ºç‰ˆæœ¬ä¹Ÿå¯èƒ½å…·æœ‰å·²é…ç½®çš„æºURLã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œè§¦å‘å™¨ä¼šæˆåŠŸå¯åŠ¨æ„å»ºï¼Œä½†æºå°†æ¥è‡ªé…ç½®çš„æºURLï¼Œè€Œä¸æ˜¯æ¥è‡ªä¸Šæ¬¡æ„å»ºè¿è¡Œæ—¶ç”¨æˆ·æä¾›çš„æºã€‚(æ¯”å¦‚: ç”¨æˆ·å…ˆä»Gitä»“åº“ä¸‹è½½äº†æºç å¹¶ä¿®æ”¹, ç”¨æœ¬åœ°ä¿®æ”¹åçš„æºç æ‰‹åŠ¨ä¸Šä¼ ã€æ„å»ºï¼Œé‚£ä¹ˆOpenShiftä¼šè·å–åˆ°Gitä»“åº“çš„URL, å¦‚æœé…ç½®äº†è§¦å‘å™¨, ä¸‹æ¬¡æ„å»ºå°±ç›´æ¥é€šè¿‡Git URL pullæºç å¹¶è‡ªåŠ¨æ„å»º, è€Œä¸æ˜¯è‡ªåŠ¨è·å–æœ¬åœ°çš„æºç .)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="_4"&gt;æ•™ç¨‹æ¦‚è¿°&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹æ•™ç¨‹å‡è®¾æ‚¨æœ‰ä¸€ä¸ªå¯ç”¨çš„OpenShifté›†ç¾¤ï¼Œå¹¶ä¸”æ‚¨æœ‰ä¸€ä¸ªå¯ä»¥åˆ›å»ºå·¥ä»¶çš„é¡¹ç›®ã€‚å®ƒè¦æ±‚æ‚¨æ‹¥æœ‰æœ¬åœ°&lt;code&gt;git&lt;/code&gt;å’Œ&lt;code&gt;oc&lt;/code&gt;å®¢æˆ·ç«¯ã€‚&lt;/p&gt;
&lt;h3 id="_5"&gt;æ•™ç¨‹ï¼šæ„å»ºæœ¬åœ°ä»£ç æ›´æ”¹&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åŸºäºç°æœ‰æºå­˜å‚¨åº“åˆ›å»ºæ–°åº”ç”¨ç¨‹åºå¹¶ä¸ºå…¶åˆ›å»ºè·¯ç”±ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc new-app https://github.com/openshift/ruby-hello-world.git
oc expose svc/ruby-hello-world
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="2"&gt;
&lt;li&gt;ç­‰å¾…åˆå§‹æ„å»ºå®Œæˆå¹¶é€šè¿‡routeæ¥æŸ¥çœ‹åº”ç”¨ç¨‹åºçš„é¡µé¢ã€‚ä½ åº”è¯¥å¾—åˆ°ä¸€ä¸ªæ¬¢è¿é¡µé¢ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc get route ruby-hello-world
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;åœ¨æœ¬åœ°å…‹éš†å­˜å‚¨åº“ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone https://github.com/openshift/ruby-hello-world.git
&lt;span class="nb"&gt;cd&lt;/span&gt; ruby-hello-world
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="4"&gt;
&lt;li&gt;
&lt;p&gt;æ›´æ”¹åº”ç”¨ç¨‹åºçš„è§†å›¾ã€‚ä½¿ç”¨æ‚¨å–œæ¬¢çš„ç¼–è¾‘å™¨ç¼–è¾‘ &lt;code&gt;views/main.rb&lt;/code&gt;ï¼šå°†&lt;code&gt;&amp;lt;body&amp;gt;&lt;/code&gt;æ ‡ç­¾æ›´æ”¹ä¸º&lt;code&gt;&amp;lt;body style="background-color:blue"&amp;gt;&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨æœ¬åœ°ä¿®æ”¹çš„æºå¯åŠ¨æ–°æ„å»ºã€‚åœ¨å­˜å‚¨åº“çš„æœ¬åœ°ç›®å½•ä¸­ï¼Œè¿è¡Œï¼š&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc start-build ruby-hello-world --from-dir&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt; --follow
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ„å»ºå®Œæˆå¹¶é‡æ–°éƒ¨ç½²åº”ç”¨ç¨‹åºåï¼ŒæŒ‡å‘åº”ç”¨ç¨‹åºä¸»æœºçš„routeåº”è¯¥ä¼šç”Ÿæˆä¸€ä¸ªè“è‰²èƒŒæ™¯çš„é¡µé¢ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥ç»§ç»­åœ¨æœ¬åœ°è¿›è¡Œæ›´æ”¹å¹¶ä½¿ç”¨&lt;code&gt;oc start-build --from-dir&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨è¿˜å¯ä»¥åˆ›å»ºä»£ç åˆ†æ”¯ï¼Œåœ¨æœ¬åœ°æäº¤æ›´æ”¹ï¼Œå¹¶ä½¿ç”¨å­˜å‚¨åº“çš„HEADä½œä¸ºæ„å»ºçš„æºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git checkout -b my_branch
git add .
git commit -m &lt;span class="s2"&gt;&amp;quot;My changes&amp;quot;&lt;/span&gt;
oc start-build ruby-hello-world --from-repo&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt; --follow
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_6"&gt;æ•™ç¨‹ï¼šæ„å»ºç§æœ‰ä»£ç &lt;a class="headerlink" href="#_6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ªæœ¬åœ°ç›®å½•æ¥ä¿å­˜æ‚¨çš„ä»£ç ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mkdir myapp
&lt;span class="nb"&gt;cd&lt;/span&gt; myapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="2"&gt;
&lt;li&gt;åœ¨ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º&lt;code&gt;Dockerfile&lt;/code&gt;çš„æ–‡ä»¶ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; centos:centos7&lt;/span&gt;
&lt;span class="k"&gt;EXPOSE&lt;/span&gt;&lt;span class="s"&gt; 8080&lt;/span&gt;
&lt;span class="k"&gt;COPY&lt;/span&gt; index.html /var/run/web/index.html
&lt;span class="k"&gt;CMD&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /var/run/web &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; python -m SimpleHTTPServer &lt;span class="m"&gt;8080&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ª&lt;code&gt;index.html&lt;/code&gt;æ–‡ä»¶ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;My local app&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;This is my local application&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="4"&gt;
&lt;li&gt;ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ªæ–°çš„æ„å»ºï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc new-build --strategy docker --binary --docker-image centos:centos7 --name myapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="5"&gt;
&lt;li&gt;ä½¿ç”¨æœ¬åœ°ç›®å½•çš„å†…å®¹å¯åŠ¨äºŒè¿›åˆ¶æ„å»ºï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc start-build myapp --from-dir . --follow
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="6"&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;new-app&lt;/code&gt;éƒ¨ç½²åº”ç”¨ç¨‹åºï¼Œç„¶åä¸ºå…¶åˆ›å»ºè·¯ç”±ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc new-app myapp
oc expose svc/myapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="7"&gt;
&lt;li&gt;è·å–æŒ‡å‘å¯¹åº”åº”ç”¨ä¸»æœºçš„è·¯ç”±ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc get route myapp
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨æ„å»ºå’Œéƒ¨ç½²ä»£ç ä¹‹åï¼Œæ‚¨å¯ä»¥é€šè¿‡æ›´æ”¹æœ¬åœ°æ–‡ä»¶å¹¶é€šè¿‡&lt;code&gt;oc start-build myapp --from-dir&lt;/code&gt;å†æ¬¡è°ƒç”¨å¯åŠ¨æ–°æ„å»ºæ¥è¿›è¡Œè¿­ä»£ã€‚æ„å»ºå®Œæˆåï¼Œä»£ç å°†è‡ªåŠ¨éƒ¨ç½²ï¼Œæ›´æ–°çš„å†…å®¹å°†åœ¨åˆ·æ–°é¡µé¢æ—¶åæ˜ åœ¨æµè§ˆå™¨ä¸­ã€‚&lt;/p&gt;
&lt;h3 id="pipeline"&gt;æ•™ç¨‹ï¼šæ¥è‡ª pipeline çš„äºŒè¿›åˆ¶å·¥ä»¶&lt;a class="headerlink" href="#pipeline" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;OpenShiftä¸Šçš„Jenkinså…è®¸ä½¿ç”¨å¸¦æœ‰åˆé€‚å·¥å…·çš„slaveé•œåƒæ¥æ„å»ºä»£ç ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨&lt;code&gt;maven&lt;/code&gt; slaveé•œåƒæ¥ä»ä»£ç å­˜å‚¨åº“æ„å»ºWARåŒ…ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦æ„å»ºäº†æ­¤å·¥ä»¶ï¼Œæ‚¨éœ€è¦å°†å…¶æäº¤åˆ°åŒ…å«æ­£ç¡®çš„è¿è¡Œæ—¶å·¥ä»¶çš„é•œåƒä»¥è¿è¡Œæ‚¨çš„ä»£ç ã€‚å¯ä»¥ä½¿ç”¨äºŒè¿›åˆ¶æ„å»ºå°†è¿™äº›å·¥ä»¶æ·»åŠ åˆ°è¿è¡Œæ—¶æ˜ åƒã€‚åœ¨ä¸‹é¢çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªJenkins pipelineï¼Œè¯¥pipelineä½¿ç”¨&lt;code&gt;maven&lt;/code&gt; slaveæ„å»ºWARï¼Œç„¶åä½¿ç”¨å¸¦æœ‰&lt;code&gt;Dockerfile&lt;/code&gt;çš„äºŒè¿›åˆ¶æ„å»ºå°†WARæ·»åŠ åˆ° wildfly è¿è¡Œæ—¶æ˜ åƒã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mkdir mavenapp
&lt;span class="nb"&gt;cd&lt;/span&gt; mavenapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="2"&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ª&lt;code&gt;Dockerfile&lt;/code&gt;å°†WARå¤åˆ¶åˆ°wildflyé•œåƒå†…çš„é€‚å½“ä½ç½®ä»¥ä¾›æ‰§è¡Œã€‚å°†ä»¥ä¸‹å†…å®¹å¤åˆ¶åˆ°åä¸ºçš„æœ¬åœ°æ–‡ä»¶ &lt;code&gt;Dockerfile&lt;/code&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; wildfly:latest&lt;/span&gt;
&lt;span class="k"&gt;COPY&lt;/span&gt; ROOT.war /wildfly/standalone/deployments/ROOT.war
&lt;span class="k"&gt;CMD&lt;/span&gt;  &lt;span class="nv"&gt;$STI_SCRIPTS_PATH&lt;/span&gt;/run
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;ä¸ºè¯¥&lt;code&gt;Dockerfile&lt;/code&gt;åˆ›å»ºä¸€ä¸ªæ–°çš„BuildConfigï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;&lt;/p&gt;
&lt;p&gt;è¿™å°†è‡ªåŠ¨å¯åŠ¨ä¸€ä¸ªæ„å»º, åˆšå¼€å§‹ä¼šæ„å»ºå¤±è´¥ï¼Œå› ä¸º &lt;code&gt;ROOT.war&lt;/code&gt;å·¥ä»¶å°šä¸å¯ç”¨ã€‚ä¸‹é¢çš„pipelineå°†ä½¿ç”¨äºŒè¿›åˆ¶æ„å»ºå°†è¯¥WARåŒ…ä¼ é€’ç»™æ„å»ºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat Dockerfile &lt;span class="p"&gt;|&lt;/span&gt; oc new-build -D - --name mavenapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="4"&gt;
&lt;li&gt;åˆ›å»º1ä¸ªä½¿ç”¨Jenkins pipelineçš„BuildConfig, è¿™ä¸ªBuildConfigå°†æ„å»º1ä¸ªWARåŒ…ï¼Œç„¶åä½¿ç”¨è¯¥WARåŒ…å’Œå…ˆå‰åˆ›å»ºçš„&lt;code&gt;Dockerfile&lt;/code&gt;æ¥æ„å»ºé•œåƒã€‚ç›¸åŒçš„æ¨¡å¼å¯ç”¨äºå…¶ä»–å¹³å°ï¼Œå…¶ä¸­äºŒè¿›åˆ¶å·¥ä»¶ç”±ä¸€ç»„å·¥å…·æ„å»ºï¼Œç„¶åä¸æœ€ç»ˆçš„åŒ…å«ä¸åŒè¿è¡Œæ—¶çš„é•œåƒç»„åˆã€‚å°†ä»¥ä¸‹ä»£ç ä¿å­˜åˆ°&lt;code&gt;mavenapp-pipeline.yml&lt;/code&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;v1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;BuildConfig&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;mavenapp-pipeline&lt;/span&gt;
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;strategy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;jenkinsPipelineStrategy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;jenkinsfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;|-&lt;/span&gt;
        &lt;span class="no"&gt;pipeline {&lt;/span&gt;
          &lt;span class="no"&gt;agent { label &amp;quot;maven&amp;quot; }&lt;/span&gt;
          &lt;span class="no"&gt;stages {&lt;/span&gt;
            &lt;span class="no"&gt;stage(&amp;quot;Clone Source&amp;quot;) {&lt;/span&gt;
              &lt;span class="no"&gt;steps {&lt;/span&gt;
                &lt;span class="no"&gt;checkout([$class: &amp;#39;GitSCM&amp;#39;,&lt;/span&gt;
                            &lt;span class="no"&gt;branches: [[name: &amp;#39;*/master&amp;#39;]],&lt;/span&gt;
                            &lt;span class="no"&gt;extensions: [&lt;/span&gt;
                              &lt;span class="no"&gt;[$class: &amp;#39;RelativeTargetDirectory&amp;#39;, relativeTargetDir: &amp;#39;mavenapp&amp;#39;]&lt;/span&gt;
                            &lt;span class="no"&gt;],&lt;/span&gt;
                            &lt;span class="no"&gt;userRemoteConfigs: [[url: &amp;#39;https://github.com/openshift/openshift-jee-sample.git&amp;#39;]]&lt;/span&gt;
                        &lt;span class="no"&gt;])&lt;/span&gt;
              &lt;span class="no"&gt;}&lt;/span&gt;
            &lt;span class="no"&gt;}&lt;/span&gt;
            &lt;span class="no"&gt;stage(&amp;quot;Build WAR&amp;quot;) {&lt;/span&gt;
              &lt;span class="no"&gt;steps {&lt;/span&gt;
                &lt;span class="no"&gt;dir(&amp;#39;mavenapp&amp;#39;) {&lt;/span&gt;
                  &lt;span class="no"&gt;sh &amp;#39;mvn clean package -Popenshift&amp;#39;&lt;/span&gt;
                &lt;span class="no"&gt;}&lt;/span&gt;
              &lt;span class="no"&gt;}&lt;/span&gt;
            &lt;span class="no"&gt;}&lt;/span&gt;
            &lt;span class="no"&gt;stage(&amp;quot;Build Image&amp;quot;) {&lt;/span&gt;
              &lt;span class="no"&gt;steps {&lt;/span&gt;
                &lt;span class="no"&gt;dir(&amp;#39;mavenapp/target&amp;#39;) {&lt;/span&gt;
                  &lt;span class="no"&gt;sh &amp;#39;oc start-build mavenapp --from-dir . --follow&amp;#39;&lt;/span&gt;
                &lt;span class="no"&gt;}&lt;/span&gt;
              &lt;span class="no"&gt;}&lt;/span&gt;
            &lt;span class="no"&gt;}&lt;/span&gt;
          &lt;span class="no"&gt;}&lt;/span&gt;
        &lt;span class="no"&gt;}&lt;/span&gt;
    &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;JenkinsPipeline&lt;/span&gt;
  &lt;span class="nt"&gt;triggers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;[]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="5"&gt;
&lt;li&gt;åˆ›å»ºpipeline æ„å»ºã€‚å¦‚æœJenkinsæœªéƒ¨ç½²åˆ°æ‚¨çš„é¡¹ç›®ä¸­ï¼Œåˆ™ä½¿ç”¨ç®¡é“åˆ›å»ºçš„BuildConfigä¼šå…ˆéƒ¨ç½²Jenkinsã€‚åœ¨Jenkinså‡†å¤‡å»ºç«‹æ‚¨çš„ç®¡é“ä¹‹å‰å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ¥å¯åŠ¨ã€‚æ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨&lt;code&gt;oc rollout status dc/jenkins&lt;/code&gt;æ¥æ£€æŸ¥Jenkinsçš„çŠ¶æ€ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc create -f ./mavenapp-pipeline.yml
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="6"&gt;
&lt;li&gt;ä¸€æ—¦Jenkinså‡†å¤‡å°±ç»ªï¼Œå¯åŠ¨ä¹‹å‰å®šä¹‰çš„ç®¡é“ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc start-build mavenapp-pipeline
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="7"&gt;
&lt;li&gt;ç®¡é“æ„å»ºå®Œæˆåï¼Œä½¿ç”¨&lt;code&gt;new-app&lt;/code&gt;éƒ¨ç½²æ–°åº”ç”¨ç¨‹åºå¹¶å…¬å¼€å…¶routeï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc new-app mavenapp
oc expose svc/mavenapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="8"&gt;
&lt;li&gt;ä½¿ç”¨æµè§ˆå™¨ï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åºçš„è·¯å¾„ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc get route mavenapp
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 08 May 2019 18:41:34 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-05-08:/binary-builds-with-openshift.html</guid><category>openshift</category><category>docker</category><category>devops</category><category>git</category><category>containers</category></item><item><title>OpenShift å’Œ Kubernetes æœ‰ä»€ä¹ˆåŒºåˆ«?</title><link>https://www.EWhisper.cn/openshift-and-kubernetes-whats-difference.html</link><description>&lt;p&gt;OpenShift 3ä»¥å, æ¶æ„å®Œå…¨åŸºäºK8Sè¿›è¡Œäº†é‡æ„, ä½†æ˜¯åˆæœ‰ä¸€äº›å·®å¼‚. ä»Šå¤©, æˆ‘ä»¬å°±æ·±å…¥ç ”ç©¶ä¸€ä¸‹.&lt;/p&gt;
&lt;h2 id="k8s"&gt;K8S æ˜¯"å†…æ ¸"&lt;a class="headerlink" href="#k8s" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;K8Så¯ä»¥è®¤ä¸ºæ˜¯å½“ä»£åˆ†å¸ƒå¼ç³»ç»Ÿçš„"å†…æ ¸". æˆ‘ä»¬æ„è¯†åˆ°, ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„ä½œä¸šè°ƒåº¦ç¨‹åº, è·¨å¤šå°åŠå…¶è¿è¡Œ, èƒ½å¤Ÿåè°ƒæ‰˜ç®¡åœ¨éª‘ä¸Šçš„å·¥ä½œè´Ÿè½½çš„çŠ¶æ€, è‡ªç„¶å°±ä¼šä¿ƒè¿›å†™ä½œ, å°±åƒLinuxå†…æ ¸ä¸ºå•ä¸ªä¸»æœºä¸Šè°ƒåº¦å·¥ä½œè´Ÿè½½æ‰€åšçš„é‚£æ ·. éµå¾ªè¿™ä¸€é€»è¾‘, æˆ‘ä»¬çŸ¥é“ä¸åŒçš„äº§å“ä¼šæ ¹æ®é’ˆå¯¹ç”¨æˆ·çš„ä¸åŒè€Œå·®å¼‚åŒ–åœ°æ‰“é€ .&lt;/p&gt;
&lt;p&gt;åœ¨å¾ˆå¤šæ‰‹æœº, ç”µè„‘, æœåŠ¡å™¨, ç”šè‡³æ˜¯æ ‘è“æ´¾ä¸Š, è¿è¡Œçš„éƒ½æ˜¯ç›¸åŒçš„Linux å†…æ ¸, ä½†æ˜¯é€šè¿‡ä¸åŒçš„ä¸å®šæ¥æ”¯æŒå¤šç§å¤šæ ·çš„ç¡¬ä»¶.&lt;/p&gt;
&lt;p&gt;K8Så’Œå„ç§å„æ ·çš„K8Så‘è¡Œç‰ˆä¹Ÿé€‚ç”¨äºåŒæ ·çš„æ¨¡å‹, é€šè¿‡ä¸åŒç±»å‹çš„è¡¥ä¸, æ¥æ”¯æŒåœ¨K8Sä¸Šé¢çš„ä¸€å±‚. &lt;/p&gt;
&lt;h2 id="openshift"&gt;OpenShift æ˜¯å‘è¡Œç‰ˆ&lt;a class="headerlink" href="#openshift" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªå¼ºæœ‰åŠ›çš„åŒºåˆ«ã€‚OpenShiftå°±æ˜¯Kubernetesçš„å‘è¡Œç‰ˆï¼Œä¸“æ³¨äºå¼€å‘äººå‘˜çš„ä½“éªŒï¼Œè€Œå¼€å‘äººå‘˜éœ€è¦å¼€å‘ä¸‹ä¸€ä»£äº‘åŸç”Ÿåº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ä»»ä½•äººéƒ½å¯ä»¥é€šè¿‡é€‰æ‹©æ¯1ä¸ªéƒ¨åˆ†å¹¶æŒ‰ç…§æ¯ä¸ªç”¨æˆ·é€‰æ‹©çš„å®šåˆ¶æ–¹å¼ç»„è£…å®ƒä»¬æ¥&lt;a href="http://www.linuxfromscratch.org/"&gt;ä»Scratch &lt;/a&gt;æ„å»º&lt;a href="http://www.linuxfromscratch.org/"&gt;Linux&lt;/a&gt;ï¼Œä½†å¤§å¤šæ•°äººéƒ½æ²¡æœ‰ã€‚å¤§å¤šæ•°ç”¨æˆ·é€‰æ‹©çš„æŠ½è±¡çº§åˆ«æ„å‘³ç€ä»–ä»¬ä¸ä¼šä»ç®¡ç†ï¼ˆç”šè‡³äº†è§£ï¼‰Util-Linuxç‰ˆæœ¬2.31å’Œ2.33ä¹‹é—´çš„å·®å¼‚ä¸­è·å¾—å¾ˆå¤šä»·å€¼ã€‚ä¸ºäº†æ›´è¿›ä¸€æ­¥ï¼Œç”¨æˆ·å…³å¿ƒæœ€ä½çº§åˆ«çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œåªè¦è¶…è¿‡æœ€å°ç‰ˆæœ¬å·ï¼Œä»–ä»¬å°±çŸ¥é“å“ªäº›å‘½ä»¤/ APIå¯ç”¨ï¼‰ï¼Œç„¶åæä¾›æ‰€æä¾›åŠŸèƒ½çš„åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸OpenShiftéå¸¸ç›¸ä¼¼ã€‚OpenShiftå°†Kubernetesæ‰“åŒ…å¹¶åŒ…å«å…¶ä»–å·¥å…·ä½œä¸ºOpenShiftè®¤ä¸ºé‡è¦ä¸”OpenShiftçš„ç”¨æˆ·éœ€æ±‚çš„åŠŸèƒ½ã€‚å°±åƒCoreOSå’ŒCentOSåŒ…å«ä¸åŒçš„å·¥å…·é›†ä¸€æ ·ï¼Œè¿åˆä¸åŒçš„ç”¨æˆ·ï¼Œå› æ­¤Kuberneteså‘è¡Œç‰ˆä¹Ÿæ˜¯å¦‚æ­¤ã€‚&lt;/p&gt;
&lt;h2 id="openshiftk8s"&gt;OpenShiftå’ŒK8Sçš„å…·ä½“åŒºåˆ«&lt;a class="headerlink" href="#openshiftk8s" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="openshift_1"&gt;OpenShift æ¶æ„æ¦‚è¿°&lt;a class="headerlink" href="#openshift_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;OpenShiftå®¹å™¨å¹³å°æ˜¯ä¸€ç³»åˆ—æµè¡Œçš„ç»„ä»¶å’ŒæœåŠ¡çš„é›†åˆä½“, æ„å»ºäºRed Hat Enterprise Linux, Docker, å’ŒK8Sä¹‹ä¸Š. OpenShifté’ˆå¯¹å¼€å‘äººå‘˜, å¢å¼ºäº†ä»¥ä¸‹åŠŸèƒ½: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿œç¨‹ç®¡ç†&lt;/li&gt;
&lt;li&gt;å¤šç§Ÿæˆ·&lt;/li&gt;
&lt;li&gt;å®‰å…¨æ€§å¢å¼º&lt;/li&gt;
&lt;li&gt;åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†&lt;/li&gt;
&lt;li&gt;è‡ªæœåŠ¡æ¥å£&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="OpenShift æ¶æ„" src="./images/openshift-architecture-overview.png"&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šå›¾ä¸­, ä»ä¸‹è‡³ä¸Š, ä»å·¦è‡³å³, å±•ç¤ºäº†ç»è¿‡Red Hat åœ¨åŸºæœ¬çš„å®¹å™¨æ¶æ„åŸºç¡€ä¸Šè¿›ä¸€æ­¥é›†æˆã€å¢å¼ºçš„æ¶æ„:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºæœ¬OSæ˜¯Red Hat Enterprise Linux (RHEL)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Docker&lt;/strong&gt;  æä¾›äº†åŸºæœ¬çš„å®¹å™¨ç®¡ç†APIå’Œå®¹å™¨é•œåƒæ–‡ä»¶æ ¼å¼&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kubernetes&lt;/strong&gt; ç®¡ç†è¿è¡Œå®¹å™¨çš„ä¸»æœºé›†ç¾¤(å®ä½“çš„æˆ–è™šæ‹Ÿçš„). å®ƒé€šè¿‡èµ„æº(resources)æ¥æè¿°å¤šå®¹å™¨åº”ç”¨æ˜¯ç”±å¤šä¸ªèµ„æºç»„æˆçš„, ä»¥åŠä»–ä»¬é—´å¦‚ä½•äº¤äº’&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Etcd&lt;/strong&gt; æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ key-value å­˜å‚¨, Kubernetes é€šè¿‡å®ƒæ¥å­˜å‚¨é›†ç¾¤å†…çš„å…³äºå®¹å™¨å’Œå…¶ä»–èµ„æºçš„é…ç½®å’ŒçŠ¶æ€ä¿¡æ¯.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨Docker + Kubernetes ä¹‹ä¸Š, OpenShiftå¢åŠ äº†å®¹å™¨å¹³å°æ‰€éœ€è¦çš„å…¶ä»–åŠŸèƒ½. å…·ä½“åŒ…æ‹¬:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;OpenShift-Kubernetes æ‰©å±•&lt;/strong&gt; æ˜¯å­˜å‚¨åœ¨Etcdä¸­, ç”±Kubernetesç®¡ç†çš„é¢å¤–çš„èµ„æºç±»å‹(resource types). è¿™äº›é¢å¤–çš„èµ„æºç±»å‹ç»„æˆäº†OpenShift å†…éƒ¨çŠ¶æ€å’Œé…ç½®, è¿˜æœ‰åº”ç”¨çš„èµ„æº.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹å™¨åŒ–æœåŠ¡&lt;/strong&gt; å……å®äº†å¾ˆå¤šåŸºç¡€æ¶æ„åŠŸèƒ½, æ¯”å¦‚ç½‘ç»œå’Œè®¤è¯. è¿™äº›åŠŸèƒ½æœ‰äº›æ˜¯ä¸€ç›´è¿è¡Œçš„, æœ‰äº›æ˜¯æŒ‰éœ€å¯åŠ¨çš„. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶å’ŒxPaaS&lt;/strong&gt; æ˜¯ä¸ºå¼€å‘è€…å‡†å¤‡å¥½çš„å®¹å™¨é•œåƒ, æ¯ä¸ªéƒ½é¢„é…ç½®äº†ç‰¹å®šçš„è¯­è¨€è¿è¡Œæ—¶æˆ–æ•°æ®åº“. å¯ä»¥è¢«ç”¨ä½œé•œåƒæµ(Image Stream)æˆ–åœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ ä¸åŒçš„æ¡†æ¶, åº“, ç”šè‡³æ˜¯ä¸­é—´ä»¶æ¥è¿›è¡Œæ‰©å±•. xPaaS æä¾›äº†ä¸€ç³»åˆ—JBossä¸­é—´ä»¶äº§å“çš„åŸºç¡€é•œåƒ, å¦‚: JBoss EAP å’Œ ActiveMQ.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DevOps å·¥å…·é›†å’Œç”¨æˆ·ä½“éªŒ&lt;/strong&gt;: OpenShift ä¸ºå¼€å‘äººå‘˜å’Œç³»ç»Ÿç®¡ç†å‘˜æä¾›äº†ä¸€ä¸ªWeb UIå’ŒCLI ç®¡ç†å·¥å…·, å…è®¸é…ç½®å’Œç›‘æ§åº”ç”¨å’ŒOpenShiftçš„æœåŠ¡å’Œèµ„æº. Webå’Œ CLI éƒ½æ˜¯åŸºäºç›¸åŒçš„REST API, è¿™ä¸ªAPIä¹Ÿå¯ä»¥è¢«å¤–éƒ¨å·¥å…·(å¦‚: IDEå’ŒCIå¹³å°)æ•´åˆ. OpenShiftä¹Ÿå¯ä»¥è®¿é—®å¤–éƒ¨SCMåº“å’Œå®¹å™¨é•œåƒåº“.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; å¤‡æ³¨:&lt;/p&gt;
&lt;p&gt;OpenShift å›¢é˜Ÿ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¸®åŠ©K8S å®Œæˆäº†Namespace å’Œ quotaåŠŸèƒ½çš„å¼€å‘;&lt;/li&gt;
&lt;li&gt;æ¨åŠ¨äº†RBAC æˆæƒè®¤è¯çš„å¼€å‘&lt;/li&gt;
&lt;li&gt;å¸®åŠ©K8Sè¿è¡Œæ›´å¤šç±»å‹çš„åº”ç”¨, å¹¶ä¸ºå…¶å¼€å‘äº†ä¸€äº›å·æ’ä»¶(Volume Plugin)&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å¤šäº†Deployment Config(DC) resource. ä½¿ç”¨è¯¥èµ„æºå¯ä»¥è¿›è¡Œå‚æ•°åŒ–éƒ¨ç½², æ‰§è¡Œæ»šåŠ¨éƒ¨ç½²å’Œå›æ»šç­‰.&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å¤šäº†Route resource. è€ŒRouterä¹Ÿæ˜¯K8Sçš„IngressåŠŸèƒ½çš„å‰èº«.&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, é»˜è®¤é›†æˆäº†SDN (Open vSwitch)&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å®ç°äº†å¼€å‘è¿ç»´ä¸€ä½“åŒ–.&lt;/li&gt;
&lt;li&gt;çº³å…¥CoreOS&lt;/li&gt;
&lt;li&gt;OpenShift 3.11, é›†æˆäº†Prometheuså’ŒGrafana&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å¢å¼ºäº†ç®¡ç†ç‰©ç†èŠ‚ç‚¹çš„èƒ½åŠ›&lt;/li&gt;
&lt;li&gt;ç›®å‰, OpenShiftè¿˜å’ŒNVåˆä½œ, æœªæ¥ä¼šæä¾›åŸºäºGPUè¿ç®—èƒ½åŠ›çš„æ”¯æŒ.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h3 id="_1"&gt;èµ„æºç±»å‹å·®å¼‚&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Kubernetes èµ„æºç±»å‹&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Pods&lt;/li&gt;
&lt;li&gt;Services&lt;/li&gt;
&lt;li&gt;Replication Controllers&lt;/li&gt;
&lt;li&gt;Persistent Volume (PV)&lt;/li&gt;
&lt;li&gt;Persistent Volume Claims (PVC)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;OpenShift èµ„æºç±»å‹&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;é™¤äº†ä»¥ä¸Šèµ„æºç±»å‹, OpenShift è¿˜å¢åŠ äº†ä»¥ä¸‹ä¸»è¦çš„èµ„æºç±»å‹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Deployment Configurations (DC) - ç”¨äº æŒç»­äº¤ä»˜(CD)å·¥ä½œæµ&lt;/li&gt;
&lt;li&gt;Build Configurations (BC) - ç”¨äº æŒç»­é›†æˆ(CI) å·¥ä½œæµ&lt;/li&gt;
&lt;li&gt;Routes - åŸºäºHAProxy, ä½œç”¨ç±»ä¼¼äºK8S Ingress, ä½†æ—©äºIngress.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="openshift-s2i"&gt;OpenShift ç‰¹æœ‰çš„S2I åŠŸèƒ½&lt;a class="headerlink" href="#openshift-s2i" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;OpenShiftä¸­çš„Source-to-Image (S2I) è¿›ç¨‹ä¼šä»SCMä»“åº“ä¸­æ‹‰å–ä»£ç , è‡ªåŠ¨åŒ–ç›‘æµ‹ä»£ç éœ€è¦å“ªç§ç±»å‹çš„è¿è¡Œæ—¶, å¹¶ä»ç‰¹å®šè¿è¡Œæ—¶çš„åŸºç¡€é•œåƒå¯åŠ¨ä¸€ä¸ªpod. åœ¨è¿™ä¸ªpod ä¸­, OpenShift ä»¥å¼€å‘äººå‘˜ç›¸åŒçš„æ–¹å¼æ¥æ„å»ºè¯¥åº”ç”¨(å¦‚, ä½¿ç”¨&lt;strong&gt;maven&lt;/strong&gt;æ¥æ„å»ºjavaç¨‹åº). å¦‚æœæ„å»ºæˆåŠŸ, å¦ä¸€ä¸ªé•œåƒä¼šè¢«åˆ›å»º, æŠŠåº”ç”¨äºŒè¿›åˆ¶é™„åŠ åˆ°è¿è¡Œæ—¶å±‚ä¹‹ä¸Š, å¹¶æŠŠè¿™ä¸ªæ–°é•œåƒæ¨é€åˆ°OpenShiftçš„å†…éƒ¨é•œåƒä»“åº“ä¸­. æ¥ä¸‹æ¥, å¯ä»¥ä»è¿™ä¸ªæ–°é•œåƒåˆ›å»ºä¸€ä¸ªpodæ¥è¿è¡Œè¯¥åº”ç”¨. S2I å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªåµŒå…¥åˆ°OpenShiftå¹³å°ä¸­çš„ CI/CD pipeline.&lt;/p&gt;
&lt;p&gt;CI/CD pipelines ä¼šæœ‰å¾ˆå¤šç§å˜å¼‚, è¿™ä¸ªpipelineä¼šæš´éœ²åœ¨è¿™ä¸ªé¡¹ç›®(project, å°±æ˜¯K8Sçš„namespace)ä¸­, é‚£ä¹ˆå®ƒå°±å¯ä»¥è¢«è°ƒèŠ‚æ¥æ»¡è¶³å¼€å‘äººå‘˜çš„éœ€æ±‚. ä¾‹å¦‚, å¤–éƒ¨CIå·¥å…·(å¦‚Jenkins)å¯ä»¥ç”¨äºæ¥å¯åŠ¨å’Œè¿è¡Œæµ‹è¯•, ç„¶åç»™æ–°é•œåƒæ‰“ä¸Š"æˆåŠŸ"æˆ–"å¤±è´¥"çš„æ ‡ç­¾(label), å¹¶æ¨é€åˆ°QAæˆ–ç”Ÿäº§ç¯å¢ƒ. éšç€æ—¶é—´æ¨ç§», ä¸€ä¸ªç»„ç»‡ä¸€ä¸ªéƒ¨é—¨ä¸€ä¸ªå…¬å¸å¯ä»¥åˆ›å»ºä»–ä»¬è‡ªå·±çš„pipelineæ¨¡æ¿, åŒ…æ‹¬è‡ªå®šä¹‰çš„æ„å»ºå™¨å’Œéƒ¨ç½²å™¨.&lt;/p&gt;
&lt;h2 id="_2"&gt;æ€»ç»“&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;OpenShift å¹³å°ç›¸æ¯”K8S, å…·æœ‰ä»¥ä¸‹ç‰¹æ€§:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªæœåŠ¡å¹³å°;&lt;/li&gt;
&lt;li&gt;å¤šè¯­è¨€, å¤šä¸­é—´ä»¶, æ•°æ®åº“æ”¯æŒ&lt;/li&gt;
&lt;li&gt;é«˜å¯ç”¨, å¯ä¼¸ç¼©æ€§&lt;/li&gt;
&lt;li&gt;ä¹Ÿæ˜¯å¼€æºçš„(Red Hatæ”¶å–æœåŠ¡è´¹)&lt;/li&gt;
&lt;li&gt;å®‰å…¨ (åŸºäº: RBAC, LDAP, ä¸»æœº, ç½‘ç»œ, å®¹å™¨å„ä¸ªå±‚é¢çš„åŠ å›º)&lt;/li&gt;
&lt;li&gt;åŠ¨æ€å­˜å‚¨ç®¡ç†&lt;/li&gt;
&lt;li&gt;ä¼ä¸šçº§&lt;/li&gt;
&lt;li&gt;æ—¥å¿—æ•´åˆ/ ç›‘æ§æ•´åˆ&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Fri, 03 May 2019 16:51:34 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-05-03:/openshift-and-kubernetes-whats-difference.html</guid><category>docker</category><category>openshift</category><category>k8s</category><category>containers</category><category>PAAS</category></item></channel></rss>