<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>ä¸œé£å¾®é¸£ Blog - DevOps</title><link>https://www.EWhisper.cn/</link><description>Focus on Python/Java/DevOps/Observability</description><lastBuildDate>Sun, 23 Jun 2019 17:08:00 +0800</lastBuildDate><item><title>NGINX å­¦ä¹ ç¬”è®°-Gzipå‹ç¼©-`ngx_http_gunzip_module`</title><link>https://www.EWhisper.cn/nginx-notebook-3-3-gunzip-module.html</link><description>&lt;h2 id="3-ngx_http_gunzip_module"&gt;3 ngx_http_gunzip_module&lt;a class="headerlink" href="#3-ngx_http_gunzip_module" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;å¦‚æœå®¢æˆ·ç«¯æœ¬èº«ä¸æ”¯æŒè§£å‹Gzip, å°±éœ€è¦NginxæœåŠ¡å™¨åœ¨å‘å…¶å‘é€æ•°æ®å‰å…ˆå°†è¯¥æ•°æ®è§£å‹. è¿™äº›å‹ç¼©æ•°æ®å¯èƒ½æ¥è‡ªäºåç«¯æœåŠ¡å™¨å‹ç¼©äº§ç”Ÿæˆ–NginxæœåŠ¡å™¨é¢„å‹ç¼©äº§ç”Ÿ.&lt;/p&gt;
&lt;p&gt;è¯¥æ¨¡å—ä¸æ˜¯é»˜è®¤æ„å»ºçš„ï¼Œåº”è¯¥ä½¿ç”¨ &lt;code&gt;--with-http_gunzip_module&lt;/code&gt; é…ç½®å‚æ•°å¯ç”¨ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 17:08:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-3-3-gunzip-module.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å­¦ä¹ ç¬”è®°-Gzipå‹ç¼©-Gzipå‹ç¼©åŠŸèƒ½çš„ä½¿ç”¨</title><link>https://www.EWhisper.cn/nginx-notebook-3-4-gzip-howto.html</link><description>&lt;h2 id="4-gzip"&gt;4 Gzipå‹ç¼©åŠŸèƒ½çš„ä½¿ç”¨&lt;a class="headerlink" href="#4-gzip" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="gzip"&gt;Gzipå‹ç¼©åŠŸèƒ½ç»¼åˆé…ç½®ç¤ºä¾‹&lt;a class="headerlink" href="#gzip" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;gzip&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;gzip_min_length&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;gzip_buffers&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt; &lt;span class="mi"&gt;4k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;gzip_comp_level&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;gzip_types&lt;/span&gt; &lt;span class="s"&gt;text/plain&lt;/span&gt; &lt;span class="s"&gt;application/x-javascript&lt;/span&gt; &lt;span class="s"&gt;text/css&lt;/span&gt; &lt;span class="s"&gt;application/xml&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;gzip_vary&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;gunzip_static&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="gzip-ie6"&gt;Gzip å‹ç¼©åŠŸèƒ½ä¸IE6æµè§ˆå™¨è¿è¡Œè„šæœ¬çš„å…¼å®¹é—®é¢˜&lt;a class="headerlink" href="#gzip-ie6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;gzip_disable&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;MSIE&lt;/span&gt; &lt;span class="s"&gt;[1-6]\.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="nginxgzip"&gt;Nginxä¸å…¶ä»–æœåŠ¡å™¨äº¤äº’æ—¶äº§ç”Ÿçš„Gzipå‹ç¼©åŠŸèƒ½ç›¸å…³é—®é¢˜&lt;a class="headerlink" href="#nginxgzip" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ä¸¤ç±»é—®é¢˜:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¤šå±‚æœåŠ¡å™¨åŒæ—¶å¼€å¯Gzipå‹ç¼©åŠŸèƒ½å¯¼è‡´;&lt;/li&gt;
&lt;li&gt;å¤šå±‚æœåŠ¡å™¨ä¹‹é—´å¯¹Gzipå‹ç¼©åŠŸèƒ½æ”¯æŒèƒ½åŠ›ä¸åŒå¯¼è‡´.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Nginxä¸åç«¯æœåŠ¡å™¨(å¦‚Tomcat)åŒæ—¶å¼€å¯Gzipå‹ç¼©åŠŸèƒ½å¯¹JavaScriptè„šæœ¬è¿›è¡Œå‹ç¼©, åœ¨å¤§å¤šæ•°æµè§ˆå™¨ä¸­åˆ·æ–°é¡µé¢ä¼šå¯¼è‡´è„šæœ¬è¿è¡Œå‘ç”Ÿå¼‚å¸¸, å”¯ä¸€å¯ä»¥è¿è¡Œçš„æµè§ˆå™¨æ˜¯Chrome.&lt;/p&gt;
&lt;p&gt;è§£å†³åŠæ³•:&lt;strong&gt;å¯¹äºåŒ…å«å¤šå±‚æœåŠ¡å™¨çš„ç³»ç»Ÿæ¥è¯´, NginxæœåŠ¡å™¨ä½œä¸ºå‰ç«¯æœåŠ¡å™¨å¦‚æœå¼€å¯äº†Gzipå‹ç¼©åŠŸèƒ½, åç«¯æœåŠ¡å™¨æœ€å¥½å°±ä¸è¦å†å¼€å¯äº†.&lt;/strong&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 17:08:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-3-4-gzip-howto.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å­¦ä¹ ç¬”è®°-Gzipå‹ç¼©-`ngx_http_gzip_static_module`</title><link>https://www.EWhisper.cn/nginx-notebook-3-2-gzip-static-module.html</link><description>&lt;h2 id="2-ngx_http_gzip_static_module"&gt;2 ngx_http_gzip_static_module&lt;a class="headerlink" href="#2-ngx_http_gzip_static_module" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;è¯¥æ¨¡å—ä¸æ˜¯é»˜è®¤æ„å»ºçš„ï¼Œå®ƒåº”è¯¥ä½¿ç”¨ &lt;code&gt;--with-http_gzip_static_module&lt;/code&gt; é…ç½®å‚æ•°å¯ç”¨ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 17:05:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-3-2-gzip-static-module.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å­¦ä¹ ç¬”è®°-é«˜çº§é…ç½®-äº‹ä»¶é©±åŠ¨æ¨¡å‹ç›¸å…³çš„é…ç½®æŒ‡ä»¤</title><link>https://www.EWhisper.cn/nginx-notebook-2-4-events-directives.html</link><description>&lt;h2 id="4"&gt;4 äº‹ä»¶é©±åŠ¨æ¨¡å‹ç›¸å…³çš„é…ç½®æŒ‡ä»¤&lt;a class="headerlink" href="#4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;use&lt;/code&gt;(æŒ‡å®šäº‹ä»¶é©±åŠ¨æ¨¡å‹)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;worker_connections&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç”¨äºè®¾ç½®NginxæœåŠ¡å™¨çš„&lt;strong&gt;æ¯ä¸ªå·¥ä½œè¿›ç¨‹&lt;/strong&gt;å…è®¸åŒæ—¶è¿æ¥å®¢æˆ·ç«¯çš„æœ€å¤§æ•°é‡(åŒ…æ‹¬å‰ç«¯ç”¨æˆ·è¿æ¥ä¹ŸåŒ…æ‹¬å…¶ä»–è¿æ¥)&lt;/p&gt;
&lt;p&gt;NginxæœåŠ¡å™¨å…è®¸åŒæ—¶è¿æ¥çš„å®¢æˆ·ç«¯æœ€å¤§æ•°é‡ &lt;code&gt;Client = worker_processes * worker_connections / 2&lt;/code&gt;&lt;/p&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;code&gt;worker_rlimit_sigpending&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;äº‹ä»¶é©±åŠ¨æ¨¡å‹rtsigå¯ä»¥ä¿å­˜çš„æœ€å¤§ä¿¡å·æ•°.&lt;/p&gt;
&lt;ol start="4"&gt;
&lt;li&gt;&lt;code&gt;devpoll_changes&lt;/code&gt; &lt;code&gt;devpoll_events&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç”¨äºè®¾ç½®åœ¨&lt;code&gt;/dev/poll&lt;/code&gt;äº‹ä»¶é©±åŠ¨æ¨¡å¼ä¸‹NginxæœåŠ¡å™¨ä¸å†…æ ¸ä¹‹é—´ä¼ é€’äº‹ä»¶çš„æ•°é‡.å‰è€…è®¾ç½®ä¼ é€’ç»™å†…æ ¸çš„äº‹ä»¶æ•°é‡, åè€…è®¾ç½®ä»å†…æ ¸è·å–çš„äº‹ä»¶æ•°é‡.&lt;/p&gt;
&lt;p&gt;é»˜è®¤å€¼ä¸º32&lt;/p&gt;
&lt;ol start="5"&gt;
&lt;li&gt;&lt;code&gt;kqueue_changes&lt;/code&gt; å’Œ &lt;code&gt;kqueue_events&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;kqueueäº‹ä»¶æ¨¡å‹ä¸‹. é»˜è®¤å€¼å‡ä¸º512&lt;/p&gt;
&lt;ol start="6"&gt;
&lt;li&gt;&lt;code&gt;epoll_events&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;epolläº‹ä»¶æ¨¡å‹ä¸‹, ä»Nginxåˆ°å†…æ ¸, ä»å†…æ ¸åˆ°Nginxç›¸ç­‰. é»˜è®¤å€¼ä¸º512.&lt;/p&gt;
&lt;ol start="7"&gt;
&lt;li&gt;&lt;code&gt;rtsig_signo&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;rtsigæ¨¡å¼. é»˜è®¤ç¬¬ä¸€ä¸ªä¿¡å·è®¾ç½®ä¸ºSIGRTMIN+10&lt;/p&gt;
&lt;ol start="8"&gt;
&lt;li&gt;&lt;code&gt;rtsig_overflow_*&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt;å¤‡æ³¨:&lt;/p&gt;
&lt;p&gt;ç°åœ¨çš„Linuxå‘è¡Œç‰ˆä¸€èˆ¬æ¨èä½¿ç”¨&lt;code&gt;epoll&lt;/code&gt;äº‹ä»¶é©±åŠ¨æ¨¡å‹&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 16:33:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-2-4-events-directives.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å­¦ä¹ ç¬”è®°-Gzipå‹ç¼©-`ngx_http_gzip_module`</title><link>https://www.EWhisper.cn/nginx-notebook-3-1-gzip-module.html</link><description>&lt;p&gt;æœ¬ç³»åˆ—æ–‡ç« ä¸»è¦è®¨è®ºä¸gzip å‹ç¼©ç›¸å…³çš„Nginx æŒ‡ä»¤.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç›¸å…³æ¨¡å—: &lt;code&gt;ngx_http_gzip_module ngx_http_gzip_static_module ngx_http_gunzip_module&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="1-ngx_http_gzip_module"&gt;1 ngx_http_gzip_module&lt;a class="headerlink" href="#1-ngx_http_gzip_module" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;gzip on | off&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;gzip_buffers&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç”¨äºè®¾ç½®Gzipå‹ç¼©æ–‡ä»¶ä½¿ç”¨ç¼“å­˜ç©ºé—´çš„å¤§å°.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gzip_buffers number size;    # number ç¼“å­˜ç©ºé—´ä¸ªæ•°; size æ¯ä¸ªç©ºé—´å¤§å°&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;é»˜è®¤&lt;em&gt;number Ã— size&lt;/em&gt; ä¸º128. sizeçš„å€¼æ¨èå–ç³»ç»Ÿå†…å­˜é¡µä¸€é¡µçš„å¤§å°, ä¸º4KB æˆ–è€…8KB. å³&lt;code&gt;gzip_buffers 32 4k | 16 8k&lt;/code&gt;&lt;/p&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;code&gt;gzip_comp_level&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è®¾å®šGzipå‹ç¼©ç¨‹åº¦, åŒ…æ‹¬1åˆ°9. 1å‹ç¼©ç¨‹åº¦æœ€ä½, 9æœ€é«˜. é»˜è®¤ä¸º1.&lt;/p&gt;
&lt;ol start="4"&gt;
&lt;li&gt;&lt;code&gt;gzip_disable&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt;å¤‡æ³¨&lt;/p&gt;
&lt;p&gt;é’ˆå¯¹ä¸åŒç§ç±»å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚, å¯ä»¥é€‰æ‹©æ€§åœ°å¼€å¯å’Œå…³é—­gzipåŠŸèƒ½.&lt;/p&gt;
&lt;p&gt;PCç«¯ï¼š&lt;/p&gt;
&lt;p&gt;safari 5.1 â€“ MAC&lt;/p&gt;
&lt;p&gt;User-Agent:Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 &amp;gt; (KHTML, like Gecko) Version/5.1 Safari/534.50&lt;/p&gt;
&lt;p&gt;safari 5.1 â€“ Windows&lt;/p&gt;
&lt;p&gt;User-Agent:Mozilla/5.0 (Windows; U; Windows NT 6.1; en-us) AppleWebKit/534.50 (KHTML, &amp;gt; like Gecko) Version/5.1 Safari/534.50&lt;/p&gt;
&lt;p&gt;IE 9.0&lt;/p&gt;
&lt;p&gt;User-Agent:Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0;&lt;/p&gt;
&lt;p&gt;IE 8.0&lt;/p&gt;
&lt;p&gt;User-Agent:Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)&lt;/p&gt;
&lt;p&gt;IE 7.0&lt;/p&gt;
&lt;p&gt;User-Agent:Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)&lt;/p&gt;
&lt;p&gt;IE 6.0&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)&lt;/p&gt;
&lt;p&gt;Firefox 4.0.1 â€“ MAC&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:2.0.1) Gecko/20100101 &amp;gt; Firefox/4.0.1&lt;/p&gt;
&lt;p&gt;Firefox 4.0.1 â€“ Windows&lt;/p&gt;
&lt;p&gt;User-Agent:Mozilla/5.0 (Windows NT 6.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1&lt;/p&gt;
&lt;p&gt;Opera 11.11 â€“ MAC&lt;/p&gt;
&lt;p&gt;User-Agent:Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; en) Presto/2.8.131 Version/&amp;gt; 11.11&lt;/p&gt;
&lt;p&gt;Opera 11.11 â€“ Windows&lt;/p&gt;
&lt;p&gt;User-Agent:Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11&lt;/p&gt;
&lt;p&gt;Chrome 17.0 â€“ MAC&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_0) AppleWebKit/535.11 (KHTML, &amp;gt; like Gecko) Chrome/17.0.963.56 Safari/535.11&lt;/p&gt;
&lt;p&gt;å‚²æ¸¸ï¼ˆMaxthonï¼‰&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Maxthon 2.0)&lt;/p&gt;
&lt;p&gt;è…¾è®¯TT&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; TencentTraveler 4.0)&lt;/p&gt;
&lt;p&gt;ä¸–ç•Œä¹‹çª—ï¼ˆThe Worldï¼‰ 2.x&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&lt;/p&gt;
&lt;p&gt;ä¸–ç•Œä¹‹çª—ï¼ˆThe Worldï¼‰ 3.x&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; The World)&lt;/p&gt;
&lt;p&gt;æœç‹—æµè§ˆå™¨ 1.x&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SE 2.X &amp;gt; MetaSr 1.0; SE 2.X MetaSr 1.0; .NET CLR 2.0.50727; SE 2.X MetaSr 1.0)&lt;/p&gt;
&lt;p&gt;360æµè§ˆå™¨&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; 360SE)&lt;/p&gt;
&lt;p&gt;Avant&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Avant Browser)&lt;/p&gt;
&lt;p&gt;Green Browser&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&lt;/p&gt;
&lt;p&gt;ç§»åŠ¨è®¾å¤‡ç«¯ï¼š&lt;/p&gt;
&lt;p&gt;safari iOS 4.33 â€“ iPhone&lt;/p&gt;
&lt;p&gt;User-Agent:Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_3 like Mac OS X; en-us) &amp;gt; AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5&lt;/p&gt;
&lt;p&gt;safari iOS 4.33 â€“ iPod Touch&lt;/p&gt;
&lt;p&gt;User-Agent:Mozilla/5.0 (iPod; U; CPU iPhone OS 4_3_3 like Mac OS X; en-us) AppleWebKit/&amp;gt; 533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5&lt;/p&gt;
&lt;p&gt;safari iOS 4.33 â€“ iPad&lt;/p&gt;
&lt;p&gt;User-Agent:Mozilla/5.0 (iPad; U; CPU OS 4_3_3 like Mac OS X; en-us) AppleWebKit/&amp;gt; 533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5&lt;/p&gt;
&lt;p&gt;Android N1&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/5.0 (Linux; U; Android 2.3.7; en-us; Nexus One Build/FRF91) &amp;gt; AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1&lt;/p&gt;
&lt;p&gt;Android QQæµè§ˆå™¨ For android&lt;/p&gt;
&lt;p&gt;User-Agent: MQQBrowser/26 Mozilla/5.0 (Linux; U; Android 2.3.7; zh-cn; MB200 Build/&amp;gt; GRJ22; CyanogenMod-7) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/&amp;gt; 533.1&lt;/p&gt;
&lt;p&gt;Android Opera Mobile&lt;/p&gt;
&lt;p&gt;User-Agent: Opera/9.80 (Android 2.3.4; Linux; Opera Mobi/build-1107180945; U; en-GB) &amp;gt; Presto/2.8.149 Version/11.10&lt;/p&gt;
&lt;p&gt;Android Pad Moto Xoom&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/5.0 (Linux; U; Android 3.0; en-us; Xoom Build/HRI39) AppleWebKit/&amp;gt; 534.13 (KHTML, like Gecko) Version/4.0 Safari/534.13&lt;/p&gt;
&lt;p&gt;BlackBerry&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/5.0 (BlackBerry; U; BlackBerry 9800; en) AppleWebKit/534.1+ (KHTML, &amp;gt; like Gecko) Version/6.0.0.337 Mobile Safari/534.1+&lt;/p&gt;
&lt;p&gt;WebOS HP Touchpad&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/5.0 (hp-tablet; Linux; hpwOS/3.0.0; U; en-US) AppleWebKit/534.6 &amp;gt; (KHTML, like Gecko) wOSBrowser/233.70 Safari/534.6 TouchPad/1.0&lt;/p&gt;
&lt;p&gt;Nokia N97&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/5.0 (SymbianOS/9.4; Series60/5.0 NokiaN97-1/20.0.019; Profile/&amp;gt; MIDP-2.1 Configuration/CLDC-1.1) AppleWebKit/525 (KHTML, like Gecko) BrowserNG/7.1.18124&lt;/p&gt;
&lt;p&gt;Windows Phone Mango&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows Phone OS 7.5; Trident/5.0; &amp;gt; IEMobile/9.0; HTC; Titan)&lt;/p&gt;
&lt;p&gt;UCæ— &lt;/p&gt;
&lt;p&gt;User-Agent: UCWEB7.0.2.37/28/999&lt;/p&gt;
&lt;p&gt;UCæ ‡å‡†&lt;/p&gt;
&lt;p&gt;User-Agent: NOKIA5700/ UCWEB7.0.2.37/28/999&lt;/p&gt;
&lt;p&gt;UCOpenwave&lt;/p&gt;
&lt;p&gt;User-Agent: Openwave/ UCWEB7.0.2.37/28/999&lt;/p&gt;
&lt;p&gt;UC Opera&lt;/p&gt;
&lt;p&gt;User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; ) Opera/UCWEB7.0.2.37/28/999&lt;br&gt;
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¤ºä¾‹:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gzip_disable MSIE [4-6]\.&lt;/code&gt;&lt;/p&gt;
&lt;ol start="5"&gt;
&lt;li&gt;&lt;code&gt;gzip_http_version&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;gzip_http_version 1.0 | 1.1&lt;/code&gt; é»˜è®¤è®¾ç½®ä¸º1.1ç‰ˆæœ¬.å³åªæœ‰å®¢æˆ·ç«¯ä½¿ç”¨1.1åŠä»¥ä¸Šç‰ˆæœ¬çš„HTTPåè®®æ—¶, æ‰ä½¿ç”¨GzipåŠŸèƒ½. ä¸€èˆ¬ä½¿ç”¨é»˜è®¤å€¼.&lt;/p&gt;
&lt;ol start="6"&gt;
&lt;li&gt;&lt;code&gt;gzip_min_length&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœå‹ç¼©å¾ˆå°çš„æ•°æ®, å¯èƒ½å‡ºç°è¶Šå‹ç¼©æ•°æ®é‡è¶Šå¤§çš„æƒ…å†µ. å› æ­¤æ ¹æ®å“åº”é¡µé¢çš„å¤§å°, é€‰æ‹©æ€§åœ°å¼€å¯æˆ–è€…å…³é—­GzipåŠŸèƒ½. è¯¥æŒ‡ä»¤è®¾ç½®é¡µé¢çš„å­—èŠ‚æ•°. &lt;strong&gt;å“åº”é¡µé¢çš„å¤§å°é€šè¿‡HTTPå“åº”å¤´éƒ¨ä¸­çš„Content-LengthæŒ‡ä»¤è·å–, ä½†æ˜¯å¦‚æœä½¿ç”¨äº†Chunk ç¼–ç åŠ¨æ€å‹ç¼©, Content-Lengthæˆ–ä¸å­˜åœ¨æˆ–è¢«å¿½ç•¥, è¯¥æŒ‡ä»¤ä¸èµ·ä½œç”¨&lt;/strong&gt;. é»˜è®¤è®¾ç½®ä¸º20. è®¾ç½®ä¸º0æ—¶ç»Ÿç»Ÿå‹ç¼©. å»ºè®®è¯¥å€¼ä¸º&lt;strong&gt;1KBæˆ–ä»¥ä¸Š&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gzip_min_length 1024&lt;/code&gt;&lt;/p&gt;
&lt;ol start="7"&gt;
&lt;li&gt;&lt;code&gt;gzip_proxied&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¯¥æŒ‡ä»¤åœ¨ä½¿ç”¨NginxæœåŠ¡å™¨çš„åå‘ä»£ç†åŠŸèƒ½æ—¶æœ‰æ•ˆ, å‰ææ˜¯åœ¨åç«¯æœåŠ¡å™¨è¿”å›çš„å“åº”é¡µå¤´éƒ¨ä¸­, Requests éƒ¨åˆ†åŒ…å«ç”¨äºé€šçŸ¥ä»£ç†æœåŠ¡å™¨çš„Viaå¤´åŸŸ.  ä¸»è¦ç”¨äºè®¾ç½®NginxæœåŠ¡å™¨æ˜¯å¦å¯¹åç«¯æœåŠ¡å™¨è¿”å›çš„ç»“æœè¿›è¡ŒGzipå‹ç¼©.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Syntax&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;gzip_proxied&lt;/span&gt; &lt;span class="n"&gt;off&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;expired&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;no&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cache&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;no&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;store&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;no_last_modified&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;no_etag&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;auth&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;any&lt;/span&gt; &lt;span class="o"&gt;...;&lt;/span&gt;
&lt;span class="n"&gt;Default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;gzip_proxied&lt;/span&gt; &lt;span class="n"&gt;off&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;location&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;off å…³é—­, é»˜è®¤è®¾ç½®;&lt;/li&gt;
&lt;li&gt;expired å½“åç«¯æœåŠ¡å™¨å“åº”é¡µå¤´éƒ¨åŒ…å«ç”¨äºæ”¯æŒå“åº”æ•°æ®è¿‡æœŸäº‹ä»¶çš„expiredå¤´åŸŸæ—¶, å¯ç”¨Gzip.&lt;/li&gt;
&lt;li&gt;no-cache å½“åç«¯åŒ…å«Cache-Controlå¤´åŸŸ, ä¸”å…¶æŒ‡ä»¤å€¼ä¸ºno-cacheæ—¶, å¯ç”¨.&lt;/li&gt;
&lt;li&gt;no-store å½“åç«¯åŒ…å«Cache-Controlå¤´åŸŸ, ä¸”å…¶æŒ‡ä»¤å€¼ä¸ºno-storeæ—¶, å¯ç”¨.&lt;/li&gt;
&lt;li&gt;private å½“åç«¯åŒ…å«Cache-Controlå¤´åŸŸ, ä¸”å…¶æŒ‡ä»¤å€¼ä¸ºprivateæ—¶, å¯ç”¨.&lt;/li&gt;
&lt;li&gt;no_last_modified å½“åç«¯æœåŠ¡å™¨å“åº”å¤´ä¸åŒ…å«ç”¨äºæŒ‡æ˜éœ€è¦è·å–æ•°æ®æœ€åä¿®æ”¹æ—¶é—´çš„Last-Modified åŸŸæ—¶, å¯ç”¨.&lt;/li&gt;
&lt;li&gt;no_etag ä¸åŒ…å«ETagæ—¶, å¯ç”¨.&lt;/li&gt;
&lt;li&gt;auth åŒ…å«Authorization, å¯ç”¨&lt;/li&gt;
&lt;li&gt;any æ— æ¡ä»¶å¯ç”¨å‹ç¼©.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="8"&gt;
&lt;li&gt;&lt;code&gt;gzip_types&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ ¹æ®å“åº”é¡µçš„MIMEç±»å‹é€‰æ‹©æ€§åœ°å¼€å¯Gzipå‹ç¼©åŠŸèƒ½.  é»˜è®¤ä¸ºtext/html. è¿˜å¯ä»¥å–'*', è¡¨ç¤ºå¯¹æ‰€æœ‰MIMEç±»å‹è¿›è¡ŒGzipå‹ç¼©. æ¨èè®¾ç½®:(é€šå¸¸æ–‡æœ¬/å›¾ç‰‡/jséƒ½å¯ä»¥å‹ç¼©)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gzip_types       text/plain application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;&lt;/code&gt;&lt;/p&gt;
&lt;ol start="9"&gt;
&lt;li&gt;&lt;code&gt;gzip_vary&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é»˜è®¤ä¸ºoff. æ¨èå¼€å¯. å¼€å¯åçš„æ•ˆæœå®åœ¨å“åº”å¤´éƒ¨æ·»åŠ äº†Accept-Encoding: gzip, è¿™å¯¹äºæœ¬èº«ä¸æ”¯æŒGzipå‹ç¼©çš„å®¢æˆ·ç«¯æµè§ˆå™¨æ˜¯æœ‰ç”¨çš„.&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥é€šè¿‡add_headerè¾¾åˆ°ç›¸åŒçš„æ•ˆæœ:&lt;code&gt;add_header Vary Accept-Encoding gzip;&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;:heavy_exclamation_mark: è¯¥æŒ‡ä»¤åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å­˜åœ¨bug, ä¼šå¯¼è‡´IE4åŠä»¥ä¸Šçš„æµè§ˆå™¨çš„æ•°æ®ç¼“å­˜åŠŸèƒ½å¤±æ•ˆ.&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 16:33:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-3-1-gzip-module.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å­¦ä¹ ç¬”è®°-é«˜çº§é…ç½®-ä¸ç½‘ç»œè¿æ¥ç›¸å…³çš„æŒ‡ä»¤</title><link>https://www.EWhisper.cn/nginx-notebook-2-3-network-directives.html</link><description>&lt;h2 id="3"&gt;3 ä¸ç½‘ç»œè¿æ¥ç›¸å…³çš„é…ç½®æŒ‡ä»¤&lt;a class="headerlink" href="#3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;keepalive_timeout&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;keepalive_timeout 60 50;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;NginxæœåŠ¡å™¨ä¸å®¢æˆ·ç«¯è¿æ¥ä¿æŒæ´»åŠ¨çš„æ—¶é—´ä¸º60s, 60såæœåŠ¡å™¨ä¸å®¢æˆ·ç«¯æ–­å¼€è¿æ¥; ä½¿ç”¨Keep-Alive æ¶ˆæ¯å¤´ä¿æŒä¸å®¢æˆ·ç«¯æŸäº›æµè§ˆå™¨(å¦‚ç«ç‹)çš„è¿æ¥æ—¶é—´ä¸º50s, 50såæµè§ˆå™¨ä¸»åŠ¨ä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥.&lt;/p&gt;
&lt;ol start="2"&gt;
&lt;li&gt;send_timeout&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è®¾ç½®NginxæœåŠ¡å™¨å“åº”å®¢æˆ·ç«¯çš„è¶…æ—¶æ—¶é—´, è¿™ä¸ªè¶…æ—¶æ—¶é—´ä»…é’ˆå¯¹ä¸¤ä¸ªå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹è¿æ¥å, æŸæ¬¡æ´»åŠ¨ä¹‹é—´çš„æ—¶é—´. å¦‚æœè¿™ä¸ªæ—¶é—´åå®¢æˆ·ç«¯æ²¡æœ‰ä»»ä½•æ´»åŠ¨, NginxæœåŠ¡å™¨å°†ä¼šå…³é—­è¿æ¥. æ­¤æŒ‡ä»¤çš„è®¾ç½®éœ€è¦è€ƒè™‘æœåŠ¡å™¨è®¿é—®æ•°é‡å’Œç½‘ç»œçŠ¶å†µç­‰æ–¹é¢.&lt;/p&gt;
&lt;ol start="3"&gt;
&lt;li&gt;client_header_buffer_size&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è®¾ç½®NginxæœåŠ¡å™¨å…è®¸çš„å®¢æˆ·ç«¯è¯·æ±‚å¤´éƒ¨çš„ç¼“å†²åŒºå¤§å°, é»˜è®¤ä¸º1KB. æ­¤æŒ‡ä»¤çš„èµ‹å€¼å¯ä»¥æ ¹æ®ç³»ç»Ÿåˆ†é¡µå¤§å°æ¥è®¾ç½®. åˆ†é¡µå¤§å°å¯ä»¥é€šè¿‡ä¸‹åˆ—å‘½ä»¤è·å¾—:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;getconf PAGESIZE&lt;/code&gt; (ä¸€èˆ¬ä¸º4k)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Nginx 400ç±»é”™è¯¯, æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†æƒ…å†µæ˜¯å®¢æˆ·ç«¯çš„è¯·æ±‚å¤´éƒ¨è¿‡å¤§é€ æˆçš„. è¯·æ±‚å¤´éƒ¨è¿‡å¤§, é€šå¸¸æ˜¯å®¢æˆ·ç«¯cookieä¸­å†™å…¥äº†è¾ƒå¤§çš„å€¼å¼•èµ·çš„.&lt;/p&gt;
&lt;p&gt;é€‚å½“å¢å¤§æ­¤æŒ‡ä»¤çš„èµ‹å€¼, å¯ä»¥æ”¹å–„è¯¥é—®é¢˜.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¨èé…ç½®:(ä¸ç³»ç»Ÿåˆ†é¡µå¤§å°ç›¸åŒ)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;client_header_buffer_size 4k;&lt;/code&gt;&lt;/p&gt;
&lt;ol start="4"&gt;
&lt;li&gt;multi_accept&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;NginxæœåŠ¡å™¨æ˜¯å¦å°½å¯èƒ½å¤šåœ°æ¥æ”¶å®¢æˆ·ç«¯çš„ç½‘ç»œè¿æ¥è¯·æ±‚. é»˜è®¤ä¸ºoff.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 16:27:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-2-3-network-directives.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å­¦ä¹ ç¬”è®°-é«˜çº§é…ç½®-é’ˆå¯¹CPUçš„è°ƒä¼˜æŒ‡ä»¤</title><link>https://www.EWhisper.cn/nginx-notebook-2-2-cpu-tuning.html</link><description>&lt;h2 id="2-cpu"&gt;2 é’ˆå¯¹CPUçš„ä¼˜åŒ–æŒ‡ä»¤&lt;a class="headerlink" href="#2-cpu" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;worker_processes&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ€å¥½æ˜¯èµ‹å€¼ä¸ºæœºå™¨CPUçš„å€æ•°.&lt;/p&gt;
&lt;ol start="2"&gt;
&lt;li&gt;worker_cpu_affinity&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é»˜è®¤çš„&lt;code&gt;auto&lt;/code&gt;å°±è¡Œ.&lt;br&gt;
&lt;code&gt;worker_cpu_affinity 0001 0010 0100 1000;&lt;/code&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 16:22:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-2-2-cpu-tuning.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å­¦ä¹ ç¬”è®°-é«˜çº§é…ç½®-IPv4 çš„å†…æ ¸7ä¸ªå‚æ•°çš„é…ç½®ä¼˜åŒ–</title><link>https://www.EWhisper.cn/nginx-notebook-2-1-kernel-tuning.html</link><description>&lt;h2 id="1-ipv4-7"&gt;1 IPv4 çš„å†…æ ¸7ä¸ªå‚æ•°çš„é…ç½®ä¼˜åŒ–&lt;a class="headerlink" href="#1-ipv4-7" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Linux å†…æ ¸å‚æ•°. å¯ä»¥å°†è¿™äº›å†…æ ¸å‚æ•°å€¼è¿½åŠ åˆ°Linuxçš„/etc/sysctl.confæ–‡ä»¶ä¸­.å¹¶ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤ç”Ÿæ•ˆ:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;# /sbin/sysctl -p&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;net.core.netdev_max_backlog&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¡¨ç¤ºå½“æ¯ä¸ªç½‘ç»œæ¥å£æ¥æ”¶æ•°æ®åŒ…çš„é€Ÿç‡æ¯”å†…æ ¸å¤„ç†è¿™äº›åŒ…çš„é€Ÿç‡å¿«æ—¶, å…è®¸å‘é€åˆ°é˜Ÿåˆ—çš„æ•°æ®åŒ…çš„æœ€å¤§æ•°ç›®. ä¸€èˆ¬é»˜è®¤ä¸º128. Nginxå®šä¹‰çš„NGX_LISTEN_BACKLOG é»˜è®¤ä¸º511. å°†è¯¥å‚æ•°è°ƒæ•´ä¸º:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;net.core.netdev_max_backlog = 262144&lt;/code&gt;&lt;/p&gt;
&lt;ol start="2"&gt;
&lt;li&gt;net.core.somaxconn&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç”¨äºè°ƒèŠ‚ç³»ç»ŸåŒæ—¶å‘èµ·çš„TCPè¿æ¥æ•°, ä¸€èˆ¬é»˜è®¤ä¸º128. åœ¨å­˜åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹, è¯¥é»˜è®¤å€¼è¾ƒå°, å¯èƒ½å¯¼è‡´é“¾æ¥è¶…æ—¶æˆ–é‡ä¼ é—®é¢˜, å¯ä»¥æ ¹æ®å®é™…éœ€è¦ç»“åˆå¹¶å‘è¯·æ±‚æ•°æ¥è°ƒèŠ‚æ­¤å€¼. å¦‚:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;net.core.somaxconn = 262144&lt;/code&gt;&lt;/p&gt;
&lt;ol start="3"&gt;
&lt;li&gt;net.ipv4.tcp_max_orphans&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç”¨äºè®¾å®šç³»ç»Ÿä¸­æœ€å¤šå…è®¸å­˜åœ¨å¤šå°‘TCPå¥—æ¥å­—ä¸è¢«å…³è”åˆ°ä»»ä½•ä¸€ä¸ªç”¨æˆ·æ–‡ä»¶å¥æŸ„ä¸Š. å¦‚æœè¶…è¿‡è¿™ä¸ªæ•°å­—, æ²¡æœ‰ä¸ç”¨æˆ·æ–‡ä»¶å¥æŸ„å…³è”çš„TCPå¥—æ¥å­—å°†ç«‹å³è¢«å¤ä½, åŒæ—¶ç»™å‡ºè­¦å‘Šä¿¡æ¯. è¿™ä¸ªé™åˆ¶åªæ˜¯ä¸ºäº†é˜²æ­¢ç®€å•çš„DoSæ”»å‡». ä¸€èˆ¬åœ¨ç³»ç»Ÿå†…å­˜å……è¶³çš„æƒ…å†µä¸‹, å¯ä»¥å¢å¤§è¯¥å€¼:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;net.ipv4.tcp_max_orphans = 262144&lt;/code&gt;&lt;/p&gt;
&lt;ol start="4"&gt;
&lt;li&gt;net.ipv4.tcp_max_syn_backlog&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç”¨äºè®°å½•å°šæœªæ”¶åˆ°å®¢æˆ·ç«¯ç¡®è®¤ä¿¡æ¯çš„è¿æ¥è¯·æ±‚çš„æœ€å¤§å€¼. å¯¹äº128MBå†…å­˜çš„ç³»ç»Ÿ, é»˜è®¤å€¼ä¸º1024. åœ¨ç³»ç»Ÿå†…å­˜å……è¶³çš„æƒ…å†µä¸‹, å¯ä»¥å¢å¤§è¯¥å€¼.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;net.ipv4.tcp_max_syn_backlog = 262144&lt;/code&gt;&lt;/p&gt;
&lt;ol start="5"&gt;
&lt;li&gt;net.ipv4.tcp_timestamps&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç”¨äºè®¾ç½®æ—¶é—´æˆ³, å¯ä»¥é¿å…åºåˆ—å·çš„å·ç»•. åœ¨ä¸€ä¸ª1Gb/sçš„é“¾è·¯ä¸Š, é‡åˆ°ä»¥å‰ç”¨è¿‡çš„åºåˆ—å·çš„æ¦‚ç‡å¾ˆå¤§. å½“æ­¤å€¼ä¸º0æ—¶, ç¦ç”¨å¯¹äºTCPæ—¶é—´æˆ³çš„æ”¯æŒ. åœ¨é»˜è®¤æƒ…å†µä¸‹, TCPä¼šæ¥å—è¿™ç§"å¼‚å¸¸"çš„æ•°æ®åŒ…. å»ºè®®å°†å…¶å…³é—­.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;net.ipv4.tcp_timestamps = 0&lt;/code&gt;&lt;/p&gt;
&lt;ol start="6"&gt;
&lt;li&gt;net.ipv4.tcp_synack_retries&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç”¨äºè®¾ç½®å†…æ ¸æ”¾å¼ƒTCPè¿æ¥ä¹‹å‰å‘å®¢æˆ·ç«¯å‘é€SYN+ACKåŒ…çš„æ•°é‡.ä¸€èˆ¬èµ‹å€¼ä¸º1, å³å†…æ ¸æ”¾å¼ƒè¿æ¥ä¹‹å‰å‘é€ä¸€æ¬¡SYN+ACKåŒ….&lt;/p&gt;
&lt;p&gt;&lt;code&gt;net.ipv4.tcp_synack_retries = 1&lt;/code&gt;&lt;/p&gt;
&lt;ol start="7"&gt;
&lt;li&gt;net.ipv4.tcp_syn_retries&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;net.ipv4.tcp_syn_retries = 1&lt;/code&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 16:15:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-2-1-kernel-tuning.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å­¦ä¹ ç¬”è®°-å®‰è£…éƒ¨ç½²-æœåŠ¡å™¨åŸºç¡€é…ç½®ç¤ºä¾‹</title><link>https://www.EWhisper.cn/nginx-notebook-1-4-nginx-conf-example.html</link><description>&lt;h2 id="4-nginx"&gt;4 NginxæœåŠ¡å™¨åŸºç¡€é…ç½®ç¤ºä¾‹&lt;a class="headerlink" href="#4-nginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#### å…¨å±€å— å¼€å§‹ #####&lt;/span&gt;
&lt;span class="k"&gt;user&lt;/span&gt; &lt;span class="s"&gt;nobody&lt;/span&gt; &lt;span class="s"&gt;nobody&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®å…è®¸è¿è¡ŒNginxæœåŠ¡å™¨çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„&lt;/span&gt;

&lt;span class="k"&gt;worker_processes&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®å…è®¸Nginxè¿›ç¨‹ç”Ÿæˆçš„worker processæ•°&lt;/span&gt;

&lt;span class="k"&gt;error_log&lt;/span&gt; &lt;span class="s"&gt;logs/error.log&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# Nginxé”™è¯¯æ—¥å¿—è¾“å‡ºç›®å½•&lt;/span&gt;

&lt;span class="k"&gt;pid&lt;/span&gt; &lt;span class="s"&gt;nginx.pid&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®NginxæœåŠ¡å™¨è¿è¡Œæ—¶çš„pidæ–‡ä»¶å­˜æ”¾è·¯å¾„å’Œåç§°&lt;/span&gt;
&lt;span class="c1"&gt;#### å…¨å±€å— ç»“æŸ #####&lt;/span&gt;

&lt;span class="c1"&gt;#### eventså— å¼€å§‹ ####&lt;/span&gt;
&lt;span class="k"&gt;events&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;user&lt;/span&gt; &lt;span class="s"&gt;epoll&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®äº‹ä»¶é©±åŠ¨æ¨¡å‹&lt;/span&gt;
    &lt;span class="kn"&gt;worker_connections&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®æœ€å¤§è¿æ¥æ•°&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="c1"&gt;#### eventså— ç»“æŸ ####&lt;/span&gt;

&lt;span class="c1"&gt;#### httpå— å¼€å§‹ ####&lt;/span&gt;
&lt;span class="k"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;include&lt;/span&gt; &lt;span class="s"&gt;mime.types&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;   &lt;span class="c1"&gt;# å®šä¹‰MIME-Type&lt;/span&gt;

    &lt;span class="kn"&gt;default_type&lt;/span&gt; &lt;span class="s"&gt;application/octet-stream&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;sendfile&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®å…è®¸ä½¿ç”¨sendfileæ–¹å¼ä¼ è¾“&lt;/span&gt;

    &lt;span class="kn"&gt;keepalive_timeout&lt;/span&gt; &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®è¿æ¥è¶…æ—¶æ—¶é—´&lt;/span&gt;

    &lt;span class="kn"&gt;log_format&lt;/span&gt; &lt;span class="s"&gt;access.log&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nv"&gt;$remote_addr-[$time_local]-&amp;quot;$request&amp;quot;-&amp;quot;$http_user_agent&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®è¯·æ±‚å¤„ç†æ—¥å¿—çš„æ ¼å¼&lt;/span&gt;

    &lt;span class="c1"&gt;#### serverå— å¼€å§‹ ####&lt;/span&gt;
    &lt;span class="c1"&gt;## é…ç½®è™šæ‹Ÿä¸»æœºmyServer1&lt;/span&gt;
    &lt;span class="kn"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;8081&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®ç›‘å¬ç«¯å£å’Œä¸»æœºåç§°&lt;/span&gt;
        &lt;span class="kn"&gt;server_name&lt;/span&gt; &lt;span class="s"&gt;myServer1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;access_log&lt;/span&gt; &lt;span class="s"&gt;/myweb/server1/log/access.log&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®è¯·æ±‚å¤„ç†æ—¥å¿—å­˜æ”¾è·¯å¾„&lt;/span&gt;
        &lt;span class="kn"&gt;error_page&lt;/span&gt; &lt;span class="mi"&gt;404&lt;/span&gt; &lt;span class="s"&gt;/404.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®é”™è¯¯é¡µé¢&lt;/span&gt;
        &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/server1/location1&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®å¤„ç†/server1/location1è¯·æ±‚çš„location&lt;/span&gt;
            &lt;span class="kn"&gt;root&lt;/span&gt; &lt;span class="s"&gt;/myweb&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kn"&gt;index&lt;/span&gt; &lt;span class="s"&gt;index.svr1-loc1.htm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/server1/location2&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®å¤„ç†/server1/location1è¯·æ±‚çš„location&lt;/span&gt;
            &lt;span class="kn"&gt;root&lt;/span&gt; &lt;span class="s"&gt;/myweb&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kn"&gt;index&lt;/span&gt; &lt;span class="s"&gt;index.svr1-loc2.htm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kn"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;    &lt;span class="c1"&gt;## é…ç½®è™šæ‹Ÿä¸»æœº myServer2&lt;/span&gt;
        &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;8082&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;server_name&lt;/span&gt; &lt;span class="mi"&gt;192&lt;/span&gt;&lt;span class="s"&gt;.168.1.3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;access_log&lt;/span&gt; &lt;span class="s"&gt;/myweb/server2/log/access.log&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;error_page&lt;/span&gt; &lt;span class="mi"&gt;404&lt;/span&gt; &lt;span class="s"&gt;/404.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/server2/location1&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kn"&gt;root&lt;/span&gt; &lt;span class="s"&gt;/myweb&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kn"&gt;index&lt;/span&gt; &lt;span class="s"&gt;index.svr2-loc1.htm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/svr2/loc2&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
          &lt;span class="kn"&gt;alias&lt;/span&gt; &lt;span class="s"&gt;/myweb/server2/location2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;# å¯¹locationçš„URIè¿›è¡Œæ›´æ”¹&lt;/span&gt;
          &lt;span class="kn"&gt;index&lt;/span&gt; &lt;span class="s"&gt;index.svr2-loc2.htm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;/404.html&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;    &lt;span class="c1"&gt;# é…ç½®é”™è¯¯é¡µé¢è½¬å‘&lt;/span&gt;
            &lt;span class="kn"&gt;root&lt;/span&gt; &lt;span class="s"&gt;/myweb/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kn"&gt;index&lt;/span&gt; &lt;span class="mi"&gt;404&lt;/span&gt;&lt;span class="s"&gt;.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="c1"&gt;#### server å— ç»“æŸ ####&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="c1"&gt;#### httpå— ç»“æŸ ####&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é…ç½®åçš„ç›®å½•ç»“æ„&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;myweb
    404.html
    server1
        location1
            index.svr1-loc1.htm
        location2
            index.svr1-loc2.htm
        log
            access.log
    server2
        location1
            index.svr2-loc1.htm
        location2
            index.svr2-loc2.htm
        log
            access.log
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 16:07:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-1-4-nginx-conf-example.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å­¦ä¹ ç¬”è®°-å®‰è£…éƒ¨ç½²-åŸºç¡€é…ç½®</title><link>https://www.EWhisper.cn/nginx-notebook-1-3-basic-config.html</link><description>&lt;h2 id="3-nginx"&gt;3 Nginx åŸºç¡€é…ç½®&lt;a class="headerlink" href="#3-nginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#user  nobody;&lt;/span&gt;
&lt;span class="k"&gt;worker_processes&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;                        &lt;span class="c1"&gt;# å…¨å±€å—&lt;/span&gt;

&lt;span class="c1"&gt;#error_log  logs/error.log;&lt;/span&gt;
&lt;span class="c1"&gt;#error_log  logs/error.log  notice;&lt;/span&gt;
&lt;span class="c1"&gt;#error_log  logs/error.log  info;&lt;/span&gt;

&lt;span class="c1"&gt;#pid        logs/nginx.pid;&lt;/span&gt;

&lt;span class="k"&gt;events&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;                                    &lt;span class="c1"&gt;# eventså—&lt;/span&gt;
    &lt;span class="kn"&gt;worker_connections&lt;/span&gt;  &lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;                                        &lt;span class="c1"&gt;# httpå—&lt;/span&gt;
    &lt;span class="kn"&gt;include&lt;/span&gt;       &lt;span class="s"&gt;mime.types&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;                &lt;span class="c1"&gt;# å¼•ç”¨mime.typesè¿™ä¸ªæ–‡ä»¶&lt;/span&gt;

    &lt;span class="kn"&gt;default_type&lt;/span&gt;  &lt;span class="s"&gt;application/octet-stream&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;#log_format  main  &amp;#39;$remote_addr - $remote_user [$time_local] &amp;quot;$request&amp;quot; &amp;#39;&lt;/span&gt;
    &lt;span class="c1"&gt;#                  &amp;#39;$status $body_bytes_sent &amp;quot;$http_referer&amp;quot; &amp;#39;&lt;/span&gt;
    &lt;span class="c1"&gt;#                  &amp;#39;&amp;quot;$http_user_agent&amp;quot; &amp;quot;$http_x_forwarded_for&amp;quot;&amp;#39;;&lt;/span&gt;
    &lt;span class="c1"&gt;#access_log  logs/access.log  main;&lt;/span&gt;

    &lt;span class="kn"&gt;sendfile&lt;/span&gt;        &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;#tcp_nopush     on;&lt;/span&gt;
    &lt;span class="c1"&gt;#keepalive_timeout  0;&lt;/span&gt;
    &lt;span class="kn"&gt;keepalive_timeout&lt;/span&gt;  &lt;span class="mi"&gt;65&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# nginxå…è®¸çš„å®¢æˆ·ç«¯è¯·æ±‚å¤´éƒ¨çš„ç¼“å†²åŒºå¤§å°&lt;/span&gt;
    &lt;span class="kn"&gt;client_header_buffer_size&lt;/span&gt; &lt;span class="mi"&gt;4k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;#gzip  on;&lt;/span&gt;
    &lt;span class="c1"&gt;# proxy buffer&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_buffers&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mi"&gt;4k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_buffer_size&lt;/span&gt; &lt;span class="mi"&gt;4k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_temp_file_write_size&lt;/span&gt; &lt;span class="mi"&gt;4k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_temp_path&lt;/span&gt; &lt;span class="s"&gt;proxy_temp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;# proxy cache&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_cache_path&lt;/span&gt; &lt;span class="s"&gt;NGINX_cache/&lt;/span&gt; &lt;span class="s"&gt;keys_zone=cache_all:10m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# 128.236.160.5 CONF&lt;/span&gt;
    &lt;span class="kn"&gt;include&lt;/span&gt; &lt;span class="s"&gt;conf.d/128_236_160_5.conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;#server {                                # serverå—&lt;/span&gt;
    &lt;span class="c1"&gt;#   listen       80;&lt;/span&gt;
    &lt;span class="c1"&gt;#   server_name  localhost;&lt;/span&gt;
    &lt;span class="c1"&gt;#   charset koi8-r;&lt;/span&gt;
    &lt;span class="c1"&gt;#   access_log  logs/host.access.log  main;&lt;/span&gt;

    &lt;span class="c1"&gt;#   location / {                        # locationå—&lt;/span&gt;
    &lt;span class="c1"&gt;#        root   html;&lt;/span&gt;
    &lt;span class="c1"&gt;#        index  index.html index.htm;&lt;/span&gt;
    &lt;span class="c1"&gt;#   }&lt;/span&gt;

        &lt;span class="c1"&gt;#error_page  404              /404.html;&lt;/span&gt;
        &lt;span class="c1"&gt;# redirect server error pages to the static page /50x.html&lt;/span&gt;
    &lt;span class="c1"&gt;#    error_page   500 502 503 504  /50x.html;&lt;/span&gt;
    &lt;span class="c1"&gt;#    location = /50x.html {&lt;/span&gt;
    &lt;span class="c1"&gt;#        root   html;&lt;/span&gt;
    &lt;span class="c1"&gt;#    }&lt;/span&gt;

        &lt;span class="c1"&gt;# proxy the PHP scripts to Apache listening on 127.0.0.1:80&lt;/span&gt;
        &lt;span class="c1"&gt;#location ~ \.php$ {&lt;/span&gt;
        &lt;span class="c1"&gt;#    proxy_pass   http://127.0.0.1;&lt;/span&gt;
        &lt;span class="c1"&gt;#}&lt;/span&gt;

        &lt;span class="c1"&gt;# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000&lt;/span&gt;
        &lt;span class="c1"&gt;#location ~ \.php$ {&lt;/span&gt;
        &lt;span class="c1"&gt;#    root           html;&lt;/span&gt;
        &lt;span class="c1"&gt;#    fastcgi_pass   127.0.0.1:9000;&lt;/span&gt;
        &lt;span class="c1"&gt;#    fastcgi_index  index.php;&lt;/span&gt;
        &lt;span class="c1"&gt;#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;&lt;/span&gt;
        &lt;span class="c1"&gt;#    include        fastcgi_params;&lt;/span&gt;
        &lt;span class="c1"&gt;#}&lt;/span&gt;

        &lt;span class="c1"&gt;# deny access to .htaccess files, if Apache&amp;#39;s document root&lt;/span&gt;
        &lt;span class="c1"&gt;# concurs with nginx&amp;#39;s one&lt;/span&gt;
        &lt;span class="c1"&gt;#location ~ /\.ht {&lt;/span&gt;
        &lt;span class="c1"&gt;#    deny  all;&lt;/span&gt;
        &lt;span class="c1"&gt;#}&lt;/span&gt;
    &lt;span class="c1"&gt;#}&lt;/span&gt;

    &lt;span class="c1"&gt;# another virtual host using mix of IP-, name-, and port-based configuration&lt;/span&gt;
    &lt;span class="c1"&gt;#server {&lt;/span&gt;
    &lt;span class="c1"&gt;#    listen       8000;&lt;/span&gt;
    &lt;span class="c1"&gt;#    listen       somename:8080;&lt;/span&gt;
    &lt;span class="c1"&gt;#    server_name  somename  alias  another.alias;&lt;/span&gt;

    &lt;span class="c1"&gt;#    location / {&lt;/span&gt;
    &lt;span class="c1"&gt;#        root   html;&lt;/span&gt;
    &lt;span class="c1"&gt;#        index  index.html index.htm;&lt;/span&gt;
    &lt;span class="c1"&gt;#    }&lt;/span&gt;
    &lt;span class="c1"&gt;#}&lt;/span&gt;

    &lt;span class="c1"&gt;# HTTPS server&lt;/span&gt;
    &lt;span class="c1"&gt;#server {&lt;/span&gt;
    &lt;span class="c1"&gt;#    listen       443 ssl;&lt;/span&gt;
    &lt;span class="c1"&gt;#    server_name  localhost;&lt;/span&gt;
    &lt;span class="c1"&gt;#    ssl_certificate      cert.pem;&lt;/span&gt;
    &lt;span class="c1"&gt;#    ssl_certificate_key  cert.key;&lt;/span&gt;
    &lt;span class="c1"&gt;#    ssl_session_cache    shared:SSL:1m;&lt;/span&gt;
    &lt;span class="c1"&gt;#    ssl_session_timeout  5m;&lt;/span&gt;
    &lt;span class="c1"&gt;#    ssl_ciphers  HIGH:!aNULL:!MD5;&lt;/span&gt;
    &lt;span class="c1"&gt;#    ssl_prefer_server_ciphers  on;&lt;/span&gt;

    &lt;span class="c1"&gt;#    location / {&lt;/span&gt;
    &lt;span class="c1"&gt;#        root   html;&lt;/span&gt;
    &lt;span class="c1"&gt;#        index  index.html index.htm;&lt;/span&gt;
    &lt;span class="c1"&gt;#    }&lt;/span&gt;
    &lt;span class="c1"&gt;#}&lt;/span&gt;

&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;å¦‚æœæŸä¸ªæŒ‡ä»¤åœ¨ä¸¤ä¸ªä¸åŒå±‚çº§çš„å—ä¸­åŒæ—¶å‡ºç°,åˆ™é‡‡ç”¨&lt;strong&gt;å°±è¿‘åŸåˆ™&lt;/strong&gt;,å³ä»¥è¾ƒä½å±‚çº§å—ä¸­çš„é…ç½®ä¸ºå‡†.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="_1"&gt;é”™è¯¯æ—¥å¿—&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;æ—¥å¿—çº§åˆ«ç”±ä½åˆ°é«˜åˆ†ä¸ºdebug(éœ€è¦åœ¨ç¼–è¯‘æ—¶ä½¿ç”¨--with-debugå¼€å¯debug)ã€infoã€noticeã€warnã€errorã€criticalã€alertã€emergã€‚&lt;/p&gt;
&lt;h3 id="_2"&gt;å¼•å…¥é…ç½®æ–‡ä»¶&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;include file&lt;/code&gt;&lt;/p&gt;
&lt;h3 id="_3"&gt;äº‹ä»¶é©±åŠ¨æ¨¡å‹&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;use method&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;methodå†…å®¹æœ‰:select, poll, kqueue, epoll, rtsig, &lt;code&gt;/dev/poll&lt;/code&gt;, eventport&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="_4"&gt;è‡ªå®šä¹‰æœåŠ¡æ—¥å¿—&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;log_format&lt;/span&gt; &lt;span class="s"&gt;exampleLog&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nv"&gt;$remote_addr&lt;/span&gt; &lt;span class="s"&gt;-&lt;/span&gt; &lt;span class="s"&gt;[&lt;/span&gt;&lt;span class="nv"&gt;$time_local]&lt;/span&gt; &lt;span class="nv"&gt;$request&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;
                &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nv"&gt;$status&lt;/span&gt; &lt;span class="nv"&gt;$body_bytes_sent&lt;/span&gt; &lt;span class="nv"&gt;$http_referer&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;
                &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nv"&gt;$http_user_agent&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;&lt;a href="http://nginx.org/en/docs/varindex.html"&gt;Nginxå†…ç½®å˜é‡&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="_5"&gt;åŸºäºåç§°çš„è™šæ‹Ÿä¸»æœºé…ç½®&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;server_name myserver.com www.myserver.com;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;server_name *.myserver.com www.myserver.*;&lt;/code&gt;  (é€šé…ç¬¦'*'åªèƒ½ç”¨äºä¸‰æ®µå­—ç¬¦ä¸²çš„é¦–æ®µæˆ–å°¾æ®µ)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;server_name ~^www\d+\.myserver\.com$;&lt;/code&gt;  ("~"ä¸ºä½¿ç”¨æ­£åˆ™çš„æ ‡è®°)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŒ¹é…ä¼˜å…ˆåº¦&lt;/strong&gt;:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å¯¹äºåŒ¹é…æ–¹å¼ä¸åŒçš„,æŒ‰ç…§ä»¥ä¸‹ä¼˜å…ˆçº§:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å‡†ç¡®åŒ¹é… server_name&lt;/li&gt;
&lt;li&gt;é€šé…ç¬¦åœ¨å¼€å§‹æ—¶åŒ¹é… server_nameæˆåŠŸ&lt;/li&gt;
&lt;li&gt;é€šé…ç¬¦åœ¨ç»“å°¾æ—¶åŒ¹é… server_nameæˆåŠŸ&lt;/li&gt;
&lt;li&gt;æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…server_nameæˆåŠŸ&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœserver_nameå¤„äºåŒä¸€ä¼˜å…ˆçº§çš„åŒ¹é…æ–¹å¼å¤šæ¬¡åŒ¹é…æˆåŠŸ,åˆ™é¦–æ¬¡åŒ¹é…æˆåŠŸçš„è™šæ‹Ÿä¸»æœºå¤„ç†è¯·æ±‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="location"&gt;é…ç½®location&lt;a class="headerlink" href="#location" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Syntax&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;~*&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;^~&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;

        &lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;Default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="err"&gt;â€”&lt;/span&gt;

&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;location&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ ‡è¯†å«ä¹‰:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;=&lt;/code&gt; ç”¨äº&lt;strong&gt;æ ‡å‡†uri&lt;/strong&gt;å‰,è¦æ±‚è¯·æ±‚å­—ç¬¦ä¸²ä¸uri&lt;strong&gt;ä¸¥æ ¼åŒ¹é…&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;~&lt;/code&gt; ç”¨äºè¡¨ç¤ºuriåŒ…å«&lt;strong&gt;æ­£åˆ™è¡¨è¾¾å¼&lt;/strong&gt;, å¹¶ä¸”&lt;strong&gt;åŒºåˆ†å¤§å°å†™&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;~*&lt;/code&gt; ç”¨äºè¡¨ç¤ºuriåŒ…å«&lt;strong&gt;æ­£åˆ™è¡¨è¾¾å¼&lt;/strong&gt;, å¹¶ä¸”&lt;strong&gt;ä¸åŒºåˆ†å¤§å°å†™&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;^~&lt;/code&gt; ç”¨äº&lt;strong&gt;æ ‡å‡†uri&lt;/strong&gt;å‰, è¦æ±‚NginxæœåŠ¡å™¨æ‰¾åˆ°æ ‡è¯†uriå’Œè¯·æ±‚å­—ç¬¦ä¸²åŒ¹é…åº¦æœ€é«˜çš„locationå, ç«‹å³ä½¿ç”¨æ­¤locationå¤„ç†è¯·æ±‚, è€Œä¸å†ä½¿ç”¨locationå—ä¸­çš„æ­£åˆ™uriå’Œè¯·æ±‚å­—ç¬¦ä¸²åšåŒ¹é….&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="_6"&gt;é…ç½®è¯·æ±‚çš„æ ¹ç›®å½•&lt;a class="headerlink" href="#_6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/data/&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;root&lt;/span&gt; &lt;span class="s"&gt;/locationtest1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“locationå—æ¥æ”¶åˆ°&lt;code&gt;/data/index.htm&lt;/code&gt; çš„è¯·æ±‚æ—¶, å°†åœ¨&lt;code&gt;/locationtest1/data/&lt;/code&gt; ç›®å½•ä¸‹æ‰¾åˆ°index.htm å“åº”è¯·æ±‚.&lt;/p&gt;
&lt;h3 id="alias"&gt;aliasæŒ‡ä»¤&lt;a class="headerlink" href="#alias" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="p"&gt;~&lt;/span&gt; &lt;span class="sr"&gt;^/data/(.+\.(htm|html))$&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;alias&lt;/span&gt; &lt;span class="s"&gt;/locationtest1/other/&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“æ”¶åˆ°&lt;code&gt;/data/index.htm&lt;/code&gt;æ—¶, åŒ¹é…æˆåŠŸ, ä¹‹åæ ¹æ®aliasæŒ‡ä»¤çš„é…ç½®, å°†åˆ° &lt;code&gt;/locationtest1/other&lt;/code&gt; ç›®å½•ä¸‹æ‰¾åˆ°å¯¹åº”è¯·æ±‚. å¯ä»¥çœ‹åˆ°, é€šè¿‡aliasæŒ‡ä»¤çš„é…ç½®, è·Ÿè·¯å¾„å·²ç»ä»&lt;code&gt;/data&lt;/code&gt; æ›´æ”¹ä¸º &lt;code&gt;/locationtest1/other&lt;/code&gt; äº†.&lt;/p&gt;
&lt;h3 id="_7"&gt;è®¾ç½®ç½‘ç«™é»˜è®¤é¦–é¡µ&lt;a class="headerlink" href="#_7" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="p"&gt;~&lt;/span&gt; &lt;span class="sr"&gt;^/data/(.+)/web/$&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;index&lt;/span&gt; &lt;span class="s"&gt;index.&lt;/span&gt;&lt;span class="nv"&gt;$1.html&lt;/span&gt; &lt;span class="s"&gt;index.my1.html&lt;/span&gt; &lt;span class="s"&gt;index.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“locationå—æ¥æ”¶åˆ°&lt;code&gt;/data/locationtest/web/&lt;/code&gt; æ—¶, åŒ¹é…æˆåŠŸ, å®ƒé¦–å…ˆå°†é¢„ç½®å˜é‡$1ç½®ä¸º&lt;em&gt;locationtest&lt;/em&gt;, ç„¶ååœ¨&lt;code&gt;/data/locationtest/web/&lt;/code&gt; è·¯å¾„ä¸‹æŒ‰ç…§indexçš„é…ç½®æ¬¡åºä¾æ¬¡å¯»æ‰¾ index.locationtest.html index.my1.html å’Œ index.html , é¦–å…ˆæ‰¾åˆ°å“ªä¸ªé¡µé¢, å°±ä½¿ç”¨å“ªä¸ªé¡µé¢å“åº”è¯·æ±‚.&lt;/p&gt;
&lt;h3 id="_8"&gt;é”™è¯¯é¡µé¢&lt;a class="headerlink" href="#_8" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´,HTTP &lt;strong&gt;2XX ä»£è¡¨è¯·æ±‚æ­£å¸¸å®Œæˆ&lt;/strong&gt;, &lt;strong&gt;3XX ä»£è¡¨ç½‘ç«™é‡å®šå‘&lt;/strong&gt;, &lt;strong&gt;4XXä»£è¡¨å®¢æˆ·ç«¯å‡ºç°é”™è¯¯&lt;/strong&gt;, &lt;strong&gt;5XXä»£è¡¨æœåŠ¡å™¨ç«¯å‡ºç°é”™è¯¯&lt;/strong&gt;.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;HTTPæ¶ˆæ¯&lt;/th&gt;
&lt;th&gt;ä»£ç &lt;/th&gt;
&lt;th&gt;å«ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å·²ç§»åŠ¨&lt;/td&gt;
&lt;td&gt;301&lt;/td&gt;
&lt;td&gt;è¯·æ±‚çš„æ•°æ®å…·æœ‰æ–°çš„ä½ç½®, å¹¶ä¸”æ›´æ”¹æ˜¯&lt;strong&gt;æ°¸ä¹…&lt;/strong&gt;çš„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å·²æ‰¾åˆ°&lt;/td&gt;
&lt;td&gt;302&lt;/td&gt;
&lt;td&gt;è¯·æ±‚çš„æ•°æ®&lt;strong&gt;ä¸´æ—¶&lt;/strong&gt;å…·æœ‰ä¸åŒçš„URI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¯·å‚é˜…å…¶ä»–&lt;/td&gt;
&lt;td&gt;303&lt;/td&gt;
&lt;td&gt;å¯åœ¨å¦ä¸€URIä¸‹æ‰¾åˆ°å¯¹è¯·æ±‚çš„å“åº”, å¹¶ä¸”åº”ä½¿ç”¨GETæ–¹æ³•æ£€ç´¢æ­¤å“åº”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœªä¿®æ”¹&lt;/td&gt;
&lt;td&gt;304&lt;/td&gt;
&lt;td&gt;æœªæŒ‰é¢„æœŸä¿®æ”¹æ–‡æ¡£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä½¿ç”¨ä»£ç†&lt;/td&gt;
&lt;td&gt;305&lt;/td&gt;
&lt;td&gt;å¿…é¡»é€šè¿‡ä½ç½®å­—æ®µä¸­æä¾›çš„ä»£ç†æ¥è®¿é—®è¯·æ±‚çš„èµ„æº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœªä½¿ç”¨&lt;/td&gt;
&lt;td&gt;306&lt;/td&gt;
&lt;td&gt;ä¸å†ä½¿ç”¨, ä½†ä¿ç•™æ­¤ä»£ç ä»¥ä¾¿å°†æ¥ä½¿ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ— æ³•æ‰¾åˆ°ç½‘é¡µ&lt;/td&gt;
&lt;td&gt;400&lt;/td&gt;
&lt;td&gt;å¯ä»¥è¿æ¥åˆ°WebæœåŠ¡å™¨, ä½†æ˜¯ç”±äºWebåœ°å€(URL) çš„é—®é¢˜, æ— æ³•æ‰¾åˆ°ç½‘é¡µ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç½‘ç«™æ‹’ç»æ˜¾ç¤ºæ­¤ç½‘é¡µ&lt;/td&gt;
&lt;td&gt;403&lt;/td&gt;
&lt;td&gt;å¯ä»¥è¿æ¥åˆ°ç½‘ç«™, ä½†æ²¡æœ‰æ˜¾ç¤ºç½‘é¡µçš„æƒé™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ— æ³•æ‰¾åˆ°ç½‘é¡µ&lt;/td&gt;
&lt;td&gt;404&lt;/td&gt;
&lt;td&gt;å¯ä»¥è¿æ¥åˆ°ç½‘ç«™, ä½†æ‰¾ä¸åˆ°ç½‘é¡µ. å¯¼è‡´æ­¤é”™è¯¯çš„åŸå› æœ‰æ—¶å¯èƒ½æ˜¯è¯¥ç½‘é¡µæš‚æ—¶ä¸å¯ç”¨æˆ–ç½‘é¡µå·²è¢«åˆ é™¤.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç½‘ç«™æ— æ³•æ˜¾ç¤ºè¯¥é¡µé¢&lt;/td&gt;
&lt;td&gt;405&lt;/td&gt;
&lt;td&gt;å¯ä»¥è¿æ¥åˆ°ç½‘ç«™, ä½†ç½‘é¡µå†…å®¹æ— æ³•ä¸‹è½½åˆ°ç”¨æˆ·çš„è®¡ç®—æœº. è¿™é€šå¸¸æ˜¯ç”±ç½‘é¡µç¼–å†™æ–¹å¼é—®é¢˜å¼•èµ·çš„.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ— æ³•è¯»å–æ­¤ç½‘é¡µæ ¼å¼&lt;/td&gt;
&lt;td&gt;406&lt;/td&gt;
&lt;td&gt;èƒ½å¤Ÿä»ç½‘ç«™æ¥æ”¶ä¿¡æ¯, ä½†ä¸èƒ½è¯†åˆ«å…¶æ ¼å¼, å› è€Œæ— æ³•æ­£ç¡®åœ°æ˜¾ç¤ºæ¶ˆæ¯.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¯¥ç½‘ç«™å¤ªå¿™, æ— æ³•æ˜¾ç¤ºæ­¤ç½‘é¡µ&lt;/td&gt;
&lt;td&gt;408 409&lt;/td&gt;
&lt;td&gt;æœåŠ¡å™¨æ˜¾ç¤ºè¯¥ç½‘é¡µçš„æ—¶é—´å¤ªé•¿, æˆ–å¯¹åŒä¸€ç½‘é¡µçš„è¯·æ±‚å¤ªå¤š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç½‘é¡µä¸å¤å­˜åœ¨&lt;/td&gt;
&lt;td&gt;410&lt;/td&gt;
&lt;td&gt;å¯ä»¥è¿æ¥åˆ°ç½‘ç«™, ä½†æ— æ³•æ‰¾åˆ°ç½‘é¡µ. ä¸404ä¸åŒ, æ­¤é”™è¯¯æ˜¯æ°¸ä¹…æ€§çš„, è€Œä¸”ç”±ç½‘ç«™ç®¡ç†å‘˜æ‰“å¼€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç½‘ç«™æ— æ³•æ˜¾ç¤ºè¯¥é¡µé¢&lt;/td&gt;
&lt;td&gt;500&lt;/td&gt;
&lt;td&gt;æ­£åœ¨è®¿é—®çš„ç½‘ç«™å‡ºç°äº†æœåŠ¡å™¨é—®é¢˜. è¯¥é—®é¢˜é˜»æ­¢äº†æ­¤ç½‘é¡µçš„æ˜¾ç¤º. å¸¸è§çš„åŸå› æ˜¯ç½‘ç«™æ­£åœ¨ç»´æŠ¤æˆ–ä½¿ç”¨è„šæœ¬çš„äº¤äº’å¼ç½‘ç«™ä¸Šçš„ç¨‹åºå‡ºé”™.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœªæ‰§è¡Œ&lt;/td&gt;
&lt;td&gt;501&lt;/td&gt;
&lt;td&gt;æ²¡æœ‰å°†æ­£åœ¨è®¿é—®çš„ç½‘ç«™è®¾ç½®ä¸ºæ˜¾ç¤ºæµè§ˆå™¨æ‰€è¯·æ±‚çš„å†…å®¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸æ”¯æŒçš„ç‰ˆæœ¬&lt;/td&gt;
&lt;td&gt;505&lt;/td&gt;
&lt;td&gt;è¯¥ç½‘ç«™ä¸æ”¯æŒæµè§ˆå™¨ç”¨äºè¯·æ±‚ç½‘é¡µçš„HTTPåè®®(å¦‚HTTP/1.1)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Syntax&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;error_page&lt;/span&gt; &lt;span class="n"&gt;code&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="o"&gt;[=[&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt; &lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;Default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="err"&gt;â€”&lt;/span&gt;
&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="n"&gt;location&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç¤ºä¾‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;error_page&lt;/span&gt; &lt;span class="mi"&gt;404&lt;/span&gt;             &lt;span class="s"&gt;/404.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;error_page&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt; &lt;span class="mi"&gt;502&lt;/span&gt; &lt;span class="mi"&gt;503&lt;/span&gt; &lt;span class="mi"&gt;504&lt;/span&gt; &lt;span class="s"&gt;/50x.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;error_page&lt;/span&gt; &lt;span class="mi"&gt;404&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt; &lt;span class="s"&gt;/empty.gif&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;#If an error response is processed by a proxied server or a FastCGI/uwsgi/SCGI server, and the server may return different response codes (e.g., 200, 302, 401 or 404), it is possible to respond with the code it returns:&lt;/span&gt;
&lt;span class="k"&gt;error_page&lt;/span&gt; &lt;span class="mi"&gt;404&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;/404.php&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;#If there is no need to change URI and method during internal redirection it is possible to pass error processing into a named location:&lt;/span&gt;
&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;error_page&lt;/span&gt; &lt;span class="mi"&gt;404&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;@fallback&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;@fallback&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_pass&lt;/span&gt; &lt;span class="s"&gt;http://backend&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;#It is also possible to use URL redirects for error processing:&lt;/span&gt;
&lt;span class="k"&gt;error_page&lt;/span&gt; &lt;span class="mi"&gt;403&lt;/span&gt;      &lt;span class="s"&gt;http://example.com/forbidden.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;error_page&lt;/span&gt; &lt;span class="mi"&gt;404&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;301&lt;/span&gt; &lt;span class="s"&gt;http://example.com/notfound.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="ipnginx"&gt;åŸºäºIPé…ç½®Nginxçš„è®¿é—®æƒé™&lt;a class="headerlink" href="#ipnginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;deny&lt;/span&gt;  &lt;span class="mi"&gt;192&lt;/span&gt;&lt;span class="s"&gt;.168.1.1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;allow&lt;/span&gt; &lt;span class="mi"&gt;192&lt;/span&gt;&lt;span class="s"&gt;.168.1.0/24&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;allow&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="s"&gt;.1.1.0/16&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;allow&lt;/span&gt; &lt;span class="n"&gt;2001&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="s"&gt;db8::/32&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;deny&lt;/span&gt;  &lt;span class="s"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Syntax&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;allow&lt;/span&gt; &lt;span class="n"&gt;address&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;CIDR&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;Default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="err"&gt;â€”&lt;/span&gt;
&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;limit_except&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;address: å®¢æˆ·ç«¯IP, ä¸æ”¯æŒåŒæ—¶è®¾ç½®å¤šä¸ª.å¦‚æœæœ‰å¤šä¸ªIPéœ€è¦è®¾ç½®, éœ€è¦é‡å¤ä½¿ç”¨allowæŒ‡ä»¤.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Nginxé…ç½®åœ¨è§£æçš„è¿‡ç¨‹ä¸­, é‡åˆ°denyæŒ‡ä»¤æˆ–è€…allowæŒ‡ä»¤æ˜¯æŒ‰ç…§é¡ºåºå¯¹å½“å‰å®¢æˆ·ç«¯çš„è¿æ¥è¿›è¡Œè®¿é—®æƒé™æ£€æŸ¥çš„. å¦‚æœé‡åˆ°åŒ¹é…çš„è®¾ç½®æ—¶, åˆ™åœæ­¢ç»§ç»­å‘ä¸‹æœç´¢ç›¸å…³é…ç½®.&lt;/p&gt;
&lt;h3 id="nginx"&gt;åŸºäºå¯†ç çš„Nginxè®¿é—®æƒé™&lt;a class="headerlink" href="#nginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Syntax&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;auth_basic&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;off&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;Default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;auth_basic&lt;/span&gt; &lt;span class="n"&gt;off&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;limit_except&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Syntax&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;auth_basic_user_file&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;Default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="err"&gt;â€”&lt;/span&gt;
&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;limit_except&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ˜æ–‡å¯†ç æ ¼å¼:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;## comment
name1:password1
name2:password2:comment
name3:password3
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åŠ å¯†å¯†ç å¯ä»¥ä½¿ç”¨&lt;code&gt;crypt()&lt;/code&gt; å‡½æ•°è¿›è¡Œå¯†ç åŠ å¯†çš„æ ¼å¼, åœ¨Linuxå¹³å°ä¸Šå¯ä»¥ä½¿ç”¨ &lt;code&gt;htpasswd&lt;/code&gt; å‘½ä»¤ç”Ÿæˆ. åœ¨PHPå’ŒPerlç­‰è¯­è¨€ä¸­, ä¹Ÿæä¾›&lt;code&gt;crypt()&lt;/code&gt;å‡½æ•°. ä½¿ç”¨htpasswdå‘½ä»¤çš„ä¸€ä¸ªç¤ºä¾‹ä¸º:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;htpasswd -c -d /nginx/conf/pass_file username&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿è¡Œåè¾“å…¥å¯†ç å³å¯.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 15:30:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-1-3-basic-config.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å­¦ä¹ ç¬”è®°-å®‰è£…éƒ¨ç½²-å¯åœæ§åˆ¶</title><link>https://www.EWhisper.cn/nginx-notebook-1-2-start-stop.html</link><description>&lt;h2 id="nginx"&gt;Nginxå¯åœæ§åˆ¶&lt;a class="headerlink" href="#nginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;nginx -t&lt;/code&gt; æ£€æŸ¥NginxæœåŠ¡å™¨é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nginx&lt;/code&gt; å¯åŠ¨&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nginx -s stop&lt;/code&gt; åœæ­¢&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nginx -s reload&lt;/code&gt;  æˆ– &lt;code&gt;kill HUP `/Nginx/logs/nginx.pid`&lt;/code&gt;  å¹³æ»‘é‡å¯&lt;/li&gt;
&lt;li&gt;å¹³æ»‘å‡çº§: å…ˆæ‰§è¡Œ&lt;code&gt;kill USR2 `/Nginx/logs/nginx.pid`&lt;/code&gt;å®ç°NginxæœåŠ¡çš„å¹³æ»‘å‡çº§; å†ä½¿ç”¨&lt;code&gt;kill WINCH `/Nginx/logs/nginx.pid`&lt;/code&gt;å¹³æ»‘åœæ­¢æ—§æœåŠ¡ä¿¡å·&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 15:25:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-1-2-start-stop.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å­¦ä¹ ç¬”è®°-å®‰è£…éƒ¨ç½²-åŸºæœ¬é…ç½®</title><link>https://www.EWhisper.cn/nginx-notebook-1-1-basic-config.html</link><description>&lt;h1 id="_1"&gt;åŸºæœ¬é…ç½®&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id="_2"&gt;ä¾èµ–&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;GCCç¼–è¯‘å™¨&lt;/li&gt;
&lt;li&gt;Automakeå·¥å…·&lt;/li&gt;
&lt;li&gt;pcreåº“(æ”¯æŒrewriteæ¨¡å—)&lt;/li&gt;
&lt;li&gt;zlibåº“(æ”¯æŒgzipæ¨¡å—)&lt;/li&gt;
&lt;li&gt;opensslåº“(æ”¯æŒsslæ¨¡å—)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å‚è€ƒæŒ‡ä»¤&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;yum -y install gcc gcc-c++ automake pcre pcre-devel zlib zlib-devel openssl openssl-devel&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="_3"&gt;ç›®å½•ç»“æ„&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="nginx"&gt;nginxè§£å‹åè½¯ä»¶åŒ…&lt;a class="headerlink" href="#nginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;src&lt;/strong&gt;: æºä»£ç &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;man&lt;/strong&gt;: å¸®åŠ©æ–‡ä»¶(å¯ä»¥é€šè¿‡&lt;code&gt;man nginx&lt;/code&gt;æŸ¥çœ‹)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;html&lt;/strong&gt;: htmlæ–‡ä»¶&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;conf&lt;/strong&gt;: é…ç½®æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;auto&lt;/strong&gt;: è„šæœ¬æ–‡ä»¶,å’Œconfigure&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;configure&lt;/strong&gt;: è‡ªåŠ¨è„šæœ¬ç¨‹åº&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt;å¤‡æ³¨:&lt;/p&gt;
&lt;p&gt;configure 2é¡¹å·¥ä½œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ£€æŸ¥ç¯å¢ƒ,æ ¹æ®ç¯å¢ƒæ£€æŸ¥ç»“æœç”ŸæˆCä»£ç ;&lt;/li&gt;
&lt;li&gt;ç”Ÿæˆç¼–è¯‘ä»£ç éœ€è¦çš„Makefileæ–‡ä»¶.&lt;br&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h3 id="nginx_1"&gt;nginxæœåŠ¡å™¨è½¯ä»¶ç›®å½•&lt;a class="headerlink" href="#nginx_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;conf&lt;/strong&gt;: Nginxçš„æ‰€æœ‰é…ç½®æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;html&lt;/strong&gt;: NginxæœåŠ¡å™¨åœ¨è¿è¡Œè¿‡ç¨‹ä¸­è°ƒç”¨çš„ä¸€äº›htmlç½‘é¡µæ–‡ä»¶.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;logs&lt;/strong&gt;: æ—¥å¿—&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;sbin&lt;/strong&gt;: nginxä¸€ä¸ªæ–‡ä»¶,å³å¯åŠ¨çš„ä¸»ç¨‹åº&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å¯ä»¥åœ¨htmlç›®å½•ä¸‹è‡ªå®šä¹‰ä¸€äº›ç½‘é¡µæ–‡ä»¶,å¹¶åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®å‘ç”Ÿä»€ä¹ˆæƒ…å†µæ—¶è½¬åˆ°ç›¸åº”çš„æ–‡ä»¶&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="configure"&gt;configure è„šæœ¬æ”¯æŒçš„å¸¸ç”¨é€‰é¡¹&lt;a class="headerlink" href="#configure" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;--prefix=&amp;lt;path&amp;gt;  æŒ‡å®šå®‰è£…è·¯å¾„,é»˜è®¤/usr/local/nginx

--user=&amp;lt;user&amp;gt;  æœªæŒ‡å®š,é»˜è®¤nobody

--with-debug  å¯ç”¨Nginxçš„è°ƒè¯•æ—¥å¿—

--add-module=&amp;lt;path&amp;gt;  å£°æ˜ç¬¬ä¸‰æ–¹æ¨¡å—çš„è·¯å¾„,ç”¨ä»¥ç¼–è¯‘åˆ€NginxæœåŠ¡å™¨ä¸­

--with-poll_module  å£°æ˜å¯ç”¨pollæ¨¡å—.pollæ¨¡å—æ˜¯ä¿¡å·å¤„ç†çš„ä¸€ç§æ–¹æ³•.

--with-http_ssl_module  å¯ç”¨HTTPçš„sslæ¨¡å—.

--with-http_stub_status_module  å¯ç”¨Server Statusé¡µ.é»˜è®¤ä¸å¯ç”¨

--http-proxy-temp-path=&amp;lt;path&amp;gt;  æŒ‡å®šå­˜æ”¾HTTPä»£ç†ä¸´æ—¶æ–‡ä»¶çš„è·¯å¾„

--without-http  å£°æ˜ç¦ç”¨HTTP Server

--with-pcre=&amp;lt;dir&amp;gt;  æŒ‡å®špcreåº“æºä»£ç çš„è·¯å¾„.è¿™æ ·å¯ä»¥åœ¨**ç¼–è¯‘Nginxæºä»£ç çš„åŒæ—¶ç¼–è¯‘pcreåº“**,ä¸éœ€è¦æå‰å®‰è£…pcreåº“

--with-zilb=&amp;lt;dir&amp;gt;  æŒ‡å®šzlibåº“æºä»£ç çš„è·¯å¾„.åŒpcre

--with-openssl=&amp;lt;dir&amp;gt;  æŒ‡å®šOpenSSLåº“æºä»£ç çš„è·¯å¾„.
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;æ¸…é™¤ä¸Šæ¬¡ç¼–è¯‘çš„é—ç•™æ–‡ä»¶ &lt;code&gt;make clean&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./configure

    --sbin-path&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/nginx/nginx

    --conf-path&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/nginx/nginx.conf

    --pid-path&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/nginx/nginx.pid

    --with-http_ssl_module

    --with-pcre&lt;span class="o"&gt;=&lt;/span&gt;../pcre-8.40

    --with-zlib&lt;span class="o"&gt;=&lt;/span&gt;../zlib-1.2.11
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 23 Jun 2019 15:10:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-23:/nginx-notebook-1-1-basic-config.html</guid><category>nginx</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-è¿ç»´-å®ç”¨è¿ç»´Tipså’Œæ€»ç»“</title><link>https://www.EWhisper.cn/nginx-handbook-3-11-operation-best-practices.html</link><description>&lt;h2 id="311-tips"&gt;3.11 å®ç”¨è¿ç»´Tipså’Œæ€»ç»“&lt;a class="headerlink" href="#311-tips" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="3110"&gt;3.11.0 ä»‹ç»&lt;a class="headerlink" href="#3110" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;æœ€åç« èŠ‚ä¼šåŒ…æ‹¬ä½¿ç”¨è¿ç»´tipså’Œæœ¬ä¹¦çš„æ€»ç»“. é€šè¿‡è¿™ä¸‰ä¸ªå¤§éƒ¨åˆ†, æˆ‘ä»¬è®¨è®ºäº†ä¸è¿ç»´å·¥ç¨‹å¸ˆæœ‰å…³çš„å¾ˆå¤šæƒ³æ³•å’Œæ¦‚å¿µ. ç„¶è€Œ, æˆ‘è®¤ä¸ºå†å¤šè®²ä¸€ç‚¹ä¼šæœ‰åŠ©äºç†è§£çš„æ›´åŠ å…¨é¢. åœ¨æœ¬ç« , æˆ‘ä¼šç¡®ä¿ä½ çš„é…ç½®æ–‡ä»¶å¹²å‡€å’Œç®€æ´, ä»¥åŠå¦‚ä½•è°ƒè¯•é…ç½®æ–‡ä»¶.&lt;/p&gt;
&lt;h3 id="3111-includes"&gt;3.11.1 ä½¿ç”¨ Includes æ¥ç¼©å‡é…ç½®&lt;a class="headerlink" href="#3111-includes" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦æ¸…ç†å¤§é‡çš„é…ç½®æ–‡ä»¶æ¥ä¿è¯ä½ çš„é…ç½®æ–‡ä»¶ä»¥æ¨¡å—åŒ–çš„é…ç½®é›†åˆ†ç»„.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;include&lt;/code&gt;æŒ‡ä»¤æ¥å¼•ç”¨é…ç½®æ–‡ä»¶, ç›®å½•æˆ–é€šé…ç¬¦:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;include&lt;/span&gt; &lt;span class="s"&gt;config.d/compression.conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;include&lt;/span&gt; &lt;span class="s"&gt;sites-enabled/*.conf&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç•¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="3112"&gt;3.11.2 è°ƒè¯•é…ç½®&lt;a class="headerlink" href="#3112" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä»NGINX server , ä½ å¾—åˆ°çš„éé¢„æœŸçš„ç»“æœ.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;è°ƒè¯•é…ç½®, è®°ä½ä»¥ä¸‹å»ºè®®:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;NGINXè¿›ç¨‹è¯·æ±‚æŸ¥æ‰¾æœ€åŒ¹é…çš„è§„åˆ™.&lt;/li&gt;
&lt;li&gt;ä½ å¯ä»¥æ‰“å¼€è°ƒè¯•æ—¥å¿—. å¯¹äºè°ƒè¯•æ—¥å¿—, ä½ éœ€è¦ç¡®ä¿ä½ çš„NGINXåŒ…é…ç½®äº†&lt;code&gt;--with-debug&lt;/code&gt; flag. å¤§éƒ¨åˆ†å¸¸è§åŒ…éƒ½æœ‰; ä½†æ˜¯å¦‚æœä½ æ„å»ºä½ è‡ªå·±çš„åŒ…, æˆ–åœ¨è¿è¡Œä¸€ä¸ªæœ€å°åŒ–çš„åŒ…, ä½ å¯èƒ½è‡³å°‘éœ€è¦å†æ¬¡ä»”ç»†æ£€æŸ¥. ä¸€æ—¦ä½ ç¡®å®šäº†ä½ æœ‰debug, ä½ å¯ä»¥è®¾ç½®&lt;code&gt;error_log&lt;/code&gt;æŒ‡ä»¤çš„æ—¥å¿—çº§åˆ«ä¸º&lt;code&gt;debug&lt;/code&gt;: &lt;code&gt;error_log /var/log/nginx/error.log debug;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä½ å¯ä»¥ä¸ºç‰¹å®šçš„è¿æ¥å¯ç”¨è°ƒè¯•. &lt;code&gt;debug_connection&lt;/code&gt;æŒ‡ä»¤åœ¨&lt;code&gt;events&lt;/code&gt;ä¸Šä¸‹æ–‡æ˜¯åˆæ³•çš„, ä½¿ç”¨IPæˆ–CIDR rangeä½œä¸ºå‚æ•°. è¯¥æŒ‡ä»¤å¯ä»¥å£°æ˜å¤šæ¬¡æ¥æ·»åŠ å¤šä¸ªè¦è°ƒè¯•çš„IPåœ°å€æˆ–CIDR ranges. è¿™åœ¨ç”Ÿäº§ç¯å¢ƒ, ä½†æ˜¯è°ƒè¯•æ‰€æœ‰è¿æ¥ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™çš„æƒ…å†µä¸‹, è°ƒè¯•ä¸€ä¸ªé—®é¢˜ä¼šå¾ˆæœ‰ç”¨&lt;/li&gt;
&lt;li&gt;ä½ å¯ä»¥è°ƒè¯•ç‰¹å®šçš„virtual servers. å› ä¸º&lt;code&gt;error_log&lt;/code&gt;åœ¨&lt;code&gt;main&lt;/code&gt; &lt;code&gt;http&lt;/code&gt; &lt;code&gt;mail&lt;/code&gt; &lt;code&gt;stream&lt;/code&gt; &lt;code&gt;server&lt;/code&gt; å’Œ&lt;code&gt;location&lt;/code&gt;ä¸Šä¸‹æ–‡éƒ½æœ‰æ•ˆ. ä½ å¯ä»¥åœ¨ä½ éœ€è¦è°ƒè¯•çš„ä¸Šä¸‹æ–‡è®¾ç½®&lt;code&gt;debug&lt;/code&gt;æ—¥å¿—çº§åˆ«.&lt;/li&gt;
&lt;li&gt;ä½ å¯ä»¥å¯ç”¨core dumps, æ¥ä»ä¸­è·å–backtraces. Core dumpså¯ä»¥é€šè¿‡æ“ä½œç³»ç»Ÿå¯ç”¨, æˆ–é€šè¿‡NGINXé…ç½®æ–‡ä»¶.&lt;/li&gt;
&lt;li&gt;ä½ å¯ä»¥ä½¿ç”¨&lt;code&gt;rewrite_log&lt;/code&gt;è®°å½•rewrite å£°æ˜çš„æ—¥å¿—: &lt;code&gt;rewrite_log on;&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;NGINXèƒ½åšå¾ˆå¤šç¥å¥‡çš„é…ç½®, ä½†æ˜¯ä¹Ÿæœ‰æ€§èƒ½ä¸‹é™çš„é£é™©. è°ƒè¯•æ—¶, ç¡®ä¿ä½ çŸ¥é“å¦‚ä½•é€šè¿‡ä½ çš„é…ç½®æ¥è¿½è¸ªä½ çš„è¯·æ±‚; å¦‚æœæœ‰é—®é¢˜, å¢åŠ è°ƒè¯•æ—¥å¿—çº§åˆ«æ¥å¸®åŠ©åˆ†æ. debugæ—¥å¿—æ—¶ç›¸å½“è¯¦ç»†, æ‰¾å‡ºNGINXå¯¹ä½ çš„è¯·æ±‚åšäº†ä»€ä¹ˆä»¥åŠä½ çš„é…ç½®åœ¨å“ªå„¿å‡ºé”™äº†å¾ˆæœ‰å¸®åŠ©.&lt;/p&gt;
&lt;h4&gt;å‚è§&lt;/h4&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2crNKVM"&gt;NGINXå¦‚ä½•å¤„ç†è¯·æ±‚&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2iQYNsZ"&gt;ç®¡ç†å‘˜è°ƒè¯•å‘å¯¼&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2j96jAH"&gt;Rewrite log&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="3113"&gt;3.11.3 æ€»ç»“&lt;a class="headerlink" href="#3113" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;è¿™æœ¬ä¹¦çš„ä¸‰ä¸ªéƒ¨åˆ†é›†ä¸­äºé«˜æ€§èƒ½è´Ÿè½½å‡è¡¡, å®‰å…¨, ä»¥åŠéƒ¨ç½²å’Œç»´æŠ¤NGINXå’ŒNGINX Plus servers. è¿™æœ¬ä¹¦å±•ç¤ºäº†NGINXåº”ç”¨äº¤ä»˜å¹³å°çš„ä¸€äº›æœ€å¼ºå¤§çš„åŠŸèƒ½. NGINXä¼šç»§ç»­å¼€å‘ç¥å¥‡çš„åŠŸèƒ½, ä¿æŒèµ›é“é¢†å…ˆ.&lt;/p&gt;
&lt;p&gt;è¿™æœ¬ä¹¦å±•ç¤ºäº†å¾ˆå¤š"ç®€çŸ­é£Ÿè°±", å…è®¸ä½ å¯¹æŒ‡ä»¤å’Œæ¨¡å—(è¿™äº›è®©NGINXæˆä¸ºå½“ä»Šç½‘ç»œä¹‹å¿ƒ)æœ‰æ›´å¥½çš„ç†è§£. NGINX serverä¸ä»…ä»…æ˜¯web server, ä¸ä»…ä»…æ—¶åå‘ä»£ç†, è€Œæ˜¯ä¸€ä¸ªå®Œæ•´çš„åº”ç”¨äº¤ä»˜å¹³å°, å®Œå…¨æœ‰èƒ½åŠ›é€šè¿‡è®¤è¯, å¹¶åœ¨æœªæ¥ç¯å¢ƒä¸­ä½¿ç”¨.  è¯·çŸ¥æ‚‰.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:39:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-3-11-operation-best-practices.html</guid><category>nginx</category><category>devops</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-è¿ç»´-ä½¿ç”¨`split_clients`è¿›è¡ŒA-Bæµ‹è¯•</title><link>https://www.EWhisper.cn/nginx-handbook-3-7-ab-test.html</link><description>&lt;h2 id="37-split_clientsa-b"&gt;3.7 ä½¿ç”¨&lt;code&gt;split_clients&lt;/code&gt;è¿›è¡ŒA-Bæµ‹è¯•&lt;a class="headerlink" href="#37-split_clientsa-b" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="370"&gt;3.7.0 ä»‹ç»&lt;a class="headerlink" href="#370" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;NGINXæœ‰ä¸€ä¸ªå«åš&lt;code&gt;split_clients&lt;/code&gt;çš„æ¨¡å—, å…è®¸ä½ æ¥ç³»ç»Ÿåœ°ç»™äºˆæŸä¸€ä¸ªå˜é‡keyæ¥æ‹†åˆ†ç”¨æˆ·. NGINXé€šè¿‡ä½¿ç”¨è½»é‡çš„å“ˆå¸Œç®—æ³•æ¥å“ˆå¸Œä¸€ä¸ªç»™å®šçš„å­—ç¬¦ä¸²æ¥æ‹†åˆ†ç”¨æˆ·. ç„¶åæ•°å­¦åœ°é€šè¿‡ç™¾åˆ†æ¯”æ‹†åˆ†, æ˜ å°„é¢„å®šä¹‰çš„å€¼åˆ°ä¸€ä¸ªå˜é‡, è¿™ä¸ªå€¼å¯ä»¥ç”¨æ¥æ”¹å˜æœåŠ¡å™¨çš„å“åº”ã€‚&lt;/p&gt;
&lt;h3 id="371-ab"&gt;3.7.1 A/B æµ‹è¯•&lt;a class="headerlink" href="#371-ab" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦æ‹†åˆ†ä¸¤ä¸ªæˆ–æ›´å¤šç‰ˆæœ¬çš„æ–‡ä»¶æˆ–ç¨‹åºçš„ç”¨æˆ·æ¥æµ‹è¯•æ¥å—åº¦.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;split_clients&lt;/code&gt;æ¨¡å—æ¥ç›´æ¥ä¸ºä½ çš„å®¢æˆ·ç«¯è®¾ç½®ä¸åŒçš„upstream pool:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;split_clients&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;${remote_addr}AAA&amp;quot;&lt;/span&gt; &lt;span class="nv"&gt;$variant&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;20.0%&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;backendv2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;*&lt;/span&gt;        &lt;span class="s"&gt;&amp;quot;backendv1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;split_clients&lt;/code&gt;æŒ‡ä»¤å“ˆå¸Œç”±ä½ æä¾›çš„å­—ç¬¦ä¸²ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°, å¹¶ä¸”å°†æ•£åˆ—çš„ç™¾åˆ†æ¯”æä¾›æ˜ å°„ä¸€ä¸ªå˜é‡çš„å€¼ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æä¾›ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªåŒ…å«key-valueå¯¹çš„å¯¹è±¡, keyæ˜¯ç™¾åˆ†æ¯”æƒé‡, å€¼æ˜¯è¦è¢«åˆ†é…çš„å€¼. keyå¯ä»¥æ˜¯ä¸€ä¸ªç™¾åˆ†æ¯”æˆ–ä¸€ä¸ªæ˜Ÿå·. æ˜Ÿå·å°±æ˜¯å‰©ä¸‹çš„ç™¾åˆ†æ¯”. å˜é‡&lt;code&gt;$variant&lt;/code&gt;çš„å€¼å°†æ˜¯20%çš„å®¢æˆ·ç«¯IPæ˜¯&lt;code&gt;backendv2&lt;/code&gt;, å‰©ä¸‹çš„80%æ˜¯&lt;code&gt;backendv1&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬ä¾‹ä¸­, &lt;code&gt;backendv1&lt;/code&gt;å’Œ&lt;code&gt;backendv2&lt;/code&gt;ä»£è¡¨upstream serveræ± , å¯ä»¥è¢«ç”¨äº&lt;code&gt;proxy_pass&lt;/code&gt;æŒ‡ä»¤, å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_pass&lt;/span&gt; &lt;span class="s"&gt;http://&lt;/span&gt;&lt;span class="nv"&gt;$variant&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨å˜é‡&lt;code&gt;$variant&lt;/code&gt;, æˆ‘ä»¬çš„æµé‡ä¼šè¢«åˆ†ä¸º2ä¸ªä¸åŒçš„åº”ç”¨serveræ± .&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªæ¡ˆä¾‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
 &lt;span class="kn"&gt;split_clients&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;${remote_addr}AAA&amp;quot;&lt;/span&gt; &lt;span class="nv"&gt;$variant&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="kn"&gt;0.5%&lt;/span&gt;               &lt;span class="s"&gt;.one&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="kn"&gt;2.0%&lt;/span&gt;               &lt;span class="s"&gt;.two&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                   &lt;span class="kn"&gt;*&lt;/span&gt;                  &lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
 &lt;span class="p"&gt;}&lt;/span&gt;
 &lt;span class="kn"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
     &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
         &lt;span class="kn"&gt;index&lt;/span&gt; &lt;span class="s"&gt;index&lt;/span&gt;&lt;span class="nv"&gt;${variant}.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;A/Bæµ‹è¯•çš„ç±»å‹å¾ˆæœ‰ç”¨, å¦‚æµ‹è¯•ä¸åŒç±»å‹çš„å¸‚åœºå’Œå‰ç«¯åŠŸèƒ½çš„ç”µå•†ç½‘ç«™è½¬åŒ–ç‡. å¯¹äºåº”ç”¨, ä½¿ç”¨é‡‘ä¸é›€å‘å¸ƒå¾ˆå¸¸è§. è¿™ç§éƒ¨ç½²ä¸­, æµé‡è¢«ç¼“æ…¢åœ°åˆ‡æ¢åˆ°æ–°çš„ç‰ˆæœ¬. æ‹†åˆ†ä¸åŒåº”ç”¨ç‰ˆæœ¬çš„å®¢æˆ·ç«¯æ˜¯å¾ˆæœ‰ç”¨çš„, å½“å›æ»šæ–°ç‰ˆæœ¬çš„ä»£ç , é™åˆ¶å› ä¸ºä¸€ä¸ªé”™è¯¯å¯¼è‡´çš„çˆ†ç‚¸åŠå¾„. ä¸è®ºæ˜¯å› ä¸ºä»€ä¹ˆåŸå› è¦æ‹†åˆ†ä¸¤ä¸ªä¸åŒåº”ç”¨é›†çš„å®¢æˆ·ç«¯, NGINXé€šè¿‡ä½¿ç”¨&lt;code&gt;split_client&lt;/code&gt;æ¨¡å—éƒ½èƒ½å¾ˆå®¹æ˜“å®ç°.&lt;/p&gt;
&lt;h4&gt;å‚è§&lt;/h4&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2jsdkw4"&gt;split_client documentation&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:39:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-3-7-ab-test.html</guid><category>nginx</category><category>devops</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-è¿ç»´-ä½¿ç”¨GeoIPæ¨¡å—é€šè¿‡IPåœ°å€å®šä½ç”¨æˆ·</title><link>https://www.EWhisper.cn/nginx-handbook-3-8-use-geoip-to-get-users-location.html</link><description>&lt;h2 id="38-geoipip"&gt;3.8 ä½¿ç”¨GeoIPæ¨¡å—é€šè¿‡IPåœ°å€å®šä½ç”¨æˆ·&lt;a class="headerlink" href="#38-geoipip" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="380"&gt;3.8.0 ä»‹ç»&lt;a class="headerlink" href="#380" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;è·Ÿè¸ª, åˆ†æ, å’Œåˆ©ç”¨ä½ çš„åº”ç”¨æˆ–åº¦é‡çš„å®¢æˆ·ç«¯çš„ä½ç½®ä¿¡æ¯å¯ä»¥å¸®åŠ©ä½ åŠ æ·±å¯¹å®¢æˆ·çš„ç†è§£. æœ‰å¾ˆå¤šæ–¹æ³•è·å–ä½ çš„å®¢æˆ·çš„ä½ç½®ä¿¡æ¯, NGINXé€šè¿‡ä½¿ç”¨GeoIPæ¨¡å—å’Œå‡ ä¸ªæŒ‡ä»¤å¾ˆå®¹æ˜“åœ°å®šä½ä»–ä»¬. è¯¥æ¨¡å—è®©åŸºäºå®¢æˆ·ä½ç½®ä¿¡æ¯è®°å½•ä½ç½®, æ§åˆ¶è®¿é—®, æˆ–è€…åŸºäºå®¢æˆ·ä½ç½®åšå†³å®šå˜å¾—å¾ˆå®¹æ˜“.  å®ƒä¹Ÿå…è®¸å®¢æˆ·çš„ä½ç½®ä¿¡æ¯è¢«å†…éƒ¨æŸ¥æ‰¾åªè¦è¯·æ±‚è¢«ä¼ è¾“åˆ°upstreamåº”ç”¨, è€Œä¸éœ€è¦å†è¿›è¡ŒæŸ¥æ‰¾. è¯¥NGINXæ¨¡å—é»˜è®¤ä¸å®‰è£…, å¯ä»¥ä»æºç é™æ€ç¼–è¯‘, åŠ¨æ€å¯¼å…¥, æˆ–é€šè¿‡åœ¨Ubuntuå®‰è£…&lt;code&gt;nginx-full&lt;/code&gt;æˆ–&lt;code&gt;nginx-extras&lt;/code&gt;æ¥å®‰è£…. åœ¨RHELå‘è¡Œç‰ˆ, å¦‚CentOS, ä½ å¯ä»¥å®‰è£…&lt;code&gt;nginx-mod-http-geoip&lt;/code&gt;åŒ…å¹¶é€šè¿‡&lt;code&gt;load_module&lt;/code&gt;åŠ¨æ€å¯¼å…¥. æœ¬ç« ä¼šè¦†ç›–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¼å…¥GeoIPåŠ¨æ€æ¨¡å—,&lt;/li&gt;
&lt;li&gt;å®‰è£…GeoIPæ•°æ®åº“,&lt;/li&gt;
&lt;li&gt;è¯¥æ¨¡å—å¯ç”¨çš„å†…å»ºå˜é‡,&lt;/li&gt;
&lt;li&gt;æ§åˆ¶è®¿é—®,&lt;/li&gt;
&lt;li&gt;å’Œä»£ç†ä¸€èµ·ä½¿ç”¨.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="381-geoip"&gt;3.8.1 ä½¿ç”¨GeoIPæ¨¡å—å’Œæ•°æ®åº“&lt;a class="headerlink" href="#381-geoip" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦å®‰è£…GeoIPæ•°æ®åº“, å¹¶å¯ç”¨åœ¨NGINXçš„å†…å»ºå‘½ä»¤, æ¥è®°å½•å’Œå‘Šè¯‰ä½ çš„åº”ç”¨ä½ çš„å®¢æˆ·ç«¯çš„åœ°ç†ä½ç½®.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä¸‹è½½GeoIPå›½å®¶å’ŒåŸå¸‚æ•°æ®åº“, å¹¶unzipå®ƒä»¬:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# mkdir /etc/nginx/geoip&lt;/span&gt;
&lt;span class="c1"&gt;# cd /etc/nginx/geoip&lt;/span&gt;
&lt;span class="c1"&gt;# wget &amp;quot;http://geolite.maxmind.com/\&lt;/span&gt;
download/geoip/database/GeoLiteCountry/GeoIP.dat.gz&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;# gunzip GeoIP.dat.gz&lt;/span&gt;
&lt;span class="s2"&gt;# wget &amp;quot;&lt;/span&gt;http://geolite.maxmind.com/&lt;span class="se"&gt;\&lt;/span&gt;
download/geoip/database/GeoLiteCity.dat.gz&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;# gunzip GeoLiteCity.dat.gz&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™äº›å‘½ä»¤åœ¨&lt;em&gt;/etc/nginx&lt;/em&gt;ä¸‹åˆ›å»ºä¸€ä¸ª&lt;em&gt;geoip&lt;/em&gt;ç›®å½•, è·³è½¬åˆ°æ–°ç›®å½•, å¹¶ä¸‹è½½å’Œè§£å‹åŒ….&lt;/p&gt;
&lt;p&gt;é€šè¿‡åœ¨æœ¬åœ°ç£ç›˜ä¸Šçš„ å›½å®¶å’ŒåŸå¸‚çš„GeoIPæ•°æ®åº“, æˆ‘ä»¬å¯ä»¥æ„å»ºNGINX GeoIPæ¨¡å—å¹¶ä½¿ç”¨å®ƒä»¬æ¥æš´éœ²å‡ºç»™äºˆå®¢æˆ·ç«¯IPåœ°å€çš„å†…å»ºæŒ‡ä»¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;load_module&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;/usr/lib64/nginx/modules/ngx_http_geoip_module.so&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;geoip_country&lt;/span&gt; &lt;span class="s"&gt;/etc/nginx/geoip/GeoIP.dat&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;geoip_city&lt;/span&gt; &lt;span class="s"&gt;/etc/nginx/geoip/GeoLiteCity.dat&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;...&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;geoip_country&lt;/code&gt;æŒ‡ä»¤æŒ‡å®šåˆ°&lt;em&gt;GeoIP.dat&lt;/em&gt;æ–‡ä»¶çš„è·¯å¾„, &lt;em&gt;GeoIP.dat&lt;/em&gt;åŒ…å«IPåœ°å€åˆ°å›½å®¶ä»£ç çš„æ˜ å°„, åªèƒ½åœ¨HTTPä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨.&lt;/p&gt;
&lt;h3 id="_1"&gt;è®¨è®º&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;æ¨¡å—çš„&lt;code&gt;geoip_country&lt;/code&gt;å’Œ&lt;code&gt;geoip_city&lt;/code&gt;æš´éœ²ä¸€ç³»åˆ—å¯ç”¨å˜é‡. &lt;code&gt;geoip_country&lt;/code&gt;æŒ‡ä»¤å…è®¸ä½ å»æœ¬ä½ çš„å®¢æˆ·çš„å›½å®¶. è¿™äº›å˜é‡åŒ…æ‹¬&lt;code&gt;$geoip_country_code&lt;/code&gt;, &lt;code&gt;geoip_country_code3&lt;/code&gt;å’Œ&lt;code&gt;geoip_country_name&lt;/code&gt;. å›½å®¶ä»£ç å˜é‡è¿”å›ä¸€ä¸ª2ä½å›½å®¶å­—æ¯. &lt;code&gt;geoip_country_code3&lt;/code&gt;è¿”å›3ä½å›½å®¶å­—æ¯. å›½å®¶åå˜é‡è¿”å›å›½å®¶çš„å…¨å.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;geoip_city&lt;/code&gt;æŒ‡ä»¤ä¹Ÿä¼šå¯ç”¨å‡ ä¸ªå˜é‡. å’Œ&lt;code&gt;geoip_country&lt;/code&gt;ç±»ä¼¼. æœ‰&lt;code&gt;$geoip_city_country_code&lt;/code&gt; &lt;code&gt;geoip_city_country_code3&lt;/code&gt; &lt;code&gt;geoip_city_contry_name&lt;/code&gt;. å…¶ä»–å˜é‡æœ‰&lt;code&gt;$geoip_city&lt;/code&gt; &lt;code&gt;$geoip_city_continent_code&lt;/code&gt; &lt;code&gt;$geoip_latitude&lt;/code&gt; &lt;code&gt;$geoip_longitude&lt;/code&gt;å’Œ&lt;code&gt;$geoip_postal_code&lt;/code&gt;. &lt;code&gt;$geoip_region&lt;/code&gt; &lt;code&gt;$geoip_region_name&lt;/code&gt;æè¿°åŒºåŸŸ, é¢†åŸŸ, å·, çœ, è”é‚¦æ”¿åºœåœ°ç­‰. åŒºåŸŸæ˜¯ä¸€ä¸ªä¸¤å­—ç¬¦ä»£ç , åŒºåŸŸåæ˜¯å…¨å. &lt;code&gt;geoip_area_code&lt;/code&gt;, åªåœ¨ç¾å›½æœ‰æ•ˆ, è¿”å›3ä½æ•°å­—ç”µè¯åŒºåŸŸç .&lt;/p&gt;
&lt;p&gt;é€šè¿‡è¿™äº›å˜é‡, ä½ èƒ½å¤Ÿè®°å½•ä½ çš„å®¢æˆ·ç«¯çš„ä¿¡æ¯. ä½ å¯ä»¥é€‰æ‹©ä¼ é€’ä¿¡æ¯åˆ°ä½ çš„åº”ç”¨ä½œä¸ºä¸€ä¸ªheaderæˆ–å˜é‡, æˆ–ä½¿ç”¨NGINXæ¥ä»¥ç‰¹å®šæ–¹å¼routeæµé‡.&lt;/p&gt;
&lt;h4&gt;å‚è§&lt;/h4&gt;
&lt;p&gt;&lt;a href="https://github.com/maxmind/geoipupdate"&gt;GeoIP å‡çº§&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="382"&gt;3.8.2 åŸºäºå›½å®¶é™åˆ¶è®¿é—®&lt;a class="headerlink" href="#382" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;æ ¹æ®åˆçº¦æˆ–åº”ç”¨éœ€æ±‚, ä½ éœ€è¦é™åˆ¶æ¥è‡ªç‰¹å®šå›½å®¶çš„è®¿é—®.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;æ˜ å°„ä½ æƒ³è¦å±è”½æˆ–å…è®¸çš„å›½å®¶ä»£ç åˆ°ä¸€ä¸ªå˜é‡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;load_module&lt;/span&gt;
  &lt;span class="s"&gt;&amp;quot;/usr/lib64/nginx/modules/ngx_http_geoip_module.so&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;map&lt;/span&gt; &lt;span class="nv"&gt;$geoip_country_code&lt;/span&gt; &lt;span class="nv"&gt;$country_access&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kn"&gt;&amp;quot;US&amp;quot;&lt;/span&gt;    &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;&amp;quot;RU&amp;quot;&lt;/span&gt;    &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;default&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kn"&gt;...&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªæ˜ å°„ä¼šè®¾ç½®æ–°çš„å˜é‡&lt;code&gt;$country_access&lt;/code&gt;ä¸º1æˆ–0. å¦‚æœå®¢æˆ·ç«¯IPåœ°å€æ¥è‡ªç¾å›½æˆ–ä¿„ç½—æ–¯, å˜é‡ä¼šè¢«è®¾ç½®ä¸º0, å…¶ä»–å›½å®¶ä¼šè®¾ç½®ä¸º1.&lt;/p&gt;
&lt;p&gt;ç„¶å, åœ¨&lt;code&gt;server&lt;/code&gt;å¿«, ä½¿ç”¨&lt;code&gt;if&lt;/code&gt;å£°æ˜æ¥æ‹’ç»ä¸æ˜¯æ¥è‡ªç¾å›½å’Œä¿„ç½—æ–¯çš„ç”¨æˆ·è®¿é—®:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;if&lt;/span&gt; &lt;span class="s"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$country_access&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;1&amp;#39;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="kn"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;403&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kn"&gt;...&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“æ¡ä»¶åˆ¤æ–­ä¸ºTrueæ—¶, ä¼šè¿”å›403 æœªè®¤è¯. å¦åˆ™æ­£å¸¸è®¿é—®.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªç®€çŸ­çš„ä¾‹å­, æ¥è¯´æ˜å¦‚ä½•å…è®¸ç‰¹å®šå›½å®¶è®¿é—®. è¿™ä¸ªä¾‹å­å¯ä»¥è¢«æ‰©å±•, ä»¥ç¬¦åˆä½ çš„éœ€è¦.&lt;/p&gt;
&lt;h3 id="383"&gt;3.8.3 æ‰¾åˆ°æºå®¢æˆ·ç«¯&lt;a class="headerlink" href="#383" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦æ‰¾åˆ°å®¢æˆ·æºIP, å› ä¸ºåœ¨NGINX serverå‰è¾¹æœ‰ä»£ç†.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;geoip_proxy&lt;/code&gt;æŒ‡ä»¤æ¥å®šä¹‰ä½ çš„ä»£ç†IPåœ°å€èŒƒå›´, &lt;code&gt;geoip_proxy_recursive&lt;/code&gt;æŒ‡ä»¤æ¥æŸ¥æ‰¾æºIP:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;load_module&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;/usr/lib64/nginx/modules/ngx_http_geoip_module.so&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;geoip_country&lt;/span&gt; &lt;span class="s"&gt;/etc/nginx/geoip/GeoIP.dat&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;geoip_city&lt;/span&gt; &lt;span class="s"&gt;/etc/nginx/geoip/GeoLiteCity.dat&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;geoip_proxy&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="s"&gt;.0.16.0/26&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;geoip_proxy_recursive&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;...&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;geoip_proxy&lt;/code&gt;æŒ‡ä»¤å®šä¹‰æˆ‘ä»¬çš„ä»£ç†æœåŠ¡å™¨çš„CIDRèŒƒå›´, æŒ‡ç¤ºNGINXåˆ©ç”¨&lt;code&gt;X-Forwarded-For&lt;/code&gt;å¤´æ¥æŸ¥æ‰¾å®¢æˆ·ç«¯IPåœ°å€. &lt;code&gt;geoip_proxy_recursive&lt;/code&gt;æŒ‡ä»¤æŒ‡ç¤ºNGINXæ¥é€’å½’åœ°æŸ¥æ‰¾ä¸Šä¸ªçŸ¥é“çš„å®¢æˆ·ç«¯IPçš„&lt;code&gt;X-Forwarded-For&lt;/code&gt; header.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;ä½ å¯èƒ½ä¼šå‘ç°ä½ åœ¨NGINXå‰è¾¹ä½¿ç”¨äº†ä»£ç†, NGINXä¼šé€‰æ‹©ä»£ç†çš„IPåœ°å€è€Œä¸æ˜¯å®¢æˆ·ç«¯çš„. å¯¹äºè¿™ç§æƒ…å†µä½ å¯ä»¥ä½¿ç”¨&lt;code&gt;geoip_proxy&lt;/code&gt;æŒ‡ä»¤æ¥æŒ‡ç¤ºåœ¨ç»™å®šçš„èŒƒå›´å†…, NGINXä½¿ç”¨&lt;code&gt;X-Forwarded-For&lt;/code&gt; header. &lt;code&gt;geoip_proxy&lt;/code&gt;æŒ‡ä»¤é…ç½®ä¸€ä¸ªåœ°å€æˆ–CIDRèŒƒå›´. å½“NGINXå‰è¾¹æœ‰å¤šä¸ªä»£ç†, å¯ä»¥ä½¿ç”¨&lt;code&gt;geoip_proxy_recursive&lt;/code&gt;æŒ‡ä»¤æ¥é€’å½’åœ°æŸ¥æ‰¾&lt;code&gt;X-Forwarded-For&lt;/code&gt;æŒ‡ä»¤, æ¥æ‰¾åˆ°æºå®¢æˆ·ç«¯. ä½ å¯èƒ½ä¼šåœ¨å¦‚åœ¨NGINXå‰è¾¹ä½¿ç”¨AWS ELB, è°·æ­Œçš„è´Ÿè½½å‡è¡¡, æˆ–Azureçš„è´Ÿè½½å‡è¡¡æ—¶ç”¨åˆ°è¿™äº›.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:39:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-3-8-use-geoip-to-get-users-location.html</guid><category>nginx</category><category>devops</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-è¿ç»´-è‡ªåŠ¨åŒ–</title><link>https://www.EWhisper.cn/nginx-handbook-3-6-automatation.html</link><description>&lt;h2 id="36"&gt;3.6 è‡ªåŠ¨åŒ–&lt;a class="headerlink" href="#36" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="360"&gt;3.6.0 ä»‹ç»&lt;a class="headerlink" href="#360" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;æœ‰å¾ˆå¤šæ–¹å¼æ¥è‡ªåŠ¨åŒ–NGINXå’ŒNGINX Plusçš„é…ç½®æ–‡ä»¶, å¦‚: ä½¿ç”¨é…ç½®ç®¡ç†å·¥å…·æˆ–å®šæ—¶ä»»åŠ¡æ¥ä»æ¨¡æ¿é…ç½®æ–‡ä»¶é…ç½®. éšç€åŠ¨æ€ç¯å¢ƒçš„å¢åŠ , è‡ªåŠ¨åŒ–é…ç½®çš„éœ€æ±‚å˜å¾—æ›´æ€¥éœ€. åœ¨ä¸Šä¸€ç« , æˆ‘ä»¬ç¡®ä¿¡NGINXé…ç½®æ–‡ä»¶è¢«é…ç½®åéœ€è¦reload.åœ¨æœ¬ç« , æˆ‘ä»¬ä¼šè®¨è®ºæ›´è¿›ä¸€æ­¥çš„ä½¿ç”¨NGINX Plus APIå’Œ&lt;strong&gt;Consul Template&lt;/strong&gt;çš„å®æ—¶(on-the-fly)NGINXé…ç½®æ–‡ä»¶é‡é…ç½®.&lt;/p&gt;
&lt;h3 id="361-nginx-plus"&gt;3.6.1 ä½¿ç”¨NGINX Plusè‡ªåŠ¨åŒ–&lt;a class="headerlink" href="#361-nginx-plus" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦ä¸ºåŠ¨æ€ç¯å¢ƒé‡å®æ—¶é…ç½®NGINX Plusçš„load balance.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨NGINX Plus APIæ¥é‡é…ç½®NGINX Plus upstream æ± :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ curl &lt;span class="s1"&gt;&amp;#39;http://nginx.local/upstream_conf?\&lt;/span&gt;
&lt;span class="s1"&gt;  add=&amp;amp;upstream=backend&amp;amp;server=10.0.0.42:8080&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;curl&lt;/code&gt;è°ƒç”¨åˆ°NGINX Plusçš„è¯·æ±‚, è¯·æ±‚ä¸€ä¸ªæŠŠä¸€ä¸ªæ–°çš„serveråŠ åˆ°&lt;code&gt;backend&lt;/code&gt; upstreamé…ç½®.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;æ›´å¤šç¬¬ä¸€æ¬¡å®‰è£…çš„ç»†èŠ‚è§ 3.8 ç« èŠ‚, NGINX Plusæä¾›ä¸€ä¸ªAPIæ¥é‡æ–°å®æ—¶é…ç½®NGINX Plus. NGINX Plus APIå…è®¸ä»upstream æ± ä¸­æ·»åŠ å’Œç§»é™¤server, åŒæ—¶draining è¿æ¥. ä½ å¯ä»¥ä½¿ç”¨è¯¥APIæ¥è‡ªåŠ¨åŒ–NGINX Plusçš„åº”ç”¨æœåŠ¡å™¨çš„åˆ›å»ºå’Œé‡Šæ”¾çš„é…ç½®.&lt;/p&gt;
&lt;h3 id="362-consul-templating"&gt;3.6.2 ä½¿ç”¨Consul Templating è‡ªåŠ¨åŒ–é…ç½®&lt;a class="headerlink" href="#362-consul-templating" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦è‡ªåŠ¨åŒ–NGINXé…ç½®æ¥é€šè¿‡ä½¿ç”¨Consulåœ¨ç¯å¢ƒä¸­åšå‡ºå˜æ›´.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;consul-template&lt;/code&gt; daemonå’Œä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶æ¥æ¨¡æ¿åŒ–NGINXé…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;upstream backend { &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;range&lt;/span&gt; &lt;span class="nv"&gt;service&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;app.backend&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;    server &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;.Address&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;end&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªä¾‹å­æ˜¯Consulæ¨¡æ¿æ–‡ä»¶çš„ä¸€ä¸ªupstreamé…ç½®å—æ¨¡æ¿. è¿™ä¸ªæ¨¡æ¿ä¼šéå†åœ¨Consulä¸Šæ ‡è®°ä¸º&lt;code&gt;app.backend&lt;/code&gt;çš„èŠ‚ç‚¹. å¯¹äºConsulä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹, è¿™ä¸ªæ¨¡æ¿ä¼šä½¿ç”¨é‚£ä¸ªèŠ‚ç‚¹çš„IPåœ°å€äº§ç”Ÿä¸€æ¡serveræŒ‡ä»¤.&lt;/p&gt;
&lt;p&gt;è¿™ä¸ª&lt;code&gt;consul-template&lt;/code&gt; daemoné€šè¿‡å‘½ä»¤è¡Œè¿è¡Œ, å¯ä»¥è¢«ç”¨äºåœ¨æ¯æ¬¡é…ç½®æ–‡ä»¶è¢«æ¨¡æ¿åŒ–å˜æ›´åreload NGINX:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# consul-template -consul consul.example.internal -template \&lt;/span&gt;
template:/etc/nginx/conf.d/upstream.conf:&lt;span class="s2"&gt;&amp;quot;nginx -s reload&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¯¥æŒ‡ä»¤æŒ‡ç¤º&lt;code&gt;consul-template&lt;/code&gt; daemon æ¥è¿æ¥åˆ°ä¸€ä¸ªä½äº&lt;code&gt;consul.example.internal&lt;/code&gt;çš„Consul é›†ç¾¤, å¹¶ä½¿ç”¨åœ¨å½“å‰å·¥ä½œç›®å½•çš„åä¸º&lt;code&gt;template&lt;/code&gt;çš„æ–‡ä»¶æ¥æ¨¡æ¿åŒ–è¯¥æ–‡ä»¶, å¹¶è¾“å‡ºç”Ÿæˆçš„å†…å®¹åˆ°&lt;code&gt;/etc/nginx/conf.d/upstream.conf&lt;/code&gt;ä¸­, ç„¶ååœ¨æ¯æ¬¡æ¨¡æ¿åŒ–æ–‡ä»¶å˜æ›´æ—¶reload NGINX. &lt;code&gt;-template&lt;/code&gt; æ ‡å¿—æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²,åŒ…æ‹¬: æ¨¡æ¿æ–‡ä»¶,è¾“å‡ºä½ç½®,å’Œè¿è¡Œæ¨¡æ¿è¿‡ç¨‹åæ‰§è¡Œçš„å‘½ä»¤; è¿™3ä¸ªå˜é‡ä»¥å†’å·åˆ†éš”. å¦‚æœè¿è¡Œçš„å‘½ä»¤ç”±ç©ºæ ¼, ç¡®ä¿ä½¿ç”¨åŒå¼•å·åŒ…è£¹. &lt;code&gt;-consul&lt;/code&gt;æ ‡å¿—æŒ‡ç¤ºè¦è¿æ¥çš„Consulé›†ç¾¤.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;Consulæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æœåŠ¡å‘ç°å·¥å…·å’Œé…ç½®ä»“åº“. Consulä»¥key-value å¯¹ä»¥ç±»ä¼¼ç›®å½•çš„ç»“æ„å­˜å‚¨èŠ‚ç‚¹ä¿¡æ¯, å…è®¸restful APIäº¤äº’.Consulä¹Ÿåœ¨æ¯ä¸ªå®¢æˆ·ç«¯ä¸Šæä¾›ä¸€ä¸ªDNSç•Œé¢, å…è®¸è¿›è¡Œè¿æ¥åˆ°é›†ç¾¤çš„èŠ‚ç‚¹çš„åŸŸåæŸ¥æ‰¾. ä¸€ä¸ªå•ç‹¬çš„, åˆ©ç”¨Consulé›†ç¾¤çš„é¡¹ç›®æ˜¯&lt;code&gt;consul-template&lt;/code&gt; daemon; è¿™ä¸ªå·¥å…·æ¨¡æ¿åŒ–åœ¨Consul èŠ‚ç‚¹, æœåŠ¡æˆ– key-valueå¯¹çš„æ–‡ä»¶å˜åŒ–. è¿™è®©Consulæˆä¸ºä¸€ä¸ªè‡ªåŠ¨åŒ–NGINXçš„éå¸¸å¼ºå¤§çš„é€‰æ‹©. ä½¿ç”¨&lt;code&gt;consul-template&lt;/code&gt;ä½ ä¹Ÿå¯ä»¥æŒ‡ç¤ºè¯¥daemonåœ¨æ¨¡æ¿æ›¿æ¢å˜æ›´åæ¥è¿è¡Œä¸€ä¸ªå‘½ä»¤. é€šè¿‡è¿™æ ·, å¯ä»¥reload NGINXé…ç½®, å¹¶å…è®¸NGINXé…ç½®åœ¨ç¯å¢ƒä¸­ç”Ÿæ•ˆ. é€šè¿‡Consul, ä½ å¯ä»¥åœ¨æ¯ä¸ªå®¢æˆ·ç«¯ä¸Šè®¾ç½®å¥åº·æ£€æŸ¥æ¥æ£€æŸ¥å…³æ³¨çš„æœåŠ¡çš„ç›‘æ§çŠ¶å†µ. é€šè¿‡å¤±è´¥æ£€æµ‹, ä½ èƒ½å¤Ÿé€šè¿‡æ¨¡æ¿åŒ–ä½ çš„NGINXé…ç½®æ¥åªç»™å¥åº·çš„ä¸»æœºå‘é€æµé‡.&lt;/p&gt;
&lt;h4&gt;å‚è§&lt;/h4&gt;
&lt;p&gt;&lt;a href="https://www.consul.io/"&gt;Consul home page&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2iosmkV"&gt;Introduction to Consul Template&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/hashicorp/consul-template"&gt;Consul template GitHub&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:33:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-3-6-automatation.html</guid><category>nginx</category><category>devops</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-è¿ç»´-å‰è¨€å’Œä»‹ç»</title><link>https://www.EWhisper.cn/nginx-handbook-3-0-foreword.html</link><description>&lt;h2 id="30"&gt;3.0 å‰è¨€å’Œä»‹ç»&lt;a class="headerlink" href="#30" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;åœ¨NGINX CookBookçš„ç¬¬ä¸€éƒ¨åˆ†, ä¸»é¢˜æ˜¯è´Ÿè½½å‡è¡¡å’Œç¼“å­˜. ç¬¬äºŒéƒ¨åˆ†æ˜¯NGINXçš„å®‰å…¨åŠŸèƒ½, å¦‚è®¤è¯å’ŒåŠ å¯†. ç¬¬ä¸‰éƒ¨åˆ†é›†ä¸­äºNGINXçš„è¿ç»´é—®ä½ , åŒ…æ‹¬éƒ¨ç½², æ€§èƒ½è°ƒä¼˜å’Œè§£å†³é—®é¢˜.&lt;/p&gt;
&lt;p&gt;åœ¨è¿™éƒ¨åˆ†, ä½ ä¼šçœ‹åˆ°åŸºäºä¸‰ä¸ªå¤§å‹å…¬æœ‰äº‘çš„NGINXéƒ¨ç½²å®è·µ: Amazon Web Services(AWS), Google Cloud Platform(GCP), å’Œå¾®è½¯Azure, åŒ…æ‹¬å¦‚ä½•è‡ªåŠ¨åŒ–åœ¨AWSä¸Šéƒ¨ç½². å¦‚æœä½ è®¡åˆ’ä½¿ç”¨Docker, ä¹Ÿæœ‰ç›¸å…³å†…å®¹.&lt;/p&gt;
&lt;p&gt;å®‰è£…ä¹Ÿä¼šæ·±å…¥è®¨è®ºä½¿ç”¨Puppet, Chef, Ansibleå’ŒSaltStackçš„è‡ªåŠ¨åŒ–é…ç½®ç®¡ç†. ä¹Ÿä»‹ç»äº†ä½¿ç”¨NGINX Plus APIæ¥å®æ–½é‡é…ç½®, ä½¿ç”¨Consulè¿›è¡ŒæœåŠ¡å‘ç°å’Œæ¨¡ç‰ˆé…ç½®.&lt;/p&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹, å¤§éƒ¨åˆ†ç³»ç»Ÿé…ç½®æ˜¯åŸºäºå…¼å®¹æ€§è€Œä¸æ˜¯æ€§èƒ½. ç„¶åä½ è¦æ ¹æ®ä½ çš„ç‰¹å®šéœ€æ±‚è¿›è¡Œæ€§èƒ½è°ƒä¼˜. åœ¨æœ¬ä¹¦ä¸­, ä½ ä¼šæ‰¾åˆ°åœ¨ä¿æŒå…¼å®¹æ€§çš„å‰æä¸‹, è¯¦ç»†çš„æœ€å¤§åŒ–NGINXæ€§èƒ½çš„æ–¹æ³•.&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ç¢°åˆ°éƒ¨ç½²é—®é¢˜, æˆ‘é¦–å…ˆä¼šçœ‹æ—¥å¿—æ–‡ä»¶, æ˜¯å¾ˆå¤šè°ƒè¯•ä¿¡æ¯çš„æ¥æº. NGINXæœ‰ç»´æŠ¤è¯¦ç»†çš„, é«˜åº¦é…ç½®åŒ–çš„æ—¥å¿—æ¥å¸®åŠ©ä½ å®šä½é—®é¢˜. æœ¬ä¹¦ä¸­åŒ…å«NGINXæ—¥å¿—çš„è¯¦ç»†å†…å®¹.&lt;/p&gt;
&lt;p&gt;å®ƒä¼šå¸®åŠ©ä½ å®‰è£…, ç›‘æ§, ç»´æŠ¤NGINXåº”ç”¨äº¤ä»˜å¹³å°.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:28:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-3-0-foreword.html</guid><category>nginx</category><category>devops</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-è¿ç»´-åœ¨Docker ä¸Šéƒ¨ç½²</title><link>https://www.EWhisper.cn/nginx-handbook-3-4-nginx-docker.html</link><description>&lt;h2 id="34-docker"&gt;3.4 åœ¨Dockerä¸Šéƒ¨ç½²&lt;a class="headerlink" href="#34-docker" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="340"&gt;3.4.0 ä»‹ç»&lt;a class="headerlink" href="#340" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Dockeræ˜¯ä¸ªå¼€æºé¡¹ç›®, ä¼šè‡ªåŠ¨æŠŠLinuxåº”ç”¨éƒ¨ç½²åˆ°è½¯ä»¶å®¹å™¨ä¸­. Dockeræä¾›ä¸€ä¸ªé¢å¤–çš„æŠ½è±¡å±‚, åœ¨linuxä¸Šè‡ªåŠ¨åŒ–æ“ä½œç³»ç»Ÿçº§åˆ«çš„è™šæ‹ŸåŒ–. å®¹å™¨åŒ–ç¯å¢ƒå·²ç»å¯¹ç”Ÿäº§ä¸–ç•Œé€ æˆäº†å·¨å¤§çš„å˜é©. Dockerå’Œå…¶ä»–å®¹å™¨å¹³å°å…è®¸å¿«é€Ÿ, å¯é , è·¨å¹³å°çš„åº”ç”¨éƒ¨ç½². æœ¬ç« ä¸­, æˆ‘ä»¬ä¼šè®¨è®ºNGINXå®˜æ–¹NGINX Dockerjingxiang,åˆ›å»ºä½ è‡ªå·±çš„Dockeræ–‡ä»¶æ¥è¿è¡ŒNGINX, åœ¨NGINXä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡, é€šç”¨Dockerå®è·µ.&lt;/p&gt;
&lt;h3 id="341-nginx"&gt;3.4.1 ä½¿ç”¨NGINXé•œåƒå¿«é€Ÿè¿è¡Œ&lt;a class="headerlink" href="#341-nginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦ä½¿ç”¨Docker Hubä¸­çš„NGINXé•œåƒå¿«é€Ÿå¯åŠ¨å’Œè¿è¡Œ.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ docker pull nginx:latest
$ docker run -it -p &lt;span class="m"&gt;80&lt;/span&gt;:80 -v &lt;span class="nv"&gt;$PWD&lt;/span&gt;/nginx-conf:/etc/nginx &lt;span class="se"&gt;\&lt;/span&gt;
                                   nginx:latest
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;NGINXå·²ç»åœ¨Docker Hubä¸Šåˆ¶ä½œäº†ä¸€ä¸ªå®˜æ–¹Dockeré•œåƒ. å®˜æ–¹Dockeré•œåƒå¾ˆå®¹æ˜“åœ¨Dockerä¸­å¯åŠ¨å’Œå¿«é€Ÿè¿è¡Œ. åœ¨æœ¬èŠ‚ä¸­æˆ‘ä»¬é€šè¿‡2ä¸ªå‘½ä»¤å°±èƒ½å¯åŠ¨å’Œè¿è¡ŒNGINX å®¹å™¨. å®˜æ–¹é•œåƒæ˜¯åŸºäºDebian Jessie Dockeré•œåƒ. ä½†æ˜¯ä½ ä¹Ÿå¯ä»¥é€‰æ‹©åŸºäºAlpine Linuxæ„å»ºçš„å®˜æ–¹é•œåƒ. è¿™äº›å®˜æ–¹é•œåƒçš„Dockerfileå’Œæºç å¯ä»¥åœ¨GitHubä¸­æ‰¾åˆ°.&lt;/p&gt;
&lt;h4&gt;å‚è§&lt;/h4&gt;
&lt;p&gt;&lt;a href="https://hub.docker.com/_/nginx/"&gt;Official NGINX Docker image, NGINX&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/nginxinc/docker-nginx/"&gt;Docker repo on GitHub&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="342-nginx-dockerfile"&gt;3.4.2 åˆ›å»ºä¸€ä¸ªNGINX Dockerfile&lt;a class="headerlink" href="#342-nginx-dockerfile" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªNGINX Dockerfile, ç”¨Dockerfileåˆ›å»ºDockeré•œåƒ.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;CMD&lt;/code&gt;æ¥åœ¨é•œåƒå®ä¾‹åŒ–ä¸ºå®¹å™¨æ—¶å¯åŠ¨NGINX. ä½ éœ€è¦åœ¨å‰å°è¿è¡ŒNGINX. è¦è¿™ä¹ˆåš, éœ€è¦å¯åŠ¨NGINXä½¿ç”¨&lt;code&gt;-g "daemon off;"&lt;/code&gt;æˆ–å¢åŠ &lt;code&gt;daemon off;&lt;/code&gt;åˆ°é…ç½®. æœ¬ä¾‹ä¸­ç¨åä½¿ç”¨&lt;code&gt;daemon off;&lt;/code&gt;åŠ åˆ°main context. ä½ ä¹Ÿæƒ³è°ƒèŠ‚ä½ çš„accessæ—¥å¿—è¾“å‡ºåˆ°&lt;code&gt;/dev/stdout&lt;/code&gt;, é”™è¯¯æ—¥å¿—è¾“å‡ºåˆ°&lt;code&gt;/dev/stderr&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; centos:7&lt;/span&gt;
&lt;span class="c"&gt;# Install epel repo to get nginx and install nginx&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; yum -y install epel-release &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    yum -y install nginx
&lt;span class="c"&gt;# add local configuration files into the image&lt;/span&gt;
&lt;span class="k"&gt;ADD&lt;/span&gt; /nginx-conf /etc/nginx
&lt;span class="k"&gt;EXPOSE&lt;/span&gt;&lt;span class="s"&gt; 80 443&lt;/span&gt;
&lt;span class="k"&gt;CMD&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;nginx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤º:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;.
â”œâ”€â”€ Dockerfile
â””â”€â”€ nginx-conf
    â”œâ”€â”€ conf.d
    â”‚   â””â”€â”€ default.conf
    â”œâ”€â”€ fastcgi.conf
    â”œâ”€â”€ fastcgi_params
    â”œâ”€â”€ koi-utf
    â”œâ”€â”€ koi-win
    â”œâ”€â”€ mime.types
    â”œâ”€â”€ nginx.conf
    â”œâ”€â”€ scgi_params
    â”œâ”€â”€ uwsgi_params
    â””â”€â”€ win-utf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨æœ¬ä¾‹ä¸­, æˆ‘é€‰æ‹©ç›´æ¥å§nginx-confç›®å½•ä¸‹æ‰€æœ‰æˆ‘çš„NGINXé…ç½®éƒ½æ·»åŠ åˆ°Dockerfileä¸­.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;å½“ä½ éœ€è¦å®Œå…¨æ§åˆ¶åŒ…çš„å®‰è£…å’Œå‡çº§, ä½ ä¼šå‘ç°åˆ›å»ºè‡ªå·±çš„Dockerfileå¾ˆæœ‰ç”¨. å¸¸è§æ“ä½œæ˜¯ä¿å­˜åœ¨ä½ è‡ªå·±çš„é•œåƒä»“åº“ä¸­, è¿™æ ·ä½ ä¼šçŸ¥é“ä½ çš„åŸºç¡€é•œåƒåœ¨ä¸Šç”Ÿäº§ä¹‹å‰æ˜¯å¯é çš„, ç»è¿‡å›¢é˜Ÿæµ‹è¯•çš„.&lt;/p&gt;
&lt;h3 id="343-nginx-plus"&gt;3.4.3 æ„å»ºNGINX Plusé•œåƒ&lt;a class="headerlink" href="#343-nginx-plus" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç•¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="344-nginx"&gt;3.4.4 åœ¨NGINXä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡&lt;a class="headerlink" href="#344-nginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä¸ºäº†åœ¨ä¸åŒçš„ç¯å¢ƒä¸­ä½¿ç”¨ç›¸åŒçš„å®¹å™¨é•œåƒ, ä½ éœ€è¦åœ¨NGINXé…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;ngx_http_perl_module&lt;/code&gt;æ¥ä»ä½ çš„ç¯å¢ƒçš„NGINXä¸­è®¾ç½®å˜é‡.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;daemon&lt;/span&gt; &lt;span class="no"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;env&lt;/span&gt; &lt;span class="s"&gt;APP_DNS&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;include&lt;/span&gt; &lt;span class="n"&gt;/usr/share/nginx/modules/*.conf&lt;/span&gt;;
&lt;span class="k"&gt;...&lt;/span&gt;
&lt;span class="s"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="kn"&gt;perl_set&lt;/span&gt; &lt;span class="nv"&gt;$upstream_app&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;sub&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="kn"&gt;return&lt;/span&gt; &lt;span class="nv"&gt;$ENV{&amp;quot;APP_DNS&amp;quot;}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="kn"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kn"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;...&lt;/span&gt;
    &lt;span class="s"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="kn"&gt;proxy_pass&lt;/span&gt; &lt;span class="s"&gt;https://&lt;/span&gt;&lt;span class="nv"&gt;$upstream_app&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¦ä½¿ç”¨&lt;code&gt;perl_set&lt;/code&gt;, ä½ å¿…é¡»å®‰è£…&lt;code&gt;ngx_http_perl_module&lt;/code&gt;; ä½ å¯ä»¥é€šè¿‡åŠ¨æ€æ¨¡å—åŠ è½½æˆ–ä»æºç é™æ€æ„å»º. NGINXé»˜è®¤ä»ç¯å¢ƒä¸­æ“¦é™¤ç¯å¢ƒå˜é‡; ä½ éœ€è¦åœ¨&lt;code&gt;env&lt;/code&gt;æŒ‡ä»¤ä¸­å£°æ˜ä»»ä½•ä½ ä¸æƒ³ç§»é™¤çš„å˜é‡. &lt;code&gt;perl_set&lt;/code&gt;æŒ‡ä»¤æœ‰2ä¸ªå‚æ•°: ä½ æƒ³è¦è®¾ç½®çš„å˜é‡åå’Œæ¸²æŸ“ç»“æœçš„perlå­—ç¬¦ä¸².&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªDockerfile, ä¼šåŠ¨æ€åŠ è½½&lt;code&gt;ngx_http_perl_module&lt;/code&gt;, ä»åŒ…ç®¡ç†å·¥å…·å®‰è£…è¯¥æ¨¡å—. å½“ä»CentOSçš„åŒ…ç®¡ç†ä¸­å®‰è£…æ¨¡å—, ä»–ä»¬è¢«æ”¾åœ¨&lt;code&gt;/usr/lib64/nginx/modules/&lt;/code&gt;ç›®å½•, é…ç½®æ–‡ä»¶ä¼šåŠ¨æ€åŠ è½½åœ¨&lt;code&gt;/usr/share/nginx/modules/&lt;/code&gt;ç›®å½•çš„æ¨¡å—. è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„é…ç½®å—ä¸­, è¦åŒ…å«å®Œæ•´çš„è·¯å¾„.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; centos:7&lt;/span&gt;
&lt;span class="c"&gt;# Install epel repo to get nginx and install nginx&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; yum -y install epel-release &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    yum -y install nginx nginx-mod-http-perl
&lt;span class="c"&gt;# add local configuration files into the image&lt;/span&gt;
&lt;span class="k"&gt;ADD&lt;/span&gt; /nginx-conf /etc/nginx
&lt;span class="k"&gt;EXPOSE&lt;/span&gt;&lt;span class="s"&gt; 80 443&lt;/span&gt;
&lt;span class="k"&gt;CMD&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;nginx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;å½“ä½¿ç”¨Docker, å…¸å‹å®è·µå°±æ˜¯åˆ©ç”¨ç¯å¢ƒå˜é‡æ¥ä¿®æ”¹å®¹å™¨æ“ä½œçš„æ–¹å¼. ä½ å¯ä»¥åœ¨NGINXé…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡, è¿™æ ·NGINXå¯ä»¥ç”¨äºå¤šä¸ª, ä¸åŒçš„ç¯å¢ƒ.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:28:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-3-4-nginx-docker.html</guid><category>nginx</category><category>devops</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category><category>docker</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-è¿ç»´-ä½¿ç”¨Puppet/Chef/Ansible/SaltStackéƒ¨ç½²</title><link>https://www.EWhisper.cn/nginx-handbook-3-5-nginx-autoconf-tools.html</link><description>&lt;h2 id="35-puppetchefansiblesaltstack"&gt;3.5 ä½¿ç”¨Puppet/Chef/Ansible/SaltStack&lt;a class="headerlink" href="#35-puppetchefansiblesaltstack" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="350"&gt;3.5.0 ä»‹ç»&lt;a class="headerlink" href="#350" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;åœ¨äº‘çš„æ—¶ä»£, é…ç½®ç®¡ç†å·¥å…·æ˜¯æ— ä»·ä¹‹å®. å¤§è§„æ¨¡webåº”ç”¨çš„å·¥ç¨‹å¸ˆæ— æ³•é€šè¿‡ä»£ç æ‰‹æŠŠæ‰‹é…ç½®servers, ä½†æ˜¯ä½¿ç”¨å…¶ä¸­ä»»ä½•ä¸€ä¸ªé…ç½®ç®¡ç†å·¥å…·éƒ½å¯ä»¥åšåˆ°. é…ç½®ç®¡ç†å·¥å…·å…è®¸å·¥ç¨‹å¸ˆä¸€æ¬¡å†™å…¥é…ç½®å’Œä»£ç åˆ°å¾ˆå¤šæœ‰ç›¸åŒé…ç½®çš„server, é€šè¿‡ä½¿ç”¨ä¸€ç§å¯é‡å¤, å¯æµ‹è¯•, æ¨¡å—åŒ–çš„æ–¹å¼. æœ¬ç« è®¨è®ºå‡ ä¸ªæµè¡Œçš„é…ç½®ç®¡ç†å·¥å…·, ä»¥åŠå¦‚ä½•ä½¿ç”¨ä»–ä»¬å®‰è£…NIGINXå’Œä»æ¨¡ç‰ˆåˆ›å»ºä¸€ä¸ªåŸºæœ¬é…ç½®. è¿™äº›ä¾‹å­éå¸¸åŸºç¡€, ä½†æ˜¯å±•ç¤ºäº†å¦‚ä½•é€šè¿‡æ¯ä¸ªå¹³å°æ¥å¯åŠ¨NGINX.&lt;/p&gt;
&lt;h3 id="351-puppet"&gt;3.5.1 ä½¿ç”¨Puppetå®‰è£…&lt;a class="headerlink" href="#351-puppet" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦é€šè¿‡Puppetå®‰è£…å’Œé…ç½®NGINX, ä»¥ä»£ç å½¢å¼ç®¡ç†NGINXé…ç½®, å¹¶ç¡®è®¤ä½ çš„å…¶ä»–Puppeté…ç½®.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;åˆ›å»ºä¸€ä¸ªæ¨¡å—, ç”¨äºå®‰è£…NGINX, ç®¡ç†ä½ éœ€è¦çš„æ–‡ä»¶, ç¡®ä¿NGINXåœ¨è¿è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="n"&gt;nginx&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;package&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;nginx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;ensure&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;installed&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,}&lt;/span&gt;
    &lt;span class="n"&gt;service&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;nginx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;ensure&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;true&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;hasrestart&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;true&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;restart&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/etc/init.d/nginx reload&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;nginx.conf&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;path&lt;/span&gt;    &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/etc/nginx/nginx.conf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nb"&gt;require&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="no"&gt;Package&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;nginx&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;notify&lt;/span&gt;  &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="no"&gt;Service&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;nginx&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;nginx/templates/nginx.conf.erb&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;root&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;group&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;root&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;0644&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¯¥æ¨¡å—ä½¿ç”¨åŒ…ç®¡ç†å·¥å…·æ¥ç¡®ä¿NGINXè¢«å®‰è£…. ä¹Ÿä¼šç¡®ä¿NGINXåœ¨å¯åŠ¨æ—¶åœ¨è¿è¡Œå’Œå¯ç”¨. è¯¥é…ç½®é€šçŸ¥Puppet, è¯¥æœåŠ¡æœ‰é‡å¯å‘½ä»¤, é€šè¿‡&lt;code&gt;hasrestart&lt;/code&gt;æŒ‡ä»¤, å¹¶ä¸”æˆ‘ä»¬ç”¨NGINX reloadå‘½ä»¤è¦†ç›–&lt;code&gt;restart&lt;/code&gt;å‘½ä»¤. å®ƒé€šè¿‡å†…ç½®Ruby(ERB)æ¨¡ç‰ˆè¯­è¨€æ¥ç®¡ç†å’Œæ¨¡æ¿åŒ–&lt;code&gt;nginx.conf&lt;/code&gt;æ–‡ä»¶. æ–‡ä»¶çš„æ¨¡æ¿åŒ–ä¼šå‘ç”Ÿåœ¨NGINXåŒ…è¢«å®‰è£…ä¹‹å(é€šè¿‡&lt;code&gt;require&lt;/code&gt;æŒ‡ä»¤). ä½†æ˜¯, å®ƒä¼šé€šè¿‡&lt;code&gt;notify&lt;/code&gt;æŒ‡ä»¤é€šçŸ¥NGINXæœåŠ¡æ¥reload. è¯¥æ¨¡ç‰ˆåŒ–é…ç½®æ–‡ä»¶æ²¡æœ‰åŒ…æ‹¬. å¦å¤–, å®ƒå¯ä»¥ç®€å•å®‰è£…ä¸€ä¸ªé»˜è®¤çš„NGINXé…ç½®æ–‡ä»¶, æˆ–æ˜¯ä½¿ç”¨å†…ç½®Ruby(ERB)æˆ–å†…ç½®Puppet(EPP)æ¨¡ç‰ˆè¯­è¨€çš„å¾ªç¯å’Œå˜é‡æ›¿æ¢.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;Puppetæ˜¯åŸºäºRubyè¯­è¨€çš„é…ç½®ç®¡ç†å·¥å…·. æ¨¡å—è¢«æ„å»ºè¿›ä¸€ä¸ªç‰¹å®šåŸŸçš„è¯­è¨€, å¹¶é€šè¿‡å®šä¹‰ç»™å®šserveré…ç½®çš„manifestæ–‡ä»¶è°ƒç”¨. Puppetå¯ä»¥ç”¨ä¸»ä»æˆ–masterlessæ¨¡å¼è¿è¡Œ. ä½¿ç”¨Puppet, manifestè¿è¡Œåœ¨masterä¸Š, ç„¶åå‘åˆ°slaveä¸Š. è¿™å¾ˆé‡è¦, å› ä¸ºå®ƒç¡®ä¿slaveåªæ˜¯è¢«äº¤ä»˜å¯¹å®ƒæœ‰ç”¨çš„é…ç½®, å¯¹å…¶ä»–serverçš„å…¶ä»–é…ç½®æ˜¯ä¸ä¼šç»™è¿™ä¸ªslaveçš„. Puppetæœ‰å¾ˆå¤šéå¸¸é«˜çº§çš„å…¬ç”¨æ¨¡å—. é€šè¿‡è¿™äº›æ¨¡å—, ä¼šåœ¨é…ç½®ä¸Šå¸®åŠ©ä½ é£èµ·. åœ¨GitHubä¸Šæ¥è‡ªvoxpupuliçš„å…¬å…±NGINXæ¨¡å—ä¼šä¸ºä½ æ¨¡æ¿åŒ–NGINXé…ç½®.&lt;/p&gt;
&lt;h4&gt;å‚è§&lt;/h4&gt;
&lt;p&gt;&lt;a href="https://docs.puppet.com/"&gt;Puppet documentation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2jfgpm4"&gt;Puppet package documentation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2jMq2cx"&gt;Puppet service documentation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2jMz4q3"&gt;Puppet file documentation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2isqAlP"&gt;Puppet templating documentation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2jMspMn"&gt;Voxpupuli NGINX module&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="352-chef"&gt;3.5.2 ä½¿ç”¨Chefå®‰è£…&lt;a class="headerlink" href="#352-chef" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç•¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="353-ansible"&gt;3.5.3 ä½¿ç”¨Ansibleå®‰è£…&lt;a class="headerlink" href="#353-ansible" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦ä½¿ç”¨Ansibleæ¥å®‰è£…å’Œé…ç½®NGINX, ä»¥ä»£ç å½¢å¼ç®¡ç†NGINXé…ç½®, å¹¶ç¡®è®¤ä½ çš„å…¶ä»–Ansibleé…ç½®.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;åˆ›å»ºä¸€ä¸ªå®‰è£…NGINXå’Œç®¡ç†&lt;em&gt;nginx.conf&lt;/em&gt;æ–‡ä»¶playbook. ä¸‹åˆ—æ˜¯ä¸€ä¸ªç¤ºä¾‹çš„ä»»åŠ¡æ–‡ä»¶.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;NGINX | Installing NGINX&lt;/span&gt;
  &lt;span class="nt"&gt;package&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;name=nginx state=present&lt;/span&gt;

&lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;NGINX | Starting NGINX&lt;/span&gt;
  &lt;span class="nt"&gt;service&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;nginx&lt;/span&gt;
    &lt;span class="nt"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;started&lt;/span&gt;
    &lt;span class="nt"&gt;enabled&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;yes&lt;/span&gt;
&lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Copy nginx configuration in place.&lt;/span&gt;
  &lt;span class="nt"&gt;template&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;src&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;nginx.conf.j2&lt;/span&gt;
    &lt;span class="nt"&gt;dest&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;/etc/nginx/nginx.conf&amp;quot;&lt;/span&gt;
    &lt;span class="nt"&gt;owner&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;root&lt;/span&gt;
    &lt;span class="nt"&gt;group&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;root&lt;/span&gt;
    &lt;span class="nt"&gt;mode&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;0644&lt;/span&gt;
  &lt;span class="nt"&gt;notify&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;reload nginx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;package&lt;/code&gt;å—å®‰è£…NGINX. &lt;code&gt;service&lt;/code&gt;å—ç¡®ä¿NGINXåœ¨å¯åŠ¨æ—¶è¢«å¯åŠ¨å’Œå¯ç”¨. &lt;code&gt;template&lt;/code&gt;å—æ¨¡æ¿åŒ–ä¸€ä¸ª&lt;em&gt;Jinja2&lt;/em&gt;æ–‡ä»¶, å¹¶æŠŠç»“æœä»¥rootç”¨æˆ·å’Œç»„æ”¾åˆ°&lt;code&gt;/etc/nginx.conf&lt;/code&gt;ä¸­. è¯¥æ¨¡ç‰ˆå—ä¹Ÿè®¾ç½®&lt;em&gt;mode&lt;/em&gt;ä¸º644, å¹¶é€šçŸ¥nginxæœåŠ¡reload. æ¨¡æ¿åŒ–é…ç½®æ–‡ä»¶æ²¡æœ‰åŒ…å«åœ¨å†…. ä½†æ˜¯, å¯ä»¥é€šè¿‡é»˜è®¤çš„NGINXé…ç½®æ–‡ä»¶æ¥ç®€å•, æˆ–è€…é€šè¿‡Jinja2æ¨¡ç‰ˆè¯­è¨€çš„å¾ªç¯å’Œå˜é‡æ›¿æ¢ç”Ÿæˆå¾ˆå¤æ‚çš„æ¨¡ç‰ˆ.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;Ansibleæ˜¯ç”¨Pythonç¼–å†™çš„å¹¿æ³›ä½¿ç”¨çš„å¼ºå¤§é…ç½®ç®¡ç†å·¥å…·. ä»»åŠ¡é…ç½®ä½¿ç”¨YAML, ä½¿ç”¨Jinja2æ¨¡ç‰ˆè¯­è¨€ç”Ÿæˆæ–‡ä»¶æ¨¡ç‰ˆ. Ansibleæä¾›ä¸€ä¸ªæœ‰masterçš„å«åšAnsible Towerçš„è®¢é˜…ç‰ˆ. ä½†æ˜¯, å®ƒç»å¸¸ç”¨äºæœ¬åœ°æœºå™¨æˆ–æ„å»ºæœåŠ¡å™¨ç›´æ¥åˆ°å®¢æˆ·ç«¯æˆ–è€…ä½¿ç”¨masterlessæ¨¡å¼. Ansibleæ‰“åŒ…SSHåˆ°å®ƒçš„serverå¹¶è¿è¡Œé…ç½®. å’Œå…¶ä»–é…ç½®å·¥å…·ç±»ä¼¼, æœ‰å¾ˆå¤šç¤¾åŒºæä¾›çš„å…¬å…±roles, AnsibleæŠŠå®ƒå«åšAnsible Galaxy. ä½ å¯ä»¥æ‰¾åˆ°å¯ä»¥ç”¨äºä½ çš„playbookçš„éå¸¸å¤æ‚çš„roles.&lt;/p&gt;
&lt;h4&gt;å‚è§&lt;/h4&gt;
&lt;p&gt;&lt;a href="http://docs.ansible.com/"&gt;Ansible documentation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2jfiwGv"&gt;Ansible packages&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2jMGF7E"&gt;Ansible service&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2j8j526"&gt;Ansible template&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://galaxy.ansible.com/"&gt;Ansible Galaxy&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="354-saltstack"&gt;3.5.4 ä½¿ç”¨SaltStackå®‰è£…&lt;a class="headerlink" href="#354-saltstack" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦ä½¿ç”¨SaltStackæ¥å®‰è£…å’Œé…ç½®NGINX, ä»¥ä»£ç å½¢å¼ç®¡ç†NGINXé…ç½®, å¹¶ç¡®è®¤ä½ çš„å…¶ä»–SaltStacké…ç½®.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;nginx&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;pkg&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;installed&lt;/span&gt;
  &lt;span class="nt"&gt;service&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;nginx&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;running&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;enable&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;True&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;reload&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;True&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;watch&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/etc/nginx/nginx.conf&lt;/span&gt;

&lt;span class="nt"&gt;/etc/nginx/nginx.conf&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;managed&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;source&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;salt://path/to/nginx.conf&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;user&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;root&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;group&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;root&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;template&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;jinja&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;mode&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;644&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;require&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;pkg&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;nginx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:28:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-3-5-nginx-autoconf-tools.html</guid><category>nginx</category><category>devops</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-å®‰å…¨-å®ç”¨å®‰å…¨æŠ€å·§</title><link>https://www.EWhisper.cn/nginx-handbook-2-10-security-tips.html</link><description>&lt;h2 id="210"&gt;2.10 å®ç”¨å®‰å…¨æŠ€å·§&lt;a class="headerlink" href="#210" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="2100"&gt;2.10.0 ä»‹ç»&lt;a class="headerlink" href="#2100" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;å®‰å…¨æ˜¯åˆ†å±‚çš„, å°±åƒä¸€ä¸ªæ´‹è‘±, ä½ çš„å®‰å…¨æ¨¡å‹ç¡®å®è¦è¢«å¤šå±‚åŠ å›º. åœ¨è¿™éƒ¨åˆ†, æˆ‘ä»¬ä»‹ç»è®¸å¤šä¸åŒçš„æ–¹æ³•æ¥ç¡®ä¿webåº”ç”¨ç¨‹åºNGINXå’ŒNGINX Plus. å¾ˆå¤šçš„è¿™äº›å®‰å…¨æ–¹æ³•å¯ä»¥ç”¨æ¥åŠ å›ºå®‰å…¨. ä¸‹é¢æ˜¯ä¸€äº›å®ç”¨çš„å®‰å…¨æç¤º,ä»¥ç¡®ä¿æ‚¨çš„ç”¨æˆ·åœ¨ä½¿ç”¨HTTPSå’Œå‘Šè¯‰NGINXæ»¡è¶³ä¸€ä¸ªæˆ–å¤šä¸ªå®‰å…¨æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id="2101-https"&gt;2.10.1 HTTPS é‡å®šå‘&lt;a class="headerlink" href="#2101-https" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦é‡å®šå‘æœªåŠ å¯†çš„è¯·æ±‚åˆ°HTTPS.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;rewrite&lt;/code&gt;æ¥å‘é€æ‰€æœ‰HTTPæµé‡åˆ°HTTPS:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt; &lt;span class="s"&gt;default_server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="s"&gt;[::]:80&lt;/span&gt; &lt;span class="s"&gt;default_server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;server_name&lt;/span&gt; &lt;span class="s"&gt;_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;301&lt;/span&gt; &lt;span class="s"&gt;https://&lt;/span&gt;&lt;span class="nv"&gt;$host$request_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªé…ç½®ç›‘å¬æ‰€æœ‰hostnameçš„IPv4å’ŒIPv6çš„80ç«¯å£ä½œä¸ºé»˜è®¤çš„server. &lt;code&gt;return&lt;/code&gt;å£°æ˜è¿”å›301æ°¸ä¹…é‡å®šå‘åˆ°åŒæ ·çš„hostå’Œè¯·æ±‚URIçš„HTTPSä¸Š.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;æ€»æ˜¯æŠŠé€‚å½“çš„è¯·æ±‚é‡å®šå‘åˆ°HTTPSæ˜¯éå¸¸é‡è¦çš„. ä½ å¯èƒ½ä¼šå‘ç°ä½ ä¸éœ€è¦é‡å®šå‘æ‰€æœ‰çš„è¯·æ±‚, è€Œæ˜¯åœ¨å®¢æˆ·ç«¯å’Œserverä¹‹é—´ä¼ è¾“æ•æ„Ÿä¿¡æ¯çš„é‚£äº›è¯·æ±‚. åœ¨æœ¬ä¾‹ä¸­, ä½ å¯èƒ½æƒ³è¦æŠŠ&lt;code&gt;return&lt;/code&gt;å£°æ˜æ”¾åˆ°ç‰¹å®šçš„locationé‡Œ, å¦‚&lt;code&gt;/login&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id="2102-ssltlsnginxhttps"&gt;2.10.2 é‡å®šå‘SSL/TLSåœ¨NGINXä¹‹å‰å·²ç»ç»“æŸçš„åˆ°HTTPS&lt;a class="headerlink" href="#2102-ssltlsnginxhttps" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦é‡å®šå‘åˆ°HTTPS, ç„¶è€Œ, åœ¨NGINXä¹‹å‰, ä½ å·²ç»ç»“æŸäº†SSL/TLS.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨æ ‡å‡†çš„&lt;code&gt;HTTP_X_Forwarded_Proto&lt;/code&gt; å¤´æ¥å†³å®šæ˜¯å¦ä½ éœ€è¦è¿›è¡Œé‡å®šå‘:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt; &lt;span class="s"&gt;default_server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="s"&gt;[::]:80&lt;/span&gt; &lt;span class="s"&gt;default_server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;server_name&lt;/span&gt; &lt;span class="s"&gt;_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;if&lt;/span&gt; &lt;span class="s"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$http_x_forwarded_proto&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;http&amp;#39;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kn"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;301&lt;/span&gt; &lt;span class="s"&gt;https://&lt;/span&gt;&lt;span class="nv"&gt;$host$request_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªé…ç½®å’ŒHTTPSé‡å®šå‘å¾ˆåƒ. ä½†æ˜¯, åœ¨è¿™ä¸ªé…ç½®ä¸­, åªæœ‰å¤´&lt;code&gt;X_Forwarded_Proto&lt;/code&gt;ç­‰äºHTTPæ‰ä¼šé‡å®šå‘.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªåœ¨NGINXä¹‹å‰å°±ç»“æŸäº†SSL/TLSçš„å¸¸è§æ¡ˆä¾‹. ä½ å¯èƒ½è¦è¿™ä¹ˆåšçš„ä¸€ä¸ªåŸå› æ˜¯èŠ‚çœè®¡ç®—å¼€é”€. ä½†æ˜¯, ä½ éœ€è¦ç¡®ä¿æ¯ä¸ªè¯·æ±‚éƒ½æ˜¯HTTPS, ä½†æ˜¯ç»“æŸäº†SSL/TLSçš„å±‚æ²¡æœ‰é‡å®šå‘çš„èƒ½åŠ›. ä½†æ˜¯, å¯ä»¥è®¾ç½®ä»£ç†å¤´éƒ¨. è¿™ä¸ªé…ç½®å¯ä»¥åœ¨Amazon Web Services Elastic Load Balancerä¸Šå·¥ä½œ, å› ä¸ºè¿™ä¸ªå¦‚æœæ²¡æœ‰é¢å¤–çš„èŠ±é’±çš„è¯å°±ä¼šå¸è½½æ‰SSL/TLS. è¿™æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„æŠ€å·§ä»¥ç¡®ä¿ä½ çš„HTTPæµé‡æ˜¯å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;h3 id="2103"&gt;2.10.3 æ»¡è¶³ä»»æ„æ•°é‡çš„å®‰å…¨æ–¹æ³•&lt;a class="headerlink" href="#2103" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦æä¾›å¤šç§æ–¹å¼æ¥ä¼ è¾“å®‰å…¨åˆ°ä¸€ä¸ªä¸å…¬å¼€çš„ç«™ç‚¹.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;satisfy&lt;/code&gt;æŒ‡ä»¤æ¥è¯´æ˜ä½ æƒ³è¦ä½¿ç”¨ä»»æ„æ•°é‡çš„å®‰å…¨æ–¹æ³•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;satisfy&lt;/span&gt; &lt;span class="s"&gt;any&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;allow&lt;/span&gt; &lt;span class="mi"&gt;192&lt;/span&gt;&lt;span class="s"&gt;.168.1.0/24&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;deny&lt;/span&gt;  &lt;span class="s"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;auth_basic&lt;/span&gt;           &lt;span class="s"&gt;&amp;quot;closed&lt;/span&gt; &lt;span class="s"&gt;site&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;auth_basic_user_file&lt;/span&gt; &lt;span class="s"&gt;conf/htpasswd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¯¥é…ç½®å‘Šè¯‰NGINXç”¨æˆ·è¯·æ±‚&lt;code&gt;location /&lt;/code&gt;éœ€è¦æ»¡è¶³å…¶ä¸­çš„ä¸€ä¸ªå®‰å…¨æ–¹æ³•: æˆ–è€…è¯¥è¯·æ±‚éœ€è¦æ¥è‡ª&lt;em&gt;192.168.1.0/24&lt;/em&gt; CIDR block, æˆ–è€…èƒ½å¤Ÿæä¾›åœ¨å¯ä»¥åœ¨&lt;code&gt;conf/htpasswd&lt;/code&gt;ä¸­æ‰¾åˆ°çš„ç”¨æˆ·åå¯†ç . &lt;code&gt;satisfy&lt;/code&gt;æŒ‡ä»¤æœ‰2ä¸ªé€‰é¡¹: &lt;code&gt;any&lt;/code&gt;æˆ–&lt;code&gt;all&lt;/code&gt;&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;satifsy&lt;/code&gt;æŒ‡ä»¤æ˜¯ä¸€ä¸ªæä¾›å¤šç§è®¤è¯çš„å¾ˆå¥½çš„æ–¹å¼. é€šè¿‡æŒ‡å®š&lt;code&gt;any&lt;/code&gt;ç»™&lt;code&gt;satisfy&lt;/code&gt;æŒ‡ä»¤, ç”¨æˆ·å¿…é¡»æ»¡è¶³å…¶ä¸­ä¸€ä¸ªå®‰å…¨. æŒ‡å®š&lt;code&gt;all&lt;/code&gt;ç»™&lt;code&gt;satisfy&lt;/code&gt;æŒ‡ä»¤, ç”¨æˆ·å¿…é¡»æ»¡è¶³æ‰€æœ‰çš„å®‰å…¨è®¤è¯. è¯¥æŒ‡ä»¤å¯ä»¥å’Œ2.1çš„&lt;code&gt;http_access_module&lt;/code&gt;ç»“åˆ, 2.4çš„&lt;code&gt;http_auth_basic_module&lt;/code&gt;, 2.5çš„&lt;code&gt;http_auth_request_module&lt;/code&gt;, 2.7çš„&lt;code&gt;http_auth_jwt_module&lt;/code&gt;. åªæœ‰å„ä¸ªå±‚éƒ½å®‰å…¨, æ‰æ˜¯çœŸæ­£çš„å®‰å…¨. &lt;code&gt;satisfy&lt;/code&gt;æŒ‡ä»¤ä¼šå¸®åŠ©ä½ ä¸ºè¿™ä¸ªlocationæˆ–serverå®ç°éœ€è¦çš„æ·±åº¦å®‰å…¨è§„åˆ™.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:24:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-2-10-security-tips.html</guid><category>nginx</category><category>å®‰å…¨</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-å®‰å…¨-ModSecurity Webåº”ç”¨é˜²ç«å¢™</title><link>https://www.EWhisper.cn/nginx-handbook-2-9-waf.html</link><description>&lt;h2 id="29-modsecurity-web"&gt;2.9 ModSecurity Webåº”ç”¨é˜²ç«å¢™&lt;a class="headerlink" href="#29-modsecurity-web" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="290"&gt;2.9.0 ä»‹ç»&lt;a class="headerlink" href="#290" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ModSecurity æ˜¯ä¸€ä¸ªå¼€æºçš„webåº”ç”¨é˜²ç«å¢™(WAF), é¦–æ¬¡è¢«æ„å»ºä»…Apache web server. åœ¨2012å¹´, å®ƒä½œä¸ºNGINXçš„ä¸€ä¸ªæ¨¡å—å¯ä¾›ä½¿ç”¨, 2016åŠ å…¥NGINX Plusä½œä¸ºä¸€ä¸ªå¯é€‰åŠŸèƒ½. æœ¬ç« å°†è¯¦ç»†ä»‹ç»ä½¿ç”¨NGINX Plusçš„åŠ¨æ€æ¨¡å—åŠŸèƒ½å®‰è£…ModSecurity 3.0, ä½¿ç”¨å¼€æºNGINXå®‰è£…ModeSecurity 2.9. ModSecurity 3.0æ¯”ModSecurity 2.xçš„å®‰å…¨å’Œæ€§èƒ½æ›´å‡ºä¼—. å½“ä»å¼€æºè¿è¡ŒModSecurity 2.9, å› ä¸ºå®ƒä»ç„¶æ˜¯åœ¨Apacheä¸Šæ„é€ , å› æ­¤éœ€è¦æ¯”3.0æ›´å¤šçš„å¼€é”€, è€Œ3.0æ˜¯åŸºäºNGINXåŸç”Ÿè®¾è®¡çš„.  ModSecurity 3.0 åªèƒ½ç”¨äºNGINX Plusè®¢é˜….&lt;/p&gt;
&lt;h3 id="291-nginx-plusmodesecurity"&gt;2.9.1 ä¸ºNGINX Pluså®‰è£…ModeSecurity&lt;a class="headerlink" href="#291-nginx-plusmodesecurity" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç•¥è¿‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="292-nginx-plusmodsecurity"&gt;2.9.2 åœ¨NGINX Plusä¸­é…ç½®ModSecurity&lt;a class="headerlink" href="#292-nginx-plusmodsecurity" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦é…ç½®NGINX Plusä½¿ç”¨ModSecurityæ¨¡å—.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;åœ¨NGINX Plusé…ç½®ä¸­å¯ç”¨åŠ¨æ€æ¨¡å—, ä½¿ç”¨&lt;code&gt;modsecurity_rules_file&lt;/code&gt;æ¥æŒ‡å‘ä¸€ä¸ªModSecurityè§„åˆ™æ–‡ä»¶:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;load_module modules/ngx_http_modsecurity.so;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;load_module&lt;/code&gt;æŒ‡ä»¤é€‚ç”¨äºä¸»context, æ„å‘³ç€è¯¥æŒ‡ä»¤å¯ä»¥åœ¨æ‰“å¼€HTTPæˆ–Streamå—ä¹‹å‰ä½¿ç”¨.&lt;/p&gt;
&lt;p&gt;å¼€å¯ModeSecurity, ä½¿ç”¨æŒ‡å®šè§„åˆ™é›†:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="k"&gt;modsecurity&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kn"&gt;proxy_pass&lt;/span&gt; &lt;span class="s"&gt;http://backend&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;modsecurity_rules_file&lt;/span&gt; &lt;span class="s"&gt;rule-set-file&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;ModSecurityçš„è§„åˆ™å¯ä»¥é˜»æ­¢å¯¹å¸¸è§çš„web serverså’Œåº”ç”¨çš„æ¼æ´åˆ©ç”¨. ModSecurityå·²çŸ¥å¯ä»¥é˜²å¾¡åº”ç”¨å±‚çš„æ”»å‡», å¦‚HTTP violations, SQLæ³¨å…¥, è·¨ç«™è„šæœ¬, åº”ç”¨å±‚, DDoS, è¿œç¨‹å’Œæœ¬åœ°æ–‡ä»¶æ”»å‡». ä½¿ç”¨ModSecurity, ä½ å¯ä»¥è®¢é˜…æ¶æ„ç”¨äºçš„å®æ—¶çš„é»‘åå•, æ¥å¸®åŠ©åœ¨æœåŠ¡è¢«æ”»å‡»ä¹‹å‰é˜»æ­¢é—®é¢˜. ModSecurityæ¨¡å—ä¹Ÿå¯ä»¥å¯ç”¨æ—¥å¿—å¸®åŠ©è¯†åˆ«æ–°çš„æ”»å‡»æ¨¡å¼å’Œå¼‚å¸¸.&lt;/p&gt;
&lt;h4&gt;å‚è§&lt;/h4&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2fdZ7Dd"&gt;OWASP ModSecurity æ ¸å¿ƒè§„åˆ™é›†&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2eJYuAx"&gt;TrustWave ModSecurity ä»˜è´¹è§„åˆ™é›†&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="293-modsecurity"&gt;2.9.3 æºç å®‰è£…ModSecurity&lt;a class="headerlink" href="#293-modsecurity" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦åœ¨CentOSæˆ–RHELç³»ç»Ÿä¸Šä½¿ç”¨NGINXè¿è¡ŒModSecurity.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä»æºç ç¼–è¯‘ModSecurityå’ŒNGINXæ¥ä½¿ç”¨ModSecurityæ¨¡å—.&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå‡çº§securityå¹¶å®‰è£…ä¾èµ–:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ yum --security update -y &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    yum -y install automake &lt;span class="se"&gt;\&lt;/span&gt;
    autoconf &lt;span class="se"&gt;\&lt;/span&gt;
    curl &lt;span class="se"&gt;\&lt;/span&gt;
    curl-devel &lt;span class="se"&gt;\&lt;/span&gt;
    gcc &lt;span class="se"&gt;\&lt;/span&gt;
    gcc-c++ &lt;span class="se"&gt;\&lt;/span&gt;
    httpd-devel &lt;span class="se"&gt;\&lt;/span&gt;
    libxml2 &lt;span class="se"&gt;\&lt;/span&gt;
    libxml2-devel &lt;span class="se"&gt;\&lt;/span&gt;
    make &lt;span class="se"&gt;\&lt;/span&gt;
    openssl &lt;span class="se"&gt;\&lt;/span&gt;
    openssl-devel &lt;span class="se"&gt;\&lt;/span&gt;
    perl &lt;span class="se"&gt;\&lt;/span&gt;
    wget
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¥ä¸‹æ¥, ä¸‹è½½å®‰è£…PCREåº“:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /opt &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    wget http://ftp.exim.org/pub/pcre/pcre-8.39.tar.gz &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    tar -zxf pcre-8.39.tar.gz &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="nb"&gt;cd&lt;/span&gt; pcre-8.39 &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    ./configure &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    make &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸‹è½½zlibæºç å¹¶å®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /opt &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    wget http://zlib.net/zlib-1.2.8.tar.gz &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    tar -zxf zlib-1.2.8.tar.gz &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="nb"&gt;cd&lt;/span&gt; zlib-1.2.8 &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    ./configure &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    make &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸‹è½½ModSecurityæºç å¹¶å®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /opt &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
  wget &lt;span class="se"&gt;\&lt;/span&gt;
  https://www.modsecurity.org/tarball/2.9.1/modsecurity-2.9.1.&lt;span class="se"&gt;\&lt;/span&gt;
tar.gz&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
  tar -zxf modsecurity-2.9.1.tar.gz &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
  &lt;span class="nb"&gt;cd&lt;/span&gt; modsecurity-2.9.1 &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
  ./configure --enable-standalone-module &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
  make
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä»æºç ä¸‹è½½å®‰è£…NGINX, å¹¶åœ¨é…ç½®è„šæœ¬é‡ŒåŒ…å«ä½ éœ€è¦çš„æ‰€æœ‰æ¨¡å—. æœ¬æ¬¡æˆ‘ä»¬çš„å…³æ³¨ç‚¹æ˜¯ModSecurity:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /opt &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    wget http://nginx.org/download/nginx-1.11.4.tar.gz &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    tar zxf nginx-1.11.4.tar.gz &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="nb"&gt;cd&lt;/span&gt; nginx-1.11.4 &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    ./configure &lt;span class="se"&gt;\&lt;/span&gt;
        --sbin-path&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/nginx/nginx &lt;span class="se"&gt;\&lt;/span&gt;
        --conf-path&lt;span class="o"&gt;=&lt;/span&gt;/etc/nginx/nginx.conf &lt;span class="se"&gt;\&lt;/span&gt;
        --pid-path&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/nginx/nginx.pid &lt;span class="se"&gt;\&lt;/span&gt;
        --with-pcre&lt;span class="o"&gt;=&lt;/span&gt;../pcre-8.39 &lt;span class="se"&gt;\&lt;/span&gt;
        --with-zlib&lt;span class="o"&gt;=&lt;/span&gt;../zlib-1.2.8 &lt;span class="se"&gt;\&lt;/span&gt;
        --with-http_ssl_module &lt;span class="se"&gt;\&lt;/span&gt;
        --with-stream &lt;span class="se"&gt;\&lt;/span&gt;
        --with-http_ssl_module &lt;span class="se"&gt;\&lt;/span&gt;
        --with-http_secure_link_module &lt;span class="se"&gt;\&lt;/span&gt;
        --add-module&lt;span class="o"&gt;=&lt;/span&gt;../modsecurity-2.9.1/nginx/modsecurity &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    make &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    make install &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    ln -s /usr/local/nginx/nginx /usr/bin/nginx
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™å°†ä¼šæŠŠModSecurity 2.9.1 æ¨¡å—ç¼–è¯‘å¹¶å’ŒNGINXä¸€èµ·å®‰è£…. ä»ç°åœ¨å¼€å§‹, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨&lt;code&gt;ModSecurityEnabled&lt;/code&gt;å’Œ&lt;code&gt;ModSecurityConfig&lt;/code&gt;æŒ‡ä»¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt; &lt;span class="s"&gt;default_server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="s"&gt;[::]:80&lt;/span&gt; &lt;span class="s"&gt;default_server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;server_name&lt;/span&gt; &lt;span class="s"&gt;_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="kn"&gt;ModSecurityEnabled&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="kn"&gt;ModSecurityConfig&lt;/span&gt; &lt;span class="s"&gt;modsecurity.conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NGINX serverçš„é…ç½®ä¼šä¸º&lt;code&gt;location /&lt;/code&gt;å¯ç”¨ModSecurity, å¹¶ä½¿ç”¨ä½äºNGINXé…ç½®ç›®å½•ä¸‹çš„ModSecurityé…ç½®æ–‡ä»¶.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;è¿™ä¸€èŠ‚ä»NGINXæºç ç¼–è¯‘, å¹¶æŠŠModSecurityç¼–è¯‘åˆ°NGINXä¸­. æ¨èä»æºç ç¼–è¯‘NGINXçš„æ—¶å€™, æ€»æ˜¯æ£€æŸ¥ä½ æ˜¯å¦ä½¿ç”¨äº†æœ€æ–°çš„ç¨³å®šç‰ˆçš„åŒ…. é€šè¿‡ä¹‹å‰çš„æ¡ˆä¾‹, ä½ å¯ä»¥ä½¿ç”¨æœ‰ModSecurityçš„å¼€æºç‰ˆæœ¬çš„NGINXæ¥æ„å»ºä½ çš„å¼€æºwebåº”ç”¨é˜²ç«å¢™.&lt;/p&gt;
&lt;h4&gt;å‚è§&lt;/h4&gt;
&lt;p&gt;&lt;a href="https://github.com/SpiderLabs/ModSecurity"&gt;ModSecurityæºç &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bit.ly/2eJYuAx"&gt;Updated and maintained ModSecurity Rules from SpiderLabs&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:22:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-2-9-waf.html</guid><category>nginx</category><category>å®‰å…¨</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-å®‰å…¨-å®‰å…¨é“¾æ¥</title><link>https://www.EWhisper.cn/nginx-handbook-2-6-secure-link.html</link><description>&lt;h2 id="26"&gt;2.6 å®‰å…¨é“¾æ¥&lt;a class="headerlink" href="#26" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="260"&gt;2.6.0 ä»‹ç»&lt;a class="headerlink" href="#260" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;å®‰å…¨é“¾æ¥(secure links)æ˜¯ä¸€ç§ä½¿ç”¨&lt;em&gt;md5&lt;/em&gt;å“ˆå¸Œç®—æ³•ä¿è¯é™æ€èµ„æºå®‰å…¨çš„æ–¹å¼. ä½¿ç”¨è¿™ä¸ªæ¨¡å—, ä½ ä¹Ÿå¯ä»¥é™åˆ¶è¯¥é“¾æ¥æ¥æ”¶è¯·æ±‚çš„æ—¶é•¿. ä½¿ç”¨å®‰å…¨é“¾æ¥ä½¿NGINXåº”ç”¨ç¨‹åºæœåŠ¡å™¨ç¡®ä¿é™æ€å†…å®¹å®‰å…¨è€Œæ— éœ€åº”ç”¨æœåŠ¡å™¨æ‰¿æ‹…è¿™ç§è´£ä»». è¿™ä¸ªæ¨¡å—åŒ…å«åœ¨å…è´¹å¼€æºçš„NGINXé‡Œ. ä½†æ˜¯, å®ƒæ²¡æœ‰æ‰“è¿›æ ‡å‡†çš„NGINXåŒ…, è€Œæ˜¯æ”¾åˆ°äº†&lt;code&gt;nginx-extras&lt;/code&gt;åŒ…é‡Œ. å½“ä»æºç æ„å»ºNGINXæ—¶, å¯ä»¥é€‰æ‹©ä½¿ç”¨é…ç½®å‚æ•°&lt;code&gt;--with-http_secure_link_module&lt;/code&gt;æ¥å¯ç”¨.&lt;/p&gt;
&lt;h3 id="261-location"&gt;2.6.1 åŠ å¯†Location&lt;a class="headerlink" href="#261-location" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦ä½¿ç”¨ä¸€ä¸ªå¯†é’¥æ¥åŠ å¯†ä¸€ä¸ªlocationå—.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨å®‰å…¨é“¾æ¥æ¨¡å—, &lt;code&gt;secure_link_secret&lt;/code&gt;æŒ‡ä»¤æ¥é™åˆ¶å¯¹èµ„æºçš„è®¿é—®çš„ç”¨æˆ·æœ‰ä¸€ä¸ªå®‰å…¨çš„é“¾æ¥:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/resources&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kn"&gt;secure_link_secret&lt;/span&gt; &lt;span class="s"&gt;mySecret&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;if&lt;/span&gt; &lt;span class="s"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$secure_link&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;quot;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="kn"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;403&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="kn"&gt;rewrite&lt;/span&gt; &lt;span class="s"&gt;^&lt;/span&gt; &lt;span class="s"&gt;/secured/&lt;/span&gt;&lt;span class="nv"&gt;$secure_link&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/secured&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kn"&gt;internal&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;root&lt;/span&gt; &lt;span class="s"&gt;/var/www&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¯¥é…ç½®åˆ›å»ºäº†ä¸€ä¸ªå†…éƒ¨å’Œä¸€ä¸ªå¤–éƒ¨çš„locationå—. å¤–éƒ¨çš„locationå—&lt;code&gt;/resources&lt;/code&gt;ä¼šè¿”å›403 Forbidden, é™¤éè¯·æ±‚URIåŒ…å«ä¸€ä¸ª&lt;em&gt;md5&lt;/em&gt;å“ˆå¸Œå­—ç¬¦ä¸², è¿™ä¸ªå­—ç¬¦ä¸²å¯ä»¥è¢«&lt;code&gt;secure_link_secret&lt;/code&gt;æŒ‡ä»¤æä¾›çš„secretéªŒè¯. &lt;code&gt;$secure_link&lt;/code&gt;å˜é‡æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸², é™¤éåœ¨URIçš„å“ˆå¸Œè¢«éªŒè¯.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨secretåŠ å¯†èµ„æºæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç¡®ä¿ä½ çš„æ–‡ä»¶å—ä¿æŠ¤çš„æ–¹æ³•. è¯¥secretç”¨äºå’ŒURIä¸²è” . è¯¥å­—ç¬¦ä¸²ç„¶åä¼šè¢«&lt;code&gt;md5&lt;/code&gt;å“ˆå¸Œ, &lt;code&gt;md5&lt;/code&gt;å“ˆå¸Œåçš„16ç¦æ­¢æ•°å­—è¢«ç”¨åœ¨è¯¥URIä¸­. è¯¥å“ˆå¸Œè¢«æ”¾åˆ°é“¾æ¥ä¸­, ç”±NGINXè®¡ç®—. NGINXä¼šçŸ¥é“URIæƒ³è¦è®¿é—®çš„è·¯å¾„, å› ä¸ºå“ˆå¸Œåå°±åœ¨URIä¸­ . NGINXä¹Ÿä¼šç›´åˆ°ä½ çš„secret, å› ä¸ºæŒ‡ä»¤&lt;code&gt;secure_link_secret&lt;/code&gt;ä¼šæä¾›. NGINXèƒ½å¤Ÿè¿…é€ŸéªŒè¯&lt;code&gt;md5&lt;/code&gt;å“ˆå¸Œ, å¹¶å­˜å‚¨åœ¨URIçš„&lt;code&gt;$secure_link&lt;/code&gt;å˜é‡ä¸­. å¦‚æœå“ˆå¸Œæ— æ³•éªŒè¯, è¯¥å˜é‡å°±æ˜¯ç©ºå­—ç¬¦ä¸². éœ€è¦æ³¨æ„, ä¼ ç»™&lt;code&gt;secure_link_secret&lt;/code&gt;çš„å‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªé™æ€å­—ç¬¦ä¸², ä¸èƒ½æ˜¯å˜é‡.&lt;/p&gt;
&lt;h3 id="262-secret"&gt;2.6.2 ä½¿ç”¨secretç”Ÿæˆä¸€ä¸ªå®‰å…¨é“¾æ¥&lt;a class="headerlink" href="#262-secret" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦ä½¿ç”¨secretä»ä½ çš„åº”ç”¨ç”Ÿæˆä¸€ä¸ªå®‰å…¨é“¾æ¥.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;NGINXçš„å®‰å…¨é“¾æ¥æ¨¡å—æ¥æ”¶ä¸€ä¸ªmd5å“ˆå¸Œ(URIè·¯å¾„å’Œsecretçš„è”æ¥)è¿‡çš„16è¿›åˆ¶å­—ç¬¦ä¸². åŸºäºä¸Šä¸€èŠ‚, æˆ‘ä»¬ä¼šåˆ›å»ºå®‰å…¨çš„è¿æ¥, å¯ä»¥å·¥ä½œåœ¨ä¸Šä¸ªé…ç½®, æ¯”å¦‚&lt;code&gt;/var/www/secured/index.html&lt;/code&gt;. è¦ç”Ÿæˆmd5å“ˆå¸Œçš„16è¿›åˆ¶å­—ç¬¦ä¸², æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Unix opensslå‘½ä»¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s1"&gt;&amp;#39;index.htmlmySecret&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; openssl md5 -hex
&lt;span class="o"&gt;(&lt;/span&gt;stdin&lt;span class="o"&gt;)=&lt;/span&gt; a53bee08a4bf0bbea978ddf736363a12
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¿æŠ¤çš„URI: &lt;em&gt;index.html&lt;/em&gt;; secret: &lt;em&gt;mySecret&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;ä¸‹è¾¹æ˜¯ä½¿ç”¨Python 2.7å’Œ&lt;em&gt;md5&lt;/em&gt;åº“ç”Ÿæˆçš„:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;md5&lt;/span&gt;
&lt;span class="n"&gt;md5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;index.htmlmySecret&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;a53bee08a4bf0bbea978ddf736363a12&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬è®¿é—®çš„åœ°å€åº”è¯¥æ˜¯å¦‚ä¸‹æ‰€ç¤º, è¦è®¿é—®&lt;code&gt;/var/www/secured/index.html&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;www.example.com/resources/a53bee08a4bf0bbea978ddf736363a12/\
index.html
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;è¦ç”Ÿæˆè¿™ä¸ªæ•°å­—å¯ä»¥ç”±å¾ˆå¤šç§æ–¹å¼, å¾ˆå¤šè¯­è¨€éƒ½å¯ä»¥å®ç°. è¦è®°ä½çš„æ˜¯: URIè·¯å¾„åœ¨secretä¹‹å‰, å­—ç¬¦ä¸²ä¸­æ²¡æœ‰å›è½¦, å¹¶ä¸”ä½¿ç”¨&lt;em&gt;md5&lt;/em&gt;å“ˆå¸Œçš„16è¿›åˆ¶æ•°å­—.&lt;/p&gt;
&lt;h3 id="263-expire-datelocation"&gt;2.6.3 ä½¿ç”¨Expire DateåŠ å¯†Location&lt;a class="headerlink" href="#263-expire-datelocation" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦ç”Ÿæˆä¸€ä¸ªåœ¨ä¸€æ®µæ—¶é—´åè¿‡æœŸçš„é“¾æ¥.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;åˆ©ç”¨åœ¨å®‰å…¨é“¾æ¥æ¨¡å—çš„å…¶ä»–æŒ‡ä»¤æ¥åœ¨ä½ çš„åŠ å¯†é“¾æ¥ä¸­è®¾ç½®è¿‡æœŸæ—¥å¿—å’Œä½¿ç”¨å˜é‡:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/resources&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;root&lt;/span&gt; &lt;span class="s"&gt;/var/www&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;secure_link&lt;/span&gt; &lt;span class="nv"&gt;$arg_md5,$arg_expires&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;secure_link_md5&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$secure_link_expires$uri$remote_addr&lt;/span&gt;
   &lt;span class="s"&gt;mySecret&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;if&lt;/span&gt; &lt;span class="s"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$secure_link&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;quot;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="kn"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;403&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kn"&gt;if&lt;/span&gt; &lt;span class="s"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$secure_link&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0&amp;quot;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="kn"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;410&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;secure_link&lt;/code&gt;æŒ‡ä»¤æœ‰2ä¸ªç”¨é€—å·éš”å¼€çš„å­—æ®µ. ç¬¬ä¸€ä¸ªå­—æ®µæ˜¯&lt;em&gt;md5&lt;/em&gt;å“ˆå¸Œçš„å˜é‡. è¿™ä¸ªä¾‹å­ä½¿ç”¨ä¸€ä¸ªHTTPå‚æ•°çš„md5ã€‚ç¬¬äºŒä¸ªå­—æ®µæ˜¯æ”¾ç½®ä»¥Unixå…ƒå¹´æ—¶é—´æ ¼å¼çš„é“¾æ¥è¿‡æœŸæ—¶é—´çš„å˜é‡. &lt;code&gt;secure_link_md5&lt;/code&gt;æŒ‡ä»¤å ç”¨ä¸€ä¸ªå•ç‹¬çš„å­—æ®µ, å£°æ˜ç”¨äºæ„é€ &lt;em&gt;md5&lt;/em&gt;å“ˆå¸Œçš„çš„æ ¼å¼çš„å­—ç¬¦ä¸². å’Œå…¶ä»–é…ç½®ä¸€æ ·, å¦‚æœhashæ²¡æœ‰é€šè¿‡éªŒè¯, &lt;code&gt;$secure_link&lt;/code&gt;å˜é‡è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸². æˆ–è€…, å¦‚æœå“ˆå¸ŒåŒ¹é…ä½†æ˜¯æ—¶é—´è¿‡æœŸ, &lt;code&gt;$secure_link&lt;/code&gt;å˜é‡è®¾ç½®ä¸º0.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;è¿™ç§ç”¨æ³•æ¯”ä¹‹å‰2.6.1ä¸­çš„æ›´çµæ´», çœ‹èµ·æ¥æ›´å¹²å‡€. ä½¿ç”¨è¿™äº›æŒ‡ä»¤, ä½ å¯ä»¥ä½¿ç”¨å¯ä»¥ç”¨åœ¨NGINXå“ˆå¸Œå­—ç¬¦ä¸²ä¸­çš„ä»»æ„æ•°é‡çš„å˜é‡. åœ¨å“ˆå¸Œå­—ç¬¦ä¸²ä¸­ä½¿ç”¨ç”¨æˆ·ç›¸å…³çš„å˜é‡ä¼šåŠ å¼ºå®‰å…¨æ€§, å› ä¸ºç”¨æˆ·ä¸èƒ½å¤Ÿå¾—åˆ°åŠ å¯†çš„èµ„æº. æ¨èä½¿ç”¨åƒæ˜¯&lt;code&gt;$remote_addr&lt;/code&gt;æˆ–&lt;code&gt;$http_x_forwarded_for&lt;/code&gt;æˆ–ç”±åº”ç”¨ç”Ÿæˆçš„ä¼šè¯cookieä½œä¸ºå˜é‡. &lt;code&gt;secure_link&lt;/code&gt;çš„å‚æ•°å¯ä»¥æ¥è‡ªä½ å–œæ¬¢çš„ä»»ä½•å˜é‡, ä»–ä»¬å¯ä»¥è¢«å‘½åä¸ºä»»æ„åˆé€‚çš„åå­—. åœ¨&lt;code&gt;$secure_link&lt;/code&gt;å˜é‡ä¸­çš„æ¡ä»¶å¯ä»¥è¢«è®¾ç½®è¿”å›å·²çŸ¥çš„Forbidderå’ŒGoneçš„HTTPä»£ç . HTTP 410, Gone, å¯¹äºè¿‡æœŸé“¾æ¥éå¸¸é€‚ç”¨, å› ä¸ºè¿™ä¸ªæ¡ä»¶è¢«è®¤ä¸ºæ˜¯æ°¸ä¹…çš„.&lt;/p&gt;
&lt;h3 id="264"&gt;2.6.4 ç”Ÿæˆä¸€ä¸ªæœ‰è¿‡æœŸæ—¶é—´çš„é“¾æ¥&lt;a class="headerlink" href="#264" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦ç”Ÿæˆä¸€ä¸ªæœ‰è¿‡æœŸæ—¶é—´çš„é“¾æ¥.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ç”¨Unixæ—¶é—´æˆ³æ ¼å¼ç”Ÿæˆä¸€ä¸ªè¿‡æœŸæ—¶é—´æˆ³. åœ¨Unixç³»ç»Ÿä¸Š, ä½ å¯ä»¥è¿™æ ·æ“ä½œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ date -d &lt;span class="s2"&gt;&amp;quot;2020-12-31 00:00&amp;quot;&lt;/span&gt; +%s
&lt;span class="m"&gt;1609390800&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¥ä¸‹æ¥ä½ éœ€è¦è¿æ¥ç”¨åœ¨&lt;code&gt;secure_link_md5&lt;/code&gt;æŒ‡ä»¤ä¸­çš„å“ˆå¸Œå­—ç¬¦ä¸². åœ¨æœ¬ä¾‹ä¸­, ä½¿ç”¨&lt;code&gt;1293771600/resources/index.html127.0.0.1  mySecret&lt;/code&gt;. md5å“ˆå¸Œå’Œåˆšåˆšçš„16è¿›åˆ¶æ•°å­—æœ‰ä¸€äº›ä¸åŒ. å®ƒæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ ¼å¼çš„md5å“ˆå¸Œ, é‡‡ç”¨base64åŠ å¯†, ç”¨åŠ å·(+)è½¬æ¢ä¸ºè¿æ¥ç¬¦(-), æ–œæ (/)è½¬æ¢ä¸ºä¸‹åˆ’çº¿(_), ç­‰å·(=)è¢«ç§»é™¤. å¦‚ä¸‹æ‰€ç¤º:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s1"&gt;&amp;#39;1609390800/resources/index.html127.0.0.1 mySecret&amp;#39;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
  &lt;span class="p"&gt;|&lt;/span&gt; openssl md5 -binary &lt;span class="se"&gt;\&lt;/span&gt;
  &lt;span class="p"&gt;|&lt;/span&gt; openssl base64 &lt;span class="se"&gt;\&lt;/span&gt;
  &lt;span class="p"&gt;|&lt;/span&gt; tr +/ -_ &lt;span class="se"&gt;\&lt;/span&gt;
  &lt;span class="p"&gt;|&lt;/span&gt; tr -d &lt;span class="o"&gt;=&lt;/span&gt;
81CYyxXFADhLHaQD36_BK
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å°±å¾—åˆ°äº†å“ˆå¸Œ, æˆ‘ä»¬å¯ä»¥ç”¨å®ƒåè¾¹è·Ÿç€è¿‡æœŸæ—¥æœŸä½œä¸ºå‚æ•°.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/resources/index.html?md5=81CYyxXFADhLHaQD36_BK&amp;amp;expires=1609390800'&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä½¿ç”¨Python 2.7çš„æ ‡å‡†åº“çš„ä¾‹å­:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;base64&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;b64encode&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;md5&lt;/span&gt;
&lt;span class="n"&gt;resource&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/resources/index.html&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;remote_addr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;127.0.0.1&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;www.example.com&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;expire&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2020&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strftime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;uncoded&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;expire&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;resource&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;remote_addr&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; mySecret&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;md5hashed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;md5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uncoded&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;digest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;b64&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b64encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;md5hashed&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;hash&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b64&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;+&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;linkformat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;{}{}?md5={}?expires{}&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;securelink&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;linkformat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;resource&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;hash&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;expire&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨è¿™ç§æ–¹å¼, æˆ‘ä»¬èƒ½ç”Ÿæˆç”¨äºURLä¸­çš„ç‰¹æ®Šæ ¼å¼çš„åŠ å¯†é“¾æ¥. æä¾›å®‰å…¨ä¿éšœçš„secretç»ä¸ä¼šå‘ç»™å®¢æˆ·ç«¯. ä½ å¯ä»¥ç”¨å°½å¯èƒ½çš„ä½ éœ€è¦çš„å…¶ä»–å˜é‡æ¥åŠ å¯†location. md5å“ˆå¸Œå’Œbase64åŠ å¯†å¾ˆå¸¸è§, è½»é‡, å‡ ä¹åœ¨æ‰€æœ‰è¯­è¨€ä¸­éƒ½å¯ç”¨.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:15:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-2-6-secure-link.html</guid><category>nginx</category><category>å®‰å…¨</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-å®‰å…¨-ä½¿ç”¨JWT APIçš„å®‰å…¨è®¤è¯</title><link>https://www.EWhisper.cn/nginx-handbook-2-7-jwt-api-auth.html</link><description>&lt;h2 id="27-jwtapi"&gt;2.7 ä½¿ç”¨JWTçš„APIè®¤è¯&lt;a class="headerlink" href="#27-jwtapi" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="270"&gt;2.7.0 ä»‹ç»&lt;a class="headerlink" href="#270" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;JSON Web Tokens (JWTs)è¿…é€Ÿæˆä¸ºä¸€ç§å¹¿ä¸ºä½¿ç”¨å’Œå—æ¬¢è¿çš„è®¤è¯æ–¹å¼. è¿™äº›è®¤è¯tokensæœ‰èƒ½åŠ›å­˜å‚¨ä¸€äº›ç”¨æˆ·å’Œç”¨æˆ·çš„è®¤è¯ä¿¡æ¯åˆ°tokené‡Œ. è¿™äº›tokensä¹Ÿå¯ä»¥å¼‚æ­¥éªŒè¯, è¿™æ„å‘³ç€è´Ÿè½½å‡è¡¡å’Œä»£ç†å¯ä»¥ä½¿ç”¨å…¬é’¥æ¥éªŒè¯è¯¥token, è€Œä¸éœ€è¦ç”¨äºç­¾å‘tokençš„ç§é’¥, ä»¥æ­¤æé«˜å®‰å…¨å’Œçµæ´»æ€§.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;NGINX Plusçš„åŠŸèƒ½, ç•¥è¿‡.&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:15:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-2-7-jwt-api-auth.html</guid><category>nginx</category><category>å®‰å…¨</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-å®‰å…¨-HTTP å­è¯·æ±‚è®¤è¯</title><link>https://www.EWhisper.cn/nginx-handbook-2-5-http-subrequest-auth.html</link><description>&lt;h3 id="251"&gt;2.5.1 ä»‹ç»&lt;a class="headerlink" href="#251" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ä¼´éšç€å¾ˆå¤šä¸åŒçš„è®¤è¯æ–¹æ³•, NGINXé€šè¿‡å¯ç”¨è‡ªè¯·æ±‚mid-flight æ¥ä½¿éªŒè¯è®¤è¯å¹¿æ³›çš„è®¤è¯ç³»ç»Ÿå˜å¾—å®¹æ˜“. HTTPè®¤è¯è¯·æ±‚æ¨¡å—å¯ä»¥å¯ç”¨å¦‚LDAPæˆ–è‡ªå®šä¹‰è®¤è¯å¾®æœåŠ¡çš„è®¤è¯ç³»ç»Ÿ. åœ¨è¯·æ±‚è¢«æ‰§è¡Œä¹‹å‰, è®¤è¯æœºåˆ¶ä¼šä»£ç†è¯¥è¯·æ±‚åˆ°è®¤è¯æœåŠ¡. åœ¨è¿™ä¸ªä»£ç†ä¸­, é€šè¿‡NGINXçš„èƒ½åŠ›å¯ä»¥æ“çºµéœ€è¦èº«ä»½éªŒè¯æœåŠ¡çš„è¯·æ±‚ã€‚å› æ­¤,å®ƒéå¸¸çµæ´»ã€‚&lt;/p&gt;
&lt;h3 id="252"&gt;2.5.2 è®¤è¯å­è¯·æ±‚&lt;a class="headerlink" href="#252" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹çš„è®¤è¯ç³»ç»Ÿ, è¯·æ±‚è®¤è¯éœ€è¦ç”¨åˆ°è¿™ä¸ªç³»ç»Ÿ.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;http_auth_request_module&lt;/code&gt;åœ¨è¯·æ±‚æ‰§è¡Œå‰, è®©è¯·æ±‚åˆ°å¯¹åº”çš„è®¤è¯æœåŠ¡æ¥è¿›è¡ŒéªŒè¯:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;private&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="err"&gt;auth_request&lt;/span&gt; &lt;span class="err"&gt;/auth&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="err"&gt;auth_request_set&lt;/span&gt; &lt;span class="err"&gt;$auth_status&lt;/span&gt; &lt;span class="err"&gt;$upstream_status&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;auth&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="err"&gt;internal&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="err"&gt;proxy_pass&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;auth-server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="err"&gt;proxy_pass_request_body&lt;/span&gt; &lt;span class="err"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="err"&gt;proxy_set_header&lt;/span&gt; &lt;span class="err"&gt;Content-length&lt;/span&gt; &lt;span class="err"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="err"&gt;proxy_set_header&lt;/span&gt; &lt;span class="err"&gt;X-Original-URI&lt;/span&gt; &lt;span class="err"&gt;$request_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;auth_request&lt;/code&gt;æŒ‡ä»¤ä½¿ç”¨å¿…é¡»æ˜¯local internal locationçš„URIå‚æ•°. &lt;code&gt;auth_request_set&lt;/code&gt;æŒ‡ä»¤å…è®¸ä½ ä»è®¤è¯è‡ªè¯·æ±‚æ¥è®¾ç½®å˜é‡.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;http_auth_request_module&lt;/code&gt;å…è®¸å¯¹æ¯ä¸ªNGINXå¤„ç†çš„è¯·æ±‚åšè®¤è¯. åœ¨å“åº”åŸæœåŠ¡ä¹‹å‰, ä¼šç”Ÿæˆä¸€ä¸ªå­è¯·æ±‚, æ¥å†³å®šè¿™ä¸ªè¯·æ±‚æ˜¯å¦å¯ä»¥è®¿é—®å®ƒè¯·æ±‚çš„èµ„æº.  æ•´ä¸ªè¯·æ±‚ä¼šè¢«ä»£ç†åˆ°è‡ªè¯·æ±‚å— location. é€šè¿‡è‡ªè¯·æ±‚çš„çŠ¶æ€ç æ¥ç¡®å®šæ˜¯å¦å¯ä»¥è®¿é—®èµ„æº. å¦‚æœè‡ªè¯·æ±‚è¿”å›200 HTTP çŠ¶æ€ç , è®¤è¯æˆåŠŸ, è¯·æ±‚è¢«å“åº”. å¦‚æœè¿”å›HTTP 401æˆ–403, ä¼šå‘åŸè¯·æ±‚è¿”å›åŒæ ·çš„ä»£ç .&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ çš„è®¤è¯æœåŠ¡ä¸éœ€è¦è¯·æ±‚body, ä½ å¯ä»¥æŠ›å¼ƒæ‰è¯·æ±‚body, é€šè¿‡&lt;code&gt;proxy_pass_reqeust_body&lt;/code&gt;æŒ‡ä»¤(å¦‚ä¸Šä¾‹å­æ‰€ç¤º). è¿™ä¼šå‡å°‘è¯·æ±‚sizeå’Œæ—¶é—´. å› ä¸ºè¯·æ±‚ä½“è¢«å¿½ç•¥, &lt;code&gt;Content-Length&lt;/code&gt; headerå¯ä»¥è®¾ä¸ºç©ºå­—ç¬¦ä¸². å¦‚æœä½ çš„è®¤è¯æœåŠ¡éœ€è¦ç›´åˆ°åŸè¯·æ±‚çš„URI, ä½ å¯ä»¥æŠŠè¿™ä¸ªå€¼æ”¾åˆ°ä¸€ä¸ªè‡ªå®šä¹‰çš„header, è®©ä½ çš„è®¤è¯æœåŠ¡æ¥æ£€æŸ¥å’ŒéªŒè¯. å¦‚æœä»å­è¯·æ±‚åˆ°è®¤è¯æœåŠ¡è§ä½ æƒ³è¦ä¿ç•™ä¸€äº›ä¸œè¥¿, ä½ å¯ä»¥ä½¿ç”¨  &lt;code&gt;auth_request_set&lt;/code&gt;æŒ‡ä»¤æ¥åˆ›å»ºç›¸åº”æ•°æ®ä¹‹å¤–æ–°çš„å˜é‡.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:13:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-2-5-http-subrequest-auth.html</guid><category>nginx</category><category>å®‰å…¨</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-å®‰å…¨-åŠ å¯†</title><link>https://www.EWhisper.cn/nginx-handbook-2-3-encrypt.html</link><description>&lt;h2 id="23"&gt;2.3 åŠ å¯†&lt;a class="headerlink" href="#23" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="230"&gt;2.3.0 ä»‹ç»&lt;a class="headerlink" href="#230" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ç½‘ç»œæ˜¯ä¸ªå¾ˆå¯æ€•çš„åœ°æ–¹, ä½†ä¸éœ€å¤ªè¿‡æ‹…å¿ƒ. åŠ å¯†ä¼ è¾“ä¿¡æ¯å˜å¾—è¶Šæ¥è¶Šå®¹æ˜“, è¶Šæ¥è¶Šå”¾æ‰‹å¯å¾—, å› ä¸ºç­¾åè¯ä¹¦åœ¨&lt;em&gt;Let's Encrypt&lt;/em&gt;å’Œ&lt;em&gt;Amazon Web Services&lt;/em&gt;å˜å¾—è¶Šæ¥è¶Šä¾¿å®œ. äºŒè€…éƒ½æä¾›æœ‰é™ç”¨é€”çš„å…è´¹è¯ä¹¦. åœ¨æœ¬ç« , æˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ç¡®ä¿NGINXå’Œå®¢æˆ·ç«¯ä¹‹é—´, ä»¥åŠNGINXå’Œupstreamä¹‹é—´çš„ä¿¡æ¯å®‰å…¨.&lt;/p&gt;
&lt;h3 id="231"&gt;2.3.1 å®¢æˆ·ç«¯åŠ å¯†&lt;a class="headerlink" href="#231" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;éœ€è¦åŠ å¯†NGINXå’Œå®¢æˆ·ç«¯ä¹‹é—´çš„æµé‡.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨SSLæ¨¡å—, å¦‚&lt;code&gt;ngx_http_ssl_module&lt;/code&gt;æˆ–&lt;code&gt;ngx_stream_ssl_module&lt;/code&gt;æ¥åŠ å¯†æµé‡.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;All&lt;/span&gt; &lt;span class="err"&gt;directives&lt;/span&gt; &lt;span class="err"&gt;used&lt;/span&gt; &lt;span class="err"&gt;below&lt;/span&gt; &lt;span class="err"&gt;are&lt;/span&gt; &lt;span class="err"&gt;also&lt;/span&gt; &lt;span class="err"&gt;valid&lt;/span&gt; &lt;span class="err"&gt;in&lt;/span&gt; &lt;span class="err"&gt;stream&lt;/span&gt;
    &lt;span class="err"&gt;server&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
        &lt;span class="err"&gt;listen&lt;/span&gt; &lt;span class="err"&gt;8083&lt;/span&gt; &lt;span class="err"&gt;ssl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="err"&gt;ssl_protocols&lt;/span&gt;       &lt;span class="err"&gt;TLSv1.2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;åè®®&lt;/span&gt;
        &lt;span class="err"&gt;ssl_ciphers&lt;/span&gt;         &lt;span class="n"&gt;AES128-SHA&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;AES256-SHA&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å¯†ç å¥—ä»¶&lt;/span&gt;
        &lt;span class="err"&gt;ssl_certificate&lt;/span&gt;     &lt;span class="err"&gt;/usr/local/nginx/conf/cert.pem&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;è¯ä¹¦&lt;/span&gt;
        &lt;span class="err"&gt;ssl_certificate_key&lt;/span&gt; &lt;span class="err"&gt;/usr/local/nginx/conf/cert.key&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å¯†é’¥&lt;/span&gt;
        &lt;span class="err"&gt;ssl_session_cache&lt;/span&gt;   &lt;span class="n"&gt;shared&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;SSL&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;sslä¼šè¯ç¼“å­˜&lt;/span&gt;
        &lt;span class="err"&gt;ssl_session_timeout&lt;/span&gt; &lt;span class="err"&gt;10m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;sslä¼šè¯è¶…æ—¶&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;ä¸è¦ä½¿ç”¨SSL(Secure Socket Layer)åè®®, 1 - 3ç‰ˆéƒ½è¢«è®¤ä¸ºä¸å®‰å…¨&lt;/li&gt;
&lt;li&gt;TLSæ˜¯é»˜è®¤çš„åè®®(Transport Layer Security), TLSè¿˜ç®—å®‰å…¨.&lt;/li&gt;
&lt;li&gt;å½“ä½¿ç”¨ç­¾åè¯ä¹¦, ä½ éœ€è¦æŠŠè¯ä¹¦å’Œè¯ä¹¦è®¤è¯é“¾è¿æ¥åˆ°ä¸€å—. ä½ çš„è¯ä¹¦åº”è¯¥åœ¨è¯ä¹¦é“¾æ–‡ä»¶çš„ä¸Šæ–¹.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SSLä¼šè¯ç¼“å­˜, ç¼“å­˜åæ— éœ€negotiate ç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶, å¯ä»¥æå‡æ€§èƒ½.&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="232-upstream"&gt;2.3.2 Upstream åŠ å¯†&lt;a class="headerlink" href="#232-upstream" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä¸ºäº†åˆè§„, æˆ–è€…ä½ çš„upstreamåœ¨ä½ çš„å®‰å…¨ç½‘ç»œä¹‹å¤–, ä½ éœ€è¦åŠ å¯†NGINXå’Œupstreamä¹‹é—´çš„æµé‡.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨HTTP ä»£ç†æ¨¡å—çš„SSLæŒ‡ä»¤&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;proxy_pass&lt;/span&gt; &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;upstream&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;example&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;proxy_ssl_verify&lt;/span&gt; &lt;span class="err"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;proxy_ssl_verify_depth&lt;/span&gt; &lt;span class="err"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;proxy_ssl_protocols&lt;/span&gt; &lt;span class="err"&gt;TLSv1.2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é…ç½®çš„æŒ‡ä»¤ç¡®ä¿NGINXåœ¨upsteamä¸ŠéªŒè¯è¯ä¹¦å’Œè¯ä¹¦é“¾2å±‚è®¤è¯æ·±åº¦æ˜¯åˆæ³•çš„. é»˜è®¤NGINX&lt;strong&gt;ä¸éªŒè¯&lt;/strong&gt;upstreamè¯ä¹¦, æ¥æ”¶æ‰€æœ‰TLSç‰ˆæœ¬.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœè¦åŠ å¯†upstream æµé‡, ä½ è‡³å°‘åº”è¯¥å¼€å¯éªŒè¯.&lt;/li&gt;
&lt;li&gt;å…¶ä»–å¯ç”¨æŒ‡ä»¤, å¦‚&lt;code&gt;proxy_ssl_certificate&lt;/code&gt;å’Œ&lt;code&gt;proxy_ssl_certificate_key&lt;/code&gt;, å…è®¸ä½ é”å®šupstreamåŠ å¯†ä»¥å¢å¼ºå®‰å…¨æ€§.&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:08:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-2-3-encrypt.html</guid><category>nginx</category><category>å®‰å…¨</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-å®‰å…¨-HTTP åŸºæœ¬è®¤è¯</title><link>https://www.EWhisper.cn/nginx-handbook-2-4-http-basic-auth.html</link><description>&lt;h2 id="24-http"&gt;2.4 HTTPåŸºæœ¬è®¤è¯&lt;a class="headerlink" href="#24-http" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="240"&gt;2.4.0 ä»‹ç»&lt;a class="headerlink" href="#240" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;åŸºæœ¬è®¤è¯æ˜¯ä¸€ä¸ªä¿æŠ¤ç§æœ‰å†…å®¹çš„ç®€å•æ–¹æ³•. è¿™ä¸ªè®¤è¯æ–¹æ³•å¯ä»¥å¾ˆå®¹æ˜“çš„ç”¨äºéšè—&lt;strong&gt;å¼€å‘ç½‘ç«™&lt;/strong&gt;æˆ–è€…éšè—ç‰¹æƒçš„å†…å®¹. æ¨èåœ¨éœ€è¦åŸºæœ¬è®¤è¯çš„locationsæˆ–serversä¸Šè®¾ç½®ä¸€ä¸ªé€Ÿç‡é™åˆ¶æ¥ç»„ç»‡æš´åŠ›æ”»å‡». ä¹Ÿæ¨èå¦‚ä¸Šç« é‚£æ ·, ä½¿ç”¨HTTPS, å› ä¸ºæ¯ä¸ªè®¤è¯è¯·æ±‚, ç”¨æˆ·åå’Œå¯†ç æ˜¯é€šè¿‡base64åŠ å¯†å­—ç¬¦ä¸², ä½œä¸ºä¸€ä¸ªheaderå‘é€åˆ°serverçš„. å¦‚æœä½¿ç”¨HTTP, æ„å‘³ç€ç”¨æˆ·åå’Œå¯†ç éƒ½å¯ä»¥è¢«æ•è·.&lt;/p&gt;
&lt;h3 id="241-user-file"&gt;2.4.1 åˆ›å»ºä¸€ä¸ªUser File&lt;a class="headerlink" href="#241-user-file" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦ä¸€ä¸ªHTTPåŸºæœ¬è®¤è¯ç”¨æˆ·æ–‡ä»¶æ¥å­˜å‚¨ç”¨æˆ·åå’Œå¯†ç .&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;ç”Ÿæˆä¸€ä¸ªä¸‹åˆ—æ ¼å¼çš„æ–‡ä»¶, å¯†ç å¯ä»¥é€šè¿‡ä»¥ä¸‹å…è®¸çš„æ ¼å¼æ¥åŠ å¯†æˆ–å“ˆå¸Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# comment
name1:password1
name2:password2:comment
name3:password3
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NGINXå¯ä»¥ç†è§£å‡ ç§æ ¼å¼çš„å¯†ç , å…¶ä¸­ä¸€ç§åŠ å¯†æ˜¯ç”¨Cå‡½æ•°&lt;code&gt;crypt()&lt;/code&gt;. è¯¥å‡½æ•°è¢«æš´éœ²ç»™&lt;code&gt;openssl passwd&lt;/code&gt;å‘½ä»¤, å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼ç”ŸæˆåŠ å¯†å­—ç¬¦ä¸²:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$ openssl passwd MyPassword1234&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¼šè¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸², NGINXå¯ä»¥ç”¨åœ¨å¯†ç æ–‡ä»¶é‡Œ.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥ç”¨Apacheçš„&lt;code&gt;htpasswd&lt;/code&gt;æ¥ç”Ÿæˆå¯†ç . &lt;code&gt;htpasswd&lt;/code&gt;å’Œ&lt;code&gt;openssl&lt;/code&gt; éƒ½ä¼šç”Ÿæˆ&lt;em&gt;apr1&lt;/em&gt; ç®—æ³•çš„å¯†ç . å¯†ç ä¹Ÿå¯ä»¥ç”¨LDAPå’ŒDovecotä½¿ç”¨çš„åŠ ç›sha-1 æ ¼å¼. NGINXæ”¯æŒæ›´å¤šçš„æ ¼å¼å’Œå“ˆå¸Œç®—æ³•, ä½†æ˜¯, å¤§éƒ¨åˆ†éƒ½è¢«è®¤ä¸ºä¸å®‰å…¨, å› ä¸ºå¯ä»¥è¢«è½»æ˜“ç ´è§£.&lt;/p&gt;
&lt;h3 id="242"&gt;2.4.2 ä½¿ç”¨åŸºæœ¬è®¤è¯&lt;a class="headerlink" href="#242" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦ç”¨åŸºæœ¬è®¤è¯æ¥ä¿æŠ¤NGINX locationæˆ–server.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;location / {
    auth_basic          &amp;quot;Private site&amp;quot;;
    auth_basic_user_file conf.d/passwd;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;auth_basic&lt;/code&gt;æŒ‡ä»¤å¯ä»¥ç”¨äºHTTP, server, æˆ–locationå—é‡Œ. å½“æœªè®¤è¯ç”¨æˆ·è®¿é—®, &lt;code&gt;auth_basic&lt;/code&gt;æŒ‡ä»¤ä¼šæŠŠå­—ç¬¦ä¸²æ˜¾ç¤ºåˆ°åŸºæœ¬è®¤è¯çš„å¼¹å‡ºçª—å£.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;åŸºæœ¬è®¤è¯é€šè¿‡serverè¿”å›ä¸€ä¸ªå¸¦æœ‰&lt;code&gt;WWW-Authenticate&lt;/code&gt;çš„401æœªè®¤è¯HTTP code. è¯¥headerä¼šæœ‰ä¸€ä¸ªå€¼&lt;code&gt;Basic realm="your string."&lt;/code&gt;. è¯¥å“åº”ä¼šå¯¼è‡´æµè§ˆå™¨æç¤ºè¾“å…¥ç”¨æˆ·åå’Œå¯†ç . è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç ä¼šé€šè¿‡base64åŠ å¯†, é€šè¿‡ä¸€ä¸ªå«åš&lt;code&gt;Authorization&lt;/code&gt;çš„è¯·æ±‚å¤´å‘é€. Serverä¼šæœºå¯†å¯†ç , å¹¶æ ¹æ®&lt;code&gt;auth_basic_user_file&lt;/code&gt;æä¾›çš„å¯†ç åšéªŒè¯. å› ä¸ºç”¨æˆ·åå¯†ç ä»…ä»…æ˜¯é€šè¿‡base64åŠ å¯†. æ‰€ä»¥æ¨èä½¿ç”¨HTTPSä¼ è¾“.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:08:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-2-4-http-basic-auth.html</guid><category>nginx</category><category>å®‰å…¨</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-å®‰å…¨-é™åˆ¶ä½¿ç”¨</title><link>https://www.EWhisper.cn/nginx-handbook-2-2-limit-usage.html</link><description>&lt;h2 id="22"&gt;2.2 é™åˆ¶ä½¿ç”¨&lt;a class="headerlink" href="#22" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="220"&gt;2.2.0 ä»‹ç»&lt;a class="headerlink" href="#220" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;è¯¥ç« èŠ‚å…³æ³¨äº: é™åˆ¶ä½¿ç”¨å’Œæ»¥ç”¨, è¿æ¥æ•°, è¯·æ±‚æœåŠ¡é€Ÿç‡, å¸¦å®½ä½¿ç”¨é‡. åŒºåˆ†å¼€è¿æ¥å’Œè¯·æ±‚æ˜¯å¾ˆé‡è¦çš„: è¿æ¥(TCPè¿æ¥)æ˜¯ç½‘ç»œå±‚, åœ¨è¿™å±‚ä¸Š, è¯·æ±‚è¢«æ‰§è¡Œ, å› æ­¤ä¸¤è€…å¹¶ä¸ä¸€æ ·.&lt;/p&gt;
&lt;p&gt;åœ¨HTTP/1å’ŒHTTP/1.1ä¸­, ä¸€ä¸ªè¿æ¥è¯·æ±‚åªèƒ½ä½¿ç”¨ä¸€æ¬¡; è€Œåœ¨HTTP/2ä¸­, å¤šä¸ªè¯·æ±‚å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªTCPè¿æ¥.&lt;/p&gt;
&lt;h3 id="221"&gt;2.2.1 é™åˆ¶è¿æ¥&lt;a class="headerlink" href="#221" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦åŸºäºé¢„å®šä¹‰çš„keyæ¥é™åˆ¶è¿æ¥æ•°, æ¯”å¦‚keyæ˜¯å®¢æˆ·ç«¯IPåœ°å€.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;åˆ›å»ºä¸€ä¸ªå…±äº«å†…å­˜åŒºåŸŸæ¥å­˜æ”¾è¿æ¥metrics, å¹¶ä½¿ç”¨&lt;code&gt;limit_conn&lt;/code&gt; æŒ‡ä»¤æ¥é™åˆ¶æ‰“å¼€çš„è¿æ¥æ•°:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="kn"&gt;limit_conn_zone&lt;/span&gt; &lt;span class="nv"&gt;$binary_remote_addr&lt;/span&gt; &lt;span class="s"&gt;zone=limitbyaddr:10m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kn"&gt;limit_conn_status&lt;/span&gt; &lt;span class="mi"&gt;429&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kn"&gt;...&lt;/span&gt;
  &lt;span class="s"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;...&lt;/span&gt;
      &lt;span class="s"&gt;limit_conn&lt;/span&gt; &lt;span class="s"&gt;limitbyaddr&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;...&lt;/span&gt;
  &lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="âœ”" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2714.png" title=":heavy_check_mark:" width="20px"&gt;  &lt;/p&gt;
&lt;p&gt;429: Too Many Requests&lt;/p&gt;
&lt;p&gt;é¢„å®šä¹‰çš„keyç”¨çš„æ˜¯:äºŒè¿›åˆ¶æ ¼å¼çš„å®¢æˆ·ç«¯IPåœ°å€.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨IPåœ°å€, å°±åƒä¸Šä¸ªä¾‹å­ä¸­é‚£æ ·, å¦‚æœå¾ˆå¤šç”¨æˆ·éƒ½åœ¨åŒä¸€ä¸ªç½‘ç»œæ¥è‡ªåŒä¸€ä¸ªIPå¯èƒ½å¾ˆå±é™©, æ¯”å¦‚ç”¨çš„æ˜¯ä¸€ä¸ªNAT(ç½‘ç»œåœ°å€è½¬æ¢). æ•´ä¸ªç»„éƒ½ä¼šè¢«é™åˆ¶. &lt;code&gt;limit_conn_zone&lt;/code&gt;æŒ‡ä»¤åªé€‚ç”¨äºHTTPå—. å¯ä»¥åˆ©ç”¨åœ¨HTTPå—ä¸­çš„NGINXçš„ä»»ä½•å˜é‡æ¥æ„å»ºä¸€ä¸ªå­—ç¬¦ä¸²æ¥é™åˆ¶. åˆ©ç”¨å˜é‡å¯ä»¥åœ¨åº”ç”¨çº§åˆ«è¯†åˆ«å…·ä½“çš„ç”¨æˆ·, åƒæ˜¯session cookie, åŸºäºä½¿ç”¨æ¡ˆä¾‹å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¹²å‡€çš„è§£å†³æ–¹æ¡ˆ. &lt;code&gt;limit_conn&lt;/code&gt;å’Œ&lt;code&gt;limit_conn_status&lt;/code&gt;æŒ‡ä»¤åœ¨HTTP, server, å’Œlocationå—ä¸­éƒ½èƒ½ç”¨. &lt;code&gt;limit_conn_status&lt;/code&gt;é»˜è®¤æ˜¯503, æœåŠ¡ä¸å¯ç”¨. 429ä¼šæ›´åˆé€‚, å› ä¸º500ç•Œåˆ«çš„æœåŠ¡ä¸å¯ç”¨æ„å‘³ç€é”™è¯¯.&lt;/p&gt;
&lt;h3 id="222"&gt;2.2.2 é™åˆ¶é€Ÿç‡&lt;a class="headerlink" href="#222" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½ éœ€è¦åŸºäºé¢„å®šä¹‰çš„keyæ¥é™åˆ¶è¯·æ±‚é€Ÿç‡, æ¯”å¦‚å®¢æˆ·ç«¯IPåœ°å€.&lt;/p&gt;
&lt;h4&gt;è§£å†³æ–¹æ¡ˆ&lt;/h4&gt;
&lt;p&gt;åˆ©ç”¨é€Ÿç‡é™åˆ¶æ¨¡å—æ¥é™åˆ¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="kn"&gt;limit_req_zone&lt;/span&gt; &lt;span class="nv"&gt;$binary_remote_addr&lt;/span&gt; &lt;span class="s"&gt;zone=limitbyaddr:10m&lt;/span&gt; &lt;span class="s"&gt;rate=1r/s&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kn"&gt;limit_req_status&lt;/span&gt; &lt;span class="mi"&gt;429&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kn"&gt;...&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kn"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;...&lt;/span&gt;
      &lt;span class="s"&gt;limit_req&lt;/span&gt; &lt;span class="s"&gt;zone=limitbyaddr&lt;/span&gt; &lt;span class="s"&gt;burst=10&lt;/span&gt; &lt;span class="s"&gt;nodelay&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;...&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªzoneç”¨å…³é”®å­—å‚æ•°è®¾ç½®äº†é€Ÿç‡. &lt;code&gt;limit_req&lt;/code&gt;æŒ‡ä»¤æœ‰2ä¸ªå…³é”®å­—å‚æ•°: &lt;code&gt;zone&lt;/code&gt;å’Œ&lt;code&gt;burst&lt;/code&gt;. å½“ç»™å®šzoneçš„è¯·æ±‚é€Ÿç‡è¶…å‡ºäº†, è¯·æ±‚ä¼šå»¶è¿Ÿç›´åˆ°è¾¾åˆ°ä»–ä»¬çš„æœ€å¤§burst size, è¿™ä¸ªç”±&lt;code&gt;burst&lt;/code&gt;å…³é”®å­—å‚æ•°æä¾›. é»˜è®¤&lt;code&gt;burst&lt;/code&gt;å…³é”®å­—å‚æ•°ä¸º0. &lt;code&gt;limit_req&lt;/code&gt;ä¹Ÿæœ‰ç¬¬ä¸‰ä¸ªå¯é€‰çš„å‚æ•°, &lt;code&gt;nodelay&lt;/code&gt;. è¿™ä¸ªå‚æ•°å…è®¸å®¢æˆ·ç«¯åœ¨è¢«é™åˆ¶ä¹‹å‰ä½¿ç”¨å®ƒçš„&lt;code&gt;burst&lt;/code&gt;è€Œä¸ç”¨å»¶è¿Ÿ. &lt;code&gt;limit_req_status&lt;/code&gt; å’Œ&lt;code&gt;limit_req&lt;/code&gt; å¯ä»¥ç”¨åœ¨HTTP, server, å’Œlocation. &lt;code&gt;limit_req_zone&lt;/code&gt;åªé€‚ç”¨äºHTTPå—.&lt;/p&gt;
&lt;h4&gt;è®¨è®º&lt;/h4&gt;
&lt;p&gt;é€Ÿç‡é™åˆ¶æ¨¡å—åœ¨ç»„ç»‡æ¶æ„è¯·æ±‚, åŒæ—¶ä»ä¸ºæ¯ä¸ªäººæä¾›ä¸€å®šè´¨é‡çš„æœåŠ¡æ—¶éå¸¸æœ‰ç”¨. æœ‰å¾ˆå¤šé™åˆ¶è¯·æ±‚é€Ÿç‡çš„åŸå› , å…¶ä¸­ä¹‹ä¸€å°±æ˜¯å®‰å…¨. ä½ å¯ä»¥é€šè¿‡åœ¨ä½ çš„ç™»é™†é¡µé¢è®¾ç½®éå¸¸ä¸¥æ ¼çš„é™åˆ¶æ¥é˜²æ­¢æ¶æ„æ”»å‡». ä½ å¯ä»¥é€šè¿‡è®¾ç½®å¯¹æ‰€æœ‰è¯·æ±‚çš„å®Œå–„çš„é™åˆ¶æ¥é˜»æ­¢æ¶æ„ç”¨æˆ·å°è¯•å¯¹ä½ çš„åº”ç”¨ä½¿ç”¨æ‹’ç»å¼æœåŠ¡æ”»å‡»æˆ–æµªè´¹èµ„æºçš„è®¡åˆ’. é€Ÿç‡é™åˆ¶æ¨¡å—çš„é…ç½®å’Œ2.2.1ä¸­çš„å¾ˆç±»ä¼¼. é€Ÿç‡å¯ä»¥è¢«è®¾ç½®ä¸ºæ¯ç§’å¤šå°‘è¯·æ±‚æˆ–æ¯åˆ†é’Ÿå¤šå°‘è¯·æ±‚. å½“è¶…è¿‡é™åˆ¶, ä¼šè®°å½•äº‹ä»¶æ—¥å¿—. ä¾‹å­ä¸­æ²¡æœ‰æåˆ°è¿™ä¸ªæŒ‡ä»¤&lt;code&gt;limit_req_log_level&lt;/code&gt; , é»˜è®¤æ˜¯&lt;code&gt;error&lt;/code&gt;, ä½†æ˜¯ä¹Ÿå¯ä»¥è®¾ç½®ä¸º&lt;code&gt;info&lt;/code&gt; , &lt;code&gt;notice&lt;/code&gt;, &lt;code&gt;warn&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id="223"&gt;2.2.3 é™åˆ¶å¸¦å®½&lt;a class="headerlink" href="#223" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;å¾…è¡¥å……&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:05:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-2-2-limit-usage.html</guid><category>nginx</category><category>å®‰å…¨</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX å®æˆ˜æ‰‹å†Œ-å®‰å…¨-è®¿é—®æ§åˆ¶</title><link>https://www.EWhisper.cn/nginx-handbook-2-1-control-access.html</link><description>&lt;h2 id="211"&gt;2.1.1 ä»‹ç»&lt;a class="headerlink" href="#211" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æ§åˆ¶ä½ çš„webåº”ç”¨æˆ–ä½ çš„webåº”ç”¨çš„å­ç½‘çš„è®¿é—®æ˜¯å¾ˆé‡è¦çš„ä¸šåŠ¡. åœ¨NGINXä¸­, è®¿é—®æ§åˆ¶æœ‰å¤šç§å½¢å¼, åƒæ˜¯åœ¨ç½‘ç»œå±‚æ‹’ç»æ‰, åŸºäºè®¤è¯ç­–ç•¥çš„å…è®¸, æˆ– HTTPæŒ‡ä»¤æµè§ˆå™¨å¦‚ä½•å“åº”. æœ¬ç« æˆ‘ä»¬å°†è®¨è®ºåŸºäºç½‘ç»œå±æ€§, è®¤è¯å’Œå¦‚ä½•é˜²æ­¢&lt;em&gt;è·¨åŸŸèµ„æºå…±äº«(Cross-Origin Resource Sharing(CORS))&lt;/em&gt;çš„è®¿é—®æ§åˆ¶.&lt;/p&gt;
&lt;h2 id="212-ip"&gt;2.1.2 åŸºäºIPåœ°å€çš„è®¿é—®&lt;a class="headerlink" href="#212-ip" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="_1"&gt;é—®é¢˜&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ä½ éœ€è¦åŸºäºå®¢æˆ·ç«¯çš„IPåœ°å€çš„æ§åˆ¶.&lt;/p&gt;
&lt;h3 id="_2"&gt;è§£å†³æ–¹æ¡ˆ&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨HTTPè®¿é—®æ¨¡å—æ¥æ§åˆ¶å¯¹å—ä¿æŠ¤èµ„æºçš„è®¿é—®:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="err"&gt;deny&lt;/span&gt; &lt;span class="err"&gt;10.0.0.1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="err"&gt;allow&lt;/span&gt; &lt;span class="err"&gt;10.0.0.0/20&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="err"&gt;allow&lt;/span&gt; &lt;span class="err"&gt;2001:0&lt;/span&gt;&lt;span class="n"&gt;db8&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="err"&gt;deny&lt;/span&gt; &lt;span class="err"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨HTTP, server, å’Œlocationä¸Šä¸‹æ–‡ä¸­, &lt;code&gt;allow&lt;/code&gt;å’Œ&lt;code&gt;deny&lt;/code&gt;æŒ‡ä»¤æä¾›å¯¹ç»™å‡ºçš„client, IP, CIDR range, Unix socket, æˆ–all å…³é”®å­—çš„å…è®¸å’Œç¦æ­¢è®¿é—®çš„èƒ½åŠ›. è§„åˆ™è¢«ä¾æ¬¡æ£€æŸ¥, ç›´åˆ°å‘ç°åŒ¹é…çš„åœ°å€.&lt;/p&gt;
&lt;h3 id="_3"&gt;è®¨è®º&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ä¿æŠ¤åœ¨äº’è”ç½‘ä¸Šçš„æœ‰ä»·å€¼çš„èµ„æºå’ŒæœåŠ¡å¿…é¡»åœ¨å¯¹åº”çš„å±‚ä¸Šåš. NGINXæä¾›å¯¹å…¶ä¸­ä¸€äº›å±‚çš„èƒ½åŠ›. &lt;code&gt;deny&lt;/code&gt; æŒ‡ä»¤ç»„ç»‡è®¿é—®ç»™å®šçš„ä¸Šä¸‹æ–‡, &lt;code&gt;allow&lt;/code&gt;æŒ‡ä»¤å¯ä»¥ç”¨äºé™åˆ¶è®¿é—®. ä½ å¯ä»¥ä½¿ç”¨IPåœ°å€, IPv4æˆ–IPv6, CIDR block ranges, å…³é”®å­—&lt;code&gt;all&lt;/code&gt;, å’ŒUnix socket. é€šå¸¸è¦ä¿æŠ¤æŸä¸ªèµ„æº, åº”è¯¥å…è®¸ç‰¹å®šåŒºåŸŸçš„å†…ç½‘IPåœ°å€, å¹¶æ‹’ç»æ‰€æœ‰.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 20:00:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-handbook-2-1-control-access.html</guid><category>nginx</category><category>å®‰å…¨</category><category>è¯‘æ–‡</category><category>æœ€ä½³å®è·µ</category></item><item><title>NGINX é…ç½®SSL æ”¯æŒ</title><link>https://www.EWhisper.cn/nginx-conf-add-ssl-support.html</link><description>&lt;p&gt;&lt;img alt="nginx+ssl" src="./images/nginx-ssl-certificate.jpg"&gt;&lt;/p&gt;
&lt;h2 id="_1"&gt;å‰è¨€&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://www.EWhisper.cn/tencentyun-apply-ssl-certificate.html"&gt;ä¸Šç¯‡æ–‡ç« &lt;/a&gt;ä¸­, æˆ‘ä»¬å·²ç»ç”³è¯·å¥½äº†SSLè¯ä¹¦. é‚£ä¹ˆç°åœ¨, æˆ‘ä»¬å°±è¦é…ç½®å…¨ç«™SSLäº†! &lt;img align="absmiddle" alt="ğŸ’ª" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4aa.png" title=":muscle:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ’ª" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4aa.png" title=":muscle:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ’ª" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4aa.png" title=":muscle:" width="20px"&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡çš„å·¥ä½œä¸»è¦æ˜¯NGINXçš„é…ç½®, åŒæ—¶ä¼šæœ‰ä¸€äº›æˆ‘çš„åšå®¢æœ¬èº«çš„é…ç½®.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åšå®¢æœ¬èº«é…ç½®æ›´æ”¹åŒ…æ‹¬: (è¿™ç¯‡æ–‡ç« å°±å…ˆä¸ç»†è¯´äº†)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç½‘é¡µå†…é“¾æ¥å…¨éƒ¨ä»httpæ”¹ä¸ºhttps(å…¶å®é…ç½®ä¸‹SITEURL, å·¥å…·ä¼šè‡ªåŠ¨ç”Ÿæˆå¥½) å¹¶é‡æ–°å‘å¸ƒ. (ç‰¹åˆ«è¦æ³¨æ„, å¦‚æœæœ‰çš„ç«™å†…css, jsç­‰æ²¡æœ‰ç”¨httpså°±å°´å°¬äº†, ä¼šè¢«å„ç±»æµè§ˆå™¨æ‹¦æˆªæ‰, å¹¶æç¤º"ä¸å®‰å…¨çš„è„šæœ¬")&lt;/li&gt;
&lt;li&gt;ç½‘ç«™æœ‰ç”¨åˆ°çš„ç¬¬ä¸‰æ–¹å·¥å…·(å¦‚æ‹¨æµ‹), æŠŠç½‘ç«™çš„åœ°å€æ”¹ä¸º httpså¼€å¤´çš„.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id="nginx"&gt;NGINXé…ç½®&lt;a class="headerlink" href="#nginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆ, åˆ›å»ºå¹¶ä¸Šä¼ å‡†å¤‡å¥½çš„è¯ä¹¦æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•: (crtå’Œkeyæ–‡ä»¶)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo mkdir -p /etc/pki/nginx/
&lt;span class="c1"&gt;# é€šè¿‡sftpä¸Šä¼ åˆ°è¯¥ç›®å½•&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿›è¡Œnginx.conf çš„sslé…ç½®, æœ¬æ¬¡ä¸»è¦æ¶‰åŠåˆ°serverå—çš„é…ç½®æ›´æ”¹, å¦‚ä¸‹: (å…·ä½“çš„æŒ‡ä»¤ä½œç”¨è§æ³¨é‡Š)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kn"&gt;listen&lt;/span&gt;       &lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;server_name&lt;/span&gt;  &lt;span class="s"&gt;www.ewhisper.cn&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;301&lt;/span&gt; &lt;span class="s"&gt;https://&lt;/span&gt;&lt;span class="nv"&gt;$host$request_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kn"&gt;listen&lt;/span&gt;       &lt;span class="mi"&gt;443&lt;/span&gt; &lt;span class="s"&gt;ssl&lt;/span&gt; &lt;span class="s"&gt;http2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;server_name&lt;/span&gt;  &lt;span class="s"&gt;www.ewhisper.cn&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;root&lt;/span&gt;         &lt;span class="s"&gt;/usr/share/nginx/html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# é™æ€åšå®¢çš„å­˜æ”¾ä½ç½®&lt;/span&gt;

        &lt;span class="kn"&gt;ssl_certificate&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;/etc/pki/nginx/1_www.ewhisper.cn_bundle.crt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# è¯ä¹¦è·¯å¾„&lt;/span&gt;
        &lt;span class="kn"&gt;ssl_certificate_key&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;/etc/pki/nginx/2_www.ewhisper.cn.key&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# è¯ä¹¦å¯†é’¥è·¯å¾„&lt;/span&gt;
        &lt;span class="kn"&gt;ssl_session_cache&lt;/span&gt; &lt;span class="s"&gt;shared:SSL:50m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# ssl session cacheåˆ†é…50mç©ºé—´, ç¼“å­˜ssl session&lt;/span&gt;
        &lt;span class="kn"&gt;ssl_session_timeout&lt;/span&gt;  &lt;span class="s"&gt;1d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# ssl session è¶…æ—¶æ—¶é—´ä¸º1å¤©&lt;/span&gt;
        &lt;span class="kn"&gt;ssl_session_tickets&lt;/span&gt; &lt;span class="no"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# ssl session ticket æœºåˆ¶, éƒ¨åˆ†ç‰ˆæœ¬æœ‰bug, è§†æƒ…å†µå¼€å¯.&lt;/span&gt;

        &lt;span class="kn"&gt;ssl_protocols&lt;/span&gt; &lt;span class="s"&gt;TLSv1.2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# ssl åè®®ç‰ˆæœ¬&lt;/span&gt;
        &lt;span class="kn"&gt;ssl_ciphers&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# ssl ciphers&lt;/span&gt;
        &lt;span class="kn"&gt;ssl_prefer_server_ciphers&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# å€¾å‘äºä½¿ç”¨serverç«¯çš„ciphers&lt;/span&gt;

        &lt;span class="c1"&gt;# HSTS 6 months&lt;/span&gt;
        &lt;span class="kn"&gt;add_header&lt;/span&gt; &lt;span class="s"&gt;Strict-Transport-Security&lt;/span&gt; &lt;span class="s"&gt;max-age=15768000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  
        &lt;span class="c1"&gt;# æ·»åŠ ä¸ªhttp header, å‘Šè¯‰æµè§ˆå™¨ç›´æ¥è½¬åˆ°https, æ­¤åŠŸèƒ½æœ‰é£é™©, æ…é‡é€‰æ‹©. &lt;/span&gt;
        &lt;span class="c1"&gt;# (æ¯”å¦‚ä½ çš„è¯ä¹¦è¿‡æœŸå¿˜è®°ç»­äº†, é‚£ä¹ˆç”¨æˆ·æƒ³è½¬åˆ°httpéƒ½æ²¡åŠæ³•)&lt;/span&gt;

        &lt;span class="kn"&gt;ssl_stapling&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# å¯ç”¨ssl OCSP staplingåŠŸèƒ½, æœåŠ¡ç«¯ä¸»åŠ¨æŸ¥è¯¢OCSPç»“æœ, æé«˜TLSæ•ˆç‡&lt;/span&gt;
        &lt;span class="kn"&gt;ssl_stapling_verify&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# å¼€å¯OCSP stapling éªŒè¯&lt;/span&gt;

        &lt;span class="c1"&gt;# Load configuration files for the default server block.&lt;/span&gt;
        &lt;span class="kn"&gt;include&lt;/span&gt; &lt;span class="s"&gt;/etc/nginx/default.d/*.conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# æˆ‘çš„åšå®¢çš„locationåœ¨è¿™é‡Œé…ç½®&lt;/span&gt;

        &lt;span class="c1"&gt;#location / {&lt;/span&gt;
        &lt;span class="c1"&gt;#}&lt;/span&gt;

        &lt;span class="kn"&gt;error_page&lt;/span&gt; &lt;span class="mi"&gt;404&lt;/span&gt; &lt;span class="s"&gt;/404.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;/40x.html&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="kn"&gt;error_page&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt; &lt;span class="mi"&gt;502&lt;/span&gt; &lt;span class="mi"&gt;503&lt;/span&gt; &lt;span class="mi"&gt;504&lt;/span&gt; &lt;span class="s"&gt;/50X.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;/50X.html&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šçš„æŸäº›æŒ‡ä»¤, æˆ‘å…ˆå¤§æ¦‚ä»‹ç»ä¸‹, åç»­ä¼šæœ‰æ–‡ç« åšè¯¦ç»†ä»‹ç».&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;return 301 https://$host$request_uri;&lt;/code&gt;   HTTPçš„å…¨éƒ¨æ°¸ä¹…é‡å®šå‘åˆ°httpså¯¹åº”çš„URL&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/usr/share/nginx/html&lt;/code&gt;  é™æ€åšå®¢çš„å­˜æ”¾ä½ç½®&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ssl_session_timeout  1d;&lt;/code&gt;  ssl session è¶…æ—¶æ—¶é—´ä¸º1å¤©&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ssl_session_tickets off;  #&lt;/code&gt;  ssl session ticket æœºåˆ¶, éƒ¨åˆ†ç‰ˆæœ¬æœ‰bug, è§†æƒ…å†µå¼€å¯.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ssl_prefer_server_ciphers on;&lt;/code&gt;  å€¾å‘äºä½¿ç”¨serverç«¯çš„ciphers&lt;/li&gt;
&lt;li&gt;HSTSåŠŸèƒ½:ã€€æ·»åŠ ä¸ªHTTP header, å‘Šè¯‰æµè§ˆå™¨ç›´æ¥è½¬åˆ°https, &lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;æ­¤åŠŸèƒ½æœ‰é£é™©, æ…é‡é€‰æ‹©.  (æ¯”å¦‚ä½ çš„è¯ä¹¦è¿‡æœŸå¿˜è®°ç»­äº†, é‚£ä¹ˆç”¨æˆ·æƒ³è½¬åˆ°HTTPéƒ½æ²¡åŠæ³•)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ssl_stapling on;&lt;/code&gt;  å¯ç”¨ssl OCSP staplingåŠŸèƒ½, æœåŠ¡ç«¯ä¸»åŠ¨æŸ¥è¯¢OCSPç»“æœ, æé«˜TLSæ¡æ‰‹æ•ˆç‡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/etc/nginx/default.d/*.conf;&lt;/code&gt;  æˆ‘çš„åšå®¢&lt;code&gt;location&lt;/code&gt;é…ç½®&lt;br&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; å°æŠ€å·§:&lt;/p&gt;
&lt;p&gt;ç«ç‹æµè§ˆå™¨èƒŒåçš„åŸºé‡‘ä¼š, å¼€æºäº†ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å·¥å…·: &lt;a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/"&gt;ssl-config-generator&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸Šè¾¹, ç‚¹ä¸€ç‚¹å°±å¯ä»¥è‡ªåŠ¨ç”Ÿæˆæ¨èçš„SSLé…ç½®äº†.&lt;/p&gt;
&lt;p&gt;&lt;img alt="ssl-config-generator" src="./images/ssl-config-generator.png"&gt;&lt;/p&gt;
&lt;p&gt;æä¸€ç‚¹, å¦‚ä¸Šå›¾æ‰€ç¤º, ç¬¬äºŒåˆ—ä¸€å®šè¦æ ¹æ®ä½ çš„å®¢æˆ·æµè§ˆå™¨æˆ–å®¢æˆ·ç«¯çš„ç‰ˆæœ¬ä½¿ç”¨æƒ…å†µæ…é‡é€‰æ‹©. &lt;/p&gt;
&lt;p&gt;æ¯”å¦‚, ç”¨æˆ·è¿˜åœ¨ç”¨Windows XP, IE6, Java 6, é‚£ä¹ˆåªèƒ½é€‰æ‹©Old.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¥ä¸‹æ¥, å°±æ˜¯è¦é‡å¯nginxæ¥ç”Ÿæ•ˆäº†. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo nginx -t  &lt;span class="c1"&gt;# æµ‹è¯•é…ç½®, æ²¡é—®é¢˜å†é‡å¯&lt;/span&gt;
$ sudo systemctl reload nginx.service
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é‡å¯å, æµ‹è¯•å‘ç° css jséƒ½æ²¡æœ‰ç”Ÿæ•ˆ. &lt;img align="absmiddle" alt="ğŸ˜±" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f631.png" title=":scream:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ˜±" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f631.png" title=":scream:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ˜±" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f631.png" title=":scream:" width="20px"&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºä¹‹å‰nginxåˆšé…ç½®è¿‡ç¼“å­˜. å½“æ—¶è„‘å­æ²¡è½¬è¿‡æ¥, æ²¡æœ‰ç¬¬ä¸€æ—¶é—´æ„è¯†åˆ°å¯èƒ½æ˜¯æµè§ˆå™¨ç¼“å­˜çš„é—®é¢˜. å°±ç›´æ¥nginx stop å†startäº†ä¸‹. ç»“æœæ‚²å‚¬çš„æˆ‘çš„ç½‘ç«™å¯ç”¨æ€§å°±ä»100%è·Œåˆ°99.81%äº†.&lt;/p&gt;
&lt;p&gt;&lt;img alt="ç½‘ç«™å¯ç”¨æ€§" src="images/index.png"&gt;&lt;/p&gt;
&lt;p&gt;åæ¥ç»ˆäºæ„è¯†åˆ°å¯èƒ½æ˜¯æµè§ˆå™¨ç¼“å­˜çš„é—®é¢˜äº†, æ¸…ç†äº†ç¼“å­˜å, å†å¯åŠ¨, ç»ˆäºé¡µé¢æ˜¾ç¤ºæ­£å¸¸, å›¾æ ‡ä¹Ÿä»"ä¸å®‰å…¨"å˜æˆäº†å°é”.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="./images/ssl-ewhisper.png"&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•è®¿é—®http://www.ewhisper.cn, ä¹Ÿä¼šè¢«å¼ºåˆ¶è½¬åˆ° https://www.ewhisper.cn. å®Œç¾!&lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;/p&gt;
&lt;h2 id="ssl"&gt;æˆ‘çš„SSLè¯„çº§&lt;a class="headerlink" href="#ssl" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;å†æ¥ä»‹ç»ä¸ªå¥½ä¸œè¥¿ - &lt;a href="https://www.ssllabs.com/ssltest/analyze.html"&gt;SSL Labs&lt;/a&gt;. å¯ä»¥å¯¹ä½ çš„ç½‘ç«™è¿›è¡ŒSSL å®‰å…¨è¯„çº§. &lt;/p&gt;
&lt;p&gt;ç‚¹å‡»é“¾æ¥, è¾“å…¥ç½‘ç«™åœ°å€, å–æ¯èŒ¶, ç»“æœå°±å‡ºæ¥äº† - &lt;strong&gt;A+&lt;/strong&gt; å“ˆå“ˆå“ˆå“ˆå“ˆ!!!!&lt;/p&gt;
&lt;p&gt;&lt;img alt="æˆ‘çš„ç½‘ç«™SSLè¯„åˆ†" src="./images/ewhisper-ssl-report.png"&gt;&lt;/p&gt;
&lt;p&gt;æœ€åé™„ä¸Šæˆ‘çš„&lt;a href="https://www.EWhisper.cn/assets/SSL_Server_Test_ www.ewhisper.cn.pdf"&gt;å®Œæ•´æŠ¥å‘Š&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 19 Jun 2019 19:26:20 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-06-19:/nginx-conf-add-ssl-support.html</guid><category>nginx</category><category>ssl</category><category>æ‹¨æµ‹</category><category>å¯ç”¨æ€§</category></item><item><title>ä½¿ç”¨ Docker å®‰è£… Gitlab</title><link>https://www.EWhisper.cn/install-gitlab-with-docker.html</link><description>&lt;h2 id="docker"&gt;Docker å®‰è£…&lt;a class="headerlink" href="#docker" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;å®˜ç½‘é“¾æ¥:&lt;a href="https://docs.gitlab.com/omnibus/docker/"&gt;GitLab Docker images&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://gitlab.com/gitlab-org/omnibus-gitlab/blob/master/docker/Dockerfile"&gt;å®˜ç½‘ Dockerfile&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo docker pull gitlab/gitlab-ce  &lt;span class="c1"&gt;# ä¸‹è½½&lt;/span&gt;
sudo docker run --detach &lt;span class="se"&gt;\&lt;/span&gt;
  --hostname gitlab.example.com &lt;span class="se"&gt;\&lt;/span&gt;
  --publish &lt;span class="m"&gt;443&lt;/span&gt;:443 --publish &lt;span class="m"&gt;80&lt;/span&gt;:80 --publish &lt;span class="m"&gt;22&lt;/span&gt;:22 &lt;span class="se"&gt;\&lt;/span&gt;
  --name gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  --restart always &lt;span class="se"&gt;\&lt;/span&gt;
  --volume /srv/gitlab/config:/etc/gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  --volume /srv/gitlab/logs:/var/log/gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  --volume /srv/gitlab/data:/var/opt/gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  gitlab/gitlab-ce:latest  &lt;span class="c1"&gt;# è¿è¡Œå®¹å™¨&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_1"&gt;æ•°æ®å­˜åœ¨å“ªå„¿:&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="left"&gt;æœ¬åœ°ä½ç½®&lt;/th&gt;
&lt;th align="left"&gt;å®¹å™¨ä½ç½®&lt;/th&gt;
&lt;th align="left"&gt;ç”¨é€”&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="left"&gt;&lt;code&gt;/srv/gitlab/data&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;&lt;code&gt;/var/opt/gitlab&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;ç”¨äºå­˜å‚¨åº”ç”¨æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="left"&gt;&lt;code&gt;/srv/gitlab/logs&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;&lt;code&gt;/var/log/gitlab&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;ç”¨äºå­˜å‚¨æ—¥å¿—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="left"&gt;&lt;code&gt;/srv/gitlab/config&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;&lt;code&gt;/etc/gitlab&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;ç”¨äºå­˜å‚¨GitLabé…ç½®æ–‡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="gitlab"&gt;é…ç½®Gitlab:&lt;a class="headerlink" href="#gitlab" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;é…ç½®æ–‡ä»¶ä½äº: &lt;code&gt;/etc/gitlab/gitlab.rb&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å‡ ç§é…ç½®æ–¹å¼:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sudo docker exec -it gitlab /bin/bash&lt;/code&gt; è¿›å…¥åˆ°å®¹å™¨å†…, ç„¶åé€šè¿‡&lt;code&gt;vi&lt;/code&gt;ç¼–è¾‘ä¿å­˜&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sudo docker exec -it gitlab editor /etc/gitlab/gitlab.rb&lt;/code&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¾‘å®Œä¹‹å, é‡å¯å®¹å™¨:&lt;code&gt;sudo docker restart gitlab&lt;/code&gt;&lt;/p&gt;
&lt;h3 id="docker_1"&gt;é¢„é…ç½® Docker å®¹å™¨&lt;a class="headerlink" href="#docker_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥é€šè¿‡å°†ç¯å¢ƒå˜é‡&lt;code&gt;GITLAB_OMNIBUS_CONFIG&lt;/code&gt;æ·»åŠ åˆ°docker runå‘½ä»¤æ¥é¢„é…ç½®GitLab Dockeræ˜ åƒã€‚æ­¤å˜é‡å¯ä»¥åŒ…å«ä»»ä½•&lt;code&gt;gitlab.rb&lt;/code&gt;è®¾ç½®ï¼Œå¹¶åœ¨åŠ è½½å®¹å™¨&lt;code&gt;gitlab.rb&lt;/code&gt;æ–‡ä»¶ä¹‹å‰è¿›è¡ŒåŠ è½½ã€‚&lt;/p&gt;
&lt;p&gt;ç¤ºä¾‹å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo docker run --detach &lt;span class="se"&gt;\&lt;/span&gt;
  --hostname gitlab.example.com &lt;span class="se"&gt;\&lt;/span&gt;
  --env &lt;span class="nv"&gt;GITLAB_OMNIBUS_CONFIG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;external_url &amp;#39;http://my.domain.com/&amp;#39;; gitlab_rails[&amp;#39;lfs_enabled&amp;#39;] = true;&amp;quot;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
  --publish &lt;span class="m"&gt;443&lt;/span&gt;:443 --publish &lt;span class="m"&gt;80&lt;/span&gt;:80 --publish &lt;span class="m"&gt;22&lt;/span&gt;:22 &lt;span class="se"&gt;\&lt;/span&gt;
  --name gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  --restart always &lt;span class="se"&gt;\&lt;/span&gt;
  --volume /srv/gitlab/config:/etc/gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  --volume /srv/gitlab/logs:/var/log/gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  --volume /srv/gitlab/data:/var/opt/gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  gitlab/gitlab-ce:latest
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_2"&gt;å¯åŠ¨å®¹å™¨å&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡&lt;a href="http://localhost"&gt;http://localhost&lt;/a&gt; è¿›è¡Œè®¿é—®.&lt;/p&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡ &lt;code&gt;sudo docker logs -f gitlab&lt;/code&gt; æŸ¥çœ‹æ—¥å¿—.&lt;/p&gt;
&lt;h3 id="ip"&gt;å‘å¸ƒåˆ°å…¬ç½‘IP&lt;a class="headerlink" href="#ip" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo docker run --detach &lt;span class="se"&gt;\&lt;/span&gt;
  --hostname gitlab.example.com &lt;span class="se"&gt;\&lt;/span&gt;
  --publish &lt;span class="m"&gt;198&lt;/span&gt;.51.100.1:443:443 &lt;span class="se"&gt;\&lt;/span&gt;
  --publish &lt;span class="m"&gt;198&lt;/span&gt;.51.100.1:80:80 &lt;span class="se"&gt;\&lt;/span&gt;
  --publish &lt;span class="m"&gt;198&lt;/span&gt;.51.100.1:22:22 &lt;span class="se"&gt;\&lt;/span&gt;
  --name gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  --restart always &lt;span class="se"&gt;\&lt;/span&gt;
  --volume /srv/gitlab/config:/etc/gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  --volume /srv/gitlab/logs:/var/log/gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  --volume /srv/gitlab/data:/var/opt/gitlab &lt;span class="se"&gt;\&lt;/span&gt;
  gitlab/gitlab-ce:latest
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="docker-composegitlab"&gt;ä½¿ç”¨docker-composeå®‰è£…GitLab&lt;a class="headerlink" href="#docker-composegitlab" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å®‰è£… docker compose&lt;/li&gt;
&lt;li&gt;åˆ›å»º&lt;code&gt;docker-compose.yml&lt;/code&gt; æ–‡ä»¶ï¼ˆæˆ–&lt;a href="https://gitlab.com/gitlab-org/omnibus-gitlab/blob/master/docker/docker-compose.yml"&gt;ä¸‹è½½ç¤ºä¾‹&lt;/a&gt;ï¼‰: &lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; &lt;span class="nt"&gt;web&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
   &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;gitlab/gitlab-ce:latest&amp;#39;&lt;/span&gt;
   &lt;span class="nt"&gt;restart&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;always&lt;/span&gt;
   &lt;span class="nt"&gt;hostname&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;gitlab.example.com&amp;#39;&lt;/span&gt;
   &lt;span class="nt"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
     &lt;span class="nt"&gt;GITLAB_OMNIBUS_CONFIG&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;|&lt;/span&gt;
       &lt;span class="no"&gt;external_url &amp;#39;https://gitlab.example.com&amp;#39;&lt;/span&gt;
       &lt;span class="no"&gt;# Add any other gitlab.rb configuration here, each on its own line&lt;/span&gt;
   &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
     &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;80:80&amp;#39;&lt;/span&gt;
     &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;443:443&amp;#39;&lt;/span&gt;
     &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;22:22&amp;#39;&lt;/span&gt;
   &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
     &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;/srv/gitlab/config:/etc/gitlab&amp;#39;&lt;/span&gt;
     &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;/srv/gitlab/logs:/var/log/gitlab&amp;#39;&lt;/span&gt;
     &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;/srv/gitlab/data:/var/opt/gitlab&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;ç¡®ä¿æ‚¨&lt;code&gt;docker-compose.yml&lt;/code&gt;ä¸è¿è¡Œ&lt;code&gt;docker-compose up -d&lt;/code&gt; åœ¨åŒä¸€ç›®å½•ä¸­ä»¥è¿è¡ŒGitLab&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="openshift"&gt;OpenShift å®‰è£…&lt;a class="headerlink" href="#openshift" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt; æ³¨æ„:&lt;/p&gt;
&lt;p&gt;ç›®å‰Gitlabé€šè¿‡OpenShift å®‰è£…, æœ‰ä¸€äº›å·²çŸ¥çš„é—®é¢˜. å¹¶ä¸”åªåœ¨OpenShift 3.11ç‰ˆæœ¬ä¸Šæµ‹è¯•é€šè¿‡.&lt;/p&gt;
&lt;p&gt;å¦å¤–, å®‰è£…æ˜¯é€šè¿‡ Helm Chartæ–¹å¼è¿›è¡Œå®‰è£…çš„. è¿˜æ˜¯æœ‰ç‚¹å¤æ‚çš„...&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="_3"&gt;å·²çŸ¥çš„é—®é¢˜&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸‹é—®é¢˜æ˜¯å·²çŸ¥çš„ï¼Œå¹¶ä¸”é¢„è®¡é€‚ç”¨äºOpenShiftä¸Šçš„GitLabå®‰è£…ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;anyuid&lt;/code&gt;sccçš„è¦æ±‚ï¼š(OpenShift çš„å®‰å…¨åŠ å›ºå¯¼è‡´çš„)&lt;ul&gt;
&lt;li&gt;GitLabçš„ä¸åŒç»„ä»¶ï¼Œå¦‚Sidekiqï¼Œunicornç­‰ï¼Œä½¿ç”¨UID 1000æ¥è¿è¡ŒæœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;PostgreSQL chartä»¥&lt;code&gt;root&lt;/code&gt;ç”¨æˆ·èº«ä»½è¿è¡ŒæœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href="https://gitlab.com/charts/gitlab/issues/752"&gt;é—®é¢˜ï¼ƒ752&lt;/a&gt;æ˜¯opençŠ¶æ€ï¼Œä»¥è°ƒæŸ¥æ›´å¤šæœ‰å…³è§£å†³æ­¤é—®é¢˜çš„ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¦‚æœä½¿ç”¨&lt;code&gt;hostpath&lt;/code&gt;å·ï¼Œåˆ™éœ€è¦ä¸ºä¸»æœºä¸­çš„æŒä¹…æ€§å·ç›®å½•æˆäºˆ&lt;code&gt;0777&lt;/code&gt;æƒé™ï¼Œä»¥æˆäºˆæ‰€æœ‰ç”¨æˆ·å¯¹å·çš„è®¿é—®æƒé™ã€‚&lt;/li&gt;
&lt;li&gt;OpenShiftçš„å†…ç½®router ä¸æ”¯æŒé€šè¿‡SSHè¿›è¡ŒGitæ“ä½œã€‚ &lt;a href="https://gitlab.com/charts/gitlab/issues/892"&gt;é—®é¢˜ï¼ƒ892&lt;/a&gt; æ˜¯oepnçŠ¶æ€ï¼Œä»¥è°ƒæŸ¥æ›´å¤šæœ‰å…³è§£å†³æ­¤é—®é¢˜çš„ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;ä¼—æ‰€å‘¨çŸ¥ï¼ŒGitLab Registryä¸èƒ½ä¸OpenShiftçš„å†…ç½®routeré…åˆä½¿ç”¨ã€‚ &lt;a href="https://gitlab.com/charts/gitlab/issues/893"&gt;é—®é¢˜ï¼ƒ893&lt;/a&gt;æ˜¯opençŠ¶æ€ï¼Œä»¥è°ƒæŸ¥æ›´å¤šæœ‰å…³ä¿®å¤æ­¤é—®é¢˜çš„ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;ä»Let's Encryptè‡ªåŠ¨å‘å‡ºSSLè¯ä¹¦ä¸é€‚ç”¨äºOpenShift routerã€‚æˆ‘ä»¬å»ºè®®&lt;a href="https://docs.gitlab.com/charts/installation/tls.html#option-2-use-your-own-wildcard-certificate"&gt;æ‚¨ä½¿ç”¨è‡ªå·±çš„è¯ä¹¦&lt;/a&gt;ã€‚ &lt;a href="https://gitlab.com/charts/gitlab/issues/894"&gt;é—®é¢˜ï¼ƒ894&lt;/a&gt;å¼€æ”¾ï¼Œä»¥è°ƒæŸ¥æ›´å¤šæœ‰å…³è§£å†³æ­¤é—®é¢˜çš„ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="_4"&gt;å…ˆå†³æ¡ä»¶æ­¥éª¤&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è¯·å‚é˜…&lt;a href="https://www.okd.io/download.html#oc-platforms"&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt; ä»¥å®‰è£…å’Œé…ç½®ç¾¤é›†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¿è¡Œ&lt;code&gt;oc cluster status&lt;/code&gt;å¹¶ç¡®è®¤ç¾¤é›†æ­£åœ¨è¿è¡Œï¼š&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc cluster status
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;è¾“å‡ºåº”ç±»ä¼¼äºï¼š
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Web console URL: https://gitlab.example.com:8443/console/

Config is at host directory
Volumes are at host directory
Persistent volumes are at host directory /home/okduser/openshift/openshift.local.clusterup/openshift.local.pv
Data will be discarded when cluster is destroyed
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;è¯·æ³¨æ„ä¸»æœºä¸­Persistent Volumesçš„ä½ç½®ï¼ˆåœ¨ä¸Šä¾‹ä¸­`/home/okduser/openshift/openshift.local.clusterup/openshift.local.pv`ï¼‰ã€‚ä»¥ä¸‹å‘½ä»¤éœ€è¦`PV_HOST_DIRECTORY`ç¯å¢ƒå˜é‡ä¸­çš„è·¯å¾„ã€‚
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;ä¿®æ”¹PVç›®å½•çš„æƒé™ï¼ˆç”¨ä»¥ä¸Šå€¼æ›¿æ¢ä»¥ä¸‹å‘½ä»¤ä¸­çš„è·¯å¾„ï¼‰ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo chmod -R a+rwx &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;PV_HOST_DIRECTORY&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;/*
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="4"&gt;
&lt;li&gt;åˆ‡æ¢åˆ°ç³»ç»Ÿç®¡ç†å‘˜ç”¨æˆ·ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc login -u system:admin
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="5"&gt;
&lt;li&gt;å°†&lt;code&gt;anyuid&lt;/code&gt;scc æ·»åŠ åˆ°ç³»ç»Ÿç”¨æˆ·ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc adm policy add-scc-to-group anyuid system:authenticated
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;**è­¦å‘Š**ï¼šæ­¤è®¾ç½®å°†åº”ç”¨äºæ‰€æœ‰namespaceï¼Œå¹¶å°†å¯¼è‡´Dockeré•œåƒæœªæ˜ç¡®æŒ‡å®šUSERä½œä¸º`root`ç”¨æˆ·è¿è¡Œã€‚ [é—®é¢˜ï¼ƒ895](https://gitlab.com/charts/gitlab/issues/895)æ˜¯å¼€æ”¾çš„ï¼Œç”¨äºè®°å½•æ‰€éœ€çš„ä¸åŒæœåŠ¡å¸æˆ·ï¼Œå¹¶æè¿°ä»…å°†sccæ·»åŠ åˆ°è¿™äº›æœåŠ¡å¸æˆ·ï¼Œå› æ­¤å½±å“å¯èƒ½æœ‰é™ã€‚
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="6"&gt;
&lt;li&gt;åˆ›å»ºæœåŠ¡å¸æˆ·å’Œ&lt;code&gt;rolebinding&lt;/code&gt;RBACå¹¶&lt;a href="https://docs.gitlab.com/charts/installation/tools.html#helm"&gt;å®‰è£…Tiller&lt;/a&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;kubectl create -f https://gitlab.com/charts/gitlab/raw/master/doc/installation/examples/rbac-config.yaml
helm init --service-account tiller
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_5"&gt;ä¸‹ä¸€æ­¥&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;åœ¨ç¾¤é›†å¯åŠ¨å¹¶è¿è¡Œåï¼Œç»§ç»­&lt;a href="https://docs.gitlab.com/charts/installation/deployment.html"&gt;å®‰è£…chart&lt;/a&gt;ï¼Œå¹¶å‡†å¤‡å¥½é™æ€IPå’ŒDNSæ¡ç›®ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ­¤ä¹‹å‰ï¼Œè¯·æ³¨æ„å¸¸è§„ chartå®‰è£…è¿‡ç¨‹ä¸­çš„ä»¥ä¸‹æ›´æ”¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æˆ‘ä»¬å°†ä½¿ç”¨OpenShiftçš„å†…ç½®routerï¼Œå› æ­¤éœ€è¦ç¦ç”¨chartä¸­åŒ…å«çš„nginx-ingressæœåŠ¡ã€‚å°†ä»¥ä¸‹æ ‡å¿—ä¼ é€’ç»™&lt;code&gt;helm install&lt;/code&gt;å‘½ä»¤ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;--set nginx-ingress.enabled&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;false&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="2"&gt;
&lt;li&gt;ç”±äºå·²çŸ¥å†…ç½®æ³¨å†Œè¡¨ä¸èƒ½ä½¿ç”¨Helm Chartä¸OpenShiftä¸€èµ·ä½¿ç”¨ï¼Œå› æ­¤è¯·ç¦ç”¨æ³¨å†Œè¡¨æœåŠ¡ã€‚å°†ä»¥ä¸‹æ ‡å¿—ä¼ é€’ç»™ &lt;code&gt;helm install&lt;/code&gt;å‘½ä»¤ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;--set registry.enabled=false
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;&lt;a href="https://docs.gitlab.com/charts/installation/tls.html#option-2-use-your-own-wildcard-certificate"&gt;ä½¿ç”¨æ‚¨è‡ªå·±çš„SSLè¯ä¹¦&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sun, 26 May 2019 21:24:52 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-05-26:/install-gitlab-with-docker.html</guid><category>docker</category><category>openshift</category><category>k8s</category><category>containers</category><category>git</category></item><item><title>OpenShiftä¼ä¸šæµ‹è¯•ç¯å¢ƒåº”ç”¨éƒ¨ç½²å®æˆ˜</title><link>https://www.EWhisper.cn/deploy-app-with-openshift-in-enterprise-env.html</link><description>&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#_1"&gt;æ€»è§ˆ&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#_2"&gt;ç¦…é“ç®€ä»‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#_3"&gt;å®æˆ˜æ­¥éª¤&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#_4"&gt;æ¦‚è¿°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_5"&gt;å…·ä½“æ­¥éª¤&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#_6"&gt;æ€»ç»“&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id="_1"&gt;æ€»è§ˆ&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©é¢†å¯¼äº¤ç»™æˆ‘ä¸ªå°ä»»åŠ¡ - æŠŠé¡¹ç›®ç®¡ç†è½¯ä»¶&lt;a href="https://www.zentao.net/download/80137.html"&gt;"ç¦…é“"&lt;/a&gt;å¼€æºç‰ˆ éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ. å¤§æ¦‚ç ”ç©¶äº†ä¸‹ç¦…é“å¼€æºç‰ˆçš„å®˜æ–¹æ–‡æ¡£, å†³å®šé€šè¿‡Dockerå®¹å™¨çš„æ–¹å¼æŠŠå®ƒéƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ. &lt;/p&gt;
&lt;p&gt;é™¤å»ç ”ç©¶çš„æ—¶é—´, å®é™…ä¸Š2å°æ—¶å°±æŠŠç¦…é“å¼€æºç‰ˆéƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ, æ— éœ€ç”³è¯·ä¸»æœºã€å­˜å‚¨ã€æ•°æ®åº“ã€ä¸­é—´ä»¶å’ŒåŸŸåã€‚çœŸæ˜¯ä¸èˆ¬é¡ºæ»‘, æŒºèˆ’æœçš„.&lt;/p&gt;
&lt;h3 id="_2"&gt;ç¦…é“ç®€ä»‹&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ç¦…é“&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt;æ˜¯ä¸“ä¸šçš„ç ”å‘é¡¹ç›®ç®¡ç†è½¯ä»¶&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»†åˆ†éœ€æ±‚ã€ä»»åŠ¡ã€ç¼ºé™·å’Œç”¨ä¾‹&lt;/li&gt;
&lt;li&gt;å®Œæ•´è¦†ç›–ç ”å‘é¡¹ç›®æ ¸å¿ƒæµç¨‹&lt;/li&gt;
&lt;li&gt;å®Œæ•´è½¯ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="_3"&gt;å®æˆ˜æ­¥éª¤&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="_4"&gt;æ¦‚è¿°&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ç®€å•å½’çº³èµ·æ¥, å°±ä»¥ä¸‹å‡ æ­¥:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ„å»º"ç¦…é“"å¼€æºç‰ˆçš„Docker é•œåƒ&lt;/li&gt;
&lt;li&gt;åœ¨OpenShiftä¸Š, åˆ›å»º"ç¦…é“"é¡¹ç›®, å¹¶é€šè¿‡Docker é•œåƒåˆ›å»º"ç¦…é“"åº”ç”¨.&lt;/li&gt;
&lt;li&gt;å°†"ç¦…é“"åº”ç”¨é€šè¿‡åŸŸåå‘å¸ƒåˆ°ä¼ä¸šå†…ç½‘.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å½“ç„¶, ç”±äºOpenShiftçš„å®‰å…¨å¢å¼º, ä»¥åŠä¼ä¸šæµ‹è¯•ç¯å¢ƒçš„éƒ¨åˆ†å®‰å…¨é™åˆ¶ä»¥åŠå…¶ä»–å®¢è§‚æ¡ä»¶, å®é™…ä¸Šæ‰§è¡Œèµ·æ¥éœ€è¦çš„æ­¥éª¤æ›´å¤š:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ„å»º"ç¦…é“"å¼€æºç‰ˆçš„Docker é•œåƒ&lt;ol&gt;
&lt;li&gt;åœ¨äº‘ä¸»æœºä¸Š, é€šè¿‡Dockerfile æ„å»ºDockeré•œåƒ. å¹¶å¯¼å‡º&lt;/li&gt;
&lt;li&gt;åœ¨ä¼ä¸šOpenShift æµ‹è¯•ç¯å¢ƒä¸Š, ä¸Šä¼ å¹¶å¯¼å…¥Docker é•œåƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;åœ¨OpenShiftä¸Š, åˆ›å»º"ç¦…é“"é¡¹ç›®, å¹¶é€šè¿‡Docker é•œåƒåˆ›å»º"ç¦…é“"åº”ç”¨.&lt;ol&gt;
&lt;li&gt;åˆ›å»º"ç¦…é“" - &lt;strong&gt;zentao&lt;/strong&gt; é¡¹ç›®&lt;ol&gt;
&lt;li&gt;(å¯é€‰) æŒ‡å®šè¯¥é¡¹ç›®åªèƒ½è¢«è°ƒåº¦åˆ°ç‰¹å®šä¸»æœºä¸Š;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;(å¯é€‰) åˆ›å»ºOpenShift useroot æœåŠ¡è´¦æˆ· &lt;/li&gt;
&lt;li&gt;åˆ›å»º"ç¦…é“" app åº”ç”¨&lt;/li&gt;
&lt;li&gt;æŒä¹…åŒ–"ç¦…é“"åº”ç”¨å’Œæ•°æ®åº“æ•°æ®.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;å°†"ç¦…é“"åº”ç”¨é€šè¿‡åŸŸåå‘å¸ƒåˆ°ä¼ä¸šå†…ç½‘.&lt;ol&gt;
&lt;li&gt;åˆ›å»º"ç¦…é“" æœåŠ¡(service)&lt;/li&gt;
&lt;li&gt;åˆ›å»º"ç¦…é“" è·¯ç”±(route)&lt;/li&gt;
&lt;li&gt;æ·»åŠ DNSè®°å½•.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="_5"&gt;å…·ä½“æ­¥éª¤&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;1-1 Dockerfile æ„å»ºé•œåƒå¹¶å¯¼å‡º&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;æˆ‘æ˜¯åœ¨æˆ‘çš„äº‘ä¸»æœºä¸Šæ„å»ºçš„. &lt;/p&gt;
&lt;p&gt;ä¹‹æ‰€ä»¥é€‰æ‹©äº‘ä¸»æœº, åŸå› æœ‰2:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æœ‰ç½‘, æœ‰Dockeré•œåƒä¸‹è½½åŠ é€Ÿ;&lt;/li&gt;
&lt;li&gt;å·²å®‰è£… Docker ç»„ä»¶å’ŒæœåŠ¡&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»º &lt;code&gt;Dockerfile&lt;/code&gt; (å¯ä»¥ç›´æ¥é€šè¿‡&lt;a href="http://dl.cnezsoft.com/zentao/docker/docker_zentao.zip"&gt;å®˜ç½‘ä¸‹è½½è¿æ¥&lt;/a&gt;ä¸‹è½½),&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; ubuntu:16.04&lt;/span&gt;
&lt;span class="k"&gt;MAINTAINER&lt;/span&gt;&lt;span class="s"&gt; yidong &amp;lt;yidong@cnezsoft.com&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y apache2 mariadb-server php php-curl php-gd php-ldap php-mbstring php-mcrypt php-mysql php-xml php-zip php-cli php-json curl unzip libapache2-mod-php locales

&lt;span class="k"&gt;ENV&lt;/span&gt; &lt;span class="nv"&gt;LANG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;en_US.UTF8&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;ENV&lt;/span&gt; &lt;span class="nv"&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;123456&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;LANG=\&amp;quot;en_US.UTF-8\&amp;quot;\nLANGUAGE=\&amp;quot;en_US:en\&amp;quot;&amp;quot;&lt;/span&gt; &amp;gt; /etc/default/locale &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; locale-gen en_US.UTF-8

&lt;span class="k"&gt;RUN&lt;/span&gt; mkdir -p /app/zentaopms
&lt;span class="k"&gt;COPY&lt;/span&gt; docker-entrypoint.sh /app
&lt;span class="k"&gt;RUN&lt;/span&gt; &lt;span class="nv"&gt;random&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;date +%s&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; curl http://cdn.zentaopm.com/latest/zentao.zip?rand&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$random&lt;/span&gt; -o /var/www/zentao.zip
&lt;span class="k"&gt;RUN&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /var/www/ &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; unzip -q zentao.zip &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; rm zentao.zip
&lt;span class="k"&gt;RUN&lt;/span&gt; a2enmod rewrite

&lt;span class="k"&gt;RUN&lt;/span&gt; rm -rf /etc/apache2/sites-enabled/000-default.conf /var/lib/mysql/*
&lt;span class="k"&gt;RUN&lt;/span&gt; sed -i &lt;span class="s1"&gt;&amp;#39;1i ServerName 127.0.0.1&amp;#39;&lt;/span&gt; /etc/apache2/apache2.conf
&lt;span class="k"&gt;COPY&lt;/span&gt; config/apache.conf /etc/apache2/sites-enabled/000-default.conf
&lt;span class="k"&gt;COPY&lt;/span&gt; config/ioncube_loader_lin_7.0.so /usr/lib/php/20151012/ioncube_loader_lin_7.0.so
&lt;span class="k"&gt;COPY&lt;/span&gt; config/00-ioncube.ini /etc/php/7.0/apache2/conf.d/
&lt;span class="k"&gt;COPY&lt;/span&gt; config/00-ioncube.ini /etc/php/7.0/cli/conf.d/

&lt;span class="k"&gt;VOLUME&lt;/span&gt;&lt;span class="s"&gt; /app/zentaopms /var/lib/mysql&lt;/span&gt;
&lt;span class="k"&gt;ENTRYPOINT&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/app/docker-entrypoint.sh&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="2"&gt;
&lt;li&gt;æ­¤æ—¶, è¯¥é¡¹ç›®ç›®å½•åŒ…å«ä»¥ä¸‹å†…å®¹:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ tree docker_zentao
docker_zentao
&lt;span class="p"&gt;|&lt;/span&gt;-- config
&lt;span class="p"&gt;|&lt;/span&gt;   &lt;span class="p"&gt;|&lt;/span&gt;-- &lt;span class="m"&gt;00&lt;/span&gt;-ioncube.ini
&lt;span class="p"&gt;|&lt;/span&gt;   &lt;span class="p"&gt;|&lt;/span&gt;-- apache.conf
&lt;span class="p"&gt;|&lt;/span&gt;   &lt;span class="sb"&gt;`&lt;/span&gt;-- ioncube_loader_lin_7.0.so
&lt;span class="p"&gt;|&lt;/span&gt;-- docker-entrypoint.sh
&lt;span class="p"&gt;|&lt;/span&gt;-- Dockerfile
&lt;span class="p"&gt;|&lt;/span&gt;-- docker_zentao.tar.gz
&lt;span class="sb"&gt;`&lt;/span&gt;-- README.md

&lt;span class="m"&gt;1&lt;/span&gt; directory, &lt;span class="m"&gt;7&lt;/span&gt; files
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;Dockerfile&lt;/code&gt; æ„å»ºdocker é•œåƒ:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; docker_zentao
docker build -t zentao .
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="4"&gt;
&lt;li&gt;(å¯é€‰) å¯ä»¥è¿è¡Œä¸€ä¸‹ä»¥æµ‹è¯•æ„å»ºçš„é•œåƒæ˜¯å¦å¯ä»¥æ­£å¸¸è¿è¡Œ:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker run --name zentao-test -p &lt;span class="m"&gt;8000&lt;/span&gt;:80 -e &lt;span class="nv"&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;123456&lt;/span&gt; -d zentao  &lt;span class="c1"&gt;# åå°è¿è¡Œè¯¥dockerå®¹å™¨&lt;/span&gt;
docker ps  &lt;span class="c1"&gt;# æŸ¥çœ‹å®¹å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œ, æœ‰æ— crash&lt;/span&gt;
docker stop zentao-test  &lt;span class="c1"&gt;# æµ‹è¯•å®Œæ¯•, åœæ­¢è¯¥å®¹å™¨&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="5"&gt;
&lt;li&gt;å°†é•œåƒå¯¼å‡ºä¸ºtaråŒ….&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker save -o docker_zentao.tar zentao
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;1-2 ä¸Šä¼ å¹¶å¯¼å…¥docker é•œåƒ&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆè¦é€šè¿‡taråŒ…å¯¼å…¥é•œåƒ?&lt;/p&gt;
&lt;p&gt;å› ä¸ºä¼ä¸šçš„OpenShiftæµ‹è¯•ç¯å¢ƒä¸é€šå¤–ç½‘, ä½†æ˜¯æœ‰ä¸ªæµ‹è¯•å†…ç½‘çš„é•œåƒä»“åº“.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;æŠŠé•œåƒtaråŒ…, ä¸Šä¼ åˆ°å¯ä»¥è¿æ¥åˆ°OpenShiftä¼ä¸šæµ‹è¯•ç¯å¢ƒçš„ä»»æ„èŠ‚ç‚¹(æœ¬ä¾‹å­é€šè¿‡sftpä¸Šä¼ )&lt;/li&gt;
&lt;li&gt;å¯¼å…¥åˆ°ä¼ä¸šæµ‹è¯•ç¯å¢ƒçš„é•œåƒä»“åº“:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker load -i docker_zentao.tar
docker push txocp-registry.example.com/ewhisper/zentao
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;2-1 åˆ›å»º"ç¦…é“" - &lt;strong&gt;zentao&lt;/strong&gt; é¡¹ç›®&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜1:&lt;/p&gt;
&lt;p&gt;"é¡¹ç›®"(project) æ˜¯OpenShiftä¸­çš„æ¦‚å¿µ, projectå¯ä»¥ç†è§£ä¸ºå¯¹åº”K8Sçš„&lt;code&gt;namespace&lt;/code&gt;. é€šè¿‡è¿™ä¸ªå®ç°äº†å¤šç§Ÿæˆ·çš„éš”ç¦».&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æ¯å¯åŠ¨ä¸€ä¸ªæ–°é¡¹ç›®, å°±åº”è¯¥åœ¨OpenShiftä¸Šåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„é¡¹ç›®.&lt;/p&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜2:&lt;/p&gt;
&lt;p&gt;(å¯é€‰) æŒ‡å®šè¯¥é¡¹ç›®åªèƒ½è¢«è°ƒåº¦åˆ°ç‰¹å®šä¸»æœºä¸Š;&lt;/p&gt;
&lt;p&gt;ç”±äºæ˜¯æµ‹è¯•ç¯å¢ƒ, ä¸ºäº†æ–¹ä¾¿é…ç½®, ä¼šé€šè¿‡&lt;code&gt;HostPath&lt;/code&gt; (å°±æ˜¯æŠŠæ–‡ä»¶æŒä¹…åŒ–åˆ°æœ¬æœºçš„æœ¬åœ°ç£ç›˜)æ¥å®ç°æŒä¹…åŒ–. é‚£ä¹ˆå°±è¦ä¿è¯"ç¦…é“"(zentao)è¿™ä¸ªé¡¹ç›®çš„å®¹å™¨éƒ½è¦è°ƒåº¦åˆ°ä¸€å°æŒ‡å®šçš„node(èŠ‚ç‚¹)æœåŠ¡å™¨. æ‰€ä»¥è¦é€šè¿‡ä¸‹æ–‡çš„&lt;code&gt;node-selector&lt;/code&gt;æ¥å®ç°è¯¥åŠŸèƒ½.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc adm new-project zentao &lt;span class="se"&gt;\&lt;/span&gt;
    --node-selector&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;kubernetes.io/hostname=txocp.node02.example.com&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ä¸Šè¾¹çš„å‘½ä»¤ä¸­, &lt;code&gt;oc adm new-project zentao&lt;/code&gt; å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›® - zentao.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--node-selector&lt;/code&gt; å°±æ˜¯é€šè¿‡&lt;code&gt;node-selector&lt;/code&gt; åè¾¹çš„æ¡ä»¶æ¥æŒ‡å®šè¯¥é¡¹ç›®å¦‚ä½•è°ƒåº¦.(åº”ç”¨åœºæ™¯æ˜¯: è°ƒåº¦åˆ°é«˜IOèŠ‚ç‚¹, æˆ–è€…è°ƒåº¦åˆ°ä¸Šæµ·åŒºåŸŸ...)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;kubernetes.io/hostname=txocp.node02.example.com&lt;/code&gt; å‰è¾¹çš„&lt;code&gt;xxxhostname&lt;/code&gt;æ˜¯æ¡ä»¶, å³æ ¹æ®hostname è°ƒåº¦, åè¾¹çš„æ˜¯åˆ¤å®š. æ€»çš„æ¥è¯´, å³è¯¥é¡¹ç›®è¦è¢«è°ƒåº¦åˆ°:hostnameä¸º&lt;code&gt;txocp.node02.example.com&lt;/code&gt;çš„èŠ‚ç‚¹. (è¯¥èŠ‚ç‚¹è‚¯å®šåªæœ‰ä¸€ä¸ª). &lt;/p&gt;
&lt;h5&gt;2-1-1 åˆ›å»ºOpenShift useroot æœåŠ¡è´¦æˆ·&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;ä¹‹æ‰€ä»¥åˆ›å»ºOpenShift æœåŠ¡è´¦æˆ·, æ˜¯å› ä¸º OpenShift ä½œä¸ºä¼ä¸šçº§å®¹å™¨å¹³å°, è¿›è¡Œäº†å®‰å…¨åŠ å›º,  é»˜è®¤ä¸å…è®¸å®¹å™¨ä»¥&lt;strong&gt;root&lt;/strong&gt; ç”¨æˆ·å¯åŠ¨å’Œè¿è¡Œ. æ‰€ä»¥è¦é€šè¿‡åˆ›å»ºä¸€ä¸ªæœåŠ¡è´¦æˆ· &lt;code&gt;useroot&lt;/code&gt;, ä¸ºæ­¤è´¦æˆ·æ·»åŠ "å…è®¸å®¹å™¨ä»¥rootå¯åŠ¨å’Œè¿è¡Œçš„"çš„æƒé™, å¹¶åº”ç”¨åˆ°"zentao" é¡¹ç›®. ä»¥æ­¤æ¥ä½¿å¾—å®¹å™¨å¯ä»¥æ­£å¸¸å¯åŠ¨.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨zentaoé¡¹ç›®ä¸­, åˆ›å»º æœåŠ¡è´¦æˆ·(serviceaccount) - useroot&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc create serviceaccount useroot
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="2"&gt;
&lt;li&gt;ä½¿ç”¨OpenShifté›†ç¾¤ç®¡ç†å‘˜ç”¨æˆ·, ä¸º&lt;code&gt;useroot&lt;/code&gt;èµ‹äºˆ&lt;code&gt;anyuid&lt;/code&gt;çš„æƒé™:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc adm policy add-scc-to-user anyuid -z useroot
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;(å¯é€‰) å¦‚æœå·²ç»å¯åŠ¨è¿‡åº”ç”¨, åˆ™é€šè¿‡&lt;code&gt;oc patch&lt;/code&gt;æ¥æ›´æ–°åº”ç”¨çš„dc (éƒ¨ç½²é…ç½®)å†…å®¹:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc patch dc/zentao --patch &lt;span class="s1"&gt;&amp;#39;{&amp;quot;spec&amp;quot;:{&amp;quot;template&amp;quot;:{&amp;quot;spec&amp;quot;:{&amp;quot;serviceAccountName&amp;quot;: &amp;quot;useroot&amp;quot;}}}&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="4"&gt;
&lt;li&gt;æ­¤å, å®¹å™¨å†…å°±å¯ä»¥é€šè¿‡rootè¿è¡Œ.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;2-2 åˆ›å»º"ç¦…é“" - zentao åº”ç”¨&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ª&lt;strong&gt;é¡¹ç›®&lt;/strong&gt; ä¸­, å¯ä»¥åŒ…æ‹¬å¤šä¸ªåº”ç”¨, æ¯”å¦‚: ç¦…é“web server, ç¦…é“app server, ç¦…é“ç¼“å­˜æœåŠ¡å™¨, ç¦…é“æ•°æ®åº“...&lt;/p&gt;
&lt;p&gt;æœ¬æ¬¡ä¸ºæµ‹è¯•ç¯å¢ƒ, ç¦…é“çš„æ‰€æœ‰ç»„ä»¶ç»Ÿç»Ÿæ‰“è¿›ä¸€ä¸ªdockeré•œåƒé‡Œäº†, æ‰€ä»¥å°±åªæœ‰ä¸€ä¸ªåº”ç”¨ - zentao. é‡Œè¾¹å…¶å®å°±åŒ…æ‹¬äº†ç¦…é“çš„: web server, app serverå’Œdb.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc new-app --name&lt;span class="o"&gt;=&lt;/span&gt;zentao &lt;span class="se"&gt;\&lt;/span&gt;
--docker-image&lt;span class="o"&gt;=&lt;/span&gt;txocp-registry.example.com/ewhisper/zentao &lt;span class="se"&gt;\&lt;/span&gt;
-e &lt;span class="nv"&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;123456&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
--insecure-registry&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸Šè¾¹çš„å‘½ä»¤, é€šè¿‡&lt;code&gt;oc new-app&lt;/code&gt;æ¥åˆ›å»ºæ–°åº”ç”¨. é€šè¿‡&lt;code&gt;--docker-image&lt;/code&gt;æ¥æŒ‡å®šé•œåƒçš„åœ°å€, é€šè¿‡&lt;code&gt;--e xxx&lt;/code&gt; æ¥æŒ‡å®šç¯å¢ƒå˜é‡.&lt;/p&gt;
&lt;p&gt;ç”±äºæµ‹è¯•ç¯å¢ƒçš„registryæ²¡æœ‰é…ç½®https, æ‰€ä»¥è¦æ·»åŠ &lt;code&gt;--insecure-registy=true&lt;/code&gt;, å¦åˆ™é»˜è®¤æ˜¯é€šè¿‡httpsè®¿é—®, ä¼šæ‰¾ä¸åˆ°é•œåƒ.&lt;/p&gt;
&lt;p&gt;è¿è¡Œå‘½ä»¤å, OpenShiftä¼šé»˜è®¤åˆ›å»º:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;deployment configuration (dc, éƒ¨ç½²é…ç½®) - zentao &lt;/li&gt;
&lt;li&gt;build configuration (bc, æ„å»ºé…ç½®)&lt;/li&gt;
&lt;li&gt;pod(å®¹å™¨)&lt;/li&gt;
&lt;li&gt;...&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡&lt;code&gt;oc get&lt;/code&gt; åè¾¹è·Ÿ &lt;code&gt;dc&lt;/code&gt;  &lt;code&gt;bc&lt;/code&gt;   &lt;code&gt;pod&lt;/code&gt;ç­‰æ¥è·å–åº”ç”¨çš„åˆ›å»ºå’Œéƒ¨ç½²çŠ¶æ€.&lt;/p&gt;
&lt;p&gt;é€šè¿‡&lt;code&gt;oc status&lt;/code&gt; æˆ–è€…&lt;code&gt;oc logs&lt;/code&gt;æ¥æŸ¥çœ‹ç›¸å…³äº‹ä»¶å’Œæ—¥å¿—.&lt;/p&gt;
&lt;p&gt;è‡³æ­¤, åº”ç”¨å·²ç»éƒ¨ç½²å¥½äº†, ä½†æ˜¯ç›®å‰è¿˜å­˜åœ¨2ä¸ªé—®é¢˜:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;"ç¦…é“"çš„åº”ç”¨å’Œæ•°æ®åº“æ•°æ®æ˜¯ä¸´æ—¶æ€§çš„, è¿˜æ²¡æœ‰è¿›è¡ŒæŒä¹…åŒ–;&lt;/li&gt;
&lt;li&gt;"ç¦…é“"åªèƒ½é€šè¿‡dockerå†…éƒ¨è®¿é—®, ç”¨æˆ·æ— æ³•è®¿é—®.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åç»­æ¥ä¸€ä¸€è§£å†³è¿™2ä¸ªé—®é¢˜. é¦–å…ˆè§£å†³æ•°æ®æ²¡æœ‰æŒä¹…åŒ–çš„é—®é¢˜.&lt;/p&gt;
&lt;h4&gt;2-3 æŒä¹…åŒ–åº”ç”¨å’Œæ•°æ®åº“æ•°æ®&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;OpenShift æ˜¯ä¸€ä¸ªå®¹å™¨ç¼–æ’è°ƒåº¦ç³»ç»Ÿ, ç†è®ºä¸Šæ¥è¯´ä¸€ä¸ªpodåœ¨å“ªå„¿æˆ‘ä»¬å®Œå…¨ä¸çŸ¥é“, æ‰€ä»¥OpenShiftæ¨èçš„æŒä¹…åŒ–æ–¹æ¡ˆæ˜¯é€šè¿‡PVå’ŒPVCæ¥å®ç°çš„.&lt;/p&gt;
&lt;p&gt;PVçš„å…·ä½“å®ç°å¯ä»¥æ˜¯: NFSä¹‹ç±»çš„å…¬æœ‰å­˜å‚¨, è€Œä¸åº”è¯¥æ˜¯æœ¬åœ°è·¯å¾„. (OpenShifté»˜è®¤ä¸å…è®¸æœ¬åœ°è·¯å¾„(å³: hostPath)å®ç°æ–¹å¼)&lt;/p&gt;
&lt;p&gt;æœ¬ä¾‹ä¸­, ä¸ºäº†é¿å…ä¸€åˆ‡ä¸å¿…è¦çš„èµ„æºç”³è¯·æµç¨‹(å½“å‰OpenShiftæµ‹è¯•ç¯å¢ƒæ²¡æœ‰ç°æˆçš„nfsè¿™ç±»å…¬æœ‰å­˜å‚¨), æ‰€ä»¥å°±ç›´æ¥ç”¨æœ¬åœ°è·¯å¾„æ¥å®ç°æŒä¹…åŒ–. ä½†è¿˜æ˜¯è¦å¼ºè°ƒ, è¿™ä¸æ˜¯æœ€ä½³å®è·µ, ä¸æ¨èè¿™ä¹ˆåš. &lt;br&gt;
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç”±äºOpenShiftä¸å…è®¸æœ¬åœ°è·¯å¾„æŒä¹…åŒ–, æ‰€ä»¥é¦–å…ˆè¦æ›´æ”¹é…ç½®ä½¿å…¶å…è®¸. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ªåä¸º&lt;code&gt;hostpath&lt;/code&gt;çš„SCC (SCCå¯ä»¥ç®€å•çš„ç†è§£ä¸ºå®‰å…¨é™åˆ¶ç­–ç•¥). å…ˆåˆ›å»ºä¸€ä¸ª&lt;code&gt;scc-hostpath.yaml&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;SecurityContextConstraints&lt;/span&gt;
&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;v1&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;hostpath&lt;/span&gt;
&lt;span class="nt"&gt;allowPrivilegedContainer&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;true&lt;/span&gt;
&lt;span class="nt"&gt;runAsUser&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;RunAsAny&lt;/span&gt;
&lt;span class="nt"&gt;seLinuxContext&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;RunAsAny&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="2"&gt;
&lt;li&gt;é€šè¿‡yaml åˆ›å»ºSCC:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc create -f scc-hostpath.yaml
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;æŠŠ&lt;code&gt;allowHostDirVolumePlugin&lt;/code&gt; å‚æ•°é…ç»™&lt;code&gt;hostpath&lt;/code&gt; :&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc patch scc hostpath -p &lt;span class="s1"&gt;&amp;#39;{&amp;quot;allowHostDirVolumePlugin&amp;quot;: true}&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="4"&gt;
&lt;li&gt;æŠŠ&lt;code&gt;hostpath&lt;/code&gt;è¿™ä¸ªSCCèµ‹æƒç»™æ‰€æœ‰ç”¨æˆ·: (&lt;code&gt;system:authenticated&lt;/code&gt; å°±æ˜¯æ‰€æœ‰ç”¨æˆ·)&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc adm policy add-scc-to-group hostpath system:authenticated
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è‡³æ­¤, æ‰€æœ‰ç”¨æˆ·å°±éƒ½å¯ä»¥æŒ‚è½½&lt;code&gt;hostPath&lt;/code&gt; å·äº†.&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥, å°±æ˜¯è¦é…ç½®æŒä¹…åŒ–äº†:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨å¯¹åº”çš„nodeèŠ‚ç‚¹, åˆ›å»ºå¯¹åº”çš„æŒä¹…åŒ–ç›®å½•, å¦‚:&lt;code&gt;/data/mysql&lt;/code&gt; å’Œ&lt;code&gt;/data/zentaopms&lt;/code&gt; (ç¦…é“ é•œåƒ, åŒ…å«äº†2ä¸ªéœ€è¦æŒä¹…åŒ–çš„ç›®å½•, åˆ†åˆ«ä¸º: &lt;code&gt;/var/lib/mysql&lt;/code&gt; å’Œ&lt;code&gt;/app/zentaopms&lt;/code&gt;, åˆ†åˆ«æŒä¹…åŒ–åˆ°å‰è¾¹çš„2ä¸ªç›®å½•)&lt;/li&gt;
&lt;li&gt;ç¼–è¾‘åˆ›å»º zentao appæ—¶è‡ªåŠ¨ç”Ÿæˆçš„&lt;code&gt;dc&lt;/code&gt; é…ç½®, &lt;code&gt;oc edit dc zentao&lt;/code&gt;, ä¿®æ”¹å®Œæˆåå¦‚ä¸‹:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;apps.openshift.io/v1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;DeploymentConfig&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;annotations&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;openshift.io/generated-by&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;OpenShiftNewApp&lt;/span&gt;
  &lt;span class="nt"&gt;creationTimestamp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;2019-05-16T10:24:25Z&amp;#39;&lt;/span&gt;
  &lt;span class="nt"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao&lt;/span&gt;
  &lt;span class="nt"&gt;namespace&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao&lt;/span&gt;
  &lt;span class="nt"&gt;resourceVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;12345678&amp;#39;&lt;/span&gt;
  &lt;span class="nt"&gt;selfLink&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/apis/apps.openshift.io/v1/namespaces/zentao/deploymentconfigs/zentao&lt;/span&gt;
  &lt;span class="nt"&gt;uid&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;c7xxxxxd-77c4-11e9-xxxx-faxxxxxxxfa&lt;/span&gt;
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;replicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt;
  &lt;span class="nt"&gt;revisionHistoryLimit&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;10&lt;/span&gt;
  &lt;span class="nt"&gt;selector&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao&lt;/span&gt;
    &lt;span class="nt"&gt;deploymentconfig&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao&lt;/span&gt;
  &lt;span class="nt"&gt;strategy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;activeDeadlineSeconds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;21600&lt;/span&gt;
    &lt;span class="nt"&gt;resources&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;{}&lt;/span&gt;
    &lt;span class="nt"&gt;rollingParams&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;intervalSeconds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt;
      &lt;span class="nt"&gt;maxSurge&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;25%&lt;/span&gt;
      &lt;span class="nt"&gt;maxUnavailable&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;25%&lt;/span&gt;
      &lt;span class="nt"&gt;timeoutSeconds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;600&lt;/span&gt;
      &lt;span class="nt"&gt;updatePeriodSeconds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt;
    &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Rolling&lt;/span&gt;
  &lt;span class="nt"&gt;template&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;annotations&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nt"&gt;openshift.io/generated-by&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;OpenShiftNewApp&lt;/span&gt;
      &lt;span class="nt"&gt;creationTimestamp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;null&lt;/span&gt;
      &lt;span class="nt"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao&lt;/span&gt;
        &lt;span class="nt"&gt;deploymentconfig&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao&lt;/span&gt;
    &lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;containers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;env&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;
              &lt;span class="nt"&gt;value&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;123456&lt;/span&gt;
          &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;&amp;gt;-&lt;/span&gt;
            &lt;span class="no"&gt;txocp-registry.example.com/ewhisper/zentao@sha256:......&lt;/span&gt;
          &lt;span class="nt"&gt;imagePullPolicy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Always&lt;/span&gt;
          &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao&lt;/span&gt;
          &lt;span class="nt"&gt;resources&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;{}&lt;/span&gt;
          &lt;span class="nt"&gt;terminationMessagePath&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/dev/termination-log&lt;/span&gt;
          &lt;span class="nt"&gt;terminationMessagePolicy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;File&lt;/span&gt;
          &lt;span class="nt"&gt;volumeMounts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;mountPath&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/app/zentaopms&lt;/span&gt;
              &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao-volume-1&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;mountPath&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/var/lib/mysql&lt;/span&gt;
              &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao-volume-2&lt;/span&gt;
      &lt;span class="nt"&gt;dnsPolicy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ClusterFirst&lt;/span&gt;
      &lt;span class="nt"&gt;restartPolicy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Always&lt;/span&gt;
      &lt;span class="nt"&gt;schedulerName&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;default-scheduler&lt;/span&gt;
      &lt;span class="nt"&gt;securityContext&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;{}&lt;/span&gt;
      &lt;span class="nt"&gt;serviceAccount&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;useroot&lt;/span&gt;
      &lt;span class="nt"&gt;serviceAccountName&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;useroot&lt;/span&gt;
      &lt;span class="nt"&gt;terminationGracePeriodSeconds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;30&lt;/span&gt;
      &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;hostPath&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nt"&gt;path&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/var/cuikaidong/zentao/zentaopms&lt;/span&gt;
            &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
          &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao-volume-1&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;hostPath&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nt"&gt;path&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/var/cuikaidong/zentao/mysql&lt;/span&gt;
            &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
          &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao-volume-2&lt;/span&gt;
  &lt;span class="nt"&gt;test&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;false&lt;/span&gt;
  &lt;span class="nt"&gt;triggers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ConfigChange&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;imageChangeParams&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nt"&gt;automatic&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;true&lt;/span&gt;
        &lt;span class="nt"&gt;containerNames&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao&lt;/span&gt;
        &lt;span class="nt"&gt;from&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ImageStreamTag&lt;/span&gt;
          &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;zentao:latest&amp;#39;&lt;/span&gt;
          &lt;span class="nt"&gt;namespace&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao&lt;/span&gt;
        &lt;span class="nt"&gt;lastTriggeredImage&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;&amp;gt;-&lt;/span&gt;
          &lt;span class="no"&gt;txocp-registry.example.com/ewhisper/zentao@sha256:......&lt;/span&gt;
      &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ImageChange&lt;/span&gt;
&lt;span class="nt"&gt;status&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;availableReplicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt;
  &lt;span class="nt"&gt;conditions&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;lastTransitionTime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;2019-05-16T10:26:16Z&amp;#39;&lt;/span&gt;
      &lt;span class="nt"&gt;lastUpdateTime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;2019-05-16T10:26:16Z&amp;#39;&lt;/span&gt;
      &lt;span class="nt"&gt;message&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Deployment config has minimum availability.&lt;/span&gt;
      &lt;span class="nt"&gt;status&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;True&amp;#39;&lt;/span&gt;
      &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Available&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;lastTransitionTime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;2019-05-16T11:54:24Z&amp;#39;&lt;/span&gt;
      &lt;span class="nt"&gt;lastUpdateTime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;2019-05-16T11:54:26Z&amp;#39;&lt;/span&gt;
      &lt;span class="nt"&gt;message&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;replication controller &amp;quot;zentao-5&amp;quot; successfully rolled out&lt;/span&gt;
      &lt;span class="nt"&gt;reason&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;NewReplicationControllerAvailable&lt;/span&gt;
      &lt;span class="nt"&gt;status&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;True&amp;#39;&lt;/span&gt;
      &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Progressing&lt;/span&gt;
  &lt;span class="nt"&gt;details&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;causes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ConfigChange&lt;/span&gt;
    &lt;span class="nt"&gt;message&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;config change&lt;/span&gt;
  &lt;span class="nt"&gt;latestVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;5&lt;/span&gt;
  &lt;span class="nt"&gt;observedGeneration&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;6&lt;/span&gt;
  &lt;span class="nt"&gt;readyReplicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt;
  &lt;span class="nt"&gt;replicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt;
  &lt;span class="nt"&gt;unavailableReplicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;0&lt;/span&gt;
  &lt;span class="nt"&gt;updatedReplicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸è¦è¢«è¿™ä¸ªé…ç½®æ–‡ä»¶å“åˆ°, å…¶å®è¿™äº›éƒ½æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„. å…³é”®ä¿¡æ¯æ˜¯å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;          &lt;span class="nt"&gt;volumeMounts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;mountPath&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/app/zentaopms&lt;/span&gt;
              &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao-volume-1&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;mountPath&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/var/lib/mysql&lt;/span&gt;
              &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao-volume-2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;â–³ å³2ä¸ªå®¹å™¨å†…çš„éœ€è¦æŒ‚è½½çš„è·¯å¾„, åˆ†åˆ«è¢«è‡ªåŠ¨å‘½åä¸º: &lt;code&gt;zentao-volume-1&lt;/code&gt;å’Œ &lt;code&gt;zentao-volume-2&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;å¯¹åº”çš„å¤–éƒ¨æŒ‚è½½, åŸå§‹æƒ…å†µæ˜¯&lt;code&gt;EmptyDir&lt;/code&gt; (å³æ²¡æœ‰æŒ‚è½½), å®¹å™¨é‡å¯äº†æ•°æ®å°±æ²¡äº†. å…·ä½“å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;      &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;emptyDir&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao-volume-1&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;emptyDir&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao-volume-2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¿®æ”¹åå¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;      &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;hostPath&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nt"&gt;path&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/var/cuikaidong/zentao/zentaopms&lt;/span&gt;
            &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
          &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao-volume-1&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;hostPath&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nt"&gt;path&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/var/cuikaidong/zentao/mysql&lt;/span&gt;
            &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
          &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zentao-volume-2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¹‹å, podä¼šè‡ªåŠ¨è¿›è¡Œé‡å¯, æŠŠå¯¹åº”çš„æ•°æ®é€šè¿‡&lt;code&gt;hostPath&lt;/code&gt; æŒ‚è½½åˆ°æœ¬åœ°ç›®å½•æ¥å®ç°æŒä¹…åŒ–.&lt;/p&gt;
&lt;h4&gt;3-1 åˆ›å»º"ç¦…é“" æœåŠ¡(service)&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœåŠ¡&lt;/strong&gt;(Service) æ˜¯OpenShiftæˆ–K8S çš„ä¸“æœ‰æ¦‚å¿µ, ç®€å•ç†è§£å°±æ˜¯æŠŠpodå†…çš„æŒ‡å®šæ¥å£æš´éœ²ç»™OpenShiftæˆ–K8Sé›†ç¾¤å†…éƒ¨ä½¿ç”¨çš„ä¸€ç§æ–¹æ³•. (æ¯”å¦‚æŠŠ: mysqlå®¹å™¨å†…çš„3306ç«¯å£æš´éœ²åˆ°OpenShift SDNç½‘ç»œçš„ 172.X.X.X:3306).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc expose dc zentao --port&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æŠŠ zentao åº”ç”¨çš„httpæœåŠ¡ç«¯å£80 æš´éœ²ç»™OpenShifté›†ç¾¤å†…éƒ¨. (ä¼šåˆ›å»ºä¸€ä¸ªå« zentao çš„ svc)&lt;/p&gt;
&lt;h4&gt;3-2 åˆ›å»º"ç¦…é“" è·¯ç”±(route)&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è·¯ç”±&lt;/strong&gt; (route)æ˜¯OpenShiftçš„ä¸“æœ‰æ¦‚å¿µ, ç±»ä¼¼äºK8Sçš„Ingress, ä½œç”¨éƒ½æ˜¯æŠŠæœåŠ¡æš´éœ²ç»™OpenShiftä¹‹å¤–çš„ç½‘ç»œ, ä½¿å¾—ç”¨æˆ·å¯ä»¥é€šè¿‡åŸŸåæˆ–å…¶ä»–æ–¹å¼è®¿é—®åˆ°è¯¥åº”ç”¨. (å¦‚: é€šè¿‡&lt;code&gt;zentao.apps.example.com&lt;/code&gt; è®¿é—®åˆ° "ç¦…é“" é¡¹ç›®ç®¡ç†å·¥å…·é¦–é¡µ)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc expose svc zentao --hostname&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;zentao.apps.example.com&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é€šè¿‡ä¸Šè¾¹çš„å‘½ä»¤, å°±åˆ›å»ºäº†ä¸€æ¡è·¯ç”±, å®ç°äº†é€šè¿‡&lt;code&gt;zentao.apps.example.com&lt;/code&gt; è®¿é—®åˆ° "ç¦…é“" é¡¹ç›®ç®¡ç†å·¥å…·é¦–é¡µ. (å¦‚æœä¸åŠ &lt;code&gt;--hostname&lt;/code&gt;, é»˜è®¤çš„hostnameå‰ç¼€ä¸º&lt;code&gt;appname-projectname&lt;/code&gt;, å³"zentao-zentao")&lt;/p&gt;
&lt;h4&gt;3-3 æ·»åŠ DNSè®°å½•&lt;/h4&gt;
&lt;p&gt;ç”±äºæˆ‘ä»¬ä¼ä¸šçš„OpenShift æµ‹è¯•ç¯å¢ƒDNS çš„å®¢è§‚æƒ…å†µ. æ— æ³•å®ç°æ³›è§£æ, æ‰€ä»¥è¿˜éœ€è¦è¯·ç›¸å…³ä¸“ä¸šç»„æ‰‹åŠ¨æ·»åŠ DNSè®°å½•. åŠå…¬ç”µè„‘æ·»åŠ DNSæµ‹è¯•åŸŸç­‰æ“ä½œ. &lt;/p&gt;
&lt;p&gt;åšå®Œè¿™äº›æ“ä½œå, æ‰èƒ½é€šè¿‡åŸŸåè®¿é—®åˆ°ç¦…é“ç³»ç»Ÿ.&lt;/p&gt;
&lt;p&gt;è‡³æ­¤, æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åŸŸåè®¿é—® "ç¦…é“" é¡µé¢â€‹, â€‹è€Œâ€‹æˆ‘ä»¬â€‹ä½¿ç”¨â€‹çš„â€‹æ•°æ®â€‹ä¹Ÿä¼šâ€‹ä¿ç•™åœ¨â€‹æŒ‡å®šâ€‹çš„â€‹nodeâ€‹èŠ‚ç‚¹â€‹ä¸Š.â€‹ &lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="ç¦…é“é¦–é¡µ" src="./images/zentao_openshift.png"&gt;&lt;/p&gt;
&lt;h2 id="_6"&gt;æ€»ç»“&lt;a class="headerlink" href="#_6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æ•´ä½“ä½¿ç”¨ä¸‹æ¥, éƒ¨åˆ†åœ°æ–¹è¿˜å­˜åœ¨ä½¿ç”¨ä¸ç•…çš„æƒ…å†µ, å¯ä»¥ç»§ç»­ä¼˜åŒ–æå‡ä½¿ç”¨ä½“éªŒ, å¤§æ¦‚æ€»ç»“ä¸€ä¸‹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†…éƒ¨é•œåƒä»“åº“é•œåƒèµ„æºå¤ªåŒ®ä¹. å¯¼è‡´æ„å»ºé•œåƒä¸å¤ªæ–¹ä¾¿. åç»­å†…éƒ¨çš„é•œåƒä»“åº“å¯ä»¥ä»docker hub, çº¢å¸½å®˜æ–¹å®šæœŸæ‹‰å–è¾ƒä¸ºæµè¡Œçš„é•œåƒ.&lt;/li&gt;
&lt;li&gt;åœ¨OpenShiftä¸Š, å¤šæŒ‚è½½ä¸€ä¸ªæˆ–å¤šä¸ªå…¬æœ‰å­˜å‚¨(å¦‚NFS, NAS, å¯¹è±¡å­˜å‚¨ç­‰), æ–¹ä¾¿è¿›è¡Œæ•°æ®æŒä¹…åŒ–&lt;ul&gt;
&lt;li&gt;è·Ÿè¿›ä¸€æ­¥, å¸Œæœ›OpenShiftå¯ä»¥ç›´æ¥è°ƒç”¨ä¸‹ä¸€å±‚æ•°æ®å­˜å‚¨çš„ç›¸å…³æ¥å£, å®ç°è‡ªåŠ¨ç”³è¯·&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åº”ç”¨é€šè¿‡åŸŸåå‘å¸ƒå‡ºæ¥, è¿˜éœ€è¦ç»è¿‡åŸŸæ§æˆ–F5æˆ–ä¸ªäººç”µè„‘è¿›è¡Œè¿›ä¸€æ­¥é…ç½®æ‰èƒ½ç”Ÿæ•ˆ. åç»­å¯ä»¥è€ƒè™‘:&lt;ul&gt;
&lt;li&gt;é…ç½®æŸäºŒçº§åŸŸåçš„æ³›è§£æ, å®ç°ç›¸å…³åŸŸåçš„è‡ªåŠ¨å‘å¸ƒ. &lt;/li&gt;
&lt;li&gt;æ›´è¿›ä¸€æ­¥, å¯ä»¥è€ƒè™‘OpenShiftç›´æ¥å’ŒF5æ·±åº¦æ•´åˆ, å°†F5ä½œä¸ºå…¶routerä½¿ç”¨. (å½“å‰æ˜¯: F5 -&amp;gt; HAProxy(router) )&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="footnote"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;https://www.zentao.net&amp;#160;&lt;a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Mon, 20 May 2019 00:04:46 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-05-20:/deploy-app-with-openshift-in-enterprise-env.html</guid><category>openshift</category><category>docker</category></item><item><title>å®¹å™¨è‡ªåŠ¨ä¼¸ç¼©</title><link>https://www.EWhisper.cn/openshift-pod-autoscaling.html</link><description>&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#_1"&gt;æ¦‚è§ˆ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#horizontal-pod-autoscalers"&gt;ä½¿ç”¨Horizontal Pod Autoscalersçš„è¦æ±‚&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_2"&gt;æ”¯æŒçš„æŒ‡æ ‡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_3"&gt;è‡ªåŠ¨ç¼©æ”¾&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#cpu"&gt;æ ¹æ®CPUåˆ©ç”¨ç‡è‡ªåŠ¨æ‰©å±•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_4"&gt;æ ¹æ®å†…å­˜åˆ©ç”¨ç‡è‡ªåŠ¨ç¼©æ”¾&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#horizontal-pod-autoscaler"&gt;æŸ¥çœ‹Horizontal Pod Autoscaler&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#horizontal-pod-autoscaler-status-conditions"&gt;æŸ¥çœ‹Horizontal Pod Autoscaler Status Conditions&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id="_1"&gt;æ¦‚è§ˆ&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;img alt="" src="./images/Matrix-agent-Smith-clones.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ç”±&lt;code&gt;HorizontalPodAutoscaler&lt;/code&gt;å¯¹è±¡å®šä¹‰çš„æ¨ªå‘podè‡ªåŠ¨ä¼¸ç¼©å™¨(autoscaler)æŒ‡å®šç³»ç»Ÿåº”å¦‚ä½•æ ¹æ®ä»å±äºè¯¥å¤åˆ¶æ§åˆ¶å™¨(replication controller)æˆ–éƒ¨ç½²é…ç½®(deployment configuration)çš„podæ”¶é›†çš„åº¦é‡æ ‡å‡†(metrics)è‡ªåŠ¨å¢åŠ æˆ–å‡å°‘å¤åˆ¶æ§åˆ¶å™¨æˆ–éƒ¨ç½²é…ç½®çš„è§„æ¨¡ã€‚&lt;/p&gt;
&lt;h2 id="horizontal-pod-autoscalers"&gt;ä½¿ç”¨Horizontal Pod Autoscalersçš„è¦æ±‚&lt;a class="headerlink" href="#horizontal-pod-autoscalers" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;è¦ä½¿ç”¨æ¨ªå‘podè‡ªåŠ¨ä¼¸ç¼©å™¨(horizontal pod autoscalers)ï¼Œæ‚¨éœ€è¦å®‰è£…OpenShift Container Platformåº¦é‡æœåŠ¡å™¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ansible-playbook &lt;span class="se"&gt;\&lt;/span&gt;
/usr/share/ansible/openshift-ansible/playbooks/metrics-server/config.yml &lt;span class="se"&gt;\&lt;/span&gt;
-e &lt;span class="nv"&gt;openshift_metrics_server_install&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯æœåŠ¡å™¨æ˜¯å¦å·²æ­£ç¡®å®‰è£…ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ oc adm top node
$ oc adm top pod
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æœ‰å…³è¿™äº›å‘½ä»¤çš„å…¶ä»–ä¿¡æ¯ï¼Œè¯·å‚é˜… &lt;a href="https://docs.openshift.com/container-platform/3.11/admin_guide/manage_nodes.html#viewing-nodes"&gt;æŸ¥çœ‹Nodes&lt;/a&gt;å’Œ &lt;a href="https://docs.openshift.com/container-platform/3.11/admin_guide/managing_pods.html#viewing-pods"&gt;æŸ¥çœ‹Pods&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="_2"&gt;æ”¯æŒçš„æŒ‡æ ‡&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Horizontal pod autoscalersæ”¯æŒä»¥ä¸‹åº¦é‡æ ‡å‡†ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="left"&gt;æŒ‡æ ‡&lt;/th&gt;
&lt;th align="left"&gt;æè¿°&lt;/th&gt;
&lt;th align="left"&gt;APIç‰ˆæœ¬&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="left"&gt;CPUåˆ©ç”¨ç‡&lt;/td&gt;
&lt;td align="left"&gt;&lt;a href="https://docs.openshift.com/container-platform/3.11/dev_guide/compute_resources.html#dev-cpu-requests"&gt;è¯·æ±‚çš„CPUçš„&lt;/a&gt;ç™¾åˆ†æ¯”&lt;/td&gt;
&lt;td align="left"&gt;&lt;code&gt;autoscaling/v1&lt;/code&gt;ï¼Œ &lt;code&gt;autoscaling/v2beta1&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="left"&gt;å†…å­˜åˆ©ç”¨ç‡&lt;/td&gt;
&lt;td align="left"&gt;è¯·æ±‚çš„å†…å­˜ç™¾åˆ†æ¯”&lt;/td&gt;
&lt;td align="left"&gt;&lt;code&gt;autoscaling/v2beta1&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="_3"&gt;è‡ªåŠ¨ç¼©æ”¾&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æ‚¨å¯ä»¥ä½¿ç”¨&lt;code&gt;oc autoscale&lt;/code&gt;å‘½ä»¤åˆ›å»ºhorizontal pod autoscalerï¼Œå¹¶æŒ‡å®šè¦è¿è¡Œçš„pod çš„æœ€å°å’Œæœ€å¤§æ•°é‡ï¼Œä»¥åŠpodåº”æŒ‡å‘çš„ &lt;a href="https://docs.openshift.com/container-platform/3.11/dev_guide/pod_autoscaling.html#creating-a-hpa"&gt;CPUåˆ©ç”¨ç‡&lt;/a&gt;æˆ–&lt;a href="https://docs.openshift.com/container-platform/3.11/dev_guide/pod_autoscaling.html#pod-autoscaling-memory"&gt;å†…å­˜åˆ©ç”¨ç‡&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åˆ›å»ºhorizontal pod autoscaleråï¼Œå®ƒå¼€å§‹å°è¯•æŸ¥è¯¢Heapsterä»¥è·å–podä¸Šçš„æŒ‡æ ‡ã€‚åœ¨Heapsterè·å¾—åˆå§‹æŒ‡æ ‡ä¹‹å‰å¯èƒ½éœ€è¦ä¸€åˆ°ä¸¤åˆ†é’Ÿã€‚&lt;/p&gt;
&lt;p&gt;åœ¨Heapsterä¸­æä¾›åº¦é‡æ ‡å‡†åï¼Œhorizontal pod autoscalerå°†è®¡ç®—å½“å‰åº¦é‡æ ‡å‡†åˆ©ç”¨ç‡ä¸æ‰€éœ€åº¦é‡æ ‡å‡†åˆ©ç”¨ç‡çš„æ¯”ç‡ï¼Œå¹¶ç›¸åº”åœ°å‘ä¸Šæˆ–å‘ä¸‹æ‰©å±•ã€‚ç¼©æ”¾å°†å®šæœŸå‘ç”Ÿï¼Œä½†åœ¨æŒ‡æ ‡è¿›å…¥Heapsterä¹‹å‰å¯èƒ½éœ€è¦ä¸€åˆ°ä¸¤åˆ†é’Ÿã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå¤åˆ¶æ§åˆ¶å™¨(replication controller)ï¼Œæ­¤æ‰©å±•ç›´æ¥å¯¹åº”äºå¤åˆ¶æ§åˆ¶å™¨çš„å‰¯æœ¬ã€‚å¯¹äºéƒ¨ç½²é…ç½®(deployment configuration)ï¼Œæ­¤æ‰©å±•ç›´æ¥å¯¹åº”äºéƒ¨ç½²é…ç½®çš„å‰¯æœ¬è®¡æ•°ã€‚è¯·æ³¨æ„ï¼Œè‡ªåŠ¨ç¼©æ”¾ä»…é€‚ç”¨äº&lt;code&gt;Complete&lt;/code&gt;é˜¶æ®µä¸­çš„æœ€æ–°éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;OpenShift Container Platformè‡ªåŠ¨å¯¹èµ„æºè¿›è¡Œæ ¸ç®—ï¼Œå¹¶é˜²æ­¢åœ¨èµ„æºæ¿€å¢æœŸé—´ï¼ˆä¾‹å¦‚å¯åŠ¨æœŸé—´ï¼‰è¿›è¡Œä¸å¿…è¦çš„è‡ªåŠ¨æ‰©å±•ã€‚åœ¨å‘ä¸Šæ‰©å±•æ—¶ï¼Œ&lt;code&gt;unready&lt;/code&gt;çŠ¶æ€ä¸­çš„podçš„CPUä½¿ç”¨ç‡ä¸º&lt;code&gt;0 CPU&lt;/code&gt;ï¼Œå¹¶ä¸”autoscaleråœ¨å‘ä¸‹ä¼¸ç¼©æ—¶ä¼šå¿½ç•¥è¿™äº›podã€‚æ— æ³•è·å–åˆ°æŒ‡æ ‡çš„podåœ¨å‘ä¸Šä¼¸ç¼©æ—¶CPUä½¿ç”¨ç‡ä¸º0%ï¼Œå‘ä¸‹ä¼¸ç¼©æ—¶CPUä½¿ç”¨ç‡ä¸º100%ã€‚è¿™æ ·å¯ä»¥åœ¨HPAå†³ç­–æœŸé—´å®ç°æ›´é«˜çš„ç¨³å®šæ€§ã€‚è¦ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œæ‚¨å¿…é¡»é…ç½® &lt;a href="https://docs.openshift.com/container-platform/3.11/dev_guide/application_health.html#dev-guide-application-health"&gt;readiness checks&lt;/a&gt; ä»¥ç¡®å®šæ˜¯å¦å¯ä»¥ä½¿ç”¨æ–°å®¹å™¨ã€‚&lt;/p&gt;
&lt;h2 id="cpu"&gt;æ ¹æ®CPUåˆ©ç”¨ç‡è‡ªåŠ¨æ‰©å±•&lt;a class="headerlink" href="#cpu" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;oc autoscale&lt;/code&gt;å‘½ä»¤å¹¶æŒ‡å®šåœ¨ä»»ä½•ç»™å®šæ—¶é—´è‡³å°‘è¦è¿è¡Œçš„æœ€å¤§podæ•°ã€‚æ‚¨å¯ä»¥é€‰æ‹©æŒ‡å®špodçš„æœ€å°æ•°é‡ä»¥åŠpodåº”è¯¥å®šä½çš„å¹³å‡CPUåˆ©ç”¨ç‡ï¼Œå¦åˆ™å°†ä»OpenShift Container PlatformæœåŠ¡å™¨è·å¾—è¿™äº›é»˜è®¤å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ oc autoscale dc/frontend --min &lt;span class="m"&gt;1&lt;/span&gt; --max &lt;span class="m"&gt;10&lt;/span&gt; --cpu-percent&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;
deploymentconfig &lt;span class="s2"&gt;&amp;quot;frontend&amp;quot;&lt;/span&gt; autoscaled
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸Šé¢çš„ç¤ºä¾‹åœ¨ä½¿ç”¨&lt;code&gt;autoscaling/v1&lt;/code&gt;ç‰ˆæœ¬çš„horizontal pod autoscaleræ—¶ä¼šåˆ›å»ºä¸€ä¸ªå…·æœ‰ä»¥ä¸‹å®šä¹‰çš„horizontal pod autoscalerï¼š&lt;/p&gt;
&lt;p&gt;ä¾‹1. Horizontal Pod Autoscaler å¯¹è±¡å®šä¹‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;autoscaling/v1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;HorizontalPodAutoscaler&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;frontend&lt;/span&gt; 
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;scaleTargetRef&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;DeploymentConfig&lt;/span&gt; 
    &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;frontend&lt;/span&gt; 
    &lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;apps/v1&lt;/span&gt; 
    &lt;span class="nt"&gt;subresource&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;scale&lt;/span&gt;
  &lt;span class="nt"&gt;minReplicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt; 
  &lt;span class="nt"&gt;maxReplicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;10&lt;/span&gt; 
  &lt;span class="nt"&gt;cpuUtilization&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;targetCPUUtilizationPercentage&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;80&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;


&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;metadata.name&lt;/td&gt;
&lt;td&gt;è¿™ä¸ªhorizontal pod autoscaler å¯¹è±¡çš„åå­—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;kind&lt;/td&gt;
&lt;td&gt;è¦ä¼¸ç¼©çš„å¯¹è±¡ç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;scaleTargetRef.name&lt;/td&gt;
&lt;td&gt;è¦ä¼¸ç¼©çš„å¯¹è±¡çš„åç§°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;scaleTargetRef.apiVersion&lt;/td&gt;
&lt;td&gt;è¦æ‰©å±•çš„å¯¹è±¡çš„APIç‰ˆæœ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;minReplicas&lt;/td&gt;
&lt;td&gt;å‘ä¸‹ä¼¸ç¼©æ—¶çš„æœ€å°å‰¯æœ¬æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;maxReplicas&lt;/td&gt;
&lt;td&gt;å‘ä¸Šæ‰©å±•æ—¶çš„æœ€å¤§å‰¯æœ¬æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;targetCPUUtilizationPercentage&lt;/td&gt;
&lt;td&gt;ç†æƒ³æƒ…å†µä¸‹æ¯ä¸ªpodåº”ä½¿ç”¨çš„è¯·æ±‚CPUçš„ç™¾åˆ†æ¯”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æˆ–è€…ï¼Œåœ¨&lt;code&gt;oc autoscale&lt;/code&gt;ä½¿ç”¨horizontal pod autoscalerçš„&lt;code&gt;v2beta1&lt;/code&gt;ç‰ˆæœ¬æ—¶ï¼Œè¯¥å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªå…·æœ‰ä»¥ä¸‹å®šä¹‰çš„horizontal pod autoscaler:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;autoscaling/v2beta1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;HorizontalPodAutoscaler&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;hpa-resource-metrics-cpu&lt;/span&gt; 
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;scaleTargetRef&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;apps/v1&lt;/span&gt; 
    &lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ReplicationController&lt;/span&gt; 
    &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;hello-hpa-cpu&lt;/span&gt; 
  &lt;span class="nt"&gt;minReplicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt; 
  &lt;span class="nt"&gt;maxReplicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;10&lt;/span&gt; 
  &lt;span class="nt"&gt;metrics&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Resource&lt;/span&gt;
    &lt;span class="nt"&gt;resource&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;cpu&lt;/span&gt;
      &lt;span class="nt"&gt;targetAverageUtilization&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;50&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;


&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;metadata.name&lt;/td&gt;
&lt;td&gt;è¿™ä¸ªhorizontal pod autoscaler å¯¹è±¡çš„åå­—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;scaleTargetRef.apiVersion&lt;/td&gt;
&lt;td&gt;è¦æ‰©å±•çš„å¯¹è±¡çš„APIç‰ˆæœ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;kind&lt;/td&gt;
&lt;td&gt;è¦æ‰©å±•çš„å¯¹è±¡ç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;scaleTargetRef.name&lt;/td&gt;
&lt;td&gt;è¦ç¼©æ”¾çš„å¯¹è±¡çš„åç§°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;minReplicas&lt;/td&gt;
&lt;td&gt;å‘ä¸‹ä¼¸ç¼©æ—¶çš„æœ€å°å‰¯æœ¬æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;maxReplicas&lt;/td&gt;
&lt;td&gt;å‘ä¸Šæ‰©å±•æ—¶çš„æœ€å¤§å‰¯æœ¬æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;targetAverageUtilization&lt;/td&gt;
&lt;td&gt;æ¯ä¸ªpodåº”ä½¿ç”¨çš„è¯·æ±‚CPUçš„å¹³å‡ç™¾åˆ†æ¯”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="_4"&gt;æ ¹æ®å†…å­˜åˆ©ç”¨ç‡è‡ªåŠ¨ç¼©æ”¾&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ä¸åŸºäºCPUçš„è‡ªåŠ¨ç¼©æ”¾ä¸åŒï¼ŒåŸºäºå†…å­˜çš„è‡ªåŠ¨ç¼©æ”¾éœ€è¦ä½¿ç”¨YAMLè€Œä¸æ˜¯ä½¿ç”¨&lt;code&gt;oc autoscale&lt;/code&gt;å‘½ä»¤æ¥æŒ‡å®šè‡ªåŠ¨ç¼©æ”¾å™¨ã€‚ï¼ˆå¯é€‰ï¼‰æ‚¨å¯ä»¥æŒ‡å®špodçš„æœ€å°æ•°é‡ä»¥åŠpodåº”è¯¥å®šä½çš„å¹³å‡å†…å­˜åˆ©ç”¨ç‡ï¼Œå¦åˆ™å°†ä»OpenShift Container PlatformæœåŠ¡å™¨è·å¾—è¿™äº›é»˜è®¤å€¼ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŸºäºå†…å­˜çš„è‡ªåŠ¨æ‰©å±•ä»…é€‚ç”¨&lt;code&gt;v2beta1&lt;/code&gt;çš„è‡ªåŠ¨æ‰©å±•API çš„ç‰ˆæœ¬ã€‚é€šè¿‡å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°ç¾¤é›†çš„&lt;code&gt;master-config.yaml&lt;/code&gt;æ–‡ä»¶æ¥å¯ç”¨åŸºäºå†…å­˜çš„è‡ªåŠ¨ç¼©æ”¾ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nn"&gt;...&lt;/span&gt;
&lt;span class="nt"&gt;apiServerArguments&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;runtime-config&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;apis/autoscaling/v2beta1=true&lt;/span&gt;
&lt;span class="nn"&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="2"&gt;
&lt;li&gt;å°†ä»¥ä¸‹å†…å®¹æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚&lt;code&gt;hpa.yaml&lt;/code&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;autoscaling/v2beta1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;HorizontalPodAutoscaler&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;hpa-resource-metrics-memory&lt;/span&gt; 
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;scaleTargetRef&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;apps/v1&lt;/span&gt; 
    &lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ReplicationController&lt;/span&gt; 
    &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;hello-hpa-memory&lt;/span&gt; 
  &lt;span class="nt"&gt;minReplicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt; 
  &lt;span class="nt"&gt;maxReplicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;10&lt;/span&gt; 
  &lt;span class="nt"&gt;metrics&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Resource&lt;/span&gt;
    &lt;span class="nt"&gt;resource&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;memory&lt;/span&gt;
      &lt;span class="nt"&gt;targetAverageUtilization&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;50&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;


&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;metadata.name&lt;/td&gt;
&lt;td&gt;è¿™ä¸ªhorizontal pod autoscaler å¯¹è±¡çš„åå­—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;scaleTargetRef.apiVersion&lt;/td&gt;
&lt;td&gt;è¦æ‰©å±•çš„å¯¹è±¡çš„APIç‰ˆæœ¬&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;kind&lt;/td&gt;
&lt;td&gt;è¦æ‰©å±•çš„å¯¹è±¡ç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;scaleTargetRef.name&lt;/td&gt;
&lt;td&gt;è¦ç¼©æ”¾çš„å¯¹è±¡çš„åç§°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;minReplicas&lt;/td&gt;
&lt;td&gt;å‘ä¸‹ç¼©å°æ—¶çš„æœ€å°å‰¯æœ¬æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;maxReplicas&lt;/td&gt;
&lt;td&gt;å‘ä¸Šæ‰©å±•æ—¶çš„æœ€å¤§å‰¯æœ¬æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;targetAverageUtilization&lt;/td&gt;
&lt;td&gt;æ¯ä¸ªpodåº”ä½¿ç”¨çš„è¯·æ±‚å†…å­˜çš„å¹³å‡ç™¾åˆ†æ¯”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start="3"&gt;
&lt;li&gt;ç„¶åï¼Œä»ä¸Šé¢çš„æ–‡ä»¶åˆ›å»ºè‡ªåŠ¨ç¼©æ”¾å™¨ï¼š&lt;code&gt;$ oc create -f hpa.yaml&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;æ³¨æ„:&lt;/p&gt;
&lt;p&gt;è¦ä½¿åŸºäºå†…å­˜çš„è‡ªåŠ¨ç¼©æ”¾å·¥ä½œï¼Œå†…å­˜ä½¿ç”¨é‡å¿…é¡»ä¸å‰¯æœ¬è®¡æ•°æˆæ¯”ä¾‹åœ°å¢åŠ å’Œå‡å°‘ã€‚ä¸€èˆ¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‰¯æœ¬è®¡æ•°çš„å¢åŠ å¿…ç„¶å¯¼è‡´æ¯ä¸ªpodçš„å†…å­˜ï¼ˆå·¥ä½œé›† working setï¼‰ä½¿ç”¨ç‡æ•´ä½“ä¸‹é™ã€‚&lt;/li&gt;
&lt;li&gt;å‰¯æœ¬è®¡æ•°çš„å‡å°‘å¿…ç„¶å¯¼è‡´æ¯ä¸ªpodçš„å†…å­˜ä½¿ç”¨é‡æ•´ä½“å¢åŠ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½¿ç”¨OpenShift Webæ§åˆ¶å°æ£€æŸ¥åº”ç”¨ç¨‹åºçš„å†…å­˜è¡Œä¸ºï¼Œå¹¶ç¡®ä¿åœ¨ä½¿ç”¨åŸºäºå†…å­˜çš„è‡ªåŠ¨ç¼©æ”¾ä¹‹å‰ï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºæ»¡è¶³è¿™äº›è¦æ±‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="horizontal-pod-autoscaler"&gt;æŸ¥çœ‹Horizontal Pod Autoscaler&lt;a class="headerlink" href="#horizontal-pod-autoscaler" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;è¦æŸ¥çœ‹Horizontal Pod Autoscalerçš„çŠ¶æ€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;oc get&lt;/code&gt;å‘½ä»¤å¯ä»¥æŸ¥çœ‹æœ‰å…³CPUåˆ©ç”¨ç‡å’Œå®¹å™¨ limits çš„ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;bash
$ oc get hpa/hpa-resource-metrics-cpu
NAME                         REFERENCE                                 TARGET    CURRENT  MINPODS        MAXPODS    AGE
hpa-resource-metrics-cpu     DeploymentConfig/default/frontend/scale   80%       79%      1              10         8d&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¾“å‡ºåŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç›®æ ‡(Target)&lt;/strong&gt;ã€‚ç”±éƒ¨ç½²é…ç½®æ§åˆ¶(deployment configuration)çš„æ‰€æœ‰podçš„ç›®æ ‡å¹³å‡CPUåˆ©ç”¨ç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Current&lt;/strong&gt;ã€‚ç”±éƒ¨ç½²é…ç½®(deployment configuration)æ§åˆ¶çš„æ‰€æœ‰podçš„å½“å‰CPUåˆ©ç”¨ç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Minpods/Maxpods&lt;/strong&gt;ã€‚autoscalerå¯ä»¥è®¾ç½®çš„æœ€å°å’Œæœ€å¤§å‰¯æœ¬æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;oc describe&lt;/code&gt;å‘½ä»¤è·å–æœ‰å…³Horizontal Pod Autoscalerå¯¹è±¡çš„è¯¦ç»†ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ oc describe hpa/hpa-resource-metrics-cpu
Name:                           hpa-resource-metrics-cpu
Namespace:                      default
Labels:                         &amp;lt;none&amp;gt;
CreationTimestamp:              Mon, &lt;span class="m"&gt;26&lt;/span&gt; Oct &lt;span class="m"&gt;2015&lt;/span&gt; &lt;span class="m"&gt;21&lt;/span&gt;:13:47 -0400
Reference:                      DeploymentConfig/default/frontend/scale
Target CPU utilization:         &lt;span class="m"&gt;80&lt;/span&gt;% 
Current CPU utilization:        &lt;span class="m"&gt;79&lt;/span&gt;% 
Min replicas:                   &lt;span class="m"&gt;1&lt;/span&gt; 
Max replicas:                   &lt;span class="m"&gt;4&lt;/span&gt; 
ReplicationController pods:     &lt;span class="m"&gt;1&lt;/span&gt; current / &lt;span class="m"&gt;1&lt;/span&gt; desired
Conditions: 
  Type                  Status  Reason                  Message
  ----                  ------  ------                  -------
  AbleToScale           True    ReadyForNewScale        the last scale &lt;span class="nb"&gt;time&lt;/span&gt; was sufficiently old as to warrant a new scale
  ScalingActive         True    ValidMetricFound        the HPA was able to successfully calculate a replica count from pods metric http_requests
  ScalingLimited        False   DesiredWithinRange      the desired replica count is within the acceptable range
Events:
&lt;/pre&gt;&lt;/div&gt;


&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Target CPU utilization&lt;/td&gt;
&lt;td&gt;æ¯ä¸ªpodåº”ä½¿ç”¨çš„è¯·æ±‚å†…å­˜çš„å¹³å‡ç™¾åˆ†æ¯”ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Current CPU utilization&lt;/td&gt;
&lt;td&gt;ç”±éƒ¨ç½²é…ç½®(deployment configuration)æ§åˆ¶çš„æ‰€æœ‰podçš„å½“å‰CPUåˆ©ç”¨ç‡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Min replicas&lt;/td&gt;
&lt;td&gt;è¦ç¼©å°åˆ°çš„æœ€å°å‰¯æœ¬æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Max replicas&lt;/td&gt;
&lt;td&gt;è¦æ‰©å±•åˆ°çš„æœ€å¤§å‰¯æœ¬æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Conditions&lt;/td&gt;
&lt;td&gt;å¦‚æœå¯¹è±¡ä½¿ç”¨&lt;code&gt;v2alpha1&lt;/code&gt;APIï¼Œåˆ™æ˜¾ç¤º&lt;a href="https://docs.openshift.com/container-platform/3.11/dev_guide/pod_autoscaling.html#viewing-a-hpa-status"&gt;status conditions&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="horizontal-pod-autoscaler-status-conditions"&gt;æŸ¥çœ‹Horizontal Pod Autoscaler Status Conditions&lt;a class="headerlink" href="#horizontal-pod-autoscaler-status-conditions" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;æ‚¨å¯ä»¥ä½¿ç”¨è®¾ç½®çš„çŠ¶æ€æ¡ä»¶(status conditions)æ¥ç¡®å®šHorizontal Pod Autoscaler æ˜¯å¦èƒ½å¤Ÿè¿›è¡Œç¼©æ”¾ä»¥åŠå½“å‰æ˜¯å¦ä»¥ä»»ä½•æ–¹å¼é™åˆ¶å®ƒã€‚&lt;/p&gt;
&lt;p&gt;è‡ªåŠ¨æ‰©å±•API &lt;code&gt;v2beta1&lt;/code&gt;çš„ç‰ˆæœ¬æä¾›Horizontal Pod Autoscaler Status Conditionsï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;kubernetesMasterConfig&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;...&lt;/span&gt;
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;apiServerArguments&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;runtime-config&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;apis/autoscaling/v2beta1=true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è®¾ç½®ä»¥ä¸‹çŠ¶æ€æ¡ä»¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;AbleToScale&lt;/code&gt; æŒ‡ç¤ºHorizontal Pod Autoscaler æ˜¯å¦èƒ½å¤Ÿè·å–å’Œæ›´æ–° scalesï¼Œä»¥åŠæ˜¯å¦æœ‰ä»»ä½•backoff æ¡ä»¶é˜»æ­¢ç¼©æ”¾ã€‚&lt;ul&gt;
&lt;li&gt;&lt;code&gt;True&lt;/code&gt;è¡¨ç¤ºç¼©æ”¾æ˜¯å…è®¸çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;False&lt;/code&gt;è¡¨ç¤ºå¯¹æŒ‡å®šçš„åŸå› ç¼©æ”¾ä¸å…è®¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ScalingActive&lt;/code&gt; æŒ‡ç¤ºæ˜¯å¦å¯ç”¨Horizontal Pod Autoscaler ï¼ˆç›®æ ‡çš„å‰¯æœ¬è®¡æ•°ä¸ä¸ºé›¶ï¼‰å¹¶ä¸”èƒ½å¤Ÿè®¡ç®—æ‰€éœ€çš„æ¯”ä¾‹ã€‚&lt;ul&gt;
&lt;li&gt;&lt;code&gt;True&lt;/code&gt;çŠ¶æ€è¡¨ç¤ºåº¦é‡å·¥ä½œæ­£å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;False&lt;/code&gt;æ¡ä»¶é€šå¸¸è¡¨æ˜ä¸è·å–æŒ‡æ ‡æ—¶é‡åˆ°é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ScalingLimited&lt;/code&gt; è¡¨ç¤ºä¸å…è®¸è‡ªåŠ¨ç¼©æ”¾ï¼Œå› ä¸ºè¾¾åˆ°äº†æœ€å¤§æˆ–æœ€å°å‰¯æœ¬è®¡æ•°ã€‚&lt;ul&gt;
&lt;li&gt;&lt;code&gt;True&lt;/code&gt;æ¡ä»¶è¡¨æ˜ï¼Œä¸ºäº†è¿›è¡Œç¼©æ”¾ä½ éœ€è¦æé«˜æˆ–é™ä½æœ€å°æˆ–æœ€å¤§å‰¯æœ¬æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;False&lt;/code&gt;çŠ¶æ€è¡¨æ˜è¯·æ±‚çš„æ¯”ä¾‹æ˜¯å…è®¸çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœæ‚¨éœ€è¦æ·»åŠ æˆ–ç¼–è¾‘æ­¤è¡Œï¼Œè¯·é‡æ–°å¯åŠ¨OpenShift Container PlatformæœåŠ¡ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#master-restart api&lt;/span&gt;
&lt;span class="c1"&gt;#master-restart controllers&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¦æŸ¥çœ‹å½±å“Horizontal Pod Autoscaler çš„æ¡ä»¶ï¼Œè¯·ä½¿ç”¨&lt;code&gt;oc describe hpa&lt;/code&gt;ã€‚æ¡ä»¶å‡ºç°åœ¨&lt;code&gt;status.conditions&lt;/code&gt;å­—æ®µä¸­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ oc describe hpa cm-test
Name:                           cm-test
Namespace:                      prom
Labels:                         &amp;lt;none&amp;gt;
Annotations:                    &amp;lt;none&amp;gt;
CreationTimestamp:              Fri, &lt;span class="m"&gt;16&lt;/span&gt; Jun &lt;span class="m"&gt;2017&lt;/span&gt; &lt;span class="m"&gt;18&lt;/span&gt;:09:22 +0000
Reference:                      ReplicationController/cm-test
Metrics:                        &lt;span class="o"&gt;(&lt;/span&gt; current / target &lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="s2"&gt;&amp;quot;http_requests&amp;quot;&lt;/span&gt; on pods:      66m / 500m
Min replicas:                   &lt;span class="m"&gt;1&lt;/span&gt;
Max replicas:                   &lt;span class="m"&gt;4&lt;/span&gt;
ReplicationController pods:     &lt;span class="m"&gt;1&lt;/span&gt; current / &lt;span class="m"&gt;1&lt;/span&gt; desired
Conditions: 
  Type                  Status  Reason                  Message
  ----                  ------  ------                  -------
  AbleToScale       True      ReadyForNewScale    the last scale &lt;span class="nb"&gt;time&lt;/span&gt; was sufficiently old as to warrant a new scale
  ScalingActive     True      ValidMetricFound    the HPA was able to successfully calculate a replica count from pods metric http_request
  ScalingLimited    False     DesiredWithinRange  the desired replica count is within the acceptable range
Events:
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Horizontal Pod Autoscaler Status Conditions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;AbleToScale&lt;/code&gt;æ¡ä»¶æŒ‡ç¤ºHPAæ˜¯å¦èƒ½å¤Ÿè·å–å’Œæ›´æ–°æ¯”ä¾‹ï¼Œä»¥åŠä»»ä½•ä¸backoffç›¸å…³çš„æ¡ä»¶æ˜¯å¦ä¼šé˜»æ­¢æ‰©å±•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ScalingActive&lt;/code&gt;çŠ¶å†µæŒ‡ç¤ºHPAæ˜¯å¦è¢«å¯ç”¨ï¼ˆä¾‹å¦‚ï¼Œç›®æ ‡çš„å‰¯æœ¬æ•°ä¸ä¸ºé›¶ï¼‰ï¼Œå¹¶èƒ½å¤Ÿè®¡ç®—æ‰€éœ€çš„scalesã€‚&lt;code&gt;False&lt;/code&gt;çŠ¶æ€é€šå¸¸è¡¨ç¤ºè·å–æŒ‡æ ‡çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ScalingLimited&lt;/code&gt;æ¡ä»¶æŒ‡ç¤ºæœŸæœ›scaleç”±Horizontal Pod Autoscalerçš„æœ€å¤§æˆ–æœ€å°ä¸Šé™ã€‚&lt;code&gt;True&lt;/code&gt;çŠ¶æ€ä¸€èˆ¬é¢„ç¤ºç€ä½ å¯èƒ½éœ€è¦åœ¨ä½ çš„æ°´å¹³èšè‡ªåŠ¨é…ç½®å™¨å‡é«˜æˆ–é™ä½çš„æœ€å°æˆ–æœ€å¤§å‰¯æœ¬æ•°é‡çš„é™åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯æ— æ³•æ‰©å±•çš„podçš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Conditions&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
  &lt;span class="n"&gt;Type&lt;/span&gt;           &lt;span class="n"&gt;Status&lt;/span&gt;    &lt;span class="n"&gt;Reason&lt;/span&gt;            &lt;span class="n"&gt;Message&lt;/span&gt;
  &lt;span class="o"&gt;----&lt;/span&gt;           &lt;span class="o"&gt;------&lt;/span&gt;    &lt;span class="o"&gt;------&lt;/span&gt;            &lt;span class="o"&gt;-------&lt;/span&gt;
  &lt;span class="n"&gt;AbleToScale&lt;/span&gt;    &lt;span class="n"&gt;False&lt;/span&gt;     &lt;span class="n"&gt;FailedGetScale&lt;/span&gt;    &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;HPA&lt;/span&gt; &lt;span class="n"&gt;controller&lt;/span&gt; &lt;span class="n"&gt;was&lt;/span&gt; &lt;span class="n"&gt;unable&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="kd"&gt;get&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="n"&gt;current&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;replicationcontrollers&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;extensions&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;hello-hpa-cpu&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;not&lt;/span&gt; &lt;span class="n"&gt;found&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä»¥ä¸‹æ˜¯æ— æ³•è·å–ç¼©æ”¾æ‰€éœ€podçš„æŒ‡æ ‡ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Conditions&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
  &lt;span class="n"&gt;Type&lt;/span&gt;                  &lt;span class="n"&gt;Status&lt;/span&gt;    &lt;span class="n"&gt;Reason&lt;/span&gt;                    &lt;span class="n"&gt;Message&lt;/span&gt;
  &lt;span class="o"&gt;----&lt;/span&gt;                  &lt;span class="o"&gt;------&lt;/span&gt;    &lt;span class="o"&gt;------&lt;/span&gt;                    &lt;span class="o"&gt;-------&lt;/span&gt;
  &lt;span class="n"&gt;AbleToScale&lt;/span&gt;           &lt;span class="n"&gt;True&lt;/span&gt;     &lt;span class="n"&gt;SucceededGetScale&lt;/span&gt;          &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;HPA&lt;/span&gt; &lt;span class="n"&gt;controller&lt;/span&gt; &lt;span class="n"&gt;was&lt;/span&gt; &lt;span class="n"&gt;able&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="kd"&gt;get&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="n"&gt;current&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt;
  &lt;span class="n"&gt;ScalingActive&lt;/span&gt;         &lt;span class="n"&gt;False&lt;/span&gt;    &lt;span class="n"&gt;FailedGetResourceMetric&lt;/span&gt;    &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;HPA&lt;/span&gt; &lt;span class="n"&gt;was&lt;/span&gt; &lt;span class="n"&gt;unable&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;compute&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;replica&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;unable&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="kd"&gt;get&lt;/span&gt; &lt;span class="n"&gt;metrics&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;resource&lt;/span&gt; &lt;span class="n"&gt;cpu&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;no&lt;/span&gt; &lt;span class="n"&gt;metrics&lt;/span&gt; &lt;span class="n"&gt;returned&lt;/span&gt; &lt;span class="n"&gt;from&lt;/span&gt; &lt;span class="n"&gt;heapster&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä»¥ä¸‹æ˜¯è¯·æ±‚çš„è‡ªåŠ¨ç¼©æ”¾å°äºæ‰€éœ€æœ€å°å€¼çš„podç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Conditions&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
  &lt;span class="n"&gt;Type&lt;/span&gt;              &lt;span class="n"&gt;Status&lt;/span&gt;    &lt;span class="n"&gt;Reason&lt;/span&gt;              &lt;span class="n"&gt;Message&lt;/span&gt;
  &lt;span class="o"&gt;----&lt;/span&gt;              &lt;span class="o"&gt;------&lt;/span&gt;    &lt;span class="o"&gt;------&lt;/span&gt;              &lt;span class="o"&gt;-------&lt;/span&gt;
  &lt;span class="n"&gt;AbleToScale&lt;/span&gt;       &lt;span class="n"&gt;True&lt;/span&gt;      &lt;span class="n"&gt;ReadyForNewScale&lt;/span&gt;    &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;last&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt; &lt;span class="n"&gt;was&lt;/span&gt; &lt;span class="n"&gt;sufficiently&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;warrant&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt;
  &lt;span class="n"&gt;ScalingActive&lt;/span&gt;     &lt;span class="n"&gt;True&lt;/span&gt;      &lt;span class="n"&gt;ValidMetricFound&lt;/span&gt;    &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;HPA&lt;/span&gt; &lt;span class="n"&gt;was&lt;/span&gt; &lt;span class="n"&gt;able&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;successfully&lt;/span&gt; &lt;span class="n"&gt;calculate&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;replica&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="n"&gt;from&lt;/span&gt; &lt;span class="n"&gt;pods&lt;/span&gt; &lt;span class="n"&gt;metric&lt;/span&gt; &lt;span class="n"&gt;http_request&lt;/span&gt;
  &lt;span class="n"&gt;ScalingLimited&lt;/span&gt;    &lt;span class="n"&gt;False&lt;/span&gt;     &lt;span class="n"&gt;DesiredWithinRange&lt;/span&gt;  &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;desired&lt;/span&gt; &lt;span class="n"&gt;replica&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;within&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;acceptable&lt;/span&gt; &lt;span class="n"&gt;range&lt;/span&gt;
&lt;span class="n"&gt;Events&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Tue, 14 May 2019 22:06:59 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-05-14:/openshift-pod-autoscaling.html</guid><category>openshift</category><category>containers</category><category>docker</category><category>k8s</category></item><item><title>æˆ‘çš„ä¸ªäººåšå®¢è¿ç§»åˆ°Dockerå•¦</title><link>https://www.EWhisper.cn/ewhisper-blog-moved-to-docker.html</link><description>&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#_1"&gt;ç½‘ç«™æ¶æ„&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#_2"&gt;æ•°æ®æµå‘&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_3"&gt;ç½‘ç«™æ¶æ„&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#_4"&gt;å®¹å™¨åŒ–ç®€å•æ­¥éª¤&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#nginx"&gt;ç›´æ¥å¯åŠ¨NGINXå®¹å™¨&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#_5"&gt;å…¶ä»–å®¹å™¨åŒ–æ–¹å¼&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#dockerfile"&gt;Dockerfile å°è£…é•œåƒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-docker-compose"&gt;ç®€å•å®¹å™¨ç¼–æ’å·¥å…· - docker compose&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#_6"&gt;æŸ¥çœ‹çŠ¶æ€å’Œæ—¥å¿—&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;2019å¹´5æœˆ10æ—¥èµ·, æˆ‘çš„ä¸ªäººåšå®¢ - https://www.EWhisper.cn æ­£å¼è¿è¡Œåœ¨dockeré‡Œè¾¹äº†! &lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt; &lt;/p&gt;
&lt;p&gt;æˆ‘æŠŠç›¸å…³çš„æºç , Dockeré•œåƒåˆ†åˆ«ä¸Šä¼ åˆ°äº†GitHubå’ŒDocker Hub. åœ°å€å¦‚ä¸‹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;GitHub: https://github.com/east4ming/my-tencentyun-nginx&lt;/li&gt;
&lt;li&gt;Docker Hub: https://cloud.docker.com/u/caseycui/repository/docker/caseycui/my-tencentyun-nginx&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="æ¬¢è¿ä¸Š&amp;quot;èˆ¹&amp;quot;" src="./images/illustration-com-container-party.png"&gt;&lt;/p&gt;
&lt;h2 id="_1"&gt;ç½‘ç«™æ¶æ„&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="_2"&gt;æ•°æ®æµå‘&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;æˆ‘çš„åšå®¢ç½‘ç«™çš„æ¶æ„å…¶å®&lt;strong&gt;éå¸¸éå¸¸&lt;/strong&gt;ç®€å•. è¯´ç™½äº†, å°±æ˜¯&lt;strong&gt;NGINX + é™æ€é¡µé¢&lt;/strong&gt;. (å¯¹çš„, ä½ æ²¡æœ‰çœ‹é”™, æˆ‘çš„ç½‘ç«™æ˜¯ä¸ªå…¨é™æ€ç½‘ç«™, æ²¡æœ‰åŠ¨æ€é¡µé¢). &lt;/p&gt;
&lt;p&gt;ä¹‹å‰çš„æ•°æ®æµå‘å¤§æ¦‚æ˜¯:&lt;/p&gt;
&lt;p&gt;ç”¨æˆ· -&amp;gt; åŸŸå -&amp;gt; DNS -&amp;gt; è…¾è®¯äº‘ä¸»æœºå¤–ç½‘IP -&amp;gt; è…¾è®¯äº‘ä¸»æœºå†…ç½‘IP -&amp;gt; NGINX 80å’Œ443ç«¯å£  (NGINXä½œä¸ºWeb Server, åç«¯æ²¡æœ‰App Serverå’ŒDB)&lt;/p&gt;
&lt;p&gt;ç°åœ¨åŠ äº†ä¸€å±‚Docker, å¤šäº†ä¸€å±‚ ä¸»æœº -&amp;gt; docker sdnçš„è½¬å‘. å¦‚ä¸‹:&lt;/p&gt;
&lt;p&gt;ç”¨æˆ· -&amp;gt; åŸŸå -&amp;gt; DNS -&amp;gt; è…¾è®¯äº‘ä¸»æœºå¤–ç½‘IP -&amp;gt; è…¾è®¯äº‘ä¸»æœºå†…ç½‘IP -&amp;gt; &lt;strong&gt;Docker SDNç«¯å£æ˜ å°„&lt;/strong&gt;(443æŒ‡å‘dockerçš„443, 80ä¹‹ä¸‹é‚£ä¸ªdockerçš„80) -&amp;gt; Dockerçš„NGINXå®¹å™¨çš„ 80å’Œ443ç«¯å£ &lt;/p&gt;
&lt;h3 id="_3"&gt;ç½‘ç«™æ¶æ„&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ä»å¤´å¼€å§‹è¯´èµ·å§, æˆ‘çš„åšå®¢æ˜¯ä¸€ä¸ª&lt;strong&gt;é™æ€ç«™ç‚¹&lt;/strong&gt;. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æˆ‘å†™åšæ–‡æ˜¯å…ˆé€šè¿‡MarkDown å†™.mdæ ¼å¼çš„æ–‡æœ¬.&lt;/li&gt;
&lt;li&gt;ç„¶åé€šè¿‡&lt;strong&gt;é™æ€ç«™ç‚¹ç”Ÿæˆå™¨&lt;/strong&gt;(static site generator) -- &lt;a href="http://www.getpelican.com/"&gt;Pelican&lt;/a&gt; (æˆ‘ç”¨çš„è¿™ä¸ªä¸ç®—æœ€ä¸»æµçš„, ä¸»æµçš„å¦‚: Hexoç­‰)å°†æˆ‘çš„MarkDown æ–‡æœ¬, æ ¹æ®Pelicanä¸­å®šä¹‰çš„ä¸»é¢˜, æ¸²æŸ“ä¸ºä¸€ä¸ªç›¸åº”é£æ ¼HTMLæ–‡ä»¶. &lt;/li&gt;
&lt;li&gt;æ•´ä¸ªç«™ç‚¹, åŒ…æ‹¬ä»¥ä¸‹å†…å®¹éƒ½æ˜¯ä¸€ä¸ªä¸ªçš„HTMLé¡µé¢.&lt;ol&gt;
&lt;li&gt;Indexé¡µé¢&lt;/li&gt;
&lt;li&gt;about  å’Œ contact é¡µé¢&lt;/li&gt;
&lt;li&gt;æ ‡ç­¾ ç±»åˆ«é¡µé¢&lt;/li&gt;
&lt;li&gt;RSS è®¢é˜…é¡µé¢&lt;/li&gt;
&lt;li&gt;æ¯ä¸€ç¯‡åšæ–‡&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;æ•´ä¸ªç½‘ç«™å‘¢, å®é™…ä¸Šå°±æ˜¯:&lt;ol&gt;
&lt;li&gt;HTML(å’ŒCSS JS)&lt;/li&gt;
&lt;li&gt;é™æ€å†…å®¹(å¦‚: å›¾ç‰‡, å›¾ç‰‡ç›®å‰éƒ¨åˆ†åœ¨æœ¬åœ°, éƒ¨åˆ†è°ƒç”¨å›¾åºŠå¤–é“¾å¦‚&lt;a href="https://www.yupoo.com"&gt;åˆæ‹&lt;/a&gt; ä¸ƒç‰› CNDç­‰)&lt;/li&gt;
&lt;li&gt;å…¶ä»–åŠŸèƒ½é€šè¿‡æ’ä»¶(ä¹Ÿæ˜¯JS, å¤–éƒ¨çš„JS)å®ç°, å¦‚:&lt;ol&gt;
&lt;li&gt;è¯„è®ºæ¡† (å›½å†…å¯èƒ½çœ‹ä¸è§, è¢«å±è”½äº†....)&lt;/li&gt;
&lt;li&gt;è½¬å‘æ¡&lt;/li&gt;
&lt;li&gt;...&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Pelican ç”Ÿæˆçš„æ‰€æœ‰çš„é™æ€ç«™ç‚¹å†…å®¹, éƒ½å…¨éƒ¨é€šè¿‡rsyncç­‰å·¥å…·åŒæ­¥åˆ°æˆ‘çš„è…¾è®¯äº‘ä¸»æœºçš„&lt;code&gt;/usr/share/nginx/html&lt;/code&gt; ç›®å½•ä¸‹, å¹¶å¯åŠ¨NGINX, é…ç½®80, 443ç«¯å£ç›‘å¬å¹¶å¤„ç†é™æ€å†…å®¹å°±å¯ä»¥äº†.  &lt;ol&gt;
&lt;li&gt;ä»¥å‰, æˆ‘æ˜¯ç›´æ¥é€šè¿‡&lt;code&gt;systemctl&lt;/code&gt; åœ¨äº‘ä¸»æœºä¸Šå¯åŠ¨çš„NGINX&lt;/li&gt;
&lt;li&gt;ç°åœ¨, æ˜¯é€šè¿‡dockerå¯åŠ¨çš„NGINXé•œåƒ.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="_4"&gt;å®¹å™¨åŒ–ç®€å•æ­¥éª¤&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;å› ä¸ºæˆ‘è¿™ä¸ªåªæ¶‰åŠNGINXçš„å®¹å™¨åŒ–, è€Œä¸”NGINXæœ‰å®˜æ–¹æä¾›çš„æ ‡å‡†é•œåƒ. æ‰€ä»¥å®¹å™¨åŒ–éå¸¸ç®€å•, æœ€ç®€å•çš„æ–¹å¼, å°±æ˜¯&lt;strong&gt;ç›´æ¥å¯åŠ¨NGINXå®¹å™¨&lt;/strong&gt;, å¦‚ä¸‹:&lt;/p&gt;
&lt;h3 id="nginx"&gt;ç›´æ¥å¯åŠ¨NGINXå®¹å™¨&lt;a class="headerlink" href="#nginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;å…¶å®, ç›´æ¥å¯åŠ¨&lt;strong&gt;NGINX&lt;/strong&gt;å®¹å™¨å°±å¥½äº†, ä½ åªéœ€è¦æŠŠä»¥ä¸‹å†…å®¹æŒ‚è½½å·æˆ–è€…æš´éœ²å‡ºæ¥:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æŒ‚è½½å·&lt;ol&gt;
&lt;li&gt;NGINXç›¸å…³é…ç½®(åŒ…æ‹¬: &lt;code&gt;/etc/nginx&lt;/code&gt;ä¸‹é¢çš„nginx.confæ–‡ä»¶, conf.då’Œdefault.dæ–‡ä»¶å¤¹)&lt;/li&gt;
&lt;li&gt;é™æ€ç«™ç‚¹æ–‡ä»¶(pelicanç”Ÿæˆçš„, æ”¾åˆ°&lt;code&gt;/usr/share/nginx/html&lt;/code&gt;çš„æ–‡ä»¶)&lt;/li&gt;
&lt;li&gt;è¯ä¹¦æ–‡ä»¶(å‘äº‘ä¾›åº”å•†æˆ–è¯ä¹¦ä¾›åº”å•†ç”³è¯·åˆ°çš„è¯ä¹¦, æ”¾åˆ°&lt;code&gt;/etc/pki/nginx&lt;/code&gt; æ–‡ä»¶å¤¹)&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;æš´éœ²ç«¯å£&lt;ol&gt;
&lt;li&gt;80&lt;/li&gt;
&lt;li&gt;443&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å‘½ä»¤å¦‚ä¸‹: &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo docker run --name my-tencentyun-nginx -d &lt;span class="se"&gt;\&lt;/span&gt;
  -p &lt;span class="m"&gt;80&lt;/span&gt;:80 -p &lt;span class="m"&gt;443&lt;/span&gt;:443 &lt;span class="se"&gt;\&lt;/span&gt;
  -v /etc/nginx/nginx.conf:/etc/nginx/nginx.conf &lt;span class="se"&gt;\&lt;/span&gt;
  -v /etc/nginx/conf.d:/etc/nginx/conf.d &lt;span class="se"&gt;\&lt;/span&gt;
  -v /etc/nginx/default.d:/etc/nginx/default.d &lt;span class="se"&gt;\&lt;/span&gt;
  -v /usr/share/nginx/html:/usr/share/nginx/html &lt;span class="se"&gt;\&lt;/span&gt;
  -v /etc/pki/nginx:/etc/pki/nginx:ro &lt;span class="se"&gt;\&lt;/span&gt;
  nginx
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸Šé¢çš„å‘½ä»¤å°±ä¸ç»†è¯´äº†, å¾ˆå®¹æ˜“ç†è§£çš„. &lt;code&gt;-p&lt;/code&gt;æ˜¯æš´éœ²ç«¯å£, &lt;code&gt;-v&lt;/code&gt;æ˜¯æŠŠä¸»æœºçš„ç£ç›˜æŒ‚è½½åˆ°å®¹å™¨é‡Œ, &lt;code&gt;-d&lt;/code&gt;æ˜¯åå°è¿è¡Œ.&lt;/p&gt;
&lt;p&gt;å¯åŠ¨å, ä½ çš„NGINX dockerå®¹å™¨å°±ä¼šè‡ªåŠ¨ä¸‹è½½å¹¶å¯åŠ¨è¿è¡Œ, ä½ çš„ç½‘ç«™ä¹Ÿå¯ä»¥æ­£å¼å¯¹å¤–æœåŠ¡å•¦. &lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;/p&gt;
&lt;h2 id="_5"&gt;å…¶ä»–å®¹å™¨åŒ–æ–¹å¼&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;è‡ªå·±æœ¬åœ°æˆ–å•æœºç©ç©, ä¸Šè¾¹çš„å®¹å™¨åŒ–æ–¹å¼å®Œå…¨å¤Ÿç”¨äº†. ä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰ä»¥ä¸‹éœ€æ±‚:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¤šäººåˆä½œ. éœ€è¦å°è£…æˆæ–°çš„é•œåƒ, å°†é•œåƒæä¾›ç»™åˆ«äººä½¿ç”¨.&lt;/li&gt;
&lt;li&gt;æ›´å¥½åœ°ç¼–æ’ä¸ç®¡ç†. ç®¡ç†ä¸€ä¸ªé¡¹ç›®, éœ€è¦å¯åŠ¨å¤šå°‘ä¸ªweb server, å¤šå°‘ä¸ªapp server, å¤šå°‘ä¸ªdb. ç›¸äº’ä¹‹é—´å¦‚ä½•äº¤äº’.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é‚£ä¹ˆä¹…éœ€è¦å…¶ä»–çš„å®¹å™¨åŒ–æ–¹å¼.&lt;/p&gt;
&lt;h3 id="dockerfile"&gt;Dockerfile å°è£…é•œåƒ&lt;a class="headerlink" href="#dockerfile" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™ç§å…¶å®æ˜¯å›¢é˜Ÿ, å…¬å¸, æˆ–ç”Ÿäº§ä¸Šæ¨èçš„ä¸€ç§æ–¹å¼. å¼€å‘è´Ÿè´£å†™ä»£ç , ç¼–è¯‘ä»£ç , å†™Dockerfile, æ„å»ºé•œåƒ. å¹¶æŠŠé•œåƒä¸Šä¼ åˆ°å…±æœ‰æˆ–ç§æœ‰çš„é•œåƒä»“åº“. ç„¶åå¦å¤–çš„å›¢é˜Ÿè§’è‰², å¦‚: æµ‹è¯•, è¿ç»´, å†ä»ä»“åº“ä¸­æ‹‰å–é•œåƒå¹¶å¯åŠ¨, æµ‹è¯•, ä¸Šçº¿. &lt;/p&gt;
&lt;p&gt;è¿™ä¹Ÿå®ç°äº†dockerçš„æœ€å¤§ä¼˜åŠ¿, ä»–ä»¬çš„slogan: &lt;strong&gt;"build, share and run any application, anywhere"&lt;/strong&gt;. &lt;/p&gt;
&lt;p&gt;èƒ½åšåˆ°è¿™ä¸€ç‚¹, ä¹Ÿæ˜¯å› ä¸ºOS+è¯­è¨€+ç»„ä»¶+åº”ç”¨åŒ…, æ•´ä¸ªæ‰“åŒ…æˆäº†ä¸€ä¸ªé•œåƒ, å®ç°äº†ç¯å¢ƒçš„ä¸€è‡´æ€§.&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ä¸ªæœ‰ç‚¹, å› ä¸ºæœ‰Dockerfile, ä¹Ÿæ–¹ä¾¿è¿›è¡Œè¿½æº¯å’Œç†è§£é•œåƒ. (å¦‚æœåªæ˜¯ä¸€ä¸ªé•œåƒçš„è¯, å¾ˆéš¾çŸ¥é“é•œåƒæ˜¯æ€ä¹ˆåšå‡ºæ¥çš„).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ­¥éª¤&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;åˆ›å»ºä¸ªé¡¹ç›®, æœ¬åœ°æ–‡ä»¶å¤¹æ˜¯&lt;strong&gt;my-tencentyun-nginx&lt;/strong&gt;, GitHubæ˜¯: https://github.com/east4ming/my-tencentyun-nginx&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å°†ç›¸å…³æºç å’Œç«™ç‚¹æ–‡ä»¶æ”¾åˆ°è¯¥ç›®å½•ä¸­(é…ç½®æ–‡ä»¶, ç«™ç‚¹æ–‡ä»¶, è¯ä¹¦)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;Â æ³¨æ„: &lt;/p&gt;
&lt;p&gt;è¯ä¹¦keyåŒ…å«é‡è¦çš„ç§å¯†ä¿¡æ¯, åƒä¸‡ä¸è¦ä¸Šä¼ åˆ°å…¬ç½‘ä¸Š!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ›å»º&lt;code&gt;Dockerfile&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ„å»ºé•œåƒ: &lt;code&gt;sudo docker build -t caseycui/my-tencentyun-nginx .&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(å¯é€‰) æ¨é€é•œåƒåˆ°Docker Hub: &lt;code&gt;sudo docker push caseycui/my-tencentyun-nginx&lt;/code&gt; (æˆ‘è¿™è¾¹æ˜¯Docker Hubç›´æ¥oauthè¿æ¥åˆ°Github, æˆ‘çš„å¯¹åº”çš„Githubä»“åº“ä»£ç æœ‰æ›´æ–°, å°±ä¼šè‡ªåŠ¨æ„å»º)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¿è¡Œé•œåƒ: &lt;code&gt;sudo docker run --name my-tencentyun-nginx -v /etc/pki/nginx:/etc/pki/nginx:ro -d -p 80:80 -p 443:443 caseycui/my-tencentyun-nginx&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Dockerfile å¦‚ä¸‹:&lt;/p&gt;
&lt;p&gt;æœ€ç®€å•çš„Dockerfile, å°±æ˜¯åœ¨nginxé•œåƒçš„åŸºç¡€ä¸Š, æŠŠæˆ‘ä»¬è‡ªå·±çš„nginxé…ç½®æ–‡ä»¶å’Œé™æ€ç«™ç‚¹æ–‡ä»¶å¤åˆ¶è¿›å», ç”Ÿæˆä¸€ä¸ªæ–°é•œåƒ.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; nginx:latest&lt;/span&gt;

&lt;span class="k"&gt;COPY&lt;/span&gt; pelican-output /usr/share/nginx/html
&lt;span class="k"&gt;COPY&lt;/span&gt; nginx.conf /etc/nginx/nginx.conf
&lt;span class="k"&gt;COPY&lt;/span&gt; default.d /etc/nginx/default.d
&lt;span class="c"&gt;#COPY conf.d /etc/nginx/conf.d  # è¿™è¾¹æ³¨é‡Šæ‰, æ˜¯å› ä¸ºè¿™ä¸ªç›®å½•é‡Œè¿˜æ²¡æœ‰å†…å®¹&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="-docker-compose"&gt;ç®€å•å®¹å™¨ç¼–æ’å·¥å…· - docker compose&lt;a class="headerlink" href="#-docker-compose" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;docker composeæ˜¯dockerå®˜æ–¹å‡ºå“çš„å®¹å™¨ç¼–æ’å·¥å…·, ç®€å•æ˜“ç”¨. å°è§„æ¨¡ç”¨ç”¨è¿˜æ˜¯æŒºèˆ’æœçš„. å¤§è§„æ¨¡, ä¼ä¸šçº§çš„ç°åœ¨éƒ½æ˜¯ä½¿ç”¨Kubernetes.&lt;/p&gt;
&lt;p&gt;æˆ‘è¿™é‡Œç”¨docker composeå…¶å®æ˜¯æ€é¸¡ç”¨ç‰›åˆ€äº†, æ²¡å•¥å¿…è¦. å®ƒé€‚ç”¨äºå“ªç§åœºæ™¯å‘¢? &lt;/p&gt;
&lt;p&gt;æ¯”å¦‚, æˆ‘ä¸€ä¸ªé¡¹ç›®è¦ä¸Šçº¿, åŒ…æ‹¬: web server, app server, db. é‚£ä¹ˆè¿™æ—¶å€™docker composeå°±å¾ˆåˆé€‚äº†. é€šè¿‡å®ƒæ¥ç¼–æ’è¿™3ç±»å®¹å™¨, ä½¿å®ƒä»¬ç›¸äº’åä½œå’Œäº¤äº’. &lt;/p&gt;
&lt;p&gt;docker-composeæ˜¯é€šè¿‡&lt;code&gt;docker-compose.yaml&lt;/code&gt;æ¥å®šä¹‰è¿™äº›ç¼–æ’å†…å®¹çš„. ç¤ºä¾‹å¦‚ä¸‹:&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªwebå®¹å™¨, ä¸€ä¸ªrediså®¹å™¨. æŒ‚è½½å“ªäº›å·, æ€ä¹ˆç¼–è¯‘...&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;3&amp;#39;&lt;/span&gt;
&lt;span class="nt"&gt;services&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;web&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
    &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;5000:5000&amp;quot;&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.:/code&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;logvolume01:/var/log&lt;/span&gt;
    &lt;span class="nt"&gt;links&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;redis&lt;/span&gt;
  &lt;span class="nt"&gt;redis&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;redis&lt;/span&gt;
&lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;logvolume01&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;{}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;æ­¥éª¤&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;åˆ›å»º&lt;code&gt;docker-compose.yaml&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;web&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;nginx&lt;/span&gt;
  &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
   &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;./nginx.conf:/etc/nginx/nginx.conf&lt;/span&gt;
   &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;./default.d:/etc/nginx/default.d&lt;/span&gt;
   &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;./conf.d:/etc/nginx/conf.d&lt;/span&gt;
   &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;./pelican-output:/usr/share/nginx/html&lt;/span&gt;
   &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/etc/pki/nginx:/etc/pki/nginx:ro&lt;/span&gt;
  &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
   &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;80:80&amp;quot;&lt;/span&gt;
   &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;443:443&amp;quot;&lt;/span&gt;
  &lt;span class="nt"&gt;command&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;[&lt;/span&gt;&lt;span class="nv"&gt;nginx&lt;/span&gt;&lt;span class="p p-Indicator"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;-g&amp;#39;&lt;/span&gt;&lt;span class="p p-Indicator"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;daemon&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;off;&amp;#39;&lt;/span&gt;&lt;span class="p p-Indicator"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿è¡Œ: &lt;code&gt;sudo nohup docker-compose up &amp;amp;&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="_6"&gt;æŸ¥çœ‹çŠ¶æ€å’Œæ—¥å¿—&lt;a class="headerlink" href="#_6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æŸ¥çœ‹çŠ¶æ€: &lt;code&gt;sudo docker ps &amp;lt;container name&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æ—¥å¿—: &lt;code&gt;sudo dockerÂ logsÂ &amp;lt;containerÂ name&amp;gt;&lt;/code&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Fri, 10 May 2019 10:32:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-05-10:/ewhisper-blog-moved-to-docker.html</guid><category>nginx</category><category>github</category><category>docker</category><category>containers</category></item><item><title>ä½¿ç”¨OpenShiftè¿›è¡ŒäºŒè¿›åˆ¶æ„å»º</title><link>https://www.EWhisper.cn/binary-builds-with-openshift.html</link><description>&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#_1"&gt;ä»‹ç»&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#_2"&gt;ç”¨ä¾‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_3"&gt;é™åˆ¶&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#_4"&gt;æ•™ç¨‹æ¦‚è¿°&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#_5"&gt;æ•™ç¨‹ï¼šæ„å»ºæœ¬åœ°ä»£ç æ›´æ”¹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_6"&gt;æ•™ç¨‹ï¼šæ„å»ºç§æœ‰ä»£ç &lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#pipeline"&gt;æ•™ç¨‹ï¼šæ¥è‡ª pipeline çš„äºŒè¿›åˆ¶å·¥ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id="_1"&gt;ä»‹ç»&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;OpenShift æ¨èå’Œå¸¸ç”¨çš„æ„å»ºæ–¹å¼æ˜¯: ç›´æ¥ä»ä»£ç ä»“åº“(å¦‚GIT æˆ–SVN)ä¸­æ‹‰å–æºç è¿›è¡Œæ„å»º(å³æºç æ„å»º). ä½†æ˜¯è¿™ä¸€ç§æ„å»ºæ–¹å¼å¹¶ä¸èƒ½æ»¡è¶³æ‰€æœ‰çš„éœ€æ±‚, æ‰€ä»¥è¿˜æœ‰ä¸€ç§æ„å»ºæ–¹å¼å°±æ˜¯: äºŒè¿›åˆ¶æ„å»º. äºŒè¿›åˆ¶æ„å»ºé€‚ç”¨äºä»¥ä¸‹2ä¸ªåœºæ™¯:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¼€å‘äººå‘˜æœ¬åœ°å¼€å‘è°ƒè¯•ä»£ç å¹¶æ„å»º;&lt;/li&gt;
&lt;li&gt;OpenShiftå’Œ CI/CDçš„pipelineè¿›è¡Œæ•´åˆ, è·å–ä»å‰è¾¹å¹³å°(å¦‚è‡ªåŠ¨åŒ–å¼€å‘å¹³å°æˆ–æµ‹è¯•å¹³å°)ä¼ è¿‡æ¥çš„å·¥ä»¶(å³äºŒè¿›åˆ¶åŒ…)å¹¶æ„å»ºä¸ºé•œåƒ.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;OpenShiftä¸­çš„äºŒè¿›åˆ¶æ„å»ºåŠŸèƒ½å…è®¸å¼€å‘äººå‘˜å°†æºä»£ç æˆ–å·¥ä»¶ç›´æ¥ä¸Šä¼ åˆ°æ„å»º(build)ï¼Œè€Œä¸æ˜¯ä»Gitå­˜å‚¨åº“URL pulléœ€è¦æ„å»ºçš„æºã€‚é€šè¿‡æºä»£ç ï¼ŒDockeræˆ–è‡ªå®šä¹‰æ„å»ºç­–ç•¥çš„ BuildConfig éƒ½å¯ä»¥ä½œä¸ºäºŒè¿›åˆ¶æ„å»ºå¯åŠ¨ã€‚ä»æœ¬åœ°å·¥ä»¶å¯åŠ¨æ„å»ºæ—¶ï¼Œç°æœ‰æºå¼•ç”¨å°†æ›¿æ¢ä¸ºæ¥è‡ªæœ¬åœ°ç”¨æˆ·è®¡ç®—æœºçš„æºã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨å‡ ç§æ–¹å¼æä¾›æºï¼Œè¿™äº›æ–¹å¼å¯¹åº”äºä½¿ç”¨&lt;code&gt;start-build&lt;/code&gt;å‘½ä»¤æ—¶å¯ç”¨çš„å‚æ•°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»æ–‡ä»¶ï¼ˆ&lt;code&gt;--from-file&lt;/code&gt;ï¼‰ï¼šå½“æ„å»ºçš„æ•´ä¸ªæºåŒ…å«å•ä¸ªæ–‡ä»¶æ—¶å°±æ˜¯è¿™ç§æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½æ˜¯ç”¨äºDockeræ„å»ºçš„&lt;code&gt;Dockerfile&lt;/code&gt;ï¼Œç”¨äºJavaåº”ç”¨æ„å»ºçš„&lt;code&gt;pom.xml&lt;/code&gt;ï¼Œæˆ–ç”¨äºRubyæ„å»ºçš„&lt;code&gt;Gemfile&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä»ç›®å½•ï¼ˆ&lt;code&gt;--from-directory&lt;/code&gt;ï¼‰ï¼šå½“æºåœ¨æœ¬åœ°ç›®å½•ä¸­å¹¶ä¸”æœªæäº¤åˆ°Gitå­˜å‚¨åº“æ—¶ä½¿ç”¨æ­¤ç›®å½•ã€‚&lt;code&gt;start-build&lt;/code&gt; å‘½ä»¤å°†åˆ›å»ºç»™å®šç›®å½•çš„å­˜æ¡£ï¼Œå¹¶å°†å…¶ä½œä¸ºæºä¸Šä¼ åˆ°æ„å»ºå™¨(builder)ã€‚&lt;/li&gt;
&lt;li&gt;ä»å­˜æ¡£ï¼ˆ&lt;code&gt;--from-archive&lt;/code&gt;ï¼‰ï¼šå½“å…·æœ‰æºçš„å­˜æ¡£å·²å­˜åœ¨æ—¶ä½¿ç”¨æ­¤é€‰é¡¹ã€‚è¯¥å­˜æ¡£å¯ä»¥æ˜¯&lt;code&gt;tar&lt;/code&gt;ï¼Œ&lt;code&gt;tar.gz&lt;/code&gt;æˆ–&lt;code&gt;zip&lt;/code&gt;æ ¼å¼ã€‚&lt;/li&gt;
&lt;li&gt;ä»Gitå­˜å‚¨åº“ï¼ˆ&lt;code&gt;--from-repo&lt;/code&gt;ï¼‰ï¼šæºæ˜¯å½“å‰ç”¨æˆ·æœ¬åœ°è®¡ç®—æœºä¸Šçš„Gitå­˜å‚¨åº“çš„ä¸€éƒ¨åˆ†ã€‚å½“å‰å­˜å‚¨åº“çš„HEAD commitå°†è¢«å­˜æ¡£å¹¶å‘é€åˆ°OpenShiftè¿›è¡Œæ„å»ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="_2"&gt;ç”¨ä¾‹&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;äºŒè¿›åˆ¶æ„å»ºé€‚ç”¨äºæ— æ³•ä»ç°æœ‰Gitå­˜å‚¨åº“ä¸­æå–æºçš„éœ€æ±‚ã€‚ä½¿ç”¨äºŒè¿›åˆ¶æ„å»ºçš„åŸå› åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ„å»ºå’Œæµ‹è¯•æœ¬åœ°ä»£ç çš„å˜æ›´ã€‚å…‹éš†æ¥è‡ªå…¬å…±å­˜å‚¨åº“çš„æºï¼Œå¹¶å°†æœ¬åœ°å˜æ›´ä¸Šä¼ åˆ°OpenShiftè¿›è¡Œæ„å»ºã€‚è€Œæ— éœ€åœ¨ä»»ä½•åœ°æ–¹æäº¤æˆ–æ¨é€æœ¬åœ°æ›´æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;æ„å»ºç§æœ‰ä»£ç ã€‚æ–°æ„å»ºå¯ä»¥ä½œä¸ºäºŒè¿›åˆ¶æ„å»ºä»å¤´å¼€å§‹ã€‚ç„¶åå¯ä»¥å°†æºç›´æ¥ä»æœ¬åœ°å·¥ä½œç«™ä¸Šä¼ åˆ°OpenShiftï¼Œè€Œæ— éœ€å°†å…¶ç­¾å…¥SCMã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å…¶ä»–æ¥æºçš„å·¥ä»¶æ„å»ºé•œåƒã€‚é€šè¿‡Jenkins pipelineï¼ŒäºŒè¿›åˆ¶æ„å»ºå¯ä»¥ç”¨äºæ•´åˆä½¿ç”¨Mavenæˆ–Cç¼–è¯‘å™¨ç­‰å·¥å…·æ„å»ºçš„å·¥ä»¶ï¼Œä»¥åŠä½¿ç”¨è¿™äº›æ„å»ºçš„è¿è¡Œæ—¶é•œåƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="_3"&gt;é™åˆ¶&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;äºŒè¿›åˆ¶æ„å»ºæ— æ³•é‡å¤ã€‚ç”±äºäºŒè¿›åˆ¶æ„å»ºä¾èµ–äºåœ¨æ„å»ºå¼€å§‹æ—¶ç”¨æˆ·ä¸Šä¼ å·¥ä»¶ï¼Œå› æ­¤OpenShiftæ— æ³•é‡å¤ç›¸åŒçš„æ„å»ºè€Œæ— éœ€ç”¨æˆ·æ¯æ¬¡éƒ½é‡å¤ç›¸åŒçš„ä¸Šè½½ã€‚&lt;/li&gt;
&lt;li&gt;æ— æ³•è‡ªåŠ¨è§¦å‘äºŒè¿›åˆ¶ç”Ÿæˆã€‚å®ƒä»¬åªèƒ½åœ¨ç”¨æˆ·ä¸Šä¼ æ‰€éœ€çš„äºŒè¿›åˆ¶å·¥ä»¶æ—¶æ‰‹åŠ¨å¯åŠ¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;&lt;/p&gt;
&lt;p&gt;ä»¥äºŒè¿›åˆ¶æ„å»ºæ–¹å¼å¯åŠ¨çš„æ„å»ºç‰ˆæœ¬ä¹Ÿå¯èƒ½å…·æœ‰å·²é…ç½®çš„æºURLã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œè§¦å‘å™¨ä¼šæˆåŠŸå¯åŠ¨æ„å»ºï¼Œä½†æºå°†æ¥è‡ªé…ç½®çš„æºURLï¼Œè€Œä¸æ˜¯æ¥è‡ªä¸Šæ¬¡æ„å»ºè¿è¡Œæ—¶ç”¨æˆ·æä¾›çš„æºã€‚(æ¯”å¦‚: ç”¨æˆ·å…ˆä»Gitä»“åº“ä¸‹è½½äº†æºç å¹¶ä¿®æ”¹, ç”¨æœ¬åœ°ä¿®æ”¹åçš„æºç æ‰‹åŠ¨ä¸Šä¼ ã€æ„å»ºï¼Œé‚£ä¹ˆOpenShiftä¼šè·å–åˆ°Gitä»“åº“çš„URL, å¦‚æœé…ç½®äº†è§¦å‘å™¨, ä¸‹æ¬¡æ„å»ºå°±ç›´æ¥é€šè¿‡Git URL pullæºç å¹¶è‡ªåŠ¨æ„å»º, è€Œä¸æ˜¯è‡ªåŠ¨è·å–æœ¬åœ°çš„æºç .)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="_4"&gt;æ•™ç¨‹æ¦‚è¿°&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹æ•™ç¨‹å‡è®¾æ‚¨æœ‰ä¸€ä¸ªå¯ç”¨çš„OpenShifté›†ç¾¤ï¼Œå¹¶ä¸”æ‚¨æœ‰ä¸€ä¸ªå¯ä»¥åˆ›å»ºå·¥ä»¶çš„é¡¹ç›®ã€‚å®ƒè¦æ±‚æ‚¨æ‹¥æœ‰æœ¬åœ°&lt;code&gt;git&lt;/code&gt;å’Œ&lt;code&gt;oc&lt;/code&gt;å®¢æˆ·ç«¯ã€‚&lt;/p&gt;
&lt;h3 id="_5"&gt;æ•™ç¨‹ï¼šæ„å»ºæœ¬åœ°ä»£ç æ›´æ”¹&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åŸºäºç°æœ‰æºå­˜å‚¨åº“åˆ›å»ºæ–°åº”ç”¨ç¨‹åºå¹¶ä¸ºå…¶åˆ›å»ºè·¯ç”±ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc new-app https://github.com/openshift/ruby-hello-world.git
oc expose svc/ruby-hello-world
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="2"&gt;
&lt;li&gt;ç­‰å¾…åˆå§‹æ„å»ºå®Œæˆå¹¶é€šè¿‡routeæ¥æŸ¥çœ‹åº”ç”¨ç¨‹åºçš„é¡µé¢ã€‚ä½ åº”è¯¥å¾—åˆ°ä¸€ä¸ªæ¬¢è¿é¡µé¢ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc get route ruby-hello-world
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;åœ¨æœ¬åœ°å…‹éš†å­˜å‚¨åº“ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone https://github.com/openshift/ruby-hello-world.git
&lt;span class="nb"&gt;cd&lt;/span&gt; ruby-hello-world
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="4"&gt;
&lt;li&gt;
&lt;p&gt;æ›´æ”¹åº”ç”¨ç¨‹åºçš„è§†å›¾ã€‚ä½¿ç”¨æ‚¨å–œæ¬¢çš„ç¼–è¾‘å™¨ç¼–è¾‘ &lt;code&gt;views/main.rb&lt;/code&gt;ï¼šå°†&lt;code&gt;&amp;lt;body&amp;gt;&lt;/code&gt;æ ‡ç­¾æ›´æ”¹ä¸º&lt;code&gt;&amp;lt;body style="background-color:blue"&amp;gt;&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨æœ¬åœ°ä¿®æ”¹çš„æºå¯åŠ¨æ–°æ„å»ºã€‚åœ¨å­˜å‚¨åº“çš„æœ¬åœ°ç›®å½•ä¸­ï¼Œè¿è¡Œï¼š&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc start-build ruby-hello-world --from-dir&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt; --follow
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ„å»ºå®Œæˆå¹¶é‡æ–°éƒ¨ç½²åº”ç”¨ç¨‹åºåï¼ŒæŒ‡å‘åº”ç”¨ç¨‹åºä¸»æœºçš„routeåº”è¯¥ä¼šç”Ÿæˆä¸€ä¸ªè“è‰²èƒŒæ™¯çš„é¡µé¢ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥ç»§ç»­åœ¨æœ¬åœ°è¿›è¡Œæ›´æ”¹å¹¶ä½¿ç”¨&lt;code&gt;oc start-build --from-dir&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨è¿˜å¯ä»¥åˆ›å»ºä»£ç åˆ†æ”¯ï¼Œåœ¨æœ¬åœ°æäº¤æ›´æ”¹ï¼Œå¹¶ä½¿ç”¨å­˜å‚¨åº“çš„HEADä½œä¸ºæ„å»ºçš„æºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git checkout -b my_branch
git add .
git commit -m &lt;span class="s2"&gt;&amp;quot;My changes&amp;quot;&lt;/span&gt;
oc start-build ruby-hello-world --from-repo&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt; --follow
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_6"&gt;æ•™ç¨‹ï¼šæ„å»ºç§æœ‰ä»£ç &lt;a class="headerlink" href="#_6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ªæœ¬åœ°ç›®å½•æ¥ä¿å­˜æ‚¨çš„ä»£ç ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mkdir myapp
&lt;span class="nb"&gt;cd&lt;/span&gt; myapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="2"&gt;
&lt;li&gt;åœ¨ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º&lt;code&gt;Dockerfile&lt;/code&gt;çš„æ–‡ä»¶ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; centos:centos7&lt;/span&gt;
&lt;span class="k"&gt;EXPOSE&lt;/span&gt;&lt;span class="s"&gt; 8080&lt;/span&gt;
&lt;span class="k"&gt;COPY&lt;/span&gt; index.html /var/run/web/index.html
&lt;span class="k"&gt;CMD&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /var/run/web &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; python -m SimpleHTTPServer &lt;span class="m"&gt;8080&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ª&lt;code&gt;index.html&lt;/code&gt;æ–‡ä»¶ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;My local app&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;This is my local application&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="4"&gt;
&lt;li&gt;ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ªæ–°çš„æ„å»ºï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc new-build --strategy docker --binary --docker-image centos:centos7 --name myapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="5"&gt;
&lt;li&gt;ä½¿ç”¨æœ¬åœ°ç›®å½•çš„å†…å®¹å¯åŠ¨äºŒè¿›åˆ¶æ„å»ºï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc start-build myapp --from-dir . --follow
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="6"&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;new-app&lt;/code&gt;éƒ¨ç½²åº”ç”¨ç¨‹åºï¼Œç„¶åä¸ºå…¶åˆ›å»ºè·¯ç”±ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc new-app myapp
oc expose svc/myapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="7"&gt;
&lt;li&gt;è·å–æŒ‡å‘å¯¹åº”åº”ç”¨ä¸»æœºçš„è·¯ç”±ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc get route myapp
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨æ„å»ºå’Œéƒ¨ç½²ä»£ç ä¹‹åï¼Œæ‚¨å¯ä»¥é€šè¿‡æ›´æ”¹æœ¬åœ°æ–‡ä»¶å¹¶é€šè¿‡&lt;code&gt;oc start-build myapp --from-dir&lt;/code&gt;å†æ¬¡è°ƒç”¨å¯åŠ¨æ–°æ„å»ºæ¥è¿›è¡Œè¿­ä»£ã€‚æ„å»ºå®Œæˆåï¼Œä»£ç å°†è‡ªåŠ¨éƒ¨ç½²ï¼Œæ›´æ–°çš„å†…å®¹å°†åœ¨åˆ·æ–°é¡µé¢æ—¶åæ˜ åœ¨æµè§ˆå™¨ä¸­ã€‚&lt;/p&gt;
&lt;h3 id="pipeline"&gt;æ•™ç¨‹ï¼šæ¥è‡ª pipeline çš„äºŒè¿›åˆ¶å·¥ä»¶&lt;a class="headerlink" href="#pipeline" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;OpenShiftä¸Šçš„Jenkinså…è®¸ä½¿ç”¨å¸¦æœ‰åˆé€‚å·¥å…·çš„slaveé•œåƒæ¥æ„å»ºä»£ç ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨&lt;code&gt;maven&lt;/code&gt; slaveé•œåƒæ¥ä»ä»£ç å­˜å‚¨åº“æ„å»ºWARåŒ…ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦æ„å»ºäº†æ­¤å·¥ä»¶ï¼Œæ‚¨éœ€è¦å°†å…¶æäº¤åˆ°åŒ…å«æ­£ç¡®çš„è¿è¡Œæ—¶å·¥ä»¶çš„é•œåƒä»¥è¿è¡Œæ‚¨çš„ä»£ç ã€‚å¯ä»¥ä½¿ç”¨äºŒè¿›åˆ¶æ„å»ºå°†è¿™äº›å·¥ä»¶æ·»åŠ åˆ°è¿è¡Œæ—¶æ˜ åƒã€‚åœ¨ä¸‹é¢çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªJenkins pipelineï¼Œè¯¥pipelineä½¿ç”¨&lt;code&gt;maven&lt;/code&gt; slaveæ„å»ºWARï¼Œç„¶åä½¿ç”¨å¸¦æœ‰&lt;code&gt;Dockerfile&lt;/code&gt;çš„äºŒè¿›åˆ¶æ„å»ºå°†WARæ·»åŠ åˆ° wildfly è¿è¡Œæ—¶æ˜ åƒã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mkdir mavenapp
&lt;span class="nb"&gt;cd&lt;/span&gt; mavenapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="2"&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ª&lt;code&gt;Dockerfile&lt;/code&gt;å°†WARå¤åˆ¶åˆ°wildflyé•œåƒå†…çš„é€‚å½“ä½ç½®ä»¥ä¾›æ‰§è¡Œã€‚å°†ä»¥ä¸‹å†…å®¹å¤åˆ¶åˆ°åä¸ºçš„æœ¬åœ°æ–‡ä»¶ &lt;code&gt;Dockerfile&lt;/code&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; wildfly:latest&lt;/span&gt;
&lt;span class="k"&gt;COPY&lt;/span&gt; ROOT.war /wildfly/standalone/deployments/ROOT.war
&lt;span class="k"&gt;CMD&lt;/span&gt;  &lt;span class="nv"&gt;$STI_SCRIPTS_PATH&lt;/span&gt;/run
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="3"&gt;
&lt;li&gt;ä¸ºè¯¥&lt;code&gt;Dockerfile&lt;/code&gt;åˆ›å»ºä¸€ä¸ªæ–°çš„BuildConfigï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;&lt;/p&gt;
&lt;p&gt;è¿™å°†è‡ªåŠ¨å¯åŠ¨ä¸€ä¸ªæ„å»º, åˆšå¼€å§‹ä¼šæ„å»ºå¤±è´¥ï¼Œå› ä¸º &lt;code&gt;ROOT.war&lt;/code&gt;å·¥ä»¶å°šä¸å¯ç”¨ã€‚ä¸‹é¢çš„pipelineå°†ä½¿ç”¨äºŒè¿›åˆ¶æ„å»ºå°†è¯¥WARåŒ…ä¼ é€’ç»™æ„å»ºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat Dockerfile &lt;span class="p"&gt;|&lt;/span&gt; oc new-build -D - --name mavenapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="4"&gt;
&lt;li&gt;åˆ›å»º1ä¸ªä½¿ç”¨Jenkins pipelineçš„BuildConfig, è¿™ä¸ªBuildConfigå°†æ„å»º1ä¸ªWARåŒ…ï¼Œç„¶åä½¿ç”¨è¯¥WARåŒ…å’Œå…ˆå‰åˆ›å»ºçš„&lt;code&gt;Dockerfile&lt;/code&gt;æ¥æ„å»ºé•œåƒã€‚ç›¸åŒçš„æ¨¡å¼å¯ç”¨äºå…¶ä»–å¹³å°ï¼Œå…¶ä¸­äºŒè¿›åˆ¶å·¥ä»¶ç”±ä¸€ç»„å·¥å…·æ„å»ºï¼Œç„¶åä¸æœ€ç»ˆçš„åŒ…å«ä¸åŒè¿è¡Œæ—¶çš„é•œåƒç»„åˆã€‚å°†ä»¥ä¸‹ä»£ç ä¿å­˜åˆ°&lt;code&gt;mavenapp-pipeline.yml&lt;/code&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;v1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;BuildConfig&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;mavenapp-pipeline&lt;/span&gt;
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;strategy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;jenkinsPipelineStrategy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;jenkinsfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;|-&lt;/span&gt;
        &lt;span class="no"&gt;pipeline {&lt;/span&gt;
          &lt;span class="no"&gt;agent { label &amp;quot;maven&amp;quot; }&lt;/span&gt;
          &lt;span class="no"&gt;stages {&lt;/span&gt;
            &lt;span class="no"&gt;stage(&amp;quot;Clone Source&amp;quot;) {&lt;/span&gt;
              &lt;span class="no"&gt;steps {&lt;/span&gt;
                &lt;span class="no"&gt;checkout([$class: &amp;#39;GitSCM&amp;#39;,&lt;/span&gt;
                            &lt;span class="no"&gt;branches: [[name: &amp;#39;*/master&amp;#39;]],&lt;/span&gt;
                            &lt;span class="no"&gt;extensions: [&lt;/span&gt;
                              &lt;span class="no"&gt;[$class: &amp;#39;RelativeTargetDirectory&amp;#39;, relativeTargetDir: &amp;#39;mavenapp&amp;#39;]&lt;/span&gt;
                            &lt;span class="no"&gt;],&lt;/span&gt;
                            &lt;span class="no"&gt;userRemoteConfigs: [[url: &amp;#39;https://github.com/openshift/openshift-jee-sample.git&amp;#39;]]&lt;/span&gt;
                        &lt;span class="no"&gt;])&lt;/span&gt;
              &lt;span class="no"&gt;}&lt;/span&gt;
            &lt;span class="no"&gt;}&lt;/span&gt;
            &lt;span class="no"&gt;stage(&amp;quot;Build WAR&amp;quot;) {&lt;/span&gt;
              &lt;span class="no"&gt;steps {&lt;/span&gt;
                &lt;span class="no"&gt;dir(&amp;#39;mavenapp&amp;#39;) {&lt;/span&gt;
                  &lt;span class="no"&gt;sh &amp;#39;mvn clean package -Popenshift&amp;#39;&lt;/span&gt;
                &lt;span class="no"&gt;}&lt;/span&gt;
              &lt;span class="no"&gt;}&lt;/span&gt;
            &lt;span class="no"&gt;}&lt;/span&gt;
            &lt;span class="no"&gt;stage(&amp;quot;Build Image&amp;quot;) {&lt;/span&gt;
              &lt;span class="no"&gt;steps {&lt;/span&gt;
                &lt;span class="no"&gt;dir(&amp;#39;mavenapp/target&amp;#39;) {&lt;/span&gt;
                  &lt;span class="no"&gt;sh &amp;#39;oc start-build mavenapp --from-dir . --follow&amp;#39;&lt;/span&gt;
                &lt;span class="no"&gt;}&lt;/span&gt;
              &lt;span class="no"&gt;}&lt;/span&gt;
            &lt;span class="no"&gt;}&lt;/span&gt;
          &lt;span class="no"&gt;}&lt;/span&gt;
        &lt;span class="no"&gt;}&lt;/span&gt;
    &lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;JenkinsPipeline&lt;/span&gt;
  &lt;span class="nt"&gt;triggers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;[]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="5"&gt;
&lt;li&gt;åˆ›å»ºpipeline æ„å»ºã€‚å¦‚æœJenkinsæœªéƒ¨ç½²åˆ°æ‚¨çš„é¡¹ç›®ä¸­ï¼Œåˆ™ä½¿ç”¨ç®¡é“åˆ›å»ºçš„BuildConfigä¼šå…ˆéƒ¨ç½²Jenkinsã€‚åœ¨Jenkinså‡†å¤‡å»ºç«‹æ‚¨çš„ç®¡é“ä¹‹å‰å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ¥å¯åŠ¨ã€‚æ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨&lt;code&gt;oc rollout status dc/jenkins&lt;/code&gt;æ¥æ£€æŸ¥Jenkinsçš„çŠ¶æ€ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc create -f ./mavenapp-pipeline.yml
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="6"&gt;
&lt;li&gt;ä¸€æ—¦Jenkinså‡†å¤‡å°±ç»ªï¼Œå¯åŠ¨ä¹‹å‰å®šä¹‰çš„ç®¡é“ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc start-build mavenapp-pipeline
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="7"&gt;
&lt;li&gt;ç®¡é“æ„å»ºå®Œæˆåï¼Œä½¿ç”¨&lt;code&gt;new-app&lt;/code&gt;éƒ¨ç½²æ–°åº”ç”¨ç¨‹åºå¹¶å…¬å¼€å…¶routeï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc new-app mavenapp
oc expose svc/mavenapp
&lt;/pre&gt;&lt;/div&gt;


&lt;ol start="8"&gt;
&lt;li&gt;ä½¿ç”¨æµè§ˆå™¨ï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åºçš„è·¯å¾„ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;oc get route mavenapp
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 08 May 2019 18:41:34 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-05-08:/binary-builds-with-openshift.html</guid><category>openshift</category><category>docker</category><category>devops</category><category>git</category><category>containers</category></item><item><title>OpenShift å’Œ Kubernetes æœ‰ä»€ä¹ˆåŒºåˆ«?</title><link>https://www.EWhisper.cn/openshift-and-kubernetes-whats-difference.html</link><description>&lt;p&gt;OpenShift 3ä»¥å, æ¶æ„å®Œå…¨åŸºäºK8Sè¿›è¡Œäº†é‡æ„, ä½†æ˜¯åˆæœ‰ä¸€äº›å·®å¼‚. ä»Šå¤©, æˆ‘ä»¬å°±æ·±å…¥ç ”ç©¶ä¸€ä¸‹.&lt;/p&gt;
&lt;h2 id="k8s"&gt;K8S æ˜¯"å†…æ ¸"&lt;a class="headerlink" href="#k8s" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;K8Så¯ä»¥è®¤ä¸ºæ˜¯å½“ä»£åˆ†å¸ƒå¼ç³»ç»Ÿçš„"å†…æ ¸". æˆ‘ä»¬æ„è¯†åˆ°, ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„ä½œä¸šè°ƒåº¦ç¨‹åº, è·¨å¤šå°åŠå…¶è¿è¡Œ, èƒ½å¤Ÿåè°ƒæ‰˜ç®¡åœ¨éª‘ä¸Šçš„å·¥ä½œè´Ÿè½½çš„çŠ¶æ€, è‡ªç„¶å°±ä¼šä¿ƒè¿›å†™ä½œ, å°±åƒLinuxå†…æ ¸ä¸ºå•ä¸ªä¸»æœºä¸Šè°ƒåº¦å·¥ä½œè´Ÿè½½æ‰€åšçš„é‚£æ ·. éµå¾ªè¿™ä¸€é€»è¾‘, æˆ‘ä»¬çŸ¥é“ä¸åŒçš„äº§å“ä¼šæ ¹æ®é’ˆå¯¹ç”¨æˆ·çš„ä¸åŒè€Œå·®å¼‚åŒ–åœ°æ‰“é€ .&lt;/p&gt;
&lt;p&gt;åœ¨å¾ˆå¤šæ‰‹æœº, ç”µè„‘, æœåŠ¡å™¨, ç”šè‡³æ˜¯æ ‘è“æ´¾ä¸Š, è¿è¡Œçš„éƒ½æ˜¯ç›¸åŒçš„Linux å†…æ ¸, ä½†æ˜¯é€šè¿‡ä¸åŒçš„ä¸å®šæ¥æ”¯æŒå¤šç§å¤šæ ·çš„ç¡¬ä»¶.&lt;/p&gt;
&lt;p&gt;K8Så’Œå„ç§å„æ ·çš„K8Så‘è¡Œç‰ˆä¹Ÿé€‚ç”¨äºåŒæ ·çš„æ¨¡å‹, é€šè¿‡ä¸åŒç±»å‹çš„è¡¥ä¸, æ¥æ”¯æŒåœ¨K8Sä¸Šé¢çš„ä¸€å±‚. &lt;/p&gt;
&lt;h2 id="openshift"&gt;OpenShift æ˜¯å‘è¡Œç‰ˆ&lt;a class="headerlink" href="#openshift" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªå¼ºæœ‰åŠ›çš„åŒºåˆ«ã€‚OpenShiftå°±æ˜¯Kubernetesçš„å‘è¡Œç‰ˆï¼Œä¸“æ³¨äºå¼€å‘äººå‘˜çš„ä½“éªŒï¼Œè€Œå¼€å‘äººå‘˜éœ€è¦å¼€å‘ä¸‹ä¸€ä»£äº‘åŸç”Ÿåº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ä»»ä½•äººéƒ½å¯ä»¥é€šè¿‡é€‰æ‹©æ¯1ä¸ªéƒ¨åˆ†å¹¶æŒ‰ç…§æ¯ä¸ªç”¨æˆ·é€‰æ‹©çš„å®šåˆ¶æ–¹å¼ç»„è£…å®ƒä»¬æ¥&lt;a href="http://www.linuxfromscratch.org/"&gt;ä»Scratch &lt;/a&gt;æ„å»º&lt;a href="http://www.linuxfromscratch.org/"&gt;Linux&lt;/a&gt;ï¼Œä½†å¤§å¤šæ•°äººéƒ½æ²¡æœ‰ã€‚å¤§å¤šæ•°ç”¨æˆ·é€‰æ‹©çš„æŠ½è±¡çº§åˆ«æ„å‘³ç€ä»–ä»¬ä¸ä¼šä»ç®¡ç†ï¼ˆç”šè‡³äº†è§£ï¼‰Util-Linuxç‰ˆæœ¬2.31å’Œ2.33ä¹‹é—´çš„å·®å¼‚ä¸­è·å¾—å¾ˆå¤šä»·å€¼ã€‚ä¸ºäº†æ›´è¿›ä¸€æ­¥ï¼Œç”¨æˆ·å…³å¿ƒæœ€ä½çº§åˆ«çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œåªè¦è¶…è¿‡æœ€å°ç‰ˆæœ¬å·ï¼Œä»–ä»¬å°±çŸ¥é“å“ªäº›å‘½ä»¤/ APIå¯ç”¨ï¼‰ï¼Œç„¶åæä¾›æ‰€æä¾›åŠŸèƒ½çš„åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸OpenShiftéå¸¸ç›¸ä¼¼ã€‚OpenShiftå°†Kubernetesæ‰“åŒ…å¹¶åŒ…å«å…¶ä»–å·¥å…·ä½œä¸ºOpenShiftè®¤ä¸ºé‡è¦ä¸”OpenShiftçš„ç”¨æˆ·éœ€æ±‚çš„åŠŸèƒ½ã€‚å°±åƒCoreOSå’ŒCentOSåŒ…å«ä¸åŒçš„å·¥å…·é›†ä¸€æ ·ï¼Œè¿åˆä¸åŒçš„ç”¨æˆ·ï¼Œå› æ­¤Kuberneteså‘è¡Œç‰ˆä¹Ÿæ˜¯å¦‚æ­¤ã€‚&lt;/p&gt;
&lt;h2 id="openshiftk8s"&gt;OpenShiftå’ŒK8Sçš„å…·ä½“åŒºåˆ«&lt;a class="headerlink" href="#openshiftk8s" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="openshift_1"&gt;OpenShift æ¶æ„æ¦‚è¿°&lt;a class="headerlink" href="#openshift_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;OpenShiftå®¹å™¨å¹³å°æ˜¯ä¸€ç³»åˆ—æµè¡Œçš„ç»„ä»¶å’ŒæœåŠ¡çš„é›†åˆä½“, æ„å»ºäºRed Hat Enterprise Linux, Docker, å’ŒK8Sä¹‹ä¸Š. OpenShifté’ˆå¯¹å¼€å‘äººå‘˜, å¢å¼ºäº†ä»¥ä¸‹åŠŸèƒ½: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿œç¨‹ç®¡ç†&lt;/li&gt;
&lt;li&gt;å¤šç§Ÿæˆ·&lt;/li&gt;
&lt;li&gt;å®‰å…¨æ€§å¢å¼º&lt;/li&gt;
&lt;li&gt;åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†&lt;/li&gt;
&lt;li&gt;è‡ªæœåŠ¡æ¥å£&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="OpenShift æ¶æ„" src="./images/openshift-architecture-overview.png"&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šå›¾ä¸­, ä»ä¸‹è‡³ä¸Š, ä»å·¦è‡³å³, å±•ç¤ºäº†ç»è¿‡Red Hat åœ¨åŸºæœ¬çš„å®¹å™¨æ¶æ„åŸºç¡€ä¸Šè¿›ä¸€æ­¥é›†æˆã€å¢å¼ºçš„æ¶æ„:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºæœ¬OSæ˜¯Red Hat Enterprise Linux (RHEL)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Docker&lt;/strong&gt;  æä¾›äº†åŸºæœ¬çš„å®¹å™¨ç®¡ç†APIå’Œå®¹å™¨é•œåƒæ–‡ä»¶æ ¼å¼&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kubernetes&lt;/strong&gt; ç®¡ç†è¿è¡Œå®¹å™¨çš„ä¸»æœºé›†ç¾¤(å®ä½“çš„æˆ–è™šæ‹Ÿçš„). å®ƒé€šè¿‡èµ„æº(resources)æ¥æè¿°å¤šå®¹å™¨åº”ç”¨æ˜¯ç”±å¤šä¸ªèµ„æºç»„æˆçš„, ä»¥åŠä»–ä»¬é—´å¦‚ä½•äº¤äº’&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Etcd&lt;/strong&gt; æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ key-value å­˜å‚¨, Kubernetes é€šè¿‡å®ƒæ¥å­˜å‚¨é›†ç¾¤å†…çš„å…³äºå®¹å™¨å’Œå…¶ä»–èµ„æºçš„é…ç½®å’ŒçŠ¶æ€ä¿¡æ¯.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨Docker + Kubernetes ä¹‹ä¸Š, OpenShiftå¢åŠ äº†å®¹å™¨å¹³å°æ‰€éœ€è¦çš„å…¶ä»–åŠŸèƒ½. å…·ä½“åŒ…æ‹¬:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;OpenShift-Kubernetes æ‰©å±•&lt;/strong&gt; æ˜¯å­˜å‚¨åœ¨Etcdä¸­, ç”±Kubernetesç®¡ç†çš„é¢å¤–çš„èµ„æºç±»å‹(resource types). è¿™äº›é¢å¤–çš„èµ„æºç±»å‹ç»„æˆäº†OpenShift å†…éƒ¨çŠ¶æ€å’Œé…ç½®, è¿˜æœ‰åº”ç”¨çš„èµ„æº.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹å™¨åŒ–æœåŠ¡&lt;/strong&gt; å……å®äº†å¾ˆå¤šåŸºç¡€æ¶æ„åŠŸèƒ½, æ¯”å¦‚ç½‘ç»œå’Œè®¤è¯. è¿™äº›åŠŸèƒ½æœ‰äº›æ˜¯ä¸€ç›´è¿è¡Œçš„, æœ‰äº›æ˜¯æŒ‰éœ€å¯åŠ¨çš„. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œæ—¶å’ŒxPaaS&lt;/strong&gt; æ˜¯ä¸ºå¼€å‘è€…å‡†å¤‡å¥½çš„å®¹å™¨é•œåƒ, æ¯ä¸ªéƒ½é¢„é…ç½®äº†ç‰¹å®šçš„è¯­è¨€è¿è¡Œæ—¶æˆ–æ•°æ®åº“. å¯ä»¥è¢«ç”¨ä½œé•œåƒæµ(Image Stream)æˆ–åœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ ä¸åŒçš„æ¡†æ¶, åº“, ç”šè‡³æ˜¯ä¸­é—´ä»¶æ¥è¿›è¡Œæ‰©å±•. xPaaS æä¾›äº†ä¸€ç³»åˆ—JBossä¸­é—´ä»¶äº§å“çš„åŸºç¡€é•œåƒ, å¦‚: JBoss EAP å’Œ ActiveMQ.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DevOps å·¥å…·é›†å’Œç”¨æˆ·ä½“éªŒ&lt;/strong&gt;: OpenShift ä¸ºå¼€å‘äººå‘˜å’Œç³»ç»Ÿç®¡ç†å‘˜æä¾›äº†ä¸€ä¸ªWeb UIå’ŒCLI ç®¡ç†å·¥å…·, å…è®¸é…ç½®å’Œç›‘æ§åº”ç”¨å’ŒOpenShiftçš„æœåŠ¡å’Œèµ„æº. Webå’Œ CLI éƒ½æ˜¯åŸºäºç›¸åŒçš„REST API, è¿™ä¸ªAPIä¹Ÿå¯ä»¥è¢«å¤–éƒ¨å·¥å…·(å¦‚: IDEå’ŒCIå¹³å°)æ•´åˆ. OpenShiftä¹Ÿå¯ä»¥è®¿é—®å¤–éƒ¨SCMåº“å’Œå®¹å™¨é•œåƒåº“.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; å¤‡æ³¨:&lt;/p&gt;
&lt;p&gt;OpenShift å›¢é˜Ÿ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¸®åŠ©K8S å®Œæˆäº†Namespace å’Œ quotaåŠŸèƒ½çš„å¼€å‘;&lt;/li&gt;
&lt;li&gt;æ¨åŠ¨äº†RBAC æˆæƒè®¤è¯çš„å¼€å‘&lt;/li&gt;
&lt;li&gt;å¸®åŠ©K8Sè¿è¡Œæ›´å¤šç±»å‹çš„åº”ç”¨, å¹¶ä¸ºå…¶å¼€å‘äº†ä¸€äº›å·æ’ä»¶(Volume Plugin)&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å¤šäº†Deployment Config(DC) resource. ä½¿ç”¨è¯¥èµ„æºå¯ä»¥è¿›è¡Œå‚æ•°åŒ–éƒ¨ç½², æ‰§è¡Œæ»šåŠ¨éƒ¨ç½²å’Œå›æ»šç­‰.&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å¤šäº†Route resource. è€ŒRouterä¹Ÿæ˜¯K8Sçš„IngressåŠŸèƒ½çš„å‰èº«.&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, é»˜è®¤é›†æˆäº†SDN (Open vSwitch)&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å®ç°äº†å¼€å‘è¿ç»´ä¸€ä½“åŒ–.&lt;/li&gt;
&lt;li&gt;çº³å…¥CoreOS&lt;/li&gt;
&lt;li&gt;OpenShift 3.11, é›†æˆäº†Prometheuså’ŒGrafana&lt;/li&gt;
&lt;li&gt;ç›¸æ¯”K8S, å¢å¼ºäº†ç®¡ç†ç‰©ç†èŠ‚ç‚¹çš„èƒ½åŠ›&lt;/li&gt;
&lt;li&gt;ç›®å‰, OpenShiftè¿˜å’ŒNVåˆä½œ, æœªæ¥ä¼šæä¾›åŸºäºGPUè¿ç®—èƒ½åŠ›çš„æ”¯æŒ.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h3 id="_1"&gt;èµ„æºç±»å‹å·®å¼‚&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Kubernetes èµ„æºç±»å‹&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Pods&lt;/li&gt;
&lt;li&gt;Services&lt;/li&gt;
&lt;li&gt;Replication Controllers&lt;/li&gt;
&lt;li&gt;Persistent Volume (PV)&lt;/li&gt;
&lt;li&gt;Persistent Volume Claims (PVC)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;OpenShift èµ„æºç±»å‹&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;é™¤äº†ä»¥ä¸Šèµ„æºç±»å‹, OpenShift è¿˜å¢åŠ äº†ä»¥ä¸‹ä¸»è¦çš„èµ„æºç±»å‹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Deployment Configurations (DC) - ç”¨äº æŒç»­äº¤ä»˜(CD)å·¥ä½œæµ&lt;/li&gt;
&lt;li&gt;Build Configurations (BC) - ç”¨äº æŒç»­é›†æˆ(CI) å·¥ä½œæµ&lt;/li&gt;
&lt;li&gt;Routes - åŸºäºHAProxy, ä½œç”¨ç±»ä¼¼äºK8S Ingress, ä½†æ—©äºIngress.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="openshift-s2i"&gt;OpenShift ç‰¹æœ‰çš„S2I åŠŸèƒ½&lt;a class="headerlink" href="#openshift-s2i" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;OpenShiftä¸­çš„Source-to-Image (S2I) è¿›ç¨‹ä¼šä»SCMä»“åº“ä¸­æ‹‰å–ä»£ç , è‡ªåŠ¨åŒ–ç›‘æµ‹ä»£ç éœ€è¦å“ªç§ç±»å‹çš„è¿è¡Œæ—¶, å¹¶ä»ç‰¹å®šè¿è¡Œæ—¶çš„åŸºç¡€é•œåƒå¯åŠ¨ä¸€ä¸ªpod. åœ¨è¿™ä¸ªpod ä¸­, OpenShift ä»¥å¼€å‘äººå‘˜ç›¸åŒçš„æ–¹å¼æ¥æ„å»ºè¯¥åº”ç”¨(å¦‚, ä½¿ç”¨&lt;strong&gt;maven&lt;/strong&gt;æ¥æ„å»ºjavaç¨‹åº). å¦‚æœæ„å»ºæˆåŠŸ, å¦ä¸€ä¸ªé•œåƒä¼šè¢«åˆ›å»º, æŠŠåº”ç”¨äºŒè¿›åˆ¶é™„åŠ åˆ°è¿è¡Œæ—¶å±‚ä¹‹ä¸Š, å¹¶æŠŠè¿™ä¸ªæ–°é•œåƒæ¨é€åˆ°OpenShiftçš„å†…éƒ¨é•œåƒä»“åº“ä¸­. æ¥ä¸‹æ¥, å¯ä»¥ä»è¿™ä¸ªæ–°é•œåƒåˆ›å»ºä¸€ä¸ªpodæ¥è¿è¡Œè¯¥åº”ç”¨. S2I å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªåµŒå…¥åˆ°OpenShiftå¹³å°ä¸­çš„ CI/CD pipeline.&lt;/p&gt;
&lt;p&gt;CI/CD pipelines ä¼šæœ‰å¾ˆå¤šç§å˜å¼‚, è¿™ä¸ªpipelineä¼šæš´éœ²åœ¨è¿™ä¸ªé¡¹ç›®(project, å°±æ˜¯K8Sçš„namespace)ä¸­, é‚£ä¹ˆå®ƒå°±å¯ä»¥è¢«è°ƒèŠ‚æ¥æ»¡è¶³å¼€å‘äººå‘˜çš„éœ€æ±‚. ä¾‹å¦‚, å¤–éƒ¨CIå·¥å…·(å¦‚Jenkins)å¯ä»¥ç”¨äºæ¥å¯åŠ¨å’Œè¿è¡Œæµ‹è¯•, ç„¶åç»™æ–°é•œåƒæ‰“ä¸Š"æˆåŠŸ"æˆ–"å¤±è´¥"çš„æ ‡ç­¾(label), å¹¶æ¨é€åˆ°QAæˆ–ç”Ÿäº§ç¯å¢ƒ. éšç€æ—¶é—´æ¨ç§», ä¸€ä¸ªç»„ç»‡ä¸€ä¸ªéƒ¨é—¨ä¸€ä¸ªå…¬å¸å¯ä»¥åˆ›å»ºä»–ä»¬è‡ªå·±çš„pipelineæ¨¡æ¿, åŒ…æ‹¬è‡ªå®šä¹‰çš„æ„å»ºå™¨å’Œéƒ¨ç½²å™¨.&lt;/p&gt;
&lt;h2 id="_2"&gt;æ€»ç»“&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;OpenShift å¹³å°ç›¸æ¯”K8S, å…·æœ‰ä»¥ä¸‹ç‰¹æ€§:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªæœåŠ¡å¹³å°;&lt;/li&gt;
&lt;li&gt;å¤šè¯­è¨€, å¤šä¸­é—´ä»¶, æ•°æ®åº“æ”¯æŒ&lt;/li&gt;
&lt;li&gt;é«˜å¯ç”¨, å¯ä¼¸ç¼©æ€§&lt;/li&gt;
&lt;li&gt;ä¹Ÿæ˜¯å¼€æºçš„(Red Hatæ”¶å–æœåŠ¡è´¹)&lt;/li&gt;
&lt;li&gt;å®‰å…¨ (åŸºäº: RBAC, LDAP, ä¸»æœº, ç½‘ç»œ, å®¹å™¨å„ä¸ªå±‚é¢çš„åŠ å›º)&lt;/li&gt;
&lt;li&gt;åŠ¨æ€å­˜å‚¨ç®¡ç†&lt;/li&gt;
&lt;li&gt;ä¼ä¸šçº§&lt;/li&gt;
&lt;li&gt;æ—¥å¿—æ•´åˆ/ ç›‘æ§æ•´åˆ&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Fri, 03 May 2019 16:51:34 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-05-03:/openshift-and-kubernetes-whats-difference.html</guid><category>docker</category><category>openshift</category><category>k8s</category><category>containers</category><category>PAAS</category></item><item><title>SRE å®£è¨€</title><link>https://www.EWhisper.cn/the-declaration-of-sre.html</link><description>&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#sre"&gt;SRE å®£è¨€&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sre_1"&gt;SRE æˆç«‹èƒŒæ™¯&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sre_2"&gt;ä½•ä¸ºSRE&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#sre_3"&gt;SRE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sre_4"&gt;SRE çš„ç›®æ ‡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sre_5"&gt;SRE è¿ç»´ä½“ç³»&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#sre_6"&gt;SRE å»ºè®¾é˜¶æ®µ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_1"&gt;æ€»ç»“&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id="sre"&gt;SRE å®£è¨€&lt;a class="headerlink" href="#sre" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©(2019å¹´4æœˆ1æ—¥)æ˜¯ä¸ªå¯¹äºæˆ‘æ¥è¯´å€¼å¾—æ°¸è¿œé“­è®°çš„æ—¥å­.&lt;/p&gt;
&lt;p&gt;ä»ä»Šå¤©èµ·, æˆ‘ç”±ä¸€åæ™®é€šçš„è¿ç»´è½¬å˜ä¸ºä¸€åæ™®é€šçš„SRE. æˆ‘ä»¬ä¸“æ³¨äº: æé«˜æ•ˆç‡, æé«˜ä¸šåŠ¡è¿ç»­æ€§, æœ€ç»ˆæé«˜ç”¨æˆ·æ»¡æ„åº¦. æ— è®ºæ˜¯å…¬å¸çš„å®¢æˆ·, è¿˜æ˜¯åˆ†å…¬å¸ã€å­å…¬å¸çš„ç”¨æˆ·, äº¦æˆ–æ˜¯ITå¼€å‘åˆ†éƒ¨çš„åŒäº‹, ä½ ä»¬éƒ½æ˜¯æˆ‘ä»¬çš„æœåŠ¡"ç”¨æˆ·". æˆ‘ä¼šç”¨æˆ‘çš„ååˆ†åŠªåŠ›, æ¥æ¢å¾—æ•ˆç‡çš„+1%, æ¥æ¢å¾—ä¸šåŠ¡è¿ç»­æ€§çš„+1s, æ¥æ¢å¾—ä½ ä»¬ç‚¹èµä¸ç¬‘è„¸çš„+1+1.&lt;/p&gt;
&lt;h2 id="sre_1"&gt;SRE æˆç«‹èƒŒæ™¯&lt;a class="headerlink" href="#sre_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;è¿‡å»ä¸€æ®µæ—¶é—´, æˆ‘ä»¬å‘ç°æˆ‘ä»¬è¿ç»´åˆ‡å®åœ°å­˜åœ¨ä»¥ä¸‹é—®é¢˜:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¿ç»´å’Œå¼€å‘è¡”æ¥ä¸ç•…. è¿ç»´åˆ†éƒ¨æ˜¯ä¸“ä¸šç»„çš„ç»„ç»‡æ¶æ„, å°±æ‹¿æ–°ç³»ç»Ÿä¸Šçº¿æ¥ä¸¾ä¾‹, å¼€å‘å‡ ä¹éœ€è¦é—®éè¿ç»´åˆ†éƒ¨å†…çš„å„ä¸ªä¸“ä¸šç»„, ä»: ä¸»æœºã€ä¸­é—´ä»¶ã€æ•°æ®åº“ã€ç½‘ç»œå†åˆ°å®‰å…¨ã€ç›‘æ§ç­‰ç­‰ç­‰ç­‰ã€‚è€Œä¸”æ—¶é•¿é¢ä¸´ç€å¯¹æ–¹â€œä¸æ˜¯æˆ‘è´Ÿè´£çš„ï¼Œä½ æ‰¾å…¶ä»–äººå§â€å¼çš„è¢«è¸¢çš®çƒçš„æ„Ÿå—ã€‚&lt;/li&gt;
&lt;li&gt;éƒ¨ç½²è§„æ¨¡è¶Šæ¥è¶Šåºå¤§ã€‚éšç€å„ç±»ç§æœ‰äº‘ã€å…¬æœ‰äº‘çš„å¼•å…¥ï¼Œå¾®æœåŠ¡æ¶æ„çš„å¼•å…¥ï¼Œä»¥åŠæ•°å­—åŒ–è½¬å‹ï¼Œç«äº‰çš„æ¿€çƒˆã€‚è¿‘äº›å¹´ï¼Œç³»ç»Ÿçš„éƒ¨ç½²è§„æ¨¡è¾ƒå‰å¹´ç”šè‡³éƒ½æœ‰æˆå€æ•°çš„å¢é•¿ï¼Œç°æœ‰çš„è¿ç»´æ¨¡å¼å¯¹äºè¶Šæ¥è¶Šåºå¤§çš„è§„æ¨¡æœ‰äº›åŠ›ä¸ä»å¿ƒã€‚&lt;/li&gt;
&lt;li&gt;æ–°æŠ€æœ¯çš„å¼•å…¥ã€‚è¿˜æ˜¯ä¸Šé¢æåˆ°çš„ï¼Œäº‘çš„å¼•å…¥ï¼Œå®¹å™¨çš„å¼•å…¥ï¼Œå¼€æºæŠ€æœ¯æ ˆï¼ˆåŒ…æ‹¬ï¼šweb serverï¼Œä¸­é—´ä»¶ï¼ŒMQï¼Œç¼“å­˜ï¼ŒNoSQL...)çš„å¼•å…¥ä»¥åŠéšä¹‹è€Œæ¥çš„å·¥å…·é“¾çš„å¼•å…¥(Ansible, SaltStack, Jenkins, Zabbix, ELK...)ä¹Ÿå¸¦æ¥æŠ€æœ¯é“¾çš„çˆ†ç‚¸å¼å¢é•¿. è€Œè¿™äº›ä¹Ÿéƒ½æ˜¯éœ€è¦è¿ç»´å…·æœ‰ç›¸åº”çš„æŠ€æœ¯å‚¨å¤‡çš„.&lt;/li&gt;
&lt;li&gt;å¼€å‘åˆ†éƒ¨DevOps. å¼€å‘åˆ†éƒ¨ä¹Ÿåœ¨æ¨åŠ¨DevOpsçš„ä½“ç³». æˆ‘ä»¬çš„ä½“ç³»ä¹Ÿè¦å’Œå¼€å‘åˆ†éƒ¨ç›¸å¯¹åº”.&lt;/li&gt;
&lt;li&gt;æŠ€æœ¯èƒ½åŠ›çš„ç§¯ç´¯å’Œå˜ç°.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="sre_2"&gt;ä½•ä¸ºSRE&lt;a class="headerlink" href="#sre_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="sre_3"&gt;SRE&lt;a class="headerlink" href="#sre_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img alt="SRE logo" src="./images/reliability-icon-t_0.png"&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å®šä¹‰:&lt;br&gt;
SRE æ˜¯è°·æ­Œé’ˆå¯¹DevOpsçš„ç”Ÿäº§å®è·µå’Œè¿è¡Œæ¨¡å‹. è½¯ä»¶ç”±å¼€å‘å›¢é˜Ÿæ˜¾ç¤º"äº¤æ¥ç»™"è¿è¡Œè½¯ä»¶çš„å›¢é˜Ÿ, å³Site Reliability Engineer(SRE, ç½‘ç«™å¯é æ€§å·¥ç¨‹å›¢é˜Ÿ). åœ¨è¿™ä¸ªæ¨¡å‹ä¸­, Devå›¢é˜Ÿéœ€è¦å‘ SRE å›¢é˜Ÿæä¾›æµ‹è¯•è¯æ®(æ—¥å¿—, æŒ‡æ ‡ç­‰), è¯æ˜ä»–ä»¬çš„è½¯ä»¶å·²ç»è¾¾åˆ°ä¸€ä¸ª SRE å›¢é˜Ÿè®¤ä¸ºè¶³å¤Ÿå¥½çš„æ ‡å‡†.&lt;br&gt;
è‡³å…³é‡è¦çš„æ˜¯, SRE å›¢é˜Ÿå¯ä»¥æ‹’ç»ä¸ç¬¦åˆè¿ç»´æ ‡å‡†çš„è½¯ä»¶(åŒ…æ‹¬å¼€å‘åˆ†éƒ¨å’Œè¿ç»´åˆ†éƒ¨çš„è½¯ä»¶), è¦æ±‚å¼€å‘äººå‘˜åœ¨æŠ•å…¥ç”Ÿäº§ä¹‹å‰æ”¹è¿›ä»£ç . Dev å’Œ SREä¹‹é—´çš„åä½œå›´ç»•ç€&lt;strong&gt;è¿ç»´æ ‡å‡†&lt;/strong&gt;å±•å¼€, ä½†æ˜¯, ä¸€æ—¦ SRE å›¢é˜Ÿå¯¹ä»£ç æ»¡æ„, ä»–ä»¬(è€Œä¸æ˜¯Devå›¢é˜Ÿ)å°±ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­æä¾›æ”¯æŒ.&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ¨¡å‹åªé€‚ç”¨äºå·¥ç¨‹å’Œç»„ç»‡æˆç†Ÿåº¦è¾ƒé«˜çš„ç»„ç»‡, å¦‚æœè¿è¡Œä¸å½“, å¯èƒ½å˜ä¸º "Dev å’Œ Opsç­’ä»“"çš„æ¨¡å¼.&lt;br&gt;
èŠ‚é€‰è‡ª: &lt;a href="https://www.infoq.cn/article/DcIUD_gi17sQjvSt5XSS"&gt;DevOpså›¢é˜Ÿç»“æ„ç±»å‹æ±‡æ€»ï¼šæ€»æœ‰ä¸€æ¬¾é€‚åˆä½ &lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img alt="SREæ¨¡å‹" src="./images/devops-models-type-7.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="dev ops ç­’ä»“" src="./images/anti-devops-models-1.png"&gt;&lt;/p&gt;
&lt;h3 id="sre_4"&gt;SRE çš„ç›®æ ‡&lt;a class="headerlink" href="#sre_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;SREçš„ç›®æ ‡æœ‰"ä¸‰åŒ–", ä¹Ÿæ˜¯æ‰¿æ¥äº†å®ç°å…¬å¸çš„"ä¸‰åŒ–"æˆ˜ç•¥. SREç›®æ ‡ä¸º:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¹³å°åŒ–&lt;/li&gt;
&lt;li&gt;æœåŠ¡åŒ–&lt;/li&gt;
&lt;li&gt;è‡ªåŠ¨åŒ–&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="sre_5"&gt;SRE è¿ç»´ä½“ç³»&lt;a class="headerlink" href="#sre_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;SRE è¿ç»´ä½“ç³»æœ‰"ä¸‰é©¾é©¬è½¦". &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;SRE. ä½äºé‡‘å­—å¡”å°–, å¯¹å¤–æä¾›æœåŠ¡.&lt;/li&gt;
&lt;li&gt;æŠ€æœ¯æœåŠ¡. å³: ä¸“ä¸šç»„. "ä½¿èƒ½"SREå›¢é˜Ÿ.&lt;/li&gt;
&lt;li&gt;è¿ç»´å¼€å‘. æ–°æˆç«‹(ç›®å‰è¿˜æœªæˆç«‹, è¿‡æ¸¡æœŸ). "èµ‹èƒ½"SREå›¢é˜Ÿ. æ‰“é€ ä»¥"ä¸‰åŒ–"ä¸ºç›®æ ‡çš„å¹³å°, å·¥å…·é›†.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="sre_6"&gt;SRE å»ºè®¾é˜¶æ®µ&lt;a class="headerlink" href="#sre_6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯å…¬å¸è¿ç»´åˆ†éƒ¨è¿‘åå¹´æ¥çš„é¦–æ¬¡å˜é©, å˜é©éœ€è¦é€æ­¥ç¨³æ­¥æ¨è¿›. SRE å»ºè®¾ä¹Ÿä¼šåˆ†é˜¶æ®µè¿›è¡Œ:&lt;br&gt;
å½“å‰é˜¶æ®µçš„ä¸»è¦å·¥ä½œæ˜¯:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ‰å£&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç›‘æ§å‘Šè­¦æ‰å£&lt;/li&gt;
&lt;li&gt;åº”ç”¨, æ•°æ®åº“å‘å¸ƒæ‰å£&lt;/li&gt;
&lt;li&gt;èµ„æº, é›†æˆéƒ¨ç½²æ‰å£&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å·¥å…·å¹³å°å»ºè®¾&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è‡ªåŠ¨åŒ–è¿ç»´å¹³å°å»ºè®¾&lt;/li&gt;
&lt;li&gt;ç»Ÿä¸€ç›‘æ§å‘Šè­¦å¹³å°å»ºè®¾&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="_1"&gt;æ€»ç»“&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æœ€ç»ˆç›®æ ‡&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æé«˜æ•ˆç‡&lt;/li&gt;
&lt;li&gt;æé«˜ä¸šåŠ¡è¿ç»­æ€§&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆæé«˜å®¢æˆ·æ»¡æ„åº¦&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ†é˜¶æ®µ, åˆ†æ­¥éª¤æ¨è¿›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;è¿ç»´å›¢é˜Ÿä»¥å¾€ç§¯ç´¯äº†ä¸€äº›ä¼˜ç§€çš„å“è´¨, ä½†ä¹Ÿæ…¢æ…¢ç§¯ç´¯äº†æƒ°æ€§. æ‡’æƒ°, å›ºæ­¥è‡ªå°è¦è¢«ä¸¥è‚ƒå¤„ç†.&lt;/li&gt;
&lt;li&gt;ç”¨äºæ¢ç´¢å’Œå®è·µ. æ•¢äºè¯•é”™, ä»å¤±è´¥ä¸­å¸å–ç»éªŒæ•™è®­.&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Tue, 02 Apr 2019 08:32:07 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-04-02:/the-declaration-of-sre.html</guid><category>DevOps</category><category>SRE</category></item><item><title>DevOpsèƒ½åŠ›æˆç†Ÿåº¦è°ƒæŸ¥é—®å·</title><link>https://www.EWhisper.cn/devops-questionnaire.html</link><description>&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#_1"&gt;ï¼ˆä¸€ï¼‰é…ç½®ç®¡ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_2"&gt;ï¼ˆäºŒï¼‰æ„å»ºä¸æŒç»­é›†æˆ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_3"&gt;ï¼ˆä¸‰ï¼‰æ„å»ºä¸æŒç»­é›†æˆ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_4"&gt;ï¼ˆå››ï¼‰æµ‹è¯•ç®¡ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_5"&gt;ï¼ˆäº”ï¼‰éƒ¨ç½²ä¸å‘å¸ƒç®¡ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_6"&gt;ï¼ˆå…­ï¼‰ç¯å¢ƒç®¡ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_7"&gt;ï¼ˆä¸ƒï¼‰æ•°æ®ç®¡ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_8"&gt;ï¼ˆå…«ï¼‰åº¦é‡ä¸åé¦ˆ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_9"&gt;ï¼ˆä¹ï¼‰åˆ†å¸ƒå¼åº”ç”¨æ¶æ„&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; é—®å·è¯´æ˜:&lt;/p&gt;
&lt;p&gt;æœ¬é—®å·æ¥è‡ªäº’è”ç½‘.&lt;br&gt;
æœ¬é—®å·ç”±ä¹ä¸ªæ¿å—æ„æˆ,ä¸€å…±73é“é¢˜, å…¨éƒ¨ä¸ºå•é€‰é¢˜.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="_1"&gt;ï¼ˆä¸€ï¼‰é…ç½®ç®¡ç†&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;1ã€ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ&lt;/p&gt;
&lt;p&gt;Â·       Aã€æœªä½¿ç”¨ç»Ÿä¸€çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œæºä»£ç åˆ†æ•£åœ¨ç ”å‘æœ¬åœ°è®¾å¤‡ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€ä½¿ç”¨é›†ä¸­å¼çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå¹¶å°†æ‰€æœ‰æºä»£ç çº³å…¥ç³»ç»Ÿç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€ä½¿ç”¨åˆ†å¸ƒå¼çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¹¶å°†æ‰€æœ‰æºä»£ç ã€é…ç½®æ–‡ä»¶ã€æ„å»ºå’Œéƒ¨ç½²ç­‰è‡ªåŠ¨åŒ–è„šæœ¬çº³å…¥ç³»ç»Ÿç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å°†æ•°æ®åº“å˜æ›´è„šæœ¬å’Œç¯å¢ƒé…ç½®ç­‰çº³å…¥ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿç®¡ç†ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæ”¯æŒè‡ªåŠ¨åŒ–çš„å˜æ›´æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å°†è½¯ä»¶ç”Ÿå‘½å‘¨æœŸçš„æ‰€æœ‰é…ç½®é¡¹çº³å…¥ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿç®¡ç†ï¼Œå¯å®Œæ•´å›æº¯è½¯ä»¶äº¤ä»˜è¿‡ç¨‹æ»¡è¶³å®¡è®¡è¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;2ã€åˆ†æ”¯ç®¡ç†&lt;/p&gt;
&lt;p&gt;Â·       Aã€ç¼ºä¹æ˜ç¡®çš„åˆ†æ”¯ç®¡ç†ç­–ç•¥ï¼Œåˆ†æ”¯ç”Ÿå‘½å‘¨æœŸæ··ä¹±ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€é‡‡å–é•¿å‘¨æœŸå’Œå¤§æ‰¹é‡çš„æ–¹å¼è¿›è¡Œä»£ç æäº¤ï¼Œä»£ç åˆå¹¶è¿‡ç¨‹å­˜åœ¨å¤§é‡å†²çªå’Œé”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€é‡‡å–çŸ­åˆ†æ”¯é¢‘ç¹æäº¤çš„æ–¹å¼ï¼Œç ”ç©¶äººå‘˜è‡³å°‘æ¯å¤©å®Œæˆä¸€æ¬¡ä»£ç æäº¤ï¼Œä»£ç åˆå¹¶è¿‡ç¨‹é¡ºç•…ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€åˆ†æ”¯ç­–ç•¥æ»¡è¶³æŒç»­äº¤ä»˜éœ€æ±‚ï¼Œå¯çµæ´»é€‚åº”äº§å“äº¤ä»˜ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­ä¼˜åŒ–çš„åˆ†æ”¯ç®¡ç†ç­–ç•¥ï¼Œå¯æ”¯æŒå›¢é˜Ÿé«˜æ•ˆåä½œã€‚&lt;/p&gt;
&lt;p&gt;3ã€æ„å»ºäº§ç‰©ç®¡ç†&lt;/p&gt;
&lt;p&gt;Â·       Aã€æœªä½¿ç”¨ç»Ÿä¸€çš„åˆ¶å“åº“ï¼Œæ„å»ºäº§ç‰©é€šè¿‡ç›´æ¥æ‹·è´æˆ–æœ¬åœ°å…±äº«ç­‰æ–¹å¼è¿›è¡Œåˆ†å‘ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€ä½¿ç”¨ç»Ÿä¸€çš„åˆ¶å“åº“ç®¡ç†æ„å»ºäº§ç‰©ï¼Œæœ‰æ¸…æ™°çš„åˆ†çº§å’Œç›®å½•ç»“æ„åŠæƒé™ç®¡æ§å¹¶é€šè¿‡å•ä¸€åˆ¶å“åº“åœ°å€è¿›è¡Œåˆ†å‘ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€ä½¿ç”¨ç»Ÿä¸€çš„åˆ¶å“åº“ç®¡ç†æ„å»ºäº§ç‰©ï¼Œå¹¶å°†äºŒè¿›åˆ¶åº“æ–‡ä»¶å’Œä¸‰æ–¹ä¾èµ–è½¯ä»¶å·¥å…·ç­‰çº³å…¥åªå‡­åº“ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å¯¹åˆ¶å“åº“å®Œæˆåˆ†çº§ç®¡ç†ï¼Œæœ‰æˆç†Ÿçš„å¤‡ä»½æ¢å¤æ¸…ç†ç­–ç•¥ï¼Œå¦‚é‡‡ç”¨åˆ†å¸ƒå¼åˆ¶å“åº“ã€‚&lt;/p&gt;
&lt;p&gt;4ã€å•ä¸€å¯ä¿¡æ•°æ®æº&lt;/p&gt;
&lt;p&gt;Â·       Aã€ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå’Œåˆ¶å“åº“ä½œä¸ºå•ä¸€å¯ä¿¡æ•°æ®æºï¼Œè¦†ç›–ç”Ÿäº§éƒ¨ç½²ç¯èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€å•ä¸€å¯ä¿¡æ•°æ®æºè¿›ä¸€æ­¥è¦†ç›–ç ”å‘æœ¬åœ°ç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å•ä¸€å¯ä¿¡æ•°æ®æºè´¯ç©¿æ•´ä¸ªç ”å‘ä»·å€¼æµäº¤ä»˜è¿‡ç¨‹ï¼Œåœ¨ç»„ç»‡å†…éƒ¨å¼€æ”¾å…±äº«ï¼Œå»ºç«‹çŸ¥è¯†ç§¯ç´¯å’Œç»éªŒå¤ç”¨ä½“ç³»ã€‚&lt;/p&gt;
&lt;p&gt;5ã€å˜æ›´è¿‡ç¨‹&lt;/p&gt;
&lt;p&gt;Â·       Aã€å˜æ›´è¿‡ç¨‹ä¸å—æ§ä¸”å˜æ›´ä¿¡å˜æ›´é—®é¢˜å®šä½å›°éš¾ä¸”å›æ»šæ“ä½œå…·æœ‰é«˜é£é™©åˆ†æ•£åœ¨æ¯ä¸ªç³»ç»Ÿå†…éƒ¨ï¼Œç¼ºä¹ä¿¡æ¯çš„æœ‰æ•ˆå…±äº«æœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€ä»£ç å˜æ›´è¿‡ç¨‹åº”é™„å¸¦å˜æ›´ç®¡ç†ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ‰€æœ‰é…ç½®é¡¹å˜æ›´ç”±å˜æ›´ç®¡ç†ç³»ç»Ÿè§¦å‘ï¼Œå¹¶ä½œä¸ºç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„å¼ºåˆ¶è¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€ä½¿ç”¨åŒä¸€å¥—å˜æ›´ç®¡ç†ç³»ç»Ÿè¦†ç›–ä»éœ€æ±‚åˆ°éƒ¨ç½²å‘å¸ƒå…¨æµç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å¯è§†åŒ–å˜æ›´ç”Ÿå‘½å‘¨æœŸï¼Œæ”¯æŒå…¨ç¨‹æ•°æ®åˆ†æç®¡ç†å’Œæ»¡è¶³å®¡è®¡è¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;6ã€å˜æ›´è¿½æº¯&lt;/p&gt;
&lt;p&gt;Â·       Aã€å˜æ›´ç¼ºä¹åŸºæœ¬çš„å¯è¿½æº¯æ€§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æœ‰æ¸…æ™°å®šä¹‰çš„è½¯ä»¶ç‰ˆæœ¬å·è§„åˆ™ï¼Œå®ç°ç‰ˆæœ¬å’Œä»£ç çš„å…³è”ï¼Œå¯è¿½æº¯ç‰ˆæœ¬æ„å»ºå¯¹åº”çš„å®Œæ•´æºä»£ç ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å®ç°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå’Œå˜æ›´ç®¡ç†ç³»ç»Ÿçš„è‡ªåŠ¨åŒ–å…³è”ï¼Œä¿¡æ¯åŒå‘åŒæ­¥å’Œå®æ—¶å¯è¿½æº¯ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å˜æ›´ä¾èµ–è¢«è¯†åˆ«å’Œæ ‡è®°ï¼Œå®ç°æ•°æ®åº“å’Œç¯å¢ƒå˜æ›´ä¿¡æ¯çš„å¯è¿½æº¯ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å®ç°ä»éœ€æ±‚åˆ°éƒ¨ç½²å‘å¸ƒå„ä¸ªç¯èŠ‚çš„ç›¸å…³å…¨éƒ¨ä¿¡æ¯çš„å…¨ç¨‹å¯è¿½æº¯ã€‚&lt;/p&gt;
&lt;p&gt;7ã€å˜æ›´å›æ»š&lt;/p&gt;
&lt;p&gt;Â·       Aã€å˜æ›´é—®é¢˜å®šä½å›°éš¾ä¸”å›æ»šæ“ä½œå…·æœ‰é«˜é£é™©ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€å¯æ”¯æŒç‰ˆæœ¬é—´å·®å¼‚å¯¹æ¯”å’Œä»£ç çº§åˆ«é—®é¢˜å®šä½å’Œå›æ»šã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å®ç°å˜æ›´ç®¡ç†ç³»ç»Ÿå’Œç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„åŒæ­¥å›æ»šï¼Œä¿è¯çŠ¶æ€çš„ä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å¯æ ¹æ®å˜æ›´ç®¡ç†ç³»ç»ŸæŒ‰éœ€å¿«é€Ÿå¯¼å‡ºå¤ç”¨è½¯ä»¶ä»£ç å˜æ›´é›†ï¼Œå¦‚å»ºç«‹ä»å˜æ›´ç®¡ç†ç³»ç»Ÿåˆ°è½¯ä»¶ä»£ç å˜æ›´é›†çš„å…³ç³»æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æ”¯æŒä»»ä½•æ—¶é—´ç‚¹å…¨éƒ¨çŠ¶æ€çš„è‡ªåŠ¨åŒ–å›æ»šéœ€æ±‚ã€‚&lt;/p&gt;
&lt;h2 id="_2"&gt;ï¼ˆäºŒï¼‰æ„å»ºä¸æŒç»­é›†æˆ&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;1ã€æ„å»ºæ–¹å¼&lt;/p&gt;
&lt;p&gt;Â·       Aã€é‡‡ç”¨æ‰‹å·¥æ–¹å¼è¿›è¡Œæ„å»ºï¼Œæ„å»ºè¿‡ç¨‹ä¸å¯é‡å¤ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€å®ç°è„šæœ¬è‡ªåŠ¨åŒ–ï¼Œé€šè¿‡æ‰‹å·¥é…ç½®å®Œæˆæ„å»ºã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å®šä¹‰ç»“æ„åŒ–æ„å»ºè„šæœ¬ï¼Œå®ç°æ¨¡å—çº§å…±äº«å¤ç”¨å’Œç»Ÿä¸€ç»´æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å®ç°æ„å»ºæœåŠ¡åŒ–ï¼Œå¯æŒ‰éœ€æä¾›æ¥å£å’Œç”¨æˆ·ç•Œé¢ç”¨äºå¯è§†åŒ–æ„å»ºç¼–æ’ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­ä¼˜åŒ–çš„æ„å»ºæœåŠ¡å¹³å°ï¼ŒæŒç»­æ”¹è¿›æœåŠ¡æ˜“ç”¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;2ã€æ„å»ºç¯å¢ƒ&lt;/p&gt;
&lt;p&gt;Â·       Aã€ä½¿ç”¨æœ¬åœ°è®¾å¤‡ï¼Œæ„å»ºç¯å¢ƒä¸å¯é ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æœ‰ç‹¬ç«‹çš„æ„å»ºæœåŠ¡å™¨ï¼Œå¤šç§ä»»åŠ¡å…±äº«æ„å»ºç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ„å»ºç¯å¢ƒé…ç½®å®ç°æ ‡å‡†åŒ–ï¼Œæœ‰ç‹¬ç«‹çš„æ„å»ºé›†ç¾¤ï¼Œå•æ¬¡æ„å»ºæ§åˆ¶åœ¨å°æ—¶çº§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€ä¼˜åŒ–æ„å»ºé€Ÿåº¦ï¼Œå®ç°å¢é‡åŒ–æ„å»ºå’Œæ¨¡å—åŒ–æ„å»ºï¼Œå•æ¬¡æ„å»ºæ§åˆ¶åœ¨åˆ†é’Ÿçº§ï¼Œå¦‚å¯é‡‡ç”¨åˆ†å¸ƒå¼æ„å»ºé›†ç¾¤ã€æ„å»ºç¼“å­˜ç­‰æŠ€æœ¯ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­æ”¹è¿›æ„å»ºæ€§èƒ½ï¼Œå®ç°æ„å»ºèµ„æºå…±äº«å’ŒåŠ¨æ€æŒ‰éœ€åˆ†é…å›æ”¶ï¼Œå¦‚æ­å»ºåŸºäºäº‘æœåŠ¡è™šæ‹ŸåŒ–å’Œå®¹å™¨åŒ–çš„åˆ†å¸ƒå¼æ„å»ºé›†ç¾¤ã€‚&lt;/p&gt;
&lt;p&gt;3ã€æ„å»ºè®¡åˆ’&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ²¡æœ‰æ˜ç¡®çš„ç‰ˆæœ¬å·è§„åˆ™å’Œæ„å»ºä»»åŠ¡è®¡åˆ’ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æ˜ç¡®å®šä¹‰ç‰ˆæœ¬å·è§„åˆ™ï¼Œå¹¶æ ¹æ®å‘å¸ƒç­–ç•¥ç»†åˆ†æ„å»ºç±»å‹ï¼Œå®ç°æ¯æ—¥è‡ªåŠ¨æ„å»ºã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ˜ç¡®å®šä¹‰æ„å»ºè®¡åˆ’å’Œè§„åˆ™ï¼Œå®ç°ä»£ç æäº¤è§¦å‘æ„å»ºå’Œå®šæœŸè‡ªåŠ¨æ‰§è¡Œæ„å»ºã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€åˆ†çº§æ„å»ºè®¡åˆ’ï¼Œå®ç°æŒ‰éœ€æ„å»ºå¹¶è¾¾åˆ°èµ„æºå’Œé€Ÿåº¦çš„æœ‰æ•ˆå¹³è¡¡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€åˆ†çº§æ„å»ºè®¡åˆ’ï¼Œå®ç°æŒ‰éœ€æ„å»ºå¹¶è¾¾åˆ°èµ„æºå’Œé€Ÿåº¦çš„æœ‰æ•ˆå¹³è¡¡ã€‚&lt;/p&gt;
&lt;p&gt;4ã€æ„å»ºèŒè´£&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ„å»ºå·¥å…·å’Œç¯å¢ƒå—é™äºå›¢é˜Ÿäººå‘˜èƒ½åŠ›ï¼Œé¢‘ç¹æ‰‹åŠ¨å¹²é¢„ç»´æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æ„å»ºå·¥å…·å’Œç¯å¢ƒç”±ä¸“äººè´Ÿè´£ç»´æŠ¤ï¼Œå¹¶ä½¿ç”¨æƒé™éš”ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ„å»ºå·¥å…·å’Œç¯å¢ƒç”±ä¸“é—¨å›¢é˜Ÿç»´æŠ¤ï¼Œå¹¶ç»†åˆ†å›¢é˜Ÿäººå‘˜èŒè´£ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æ„å»ºç³»ç»ŸæœåŠ¡åŒ–æä¾›æ›´å¤šç”¨æˆ·ä½¿ç”¨ï¼Œæ„å»ºä¸å†å±€é™äºä¸“ä¸šå›¢é˜Ÿè¿›è¡Œã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å°†æ„å»ºèƒ½åŠ›èµ‹äºˆå…¨éƒ¨å›¢é˜Ÿæˆå‘˜ï¼Œå¹¶æŒ‰éœ€è§¦å‘æ„å»ºå®ç°å¿«é€Ÿåé¦ˆã€‚&lt;/p&gt;
&lt;h2 id="_3"&gt;ï¼ˆä¸‰ï¼‰æ„å»ºä¸æŒç»­é›†æˆ&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;1ã€é›†æˆæœåŠ¡&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ²¡æœ‰æ­å»ºæŒç»­é›†æˆæœåŠ¡ï¼Œå›¢é˜Ÿæˆå‘˜ç¼ºä¹å¯¹æŒç»­é›†æˆçš„ç†è§£ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æ­å»ºç»Ÿä¸€çš„æŒç»­é›†æˆæœåŠ¡å¹¶å¯¹ç³»ç»Ÿè¿› è¡Œæ—¥å¸¸ç»´æŠ¤å’Œç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€ç»„å»ºä¸“é—¨çš„æŒç»­é›†æˆå›¢é˜Ÿï¼Œè´Ÿè´£ä¼˜åŒ–æŒç»­é›†æˆç³»ç»Ÿå’ŒæœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æŒç»­é›†æˆåµŒå…¥æ¯ä¸ªç ”å‘å›¢é˜Ÿæ—¥å¸¸æ´»åŠ¨ï¼Œå®ç°æŒç»­é›†æˆç³»ç»ŸæœåŠ¡åŒ–å’Œè‡ªåŠ©åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­ä¼˜åŒ–å’Œæ”¹è¿›å›¢é˜ŸæŒç»­é›†æˆæœåŠ¡ï¼Œå®ç°ç»„ç»‡äº¤ä»˜èƒ½åŠ›æå‡ã€‚&lt;/p&gt;
&lt;p&gt;2ã€é›†æˆé¢‘ç‡&lt;/p&gt;
&lt;p&gt;Â·       Aã€é•¿æœŸæœ¬åœ°å¼€å‘ä»£ç é›†æˆé¢‘ç‡å‡ å‘¨æˆ–è€…å‡ æœˆä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€é‡‡ç”¨å›¢é˜Ÿå®šæœŸç»Ÿä¸€é›†æˆçš„ç­–ç•¥ï¼Œä»£ç é›†æˆé¢‘ç‡å‡ å¤©æˆ–è€…å‡ å‘¨ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€ç ”å‘äººå‘˜è‡³å°‘æ¯å¤©å‘ä»£ç ä¸»å¹²é›†æˆä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€ç ”å‘äººå‘˜æ¯å¤©å¤šæ¬¡å‘ä»£ç ä¸»å¹²é›†æˆï¼Œæ¯æ¬¡é›†æˆä»£ä»·è¾ƒä½ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€ä»»ä½•å˜æ›´(ä»£ç ï¼Œé…ç½®ï¼Œç¯å¢ƒ)éƒ½ä¼šè§¦å‘å®Œæ•´çš„æŒç»­é›†æˆæµç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;3ã€é›†æˆæ–¹å¼&lt;/p&gt;
&lt;p&gt;Â·       Aã€ä»£ç é›†æˆä½œä¸ºè½¯ä»¶äº¤ä»˜æµç¨‹ä¸­çš„ä¸€ä¸ªç‹¬ç«‹é˜¶æ®µã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€åœ¨éƒ¨åˆ†åˆ†æ”¯ä¸Šè¿›è¡Œæ¯å¤©å¤šæ¬¡çš„å®šæ—¶æ„å»ºã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ¯æ¬¡ä»£ç æäº¤è§¦å‘è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ„å»ºé—®é¢˜é€šè¿‡è‡ªåŠ¨åˆ†æç²¾å‡†æ¨é€ç›¸å…³äººå‘˜å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æ¯æ¬¡ä»£ç æäº¤æ„å»ºè§¦å‘è‡ªåŠ¨åŒ–æµ‹è¯•å’Œé™æ€ä»£ç æ£€æŸ¥ï¼Œæµ‹è¯•é—®é¢˜è‡ªåŠ¨ä¸ŠæŠ¥å˜æ›´ç®¡ç†ç³»ç»Ÿï¼Œæµ‹è¯•ç»“æœä½œä¸ºç‰ˆæœ¬è´¨é‡æ ‡å‡†è¦æ±‚ï¼Œå¦‚ï¼šé‡‡å–è´¨é‡é—¨ç¦ç­‰æ–¹å¼å¼ºåŒ–ä¸»å¹²ä»£ç è´¨é‡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å®ç°æŒç»­é›†æˆåˆ†çº§å’Œè‡ªåŠ¨åŒ–æµ‹è¯•åˆ†çº§ï¼Œæ»¡è¶³ä¸åŒæ¨¡å—å’Œé›†æˆé˜¶æ®µçš„å·®å¼‚åŒ–éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;4ã€åé¦ˆå‘¨æœŸ&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ¯æ¬¡é›†æˆä¼´éšå¤§é‡çš„é—®é¢˜å’Œå†²çªï¼Œé›†æˆæœŸé—´ä¸»å¹²åˆ†æ”¯é•¿æœŸä¸å¯ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€é›†æˆé—®é¢˜åé¦ˆå’Œè§£å†³éœ€è¦åŠå¤©æˆ–è€…æ›´é•¿æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€é›†æˆé—®é¢˜åé¦ˆå’Œè§£å†³å¯ä»¥åœ¨å‡ ä¸ªå°æ—¶å†…å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€é›†æˆé—®é¢˜åé¦ˆå’Œè§£å†³æ§åˆ¶åœ¨ 30åˆ†é’Ÿä»¥å†…å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€é›†æˆé—®é¢˜åé¦ˆå’Œè§£å†³æ§åˆ¶åœ¨ 10åˆ†é’Ÿä»¥å†…å®Œæˆã€‚&lt;/p&gt;
&lt;h2 id="_4"&gt;ï¼ˆå››ï¼‰æµ‹è¯•ç®¡ç†&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;1ã€åˆ†å±‚æ–¹æ³•&lt;/p&gt;
&lt;p&gt;Â·       Aã€åªè¿›è¡Œç”¨æˆ·/ä¸šåŠ¡çº§çš„ UI æµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€é‡‡ç”¨æ¥å£/æœåŠ¡çº§æµ‹è¯•å¯¹æ¨¡å—/æœåŠ¡è¿›è¡Œè¦†ç›–å…¨é¢çš„æ¥å£æµ‹è¯•ï¼›é‡‡ç”¨ä»£ç çº§æµ‹è¯•å¯¹æ ¸å¿ƒæ¨¡å—çš„å‡½æ•°æˆ–ç±»æ–¹æ³•è¿›è¡Œå•å…ƒæµ‹è¯•ï¼›å¯¹ç³»ç»Ÿè¿›è¡ŒåŸºæœ¬çš„æ€§èƒ½æµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€é‡‡ç”¨ä»£ç çº§æµ‹è¯•å¯¹æ¨¡å—çš„å‡½æ•°æˆ–ç±»æ–¹æ³•è¿›è¡Œè¦†ç›–å…¨é¢çš„å•å…ƒæµ‹è¯•ï¼›ç³»ç»Ÿå…¨é¢çš„è¿›è¡Œæ€§èƒ½ã€å®¹é‡ã€ç¨³å®šæ€§ã€å¯é æ€§ã€æ˜“ç”¨æ€§ã€å…¼å®¹æ€§ã€å®‰å…¨æ€§ç­‰éåŠŸèƒ½æ€§æµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€é‡‡ç”¨æµ‹è¯•é©±åŠ¨å¼€å‘çš„æ–¹å¼,è¿›è¡Œä»£ç çº§ã€æ¥å£çº§æµ‹è¯•ï¼›é‡‡ç”¨æ¢ç´¢æ€§æµ‹è¯•æ–¹æ³•å¯¹éœ€æ±‚è¿›è¡Œæ·±å…¥æŒ–æ˜æµ‹è¯•&lt;/p&gt;
&lt;p&gt;Â·       Eã€é‡‡ç”¨éªŒæ”¶æµ‹è¯•é©±åŠ¨å¼€å‘çš„æ–¹å¼è¿›è¡Œç”¨æˆ·/ä¸šåŠ¡çº§çš„ UIæµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;2ã€åˆ†å±‚ç­–ç•¥&lt;/p&gt;
&lt;p&gt;Â·       Aã€å°šæœªå»ºç«‹æµ‹è¯•åˆ†å±‚ç­–ç•¥ï¼Œæµ‹è¯•ä¸åˆ†å±‚ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æµ‹è¯•å¼€å§‹åˆ†å±‚ï¼Œä½†å¯¹æµ‹è¯•åˆ†å±‚ç­–ç•¥ç¼ºä¹ç³»ç»Ÿçš„è§„åˆ’ï¼Œå¯¹ç”¨æˆ·/ä¸šåŠ¡çº§æµ‹è¯•ã€æ¥å£/æœåŠ¡çº§ã€ä»£ç çº§æµ‹è¯•åˆ†å¸ƒæ¯”ä¾‹ç”±é«˜åˆ°ä½ï¼Œå„å±‚æµ‹è¯•ç¼ºä¹æœ‰æ•ˆçš„è®¾è®¡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å¯¹æµ‹è¯•åˆ†å±‚ç­–ç•¥è¿›è¡Œç³»ç»Ÿçš„è§„åˆ’ï¼Œç”¨æˆ·/ä¸šåŠ¡çº§ã€æ¥å£/æœåŠ¡çº§ã€ä»£ç çº§æµ‹è¯•åˆ†å¸ƒæ¯”ä¾‹ç”±ä½åˆ°é«˜ï¼Œå……åˆ†è®¾è®¡;ä»£ç å¯¹éåŠŸèƒ½æ€§æµ‹è¯•è¿›è¡Œå…¨é¢ç³»ç»Ÿçš„è®¾è®¡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æµ‹è¯•åˆ†å±‚ç­–ç•¥çš„å„å±‚æµ‹è¯•å…·æœ‰äº¤å‰äº’è¡¥æ€§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å®šæœŸéªŒè¯æµ‹è¯•åˆ†å±‚ç­–ç•¥ï¼Œæ˜¯å¦å®Œæ•´æœ‰æ•ˆï¼ŒæŒç»­ä¼˜åŒ–ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;3ã€æµ‹è¯•æ—¶æœº&lt;/p&gt;
&lt;p&gt;Â·       Aã€æµ‹è¯•åœ¨è½¯ä»¶äº¤ä»˜è¿‡ç¨‹ä¸­åœ¨å¼€å‘å®Œæˆåæ‰ä»‹å…¥ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æµ‹è¯•åœ¨æŒç»­äº¤ä»˜è¿‡ç¨‹ä¸­çš„ä»‹å…¥æ—¶é—´æå‰åˆ°å¼€å‘çš„é›†æˆé˜¶æ®µï¼Œæ¥å£/æœåŠ¡çº§æµ‹è¯•åœ¨æ¨¡å—çš„æ¥å£å¼€å‘å®Œæˆåè¿›è¡Œã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æµ‹è¯•åœ¨æŒç»­äº¤ä»˜è¿‡ç¨‹ä¸­çš„ä»‹å…¥æ—¶é—´æå‰åˆ°å¼€å‘çš„ç¼–ç é˜¶æ®µï¼Œä»£ç çº§æµ‹è¯•åœ¨æ¨¡å—çš„å‡½æ•°æˆ–ç±»æ–¹æ³•å¼€å‘å®Œæˆåè¿›è¡Œã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€ä»£ç çº§æµ‹è¯•åœ¨æ¨¡å—çš„å‡½æ•°æˆ–ç±»æ–¹æ³•å¼€å‘è¿‡ç¨‹ä¸­åŒæ­¥è¿›è¡Œå’Œå®Œæˆï¼›æ¥å£/æœåŠ¡çº§æµ‹è¯•åœ¨æ¨¡å—çš„æ¥å£å¼€å‘è¿‡ç¨‹ä¸­åŒæ­¥è¿›è¡Œå’Œå®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€åœ¨éœ€æ±‚é˜¶æ®µè¿›è¡Œç”¨æˆ·/ä¸šåŠ¡çº§æµ‹å®šæœŸéªŒè¯æµ‹è¯•è®¾è®¡ï¼Œåœ¨éœ€æ±‚ç‰¹æ€§å¹¶å‘ã€äº¤ä»˜ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸­åŒæ­¥è¿›è¡Œå¹¶å®Œæˆæµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;4ã€è´¨é‡è§„çº¦&lt;/p&gt;
&lt;p&gt;Â·       Aã€ä»£ç è´¨é‡æ£€æŸ¥æ— ä»»ä½•è§„çº¦ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€ä»£ç è´¨é‡æ£€æŸ¥å…·å¤‡åŸºæœ¬è§„çº¦ï¼Œä½†è¿˜ç¼ºä¹å®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€ä»£ç è´¨é‡æ£€æŸ¥å…·å¤‡å®Œæ•´ã€æœ‰æ•ˆå’Œå¼ºåˆ¶æ‰§è¡Œçš„è§„çº¦ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€ä»£ç è´¨é‡æ£€æŸ¥è§„çº¦æ ¹æ®éœ€è¦å¯è¿›è¡Œæ‰©å±•å’Œå®šåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å®šæœŸéªŒè¯ä»£ç è´¨é‡è§„çº¦çš„å®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼ŒæŒç»­ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;5ã€æ£€æŸ¥ç­–ç•¥&lt;/p&gt;
&lt;p&gt;Â·       Aã€ä»£ç è´¨é‡æ£€æŸ¥æ— é’ˆå¯¹æ£€æŸ¥èŒƒå›´ã€è´¨é‡é—¨é™ç­‰ç›¸å…³çš„ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€ä»£ç è´¨é‡æ£€æŸ¥æœ‰é’ˆå¯¹æ£€æŸ¥èŒƒå›´ã€è´¨é‡é—¨é™çš„ç­–ç•¥ï¼Œå¯¹ä»£ç è§„èŒƒã€é”™è¯¯å’Œåœˆå¤æ‚åº¦ã€é‡å¤åº¦ç­‰è´¨é‡æŒ‡æ ‡è¿›ã€‚è¡Œæ£€æŸ¥åˆ†æ&lt;/p&gt;
&lt;p&gt;Â·       Cã€ä»£ç è´¨é‡æ£€æŸ¥å°†å®‰å…¨æ¼æ´æ£€æŸ¥ã€åˆè§„æ£€æŸ¥çº³å…¥åˆ°æ£€æŸ¥èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€ä»£ç è´¨é‡æ£€æŸ¥é’ˆå¯¹æ£€æŸ¥èŒƒå›´ã€è´¨é‡é—¨é™çš„ç­–ç•¥å¯æ ¹æ®éœ€è¦çµæ´»è°ƒæ•´ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å®šæœŸéªŒè¯ä»£ç è´¨é‡ç­–ç•¥çš„å®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼ŒæŒç»­ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;6ã€æ£€æŸ¥æ–¹å¼&lt;/p&gt;
&lt;p&gt;Â·       Aã€ä»£ç è´¨é‡æ£€æŸ¥é‡‡ç”¨äººå·¥æ–¹å¼è¿›è¡Œè¯„å®¡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€ä»£ç è´¨é‡æ£€æŸ¥é‡‡ç”¨è‡ªåŠ¨åŒ–ç»“åˆæ‰‹å·¥æ–¹å¼è¿›è¡Œã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€ä»£ç è´¨é‡æ£€æŸ¥å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œä¸éœ€è¦æ‰‹å·¥å¹²é¢„ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å¯¹ä»£ç è´¨é‡æ£€æŸ¥å‘ç°çš„éƒ¨åˆ†é—®é¢˜è‡ªåŠ¨æå‡ºä¿®æ”¹å»ºè®®ï¼Œæ”¯æŒå¯è§†åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å…·å¤‡ä¼ä¸šçº§çš„ä»£ç è´¨é‡ç®¡ç†å¹³å°ï¼Œä»¥æœåŠ¡çš„å½¢å¼æä¾›å¯¹ä»£ç è´¨é‡çš„æ£€æŸ¥åˆ†æã€‚&lt;/p&gt;
&lt;p&gt;7ã€åé¦ˆå¤„ç†&lt;/p&gt;
&lt;p&gt;Â·       Aã€å¯¹ä»£ç è´¨é‡æ£€æŸ¥ç»“æœå¤„ç†ä¸åŠæ—¶ï¼Œé—ç•™å¤§é‡æŠ€æœ¯å€ºã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€å¯¹ä»£ç è´¨é‡æ£€æŸ¥ç»“æœç»™å‡ºåé¦ˆï¼Œæ ¹æ®åé¦ˆè¿›è¡Œå¤„ç†ï¼Œå¯¹é—ç•™çš„éƒ¨åˆ†æŠ€æœ¯å€ºä¹è·Ÿè¸ªå’Œç®¡ç†ï¼Œå¯¼è‡´é—æ¼ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ ¹æ®ä»£ç è´¨é‡æ£€æŸ¥ç»“æœåé¦ˆåŠæ—¶å¤„ç†ï¼ŒæŠ€æœ¯å€ºä»æœ‰çŸ­æœŸé—ç•™ï¼Œä½†è¿›è¡Œæœ‰æ•ˆçš„è·Ÿè¸ªã€ç®¡ç†å’Œå¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å°†æ£€æŸ¥ç»“æœå¼ºåˆ¶ä½œä¸ºç‰ˆæœ¬è´¨é‡æ ‡å‡†è¦æ±‚ï¼Œæ ¹æ®ä»£ç è´¨é‡æ£€æŸ¥æå‡ºçš„ä¿®æ”¹å»ºè®®ï¼Œå¯¹é—®é¢˜åŠæ—¶å¤„ç†ï¼Œåœ¨ç ”å‘é˜¶æ®µä¸»åŠ¨è§£å†³æŠ€æœ¯å€ºã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å¯¹ä»£ç è´¨é‡æ•°æ®è¿›è¡Œç»Ÿä¸€ç®¡ç†ï¼Œå¯æœ‰æ•ˆè¿½æº¯å¹¶å¯¹ä»£ç è´¨é‡è¿›è¡Œæœ‰æ•ˆåº¦é‡ã€‚&lt;/p&gt;
&lt;p&gt;8ã€è‡ªåŠ¨åŒ–è®¾è®¡&lt;/p&gt;
&lt;p&gt;Â·       Aã€æœªé‡‡ç”¨è‡ªåŠ¨åŒ–æ–¹å¼æµ‹è¯•ï¼Œçº¯æ‰‹å·¥æµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€å°šæœªå¯¹æµ‹è¯•ç”¨ä¾‹ä¸­è‡ªåŠ¨åŒ–éƒ¨åˆ†è¿›è¡Œè§„åˆ’å’Œè®¾è®¡ï¼Œè¦†ç›–ä¸å®Œæ•´ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ ¹æ®éœ€æ±‚ã€æ¥å£å’Œä»£ç å¯¹ä¸åŒæµ‹è¯•åˆ†å±‚ä¸­è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹è¿›è¡Œè§„åˆ’å’Œè®¾è®¡ï¼Œè‡ªåŠ¨åŒ–è¦†ç›–æ¯”è¾ƒå®Œæ•´ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å¯¹æ€§èƒ½ã€ç¨³å®šæ€§ã€å¯é æ€§ã€å®‰å…¨æ€§ç­‰éåŠŸèƒ½æ€§æµ‹è¯•ä¸­è‡ªåŠ¨åŒ–ç”¨ä¾‹è¿›è¡Œè§„åˆ’å’Œè®¾è®¡ï¼Œè‡ªåŠ¨åŒ–è¦†ç›–å®Œæ•´ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å¯¹æ•…éšœå’Œæµ‹è¯•è¿›è¡Œå¤ç›˜ï¼Œå¯¹é—æ¼çš„æµ‹è¯•ç”¨ä¾‹è¿›è¡Œè¡¥å……ï¼Œä¸æ–­ä¼˜åŒ–å’Œå®Œå–„ï¼ŒæŒç»­æå‡è¦†ç›–ç‡ã€‚&lt;/p&gt;
&lt;p&gt;9ã€è‡ªåŠ¨åŒ–å¼€å‘&lt;/p&gt;
&lt;p&gt;Â·       Aã€å°šæœªå¯¹è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬è¿›è¡Œå¼€å‘å’Œç®¡ç†ï¼Œæ‰‹å·¥æµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€å¯¹è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬è¿›è¡Œå¼€å‘å’Œæœ¬åœ°ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬å¼€å‘é‡‡ç”¨æ•°æ®é©±åŠ¨ã€å…³é”®å­—é©±åŠ¨ç­‰æ–¹æ³•ï¼›ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå¯¹è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬è¿›è¡Œæœ‰æ•ˆç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹è„šæœ¬é—´å…·å¤‡ç‹¬ç«‹æ€§å’Œå¤§æ‰¹é‡æ‰§è¡Œçš„å¥å£®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€è‡ªåŠ¨åŒ–è„šæœ¬æ˜¯æµ‹è¯•ç”¨ä¾‹è®¾è®¡çš„æ´»æ–‡æ¡£ï¼Œè‡ªåŠ¨åŒ–è„šæœ¬å¼€å‘å’Œæµ‹è¯•ç”¨ä¾‹è®¾è®¡å®Œå…¨ç»Ÿä¸€ã€‚&lt;/p&gt;
&lt;p&gt;10ã€è‡ªåŠ¨åŒ–æ‰§è¡Œ&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ‰‹å·¥æµ‹è¯•æ‰§è¡Œæ•ˆç‡ä½ä¸‹ï¼Œä»¥å‘¨çº§ä¸ºå•ä½ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€å¯¹ç”¨æˆ·/ä¸šåŠ¡çº§æµ‹è¯•é‡‡ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•çš„æ‰§è¡Œæ•ˆç‡ä¸é«˜ï¼Œä»¥å¤©çº§ä¸ºå•ä½ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€ä»ä»£ç çº§ã€æ¥å£çº§UIçº§æµ‹è¯•å®ç°äº†ç«¯åˆ°ç«¯çš„è‡ªåŠ¨åŒ–æµ‹è¯•æ‰“é€šï¼›è‡ªåŠ¨åŒ–æµ‹è¯•æ‰§è¡Œæ•ˆç‡è¾ƒé«˜ï¼Œä»£ç çº§æµ‹è¯•åˆ†é’Ÿçº§ï¼ŒUIçº§æµ‹è¯•å°æ—¶çº§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æœ‰ç»„ç»‡çº§çš„ç»Ÿä¸€è‡ªåŠ¨åŒ–æµ‹è¯•å¹³å°ï¼Œå’Œä¸Šä¸‹æ¸¸éœ€æ±‚ã€æ•…éšœç³»ç»Ÿæ‰“é€šï¼›å¯ä»¥æ ¹æ®éœ€æ±‚é’ˆå¯¹æ€§è‡ªåŠ¨å…³è”é€‰æ‹©è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹è„šæœ¬æ‰§è¡Œï¼›å¯ä»¥å°†ç”±äºç‰ˆå’Œæ•…éšœå…³è”ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€é‡‡ç”¨ä¼ä¸šçº§ç»Ÿä¸€çš„è‡ªåŠ¨åŒ–æµ‹è¯•å¹³å°ï¼Œä»¥äº‘åŒ–çš„æ–¹å¼æä¾›æµ‹è¯•æœåŠ¡ï¼Œè¿›è¡Œåˆ†å¸ƒå¼æµ‹è¯•è°ƒåº¦æ‰§è¡Œï¼Œæé«˜æµ‹è¯•æ‰§è¡Œæ•ˆç‡å’Œèµ„æºåˆ©ç”¨ç‡ï¼›å®šæœŸéªŒè¯è‡ªåŠ¨åŒ–æ‰§è¡Œç­–ç•¥,æŒç»­ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;11ã€è‡ªåŠ¨åŒ–åˆ†æ&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ‰‹å·¥å¯¹æµ‹è¯•ç»“æœè¿›è¡Œåˆ†æåˆ¤æ–­ï¼Œé”™è¯¯é«˜ï¼Œå¯ä¿¡åº¦ä½ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€å¯¹è‡ªåŠ¨åŒ–æµ‹è¯•ç»“æœå…·å¤‡ä¸€å®šçš„è‡ªåŠ¨åˆ¤æ–­èƒ½åŠ›ï¼Œå­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥ï¼Œå¯ä¿¡åº¦ä¸è¶³ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å¯¹è‡ªåŠ¨åŒ–æµ‹è¯•ç»“æœå…·å¤‡è¾ƒå¼ºçš„è‡ªåŠ¨åˆ¤æ–­èƒ½åŠ›ï¼Œè¯¯æŠ¥å°‘ï¼Œå¯ä¿¡åº¦é«˜ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€è‡ªåŠ¨åŒ–æµ‹è¯•æ•°æ®æ¨¡å‹æ ‡å‡†åŒ–ï¼Œå’Œä¸Šä¸‹æ¸¸éœ€æ±‚ã€æ•…éšœç­‰ç ”å‘æ•°æ®å…³è”ï¼Œå¯ä»¥å¯¹è‡ªåŠ¨åŒ–æµ‹è¯•æ•ˆæœè¿›è¡Œåº¦é‡åˆ†æã€‚ä¾‹å¦‚ï¼šéœ€æ±‚æµ‹è¯•è¦†ç›–ç‡ã€æµ‹è¯•é€šè¿‡ç‡å’Œæµ‹è¯•æ•ˆç‡ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å¯¹è‡ªåŠ¨åŒ–æµ‹è¯•ç»“æœå¯ä»¥æ™ºèƒ½åˆ†æï¼Œè‡ªåŠ¨åˆ†æå¤±è´¥ç”¨ä¾‹çš„å¤±è´¥ç±»å‹åŠåŸå› ï¼Œå¯ä»¥è‡ªåŠ¨å‘æ•…éšœç®¡ç†ç³»ç»Ÿæäº¤æ•…éšœï¼Œå¯ä¿¡åº¦é«˜ã€‚&lt;/p&gt;
&lt;h2 id="_5"&gt;ï¼ˆäº”ï¼‰éƒ¨ç½²ä¸å‘å¸ƒç®¡ç†&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;1ã€éƒ¨ç½²æ–¹å¼&lt;/p&gt;
&lt;p&gt;Â·       Aã€è¿ç»´äººå‘˜æ‰‹å·¥å®Œæˆæ‰€æœ‰ç¯å¢ƒçš„éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€è¿ç»´äººå‘˜é€šè¿‡è‡ªåŠ¨åŒ–è„šæœ¬å®ç°éƒ¨ç½²è¿‡ç¨‹éƒ¨åˆ†è‡ªåŠ¨åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€éƒ¨ç½²å’Œå‘å¸ƒå®ç°å…¨è‡ªåŠ¨åŒ–ï¼ŒåŒæ—¶æ”¯æŒæ•°æ®åº“è‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€éƒ¨ç½²å‘å¸ƒæœåŠ¡åŒ–ï¼Œå®ç°äº¤ä»˜å›¢é˜Ÿè‡ªåŠ©ä¸€é”®å¼å¤šç¯å¢ƒè‡ªåŠ¨åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­ä¼˜åŒ–çš„éƒ¨ç½²å‘å¸ƒæ¨¡å¼å’Œå·¥å…·ç³»ç»Ÿå¹³å°ã€‚&lt;/p&gt;
&lt;p&gt;2ã€éƒ¨ç½²æ´»åŠ¨&lt;/p&gt;
&lt;p&gt;Â·       Aã€éƒ¨ç½²è¿‡ç¨‹å¤æ‚ä¸å¯æ§ï¼Œä¼´éšå¤§é‡é—®é¢˜å’Œè¾ƒé•¿çš„åœæœºæ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€éƒ¨ç½²è¿‡ç¨‹é€šè¿‡æµç¨‹æ–‡æ¡£å®šä¹‰å®ç°æ ‡å‡†åŒ–æ•´ä½“å¯æ§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€ä½¿ç”¨ç›¸åŒçš„è¿‡ç¨‹å’Œå·¥å…·å®Œæˆæ‰€æœ‰ç¯å¢ƒéƒ¨ç½²ï¼Œä¸€æ¬¡éƒ¨ç½²è¿‡ç¨‹ä¸­ä½¿ç”¨ç›¸åŒçš„æ„å»ºäº§ç‰©ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€éƒ¨ç½²è¿‡ç¨‹å¯çµæ´»å“åº”ä¸šåŠ¡éœ€æ±‚å˜åŒ–é€šè¿‡åˆç†ç»„åˆé«˜æ•ˆç¼–æ’ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­éƒ¨ç½²ï¼Œæ¯æ¬¡å˜æ›´éƒ½è§¦å‘ä¸€æ¬¡è‡ªåŠ¨åŒ–ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;3ã€éƒ¨ç½²ç­–ç•¥&lt;/p&gt;
&lt;p&gt;Â·       Aã€é‡‡ç”¨å®šæœŸå¤§æ‰¹é‡éƒ¨ç½²ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€åº”ç”¨ä½œä¸ºéƒ¨ç½²çš„æœ€å°å•ä½ï¼Œåº”ç”¨å’Œæ•°æ®åº“éƒ¨ç½²å®ç°åˆ†ç¦»ï¼Œå®ç°æµ‹è¯•ç¯å¢ƒçš„è‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å¯è¿è¡Œçš„ç¯å¢ƒä½œä¸ºéƒ¨ç½²çš„æœ€å°å•ä½ï¼Œåº”ç”¨å’Œé…ç½®è¿›è¡Œåˆ†ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€é€šè¿‡å¤šç§éƒ¨ç½²å‘å¸ƒç­–ç•¥ä¿è¯æµç¨‹é£é™©å¯æ§ï¼Œå¦‚ï¼šè“ç»¿éƒ¨ç½²ï¼Œé‡‘ä¸é›€å‘å¸ƒã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€è½¯ä»¶äº¤ä»˜å›¢é˜Ÿè‡ªä¸»è¿›è¡Œå®‰å…¨å¯é çš„éƒ¨ç½²å’Œå‘å¸ƒæ´»åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;4ã€éƒ¨ç½²è´¨é‡&lt;/p&gt;
&lt;p&gt;Â·       Aã€éƒ¨ç½²æ•´ä½“å¤±è´¥ç‡è¾ƒé«˜ï¼Œå¹¶ä¸”æ— æ³•å®ç°å›æ»šï¼Œç”Ÿäº§é—®é¢˜åªèƒ½åœ¨çº¿ä¸Šä¿®å¤ï¼Œä¿®å¤æ—¶é—´ä¸å¯æ§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€å®ç°åº”ç”¨éƒ¨ç½²çš„å›æ»šæ“ä½œï¼Œéƒ¨ç½²å¤±è´¥ç‡ä¸­ç­‰ï¼Œé—®é¢˜å¯åŠæ—¶ä¿®å¤ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€éƒ¨ç½²æ´»åŠ¨é›†æˆè‡ªåŠ¨åŒ–æµ‹è¯•åŠŸèƒ½ï¼Œå¹¶ä»¥æµ‹è¯•ç»“æœä¸ºéƒ¨ç½²å‰ç½®æ¡ä»¶æ¯æ¬¡éƒ¨ç½²æ´»åŠ¨æä¾›å˜æ›´å¯¹è±¡èŒƒå›´æŠ¥å‘Šå’Œæµ‹è¯•æŠ¥å‘Šã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å»ºç«‹ç›‘æ§ä½“ç³»è·Ÿè¸ªå’Œåˆ†æéƒ¨ç½²è¿‡ç¨‹ï¼Œå‡ºç°é—®é¢˜è‡ªåŠ¨åŒ–é™çº§å›æ»šï¼Œå¤±è´¥ç‡è¾ƒä½ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­ä¼˜åŒ–çš„éƒ¨ç½²ç›‘æ§ä½“ç³»å’Œæµ‹è¯•ä½“ç³»ï¼Œéƒ¨ç½²å¤±è´¥ç‡ç»´æŒåœ¨æä½æ°´å¹³ã€‚&lt;/p&gt;
&lt;p&gt;5ã€åä½œæ¨¡å¼&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ•´ä¸ªè½¯ä»¶äº¤ä»˜è¿‡ç¨‹ä¸¥æ ¼éµå¾ªé¢„å…ˆè®¡åˆ’ï¼Œå­˜åœ¨å¤æ‚çš„éƒ¨é—¨é—´åä½œå’Œç­‰å¾…ï¼Œåªæœ‰åœ¨å¼€å‘å®Œæˆåæ‰è¿›è¡Œæµ‹è¯•å’Œéƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€é€šè¿‡å®šä¹‰å®Œæ•´çš„è½¯ä»¶äº¤ä»˜è¿‡ç¨‹å’Œæ¸…æ™°çš„äº¤ä»˜è§„èŒƒï¼Œä¿è¯å›¢é˜Ÿä¹‹é—´äº¤ä»˜çš„æœ‰åºã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å›¢é˜Ÿé—´äº¤ä»˜æŒ‰ç…§çº¦å®šç”±ç³»ç»Ÿé—´è°ƒç”¨å®Œæˆï¼Œä»…åœ¨å¿…è¦ç¯èŠ‚è¿›è¡Œæ‰‹å·¥ç¡®è®¤ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å›¢é˜Ÿé—´ä¾èµ–è§£è€¦ï¼Œå¯å®ç°ç‹¬ç«‹å®‰å…¨çš„è‡ªä¸»éƒ¨ç½²äº¤ä»˜ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­ä¼˜åŒ–çš„äº¤ä»˜ä¸šåŠ¡ç»„ç»‡çµæ´»å“åº”ä¸šåŠ¡å˜åŒ–æ”¹å–„å‘å¸ƒæ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;6ã€æµæ°´çº¿è¿‡ç¨‹&lt;/p&gt;
&lt;p&gt;Â·       Aã€è½¯ä»¶äº¤ä»˜è¿‡ç¨‹ä¸­çš„å¤§éƒ¨åˆ†å·¥ä½œé€šè¿‡æ‰‹å·¥æ–¹å¼å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€è½¯ä»¶äº¤ä»˜è¿‡ç¨‹ä¸­çš„å„ä¸ªç¯èŠ‚å»ºç«‹è‡ªåŠ¨åŒ–èƒ½åŠ›ä»¥æå‡å¤„ç†æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ‰“é€šè½¯ä»¶äº¤ä»˜è¿‡ç¨‹ä¸­çš„å„ä¸ªç¯èŠ‚ï¼Œå»ºç«‹å…¨æµç¨‹çš„è‡ªåŠ¨åŒ–èƒ½åŠ›ï¼Œå¹¶æ ¹æ®è‡ªåŠ¨åŒ–æµ‹è¯•ç»“æœæ§åˆ¶è½¯ä»¶äº¤ä»˜è´¨é‡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å»ºç«‹å¯è§†åŒ–éƒ¨ç½²æµæ°´çº¿ï¼Œè¦†ç›–æ•´ä¸ªè½¯ä»¶äº¤ä»˜è¿‡ç¨‹ï¼Œæ¯æ¬¡å˜æ›´éƒ½ä¼šè§¦å‘å®Œæ•´çš„è‡ªåŠ¨åŒ–éƒ¨ç½²æµæ°´çº¿ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­éƒ¨ç½²æµæ°´çº¿é©±åŠ¨æŒç»­æ”¹è¿›ã€‚&lt;/p&gt;
&lt;p&gt;7ã€è¿‡ç¨‹å¯è§†åŒ–&lt;/p&gt;
&lt;p&gt;Â·       Aã€äº¤ä»˜è¿‡ç¨‹ä¸­çš„ä¿¡æ¯æ˜¯å°é—­çš„ï¼Œäº¤ä»˜çŠ¶æ€ä¸å¯è¿½æº¯ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€äº¤ä»˜è¿‡ç¨‹åœ¨å›¢é˜Ÿå†…éƒ¨å¯è§ï¼Œä¿¡æ¯åœ¨å›¢é˜Ÿé—´å…±äº«ï¼Œäº¤ä»˜çŠ¶æ€å¯è¿½æº¯ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€äº¤ä»˜è¿‡ç¨‹ç»„ç»‡å†…éƒ¨å¯è§ï¼Œå›¢é˜Ÿå…±äº«åº¦é‡æŒ‡æ ‡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€éƒ¨ç½²æµæ°´çº¿å…¨å‘˜å¯è§ï¼Œå¯¹è¿‡ç¨‹ä¿¡æ¯è¿›è¡Œæœ‰æ•ˆèšåˆåˆ†æå±•ç¤ºè¶‹åŠ¿ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€éƒ¨ç½²æµæ°´çº¿è¿‡ç¨‹ä¿¡æ¯è¿›è¡Œæ•°æ®ä»·å€¼æŒ–æ˜ï¼Œæ¨åŠ¨ä¸šåŠ¡æ”¹è¿›ã€‚&lt;/p&gt;
&lt;h2 id="_6"&gt;ï¼ˆå…­ï¼‰ç¯å¢ƒç®¡ç†&lt;a class="headerlink" href="#_6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;1ã€ç¯å¢ƒç±»å‹&lt;/p&gt;
&lt;p&gt;Â·       Aã€ç¯å¢ƒç±»å‹åªæœ‰ç”Ÿäº§ç¯å¢ƒå’Œéç”Ÿäº§ç¯å¢ƒçš„åˆ’åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€ITäº¤ä»˜è¿‡ç¨‹æ„è¯†åˆ°éƒ¨åˆ†æµ‹è¯•ç¯å¢ƒçš„é‡è¦æ€§ï¼Œå¼€å§‹æä¾›åŠŸèƒ½æµ‹è¯•ç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æŒç»­äº¤ä»˜è¿‡ç¨‹æ„è¯†åˆ°ç ”å‘ç¯å¢ƒçš„é‡è¦æ€§ï¼Œå¼€å§‹æä¾›é¢å‘å„ç±»å¼€å‘è€…ç‹¬ç«‹çš„ç ”å‘ å·¥ä½œåŒºã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å…¨é¢çš„æµ‹è¯•ä¸ç°åº¦ç¯å¢ƒå¯¹äºè´¨é‡äº¤ä»˜è¿‡ç¨‹æ¥è¯´éå¸¸é‡è¦ï¼Œæœ‰å„ç±»çš„ç¯å¢ƒç±»å‹åˆ’åˆ†ï¼ŒåŒºåˆ†äº†å¼€å‘è€…ï¼ŒæŠ€æœ¯æµ‹è¯•åŠä¸šåŠ¡æµ‹è¯•ç¯å¢ƒä»¥åŠç°åº¦å‘å¸ƒç¯å¢ƒç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æ ¹æ®ä¸šåŠ¡ä¸åº”ç”¨çš„éœ€è¦ï¼Œå¼¹æ€§åˆ†é…å„ç±»ç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;2ã€ç¯å¢ƒæ¶æ„&lt;/p&gt;
&lt;p&gt;Â·       Aã€ç¯å¢ƒçš„æ„å»ºé€šè¿‡äººå·¥åˆ›å»ºå®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€ç¯å¢ƒæ„å»ºé€šè¿‡ä¸€é”®åŒ–çš„è„šæœ¬æˆ–è€…è™šæ‹Ÿæœºæ¥å®Œæˆçš„ï¼Œæ„å»ºè¿‡ç¨‹å®Œå…¨é»‘ç›’ åŒ–å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€ç¯å¢ƒçš„æ„å»ºé€šè¿‡èµ„æºäº¤ä»˜å¹³å°æ¥å®Œæˆï¼Œå¹¶ä¸”åº•å±‚æ˜¯ç”±äº‘æ¥äº¤ä»˜ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€ç¯å¢ƒçš„æ„å»ºå¯ä»¥é€šè¿‡ Docker å®¹å™¨åŒ–å¿«é€Ÿäº¤ä»˜ï¼Œä½æˆæœ¬æ„å»ºä¸€ä¸ªæ–°çš„ç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€ç¯å¢ƒçš„æ„å»ºç»“åˆåº•å±‚ITèµ„æºçŠ¶å†µï¼Œé‡‡ç”¨äº†å„ç±»æ··åˆITæŠ€æœ¯ï¼Œæ ¹æ®ä¸šåŠ¡åŠåº”ç”¨æ¶æ„å¼¹æ€§æ„å»ºã€‚&lt;/p&gt;
&lt;p&gt;3ã€ç¯å¢ƒä¾èµ–ä¸é…ç½®ç®¡ç†&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ— ä¾èµ–ç®¡ç†ï¼Œç¯å¢ƒçš„ç®¡ç†å°±æ˜¯ä¸€ä¸ªOSçš„äº¤ä»˜ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€ä»¥åº”ç”¨ä¸ºä¸­å¿ƒæœ‰OSçº§åˆ«çš„ä¾èµ–å’Œé…ç½®ç®¡ç†èƒ½åŠ›ï¼Œæ¯”å¦‚è¯´æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€ç»„ä»¶ç‰ˆæœ¬ã€ç¨‹åºåŒ…ç‰ˆæœ¬ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€ä»¥åº”ç”¨ä¸ºä¸­å¿ƒï¼Œæœ‰æœåŠ¡çº§ä¾èµ–çš„é…ç½®ç®¡ç†èƒ½åŠ›ï¼Œæ¯”å¦‚è¯´ä¾èµ–çš„å…³è”æœåŠ¡ï¼ŒMysql æœåŠ¡ã€cache æœåŠ¡ã€å…³è”åº”ç”¨æœåŠ¡ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€ç¯å¢ƒå’Œä¾èµ–é…ç½®ç®¡ç†å¯ä»¥èµ„æºåŒ–æè¿°ï¼Œç±»ä¼¼dockerfileï¼Œå¤§å¤§æå‡å…¶é…ç½®ç®¡ç†èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€ç¯å¢ƒä¾èµ–å’Œé…ç½®å¯ä»¥åšåˆ°å®ä¾‹çº§çš„åŠ¨æ€é…ç½®ç®¡ç†èƒ½åŠ›ï¼Œæ ¹æ®ä¸šåŠ¡å’Œåº”ç”¨æ¶æ„çš„å˜åŒ–è€Œå˜åŒ–ã€‚&lt;/p&gt;
&lt;h2 id="_7"&gt;ï¼ˆä¸ƒï¼‰æ•°æ®ç®¡ç†&lt;a class="headerlink" href="#_7" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;1ã€æ•°æ®æ¥æº&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ¯æ¬¡æµ‹è¯•æ—¶æ‰‹å·¥åˆ›å»ºæ•°æ®ï¼Œæµ‹è¯•æ•°æ®éƒ½æ˜¯ä¸´æ—¶æ€§çš„ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€ä»ç”Ÿäº§ç¯å¢ƒå¯¼å‡ºä¸€ä¸ªå­é›†å¹¶è¿›è¡Œæ¸…æ´—åï¼Œå½¢æˆåŸºå‡†çš„æµ‹è¯•æ•°æ®é›†ï¼Œæ»¡è¶³éƒ¨åˆ†æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œè¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€ä»ç”Ÿäº§ç¯å¢ƒå¯¼å‡ºä¸€ä¸ªå­é›†å¹¶è¿›è¡Œæ¸…æ´—åï¼Œå½¢æˆåŸºå‡†çš„æµ‹è¯•æ•°æ®é›†ï¼Œæ»¡è¶³éƒ¨åˆ†æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œè¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ä¸“å±çš„æµ‹è¯•æ•°æ®éƒ½å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–è°ƒç”¨åº”ç”¨ç¨‹åº API çš„æ–¹å¼è‡ªåŠ¨ç”Ÿæˆã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æ‰€æœ‰çš„åŠŸèƒ½ã€éåŠŸèƒ½æµ‹è¯•çš„æµ‹è¯•æ•°æ®ï¼Œéƒ½å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿã€æ•°æ®åº“è½¬å‚¨æˆ–è°ƒç”¨åº”ç”¨ç¨‹åº API çš„æ–¹å¼è‡ªåŠ¨ç”Ÿæˆã€‚&lt;/p&gt;
&lt;p&gt;2ã€æ•°æ®è¦†ç›–&lt;/p&gt;
&lt;p&gt;Â·       Aã€æµ‹è¯•æ•°æ®è¦†ç›–ç‡ä½ï¼Œä»…æ”¯æŒéƒ¨åˆ†æµ‹è¯•åœºæ™¯ï¼Œæ— æ³•æœ‰æ•ˆæ”¯æŒæµ‹è¯•å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æµ‹è¯•æ•°æ®è¦†ç›–ä¸»è¦åœºæ™¯ï¼ŒåŒ…æ‹¬æ­£å¸¸ç±»å‹ï¼Œé”™è¯¯ç±»å‹ä»¥åŠè¾¹ç•Œç±»å‹ï¼Œå¹¶è¿›è¡Œåˆæ­¥çš„åˆ†ç±»åˆ†çº§ï¼Œæ»¡è¶³ä¸åŒæµ‹ã€‚è¯•ç±»å‹éœ€è¦ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å»ºç«‹ä½“ç³»åŒ–æµ‹è¯•æ•°æ®ï¼Œè¿›è¡Œæ•°æ®ä¾èµ–ç®¡ç†ï¼Œè¦†ç›–æ›´åŠ å¤æ‚çš„ä¸šåŠ¡åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æµ‹è¯•æ•°æ®è¦†ç›–å®‰å…¨æ¼æ´å’Œå¼€æºåˆè§„ç­‰éœ€æ±‚åœºæ™¯å¹¶å»ºç«‹å®šæœŸæ›´æ–°æœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­ä¼˜åŒ–çš„æŒç»­æ•°æ®ç®¡ç†æ–¹å¼å’Œç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;3ã€æ•°æ®ç‹¬ç«‹æ€§&lt;/p&gt;
&lt;p&gt;Â·       Aã€æµ‹è¯•æ•°æ®æ²¡æœ‰ç‰ˆæœ¬æ§åˆ¶å’Œå¤‡ä»½æ¢å¤æœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æµ‹è¯•æ•°æ®æœ‰æ˜ç¡®å¤‡ä»½æ¢å¤æœºåˆ¶ï¼Œå®ç°æµ‹è¯•æ•°æ®å¤ç”¨å’Œä¿è¯æµ‹è¯•ä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹æ‹¥æœ‰ä¸“å±çš„æµ‹è¯•æ•°æ®ï¼Œæœ‰æ˜ç¡®çš„æµ‹è¯•åˆå§‹çŠ¶æ€æµ‹è¯•ç”¨ä¾‹çš„æ‰§è¡Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œæ‰€ã€‚äº§ç”Ÿçš„æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€é€šè¿‡æµ‹è¯•æ•°æ®åˆ†çº§ï¼Œå®ç°ä¸“å±æµ‹è¯•æ•°æ®å’Œé€šç”¨æµ‹è¯•æ•°æ®çš„æœ‰æ•ˆç®¡ç†å’Œçµæ´»ç»„åˆï¼Œä¿è¯æµ‹è¯•æ•°æ®çš„ç‹¬ç«‹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€é€šè¿‡æµ‹è¯•æ•°æ®åˆ†çº§ï¼Œå®ç°ä¸“å±æµ‹è¯•æ•°æ®å’Œé€šç”¨æµ‹è¯•æ•°æ®çš„æœ‰æ•ˆç®¡ç†å’Œçµæ´»ç»„åˆï¼Œä¿è¯æµ‹è¯•æ•°æ®çš„ç‹¬ç«‹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;4ã€æ•°æ®å®‰å…¨&lt;/p&gt;
&lt;p&gt;Â·       Aã€æµ‹è¯•æ•°æ®æ¥æºå¤æ‚ï¼Œæ··å…¥æ ¸å¿ƒç”Ÿäº§æ•°æ®ï¼Œå¸¦æ¥ä¿¡æ¯å®‰å…¨é£é™©&lt;/p&gt;
&lt;p&gt;Â·       Bã€æµ‹è¯•æ•°æ®ç»è¿‡æ¸…æ´—ï¼Œä¸åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œæœ‰æ•ˆé¿å…ä¿¡æ¯å®‰å…¨é£é™©ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æµ‹è¯•æ•°æ®ç»è¿‡æ¸…æ´—ï¼Œä¸åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œæœ‰æ•ˆé¿å…ä¿¡æ¯å®‰å…¨é£é™©ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æµ‹è¯•æ•°æ®ç»è¿‡æ¸…æ´—ï¼Œä¸åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œæœ‰æ•ˆé¿å…ä¿¡æ¯å®‰å…¨é£é™©ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æµ‹è¯•æ•°æ®ç»è¿‡æ¸…æ´—ï¼Œä¸åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œæœ‰æ•ˆé¿å…ä¿¡æ¯å®‰å…¨é£é™©ã€‚&lt;/p&gt;
&lt;p&gt;5ã€å˜æ›´è¿‡ç¨‹&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ•°æ®å˜æ›´ç”±ä¸“ä¸šäººå‘˜åœ¨åå°æ‰‹å·¥å®Œæˆ æ•°æ®å˜æ›´ä½œä¸ºè½¯ä»¶å‘å¸ƒçš„ä¸€ä¸ªç‹¬ç«‹ç¯èŠ‚ï¼Œå•ç‹¬å®æ–½å’Œäº¤ä»˜&lt;/p&gt;
&lt;p&gt;Â·       Bã€æ•°æ®å˜æ›´é€šè¿‡æ–‡æ¡£å®ç°æ ‡å‡†åŒ–ï¼Œä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬å®Œæˆå˜æ›´ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ•°æ®å˜æ›´ä½œä¸ºæŒç»­éƒ¨ç½²æµæ°´çº¿çš„ä¸€ä¸ªç¯èŠ‚ï¼Œéšåº”ç”¨çš„éƒ¨ç½²è‡ªåŠ¨åŒ–å®Œæˆï¼Œæ— éœ€ä¸“ä¸šäººå‘˜å•ç‹¬æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€åº”ç”¨ç¨‹åºéƒ¨ç½²å’Œæ•°æ®åº“è¿ç§»è§£è€¦ï¼Œå¯å•ç‹¬æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­ä¼˜åŒ–çš„æ•°æ®ç®¡ç†æ–¹æ³•ï¼ŒæŒç»­æ”¹è¿›æ•°æ®ç®¡ç†æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;6ã€å…¼å®¹å›æ»š&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ²¡æœ‰è¯†åˆ«æ•°æ®åº“å’Œåº”ç”¨ç‰ˆæœ¬ï¼Œå­˜åœ¨ä¸å…¼å®¹é£é™©ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€å»ºç«‹æ•°æ®åº“å’Œåº”ç”¨çš„ç‰ˆæœ¬å¯¹åº”å…³ç³»ï¼Œå¹¶è·Ÿè¸ªå˜æ›´æœ‰æ•ˆæ€§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ¯æ¬¡æ•°æ®å˜æ›´åŒæ—¶æä¾›æ˜ç¡®çš„æ¢å¤å›æ»šæœºåˆ¶ï¼Œå¹¶è¿›è¡Œå˜æ›´æµ‹è¯•ï¼Œå¦‚ï¼šæä¾›å‡çº§å’Œå›æ»šä¸¤ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æ•°æ®å˜æ›´å…·å¤‡å‘ä¸‹å…¼å®¹æ€§ï¼Œæ”¯æŒä¿ç•™æ•°æ®çš„å›æ»šæ“ä½œå’Œé›¶åœæœºéƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;7ã€ç‰ˆæœ¬æ§åˆ¶&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ•°æ®å˜æ›´æ²¡æœ‰çº³å…¥ç‰ˆæœ¬æ§åˆ¶ï¼Œå˜æ›´è¿‡ç¨‹ä¸å¯é‡å¤ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æ•°æ®å˜æ›´è„šæœ¬çº³å…¥ç‰ˆæœ¬æ§åˆ¶ï¼Œå¹¶ä¸æ•°æ®åº“ç‰ˆæœ¬è¿›è¡Œå…³è”ã€‚&lt;/p&gt;
&lt;p&gt;8ã€æ•°æ®ç›‘æ§&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ²¡æœ‰å»ºç«‹å˜æ›´ç›‘æ§ä½“ç³»ï¼Œå˜æ›´ç»“æœä¸å¯è§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€å¯¹å˜æ›´æ—¥å¿—è¿›è¡Œæ”¶é›†åˆ†æï¼Œå¸®åŠ©é—®é¢˜å¿«é€Ÿå®šä½ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å¯¹æ•°æ®å˜æ›´è¿›è¡Œæµç¨‹åˆ†çº§å®šä¹‰ï¼Œåº”å¯¹ä¸åŒç¯å¢ƒä¸‹çš„é«˜å±æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å¯¹æ•°æ®å˜æ›´è¿›è¡Œç›‘æ§ï¼Œè‡ªåŠ¨å‘ç°å¼‚å¸¸å˜æ›´çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€ç›‘æ§æ•°æ®åº“æ€§èƒ½å¹¶æŒç»­ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;h2 id="_8"&gt;ï¼ˆå…«ï¼‰åº¦é‡ä¸åé¦ˆ&lt;a class="headerlink" href="#_8" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;1ã€åº¦é‡æŒ‡æ ‡å®šä¹‰&lt;/p&gt;
&lt;p&gt;Â·       Aã€åº¦é‡æŒ‡æ ‡æ²¡æœ‰æ˜ç¡®å®šä¹‰ï¼Œå¯¹åº¦é‡ä»·å€¼çš„ç†è§£æ˜¯æ¨¡ç³Šçš„ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€åœ¨æŒç»­äº¤ä»˜å„ä¸ªé˜¶æ®µå®šä¹‰åº¦é‡æŒ‡æ ‡ï¼Œåº¦é‡æŒ‡æ ‡å±€é™äºèŒèƒ½éƒ¨é—¨å†…éƒ¨ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å»ºç«‹è·¨ç»„ç»‡åº¦é‡æŒ‡æ ‡ï¼Œè¿›è¡Œè·¨é¢†åŸŸç»¼åˆç»´åº¦çš„åº¦é‡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æ•´ä¸ªç ”å‘å›¢é˜Ÿå…±äº«ä¸šåŠ¡ä»·å€¼å¯¼å‘çš„åº¦é‡æŒ‡æ ‡ï¼Œå®ç°æŒ‡æ ‡çš„æŠ½è±¡åˆ†çº§ï¼Œå…³æ³¨æ ¸å¿ƒä¸šåŠ¡æŒ‡æ ‡ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­ä¼˜åŒ–çš„åº¦é‡æŒ‡æ ‡ï¼Œå›¢é˜Ÿè‡ªæˆ‘é©±åŠ¨æŒç»­æ”¹è¿›ã€‚&lt;/p&gt;
&lt;p&gt;2ã€åº¦é‡æŒ‡æ ‡ç±»å‹&lt;/p&gt;
&lt;p&gt;Â·       Aã€åº¦é‡æŒ‡æ ‡ä»¥ç»“æœæŒ‡æ ‡ä¸ºä¸»ï¼Œå¦‚å˜æ›´é¢‘ç‡ï¼Œéœ€æ±‚äº¤ä»˜å‰ç½®æ—¶é—´ï¼Œå˜æ›´å¤±è´¥ç‡å’Œå¹³å‡ä¿®å¤æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€åº¦é‡æŒ‡æ ‡è¦†ç›–è¿‡ç¨‹æŒ‡æ ‡ï¼Œå®¢è§‚åæ˜ ç»„ç»‡ç ”å‘ç°çŠ¶ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€åº¦é‡æŒ‡æ ‡è¦†ç›–æ¢ç´¢æ€§æŒ‡æ ‡ï¼Œå…³æ³¨å±•ç¤ºè¶‹åŠ¿å’Œè¯†åˆ«æ½œåœ¨æ”¹è¿›ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æ”¯æŒæ”¹è¿›ç›®æ ‡å’Œè¯•éªŒç»“æœçš„æœ‰æ•ˆåé¦ˆï¼Œç”¨äºç»éªŒç§¯ç´¯å’ŒæŒ‡å¯¼ä¸‹ä¸€é˜¶æ®µçš„æ”¹è¿›å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;3ã€åº¦é‡æ•°æ®ç®¡ç†&lt;/p&gt;
&lt;p&gt;Â·       Aã€åº¦é‡æ•°æ®æ˜¯ä¸´æ—¶æ€§çš„ï¼Œæ²¡æœ‰æ”¶é›†ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€åº¦é‡æ•°æ®çš„æ”¶é›†æ˜¯ç¦»æ•£çš„ä¸è¿ç»­çš„ï¼Œå†å²åº¦é‡æ•°æ®æ²¡æœ‰è¿›è¡Œæœ‰æ•ˆç†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€åº¦é‡æ•°æ®çš„æ”¶é›†æ˜¯è¿ç»­çš„ï¼Œå†å²åº¦é‡æ•°æ®æœ‰æ˜ç¡®çš„ç®¡ç†è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€åº¦é‡æ•°æ®çš„æ”¶é›†æ˜¯è¿ç»­ä¸”ä¼˜åŒ–çš„ï¼Œå¯¹å†å²æ•°æ®æ•°æ®è¿›è¡Œæœ‰æ•ˆçš„æŒ–æ˜åˆ†æã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€åº¦é‡æ•°æ®çš„æ”¶é›†æ˜¯è¿ç»­ä¸”ä¼˜åŒ–çš„ï¼Œå¯¹å†å²æ•°æ®æ•°æ®è¿›è¡Œæœ‰æ•ˆçš„æŒ–æ˜åˆ†æã€‚&lt;/p&gt;
&lt;p&gt;4ã€åº¦é‡æŒ‡æ ‡æ›´æ–°&lt;/p&gt;
&lt;p&gt;Â·       Aã€åº¦é‡æŒ‡æ ‡çš„è®¾ç«‹å’Œæ›´æ–°æ˜¯å›ºåŒ–çš„ï¼Œåº¦é‡æŒ‡æ ‡æ²¡æœ‰æ˜ç¡®çš„ä¼˜å…ˆçº§ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€åº¦é‡æŒ‡æ ‡çš„è®¾ç«‹å’Œæ›´æ–°æ˜¯åŠ¨æ€çš„ï¼Œå¯ä»¥æŒ‰ç…§ç»„ç»‡éœ€æ±‚å®šæœŸå˜æ›´ï¼Œåº¦é‡æŒ‡æ ‡çš„ä¼˜å…ˆçº§åœ¨å›¢é˜Ÿå†…éƒ¨å¯ä»¥è¾¾ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å»ºç«‹å®Œæ•´çš„åº¦é‡ä½“ç³»å’Œæˆç†Ÿçš„åº¦é‡æ¡†æ¶ï¼Œåº¦é‡æŒ‡æ ‡çš„è®¾ç«‹å’Œæ›´æ–°å¯æŒ‰éœ€å®ç°å¿«é€Ÿå®šä¹‰å¹¶çº³å…¥åº¦é‡ä½“ç³»ï¼Œæ¨åŠ¨æµç¨‹çš„æŒç»­æ”¹è¿›ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€åº¦é‡æŒ‡æ ‡å¯åŸºäºå¤§æ•°æ®åˆ†æå’Œäººå·¥æ™ºèƒ½è‡ªåŠ¨è¯†åˆ«æ¨èï¼Œå¹¶ä¸”åŠ¨æ€è°ƒæ•´æŒ‡æ ‡ä¼˜å…ˆçº§ã€‚&lt;/p&gt;
&lt;p&gt;5ã€æŠ¥å‘Šç”Ÿæˆæ–¹å¼&lt;/p&gt;
&lt;p&gt;Â·       Aã€åº¦é‡æŠ¥å‘Šé€šè¿‡æ‰‹å·¥æ–¹å¼ç”Ÿæˆï¼Œæ²¡æœ‰æ ‡å‡†åŒ–çš„æ ¼å¼å®šä¹‰ï¼Œå†…å®¹ç¼ºä¹ç»†èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€åº¦é‡æŠ¥å‘Šä»¥è‡ªåŠ¨åŒ–æ–¹å¼ç”Ÿæˆï¼Œé€šè¿‡é¢„å®šä¹‰æ ¼å¼å’Œå†…å®¹æ ‡å‡†åŒ–åº¦é‡æŠ¥å‘Šã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€åº¦é‡æŠ¥å‘Šè¿›è¡Œåˆ†ç±»åˆ†çº§ï¼Œå»ºç«‹å¤šç§åº¦é‡åé¦ˆæ¸ é“ï¼Œå†…å®¹æŒ‰éœ€ç”Ÿæˆã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å»ºç«‹è·¨ç»„ç»‡çº§ç»Ÿä¸€çš„æ•°æ®åº¦é‡å¹³å°ï¼Œæ•°æ®çœ‹æ¿å†…å®¹å¯å®šåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€æŒç»­ä¼˜åŒ–çš„åº¦é‡æ–¹æ³•ï¼Œå¹³å°å’Œå±•ç°å½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;6ã€æŠ¥å‘Šæœ‰æ•ˆæ€§&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ•°æ®æ—¶æ•ˆæ€§æ— æ³•ä¿è¯èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æ•°æ®ä½“ç°æŠ¥å‘Šç”Ÿæˆæ—¶é—´ç‚¹çš„æœ€æ–°çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€é€šè¿‡å¯è§†åŒ–çœ‹æ¿å®æ—¶å±•ç¤ºæ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€é€šè¿‡å¯è§†åŒ–çœ‹æ¿èšåˆæŠ¥å‘Šå†…å®¹ï¼Œè‡ªåŠ¨ç”Ÿæˆè¶‹åŠ¿å›¾ï¼Œè¿›è¡Œè¶‹åŠ¿åˆ†æã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€é€šè¿‡å¯è§†åŒ–çœ‹æ¿èšåˆæŠ¥å‘Šå†…å®¹ï¼Œè‡ªåŠ¨ç”Ÿæˆè¶‹åŠ¿å›¾ï¼Œè¿›è¡Œè¶‹åŠ¿åˆ†æã€‚&lt;/p&gt;
&lt;p&gt;7ã€æŠ¥å‘Šè¦†ç›–èŒƒå›´&lt;/p&gt;
&lt;p&gt;Â·       Aã€å—ä¼—å±€é™äºæŠ¥å‘Šç”Ÿæˆäººå‘˜åŠç›¸å…³çš„å°èŒƒå›´å†…éƒ¨ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€ç”±é¢„å…ˆå®šä¹‰çš„äº‹ä»¶è§¦å‘è‡ªåŠ¨åŒ–æŠ¥å‘Šå‘é€ï¼Œå—ä¼—è¦†ç›–å›¢é˜Ÿå†…éƒ¨æˆå‘˜ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€å®ç°æŠ¥å‘Šç²¾å‡†èŒƒå›´æ¨é€ï¼Œæ”¯æŒä¸»åŠ¨è®¢é˜…ï¼Œå—ä¼—è¦†ç›–è·¨éƒ¨é—¨å›¢é˜Ÿã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€å¤šç»´åº¦äº§å“çŠ¶æ€å®æ—¶ä¿¡æ¯å±•ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€å¤šç»´åº¦äº§å“çŠ¶æ€å®æ—¶ä¿¡æ¯å±•ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;8ã€åé¦ˆæ”¹è¿›&lt;/p&gt;
&lt;p&gt;Â·       Aã€æŠ¥å‘Šå‘ç°çš„é—®é¢˜æ²¡æœ‰è¿›è¡Œæœ‰æ•ˆè·Ÿè¸ªè½å®ï¼Œé—®é¢˜é•¿æœŸæ— æ³•æ”¹è¿›ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æµ‹è¯•æŠ¥å‘Šä¸­åé¦ˆçš„é—®é¢˜å½•å…¥é—®é¢˜è¿½è¸ªç³»ç»Ÿï¼Œè¿›è¡ŒæŒç»­è·Ÿè¸ªã€‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€åº¦é‡åé¦ˆé—®é¢˜çº³å…¥ç ”å‘è¿­ä»£çš„å¾…åŠäº‹é¡¹ï¼Œä½œä¸ºæŒç»­æ”¹è¿›çš„ä¸€éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€åº¦é‡åé¦ˆçš„æŒç»­æ”¹è¿›çº³å…¥ç ”å‘æ—¥å¸¸å·¥ä½œï¼Œé¢„ç•™æ—¶é—´å¤„ç†éåŠŸèƒ½æ€§éœ€æ±‚å’ŒæŠ€æœ¯å€ºåŠ¡ï¼Œå¹¶ä¸”è¯†åˆ«æœ‰æ•ˆæ”¹è¿›å¹¶æ‰©å±•åˆ°æ•´ä¸ªç»„ç»‡ï¼Œä½œä¸ºä¼ä¸šçº§çŸ¥è¯†ä½“ç³»ç§¯ç´¯ä¿ç•™ã€‚&lt;/p&gt;
&lt;p&gt;Â·       Eã€é€šè¿‡æ•°æ®æŒ–æ˜å®ç°è·¨ç»„ç»‡è·¨æµç¨‹æ•°æ®åº¦é‡åˆ†æï¼Œåˆ†æç»“æœä½œä¸ºä¸šåŠ¡å†³ç­–çš„é‡è¦ä¾æ®ï¼Œå¸®åŠ©ç»„ç»‡æŒç»­æ”¹è¿›ä»·å€¼äº¤ä»˜æµç¨‹ã€‚&lt;/p&gt;
&lt;h2 id="_9"&gt;ï¼ˆä¹ï¼‰åˆ†å¸ƒå¼åº”ç”¨æ¶æ„&lt;a class="headerlink" href="#_9" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;1ã€åˆ†å¸ƒå¼åº”ç”¨æ•°é‡&lt;/p&gt;
&lt;p&gt;Â·       Aã€20ä¸ªä»¥ä¸Š&lt;/p&gt;
&lt;p&gt;Â·       Bã€10~20ä¸ª&lt;/p&gt;
&lt;p&gt;Â·       Cã€5~10ä¸ª&lt;/p&gt;
&lt;p&gt;Â·       Dã€5ä¸ªä»¥ä¸‹&lt;/p&gt;
&lt;p&gt;2ã€å®æ–½è®¡åˆ’&lt;/p&gt;
&lt;p&gt;Â·       Aã€å¤§è§„æ¨¡è¿ç§»&lt;/p&gt;
&lt;p&gt;Â·       Bã€ä¿æŒç°çŠ¶&lt;/p&gt;
&lt;p&gt;Â·       Cã€å¯èƒ½å›é€€&lt;/p&gt;
&lt;p&gt;3ã€æŠ€æœ¯æˆç†Ÿåº¦&lt;/p&gt;
&lt;p&gt;Â·       Aã€ç¨³å®šè¿è¡Œ&lt;/p&gt;
&lt;p&gt;Â·       Bã€åŸºæœ¬æˆç†Ÿ&lt;/p&gt;
&lt;p&gt;Â·       Cã€å‰æœŸæ¢ç´¢&lt;/p&gt;
&lt;p&gt;Â·       Dã€ç ”ç©¶é˜¶æ®µ&lt;/p&gt;
&lt;p&gt;4ã€äº‘æŠ€æœ¯&lt;/p&gt;
&lt;p&gt;Â·       Aã€è™šæ‹ŸåŒ–&lt;/p&gt;
&lt;p&gt;Â·       Bã€å®¹å™¨(K8Sã€MESOSç­‰)&lt;/p&gt;
&lt;p&gt;Â·       Cã€ç‰©ç†æœº&lt;/p&gt;
&lt;p&gt;Â·       Dã€å¤–éƒ¨éƒ¨ç½²&lt;/p&gt;
&lt;p&gt;5ã€ç®¡ç†å·¥å…·&lt;/p&gt;
&lt;p&gt;Â·       Aã€openstackç³»åˆ—&lt;/p&gt;
&lt;p&gt;Â·       Bã€openshiftç³»åˆ—&lt;/p&gt;
&lt;p&gt;Â·       Cã€å…¶ä»–&lt;/p&gt;
&lt;p&gt;5ã€æ•°æ®åº“&lt;/p&gt;
&lt;p&gt;Â·       Aã€UNIXæ•°æ®åº“&lt;/p&gt;
&lt;p&gt;Â·       Bã€Linuxå•†ä¸šæ•°æ®åº“&lt;/p&gt;
&lt;p&gt;Â·       Cã€å¼€æºåˆ†å¸ƒå¼æ•°æ®åº“&lt;/p&gt;
&lt;p&gt;Â·       Dã€å¼€æºå•æ•°æ®åº“&lt;/p&gt;
&lt;p&gt;6ã€å¾®æœåŠ¡æ¡†æ¶&lt;/p&gt;
&lt;p&gt;Â·       Aã€dobbo/dobbox&lt;/p&gt;
&lt;p&gt;Â·       Bã€spring cloud&lt;/p&gt;
&lt;p&gt;Â·       Cã€éƒ½ç”¨&lt;/p&gt;
&lt;p&gt;Â·       Dã€å…¶ä»–&lt;/p&gt;
&lt;p&gt;7ã€å¼€å‘&lt;/p&gt;
&lt;p&gt;Â·       Aã€å®Œå…¨æ•æ·&lt;/p&gt;
&lt;p&gt;Â·       Bã€éƒ¨åˆ†æ•æ·&lt;/p&gt;
&lt;p&gt;Â·       Cã€ä¼ ç»Ÿæ–¹æ³•&lt;/p&gt;
&lt;p&gt;8ã€è‡ªåŠ¨åŒ–æµ‹è¯•&lt;/p&gt;
&lt;p&gt;Â·       Aã€å®Œæ•´å•å…ƒæµ‹è¯•&lt;/p&gt;
&lt;p&gt;Â·       Bã€éƒ¨åˆ†å•å…ƒæµ‹è¯•&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ— å•å…ƒæµ‹è¯•&lt;/p&gt;
&lt;p&gt;9ã€éƒ¨ç½²ç­–ç•¥&lt;/p&gt;
&lt;p&gt;Â·       Aã€ç°åº¦éƒ¨ç½²&lt;/p&gt;
&lt;p&gt;Â·       Bã€è“ç»¿éƒ¨ç½²&lt;/p&gt;
&lt;p&gt;Â·       Cã€ABéƒ¨ç½²&lt;/p&gt;
&lt;p&gt;Â·       Dã€ç›´æ¥æ›¿æ¢&lt;/p&gt;
&lt;p&gt;10ã€éƒ¨ç½²å·¥å…·&lt;/p&gt;
&lt;p&gt;Â·       Aã€SSH&lt;/p&gt;
&lt;p&gt;Â·       Bã€SALT&lt;/p&gt;
&lt;p&gt;Â·       Cã€å®¹å™¨ç¼–æ’å·¥å…·&lt;/p&gt;
&lt;p&gt;Â·       Dã€å…¶ä»–&lt;/p&gt;
&lt;p&gt;11ã€å›æ»šç­–ç•¥&lt;/p&gt;
&lt;p&gt;Â·       Aã€è‡ªåŠ¨å›æ»š&lt;/p&gt;
&lt;p&gt;Â·       Bã€æ‰‹å·¥å›æ»š&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ— å›æ»šç­–ç•¥&lt;/p&gt;
&lt;p&gt;12ã€å¼¹æ€§éƒ¨ç½²&lt;/p&gt;
&lt;p&gt;Â·       Aã€è‡ªåŠ¨æ‰©å®¹&lt;/p&gt;
&lt;p&gt;Â·       Bã€æ‰‹å·¥æ‰©å®¹&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ— æ³•æ‰©å®¹&lt;/p&gt;
&lt;p&gt;13ã€éƒ¨ç½²å¯¹è±¡&lt;/p&gt;
&lt;p&gt;Â·       Aã€docker&lt;/p&gt;
&lt;p&gt;Â·       Bã€war&lt;/p&gt;
&lt;p&gt;Â·       Cã€å…¶ä»–&lt;/p&gt;
&lt;p&gt;14ã€éƒ¨ç½²æ–¹å¼&lt;/p&gt;
&lt;p&gt;Â·       Aã€è™šæ‹ŸåŒ–+docker&lt;/p&gt;
&lt;p&gt;Â·       Bã€è™šæ‹ŸåŒ–+war&lt;/p&gt;
&lt;p&gt;Â·       Cã€å®¹å™¨+docker&lt;/p&gt;
&lt;p&gt;15ã€éƒ¨ç½²æ•°é‡&lt;/p&gt;
&lt;p&gt;Â·       Aã€1000+&lt;/p&gt;
&lt;p&gt;Â·       Bã€500~1000&lt;/p&gt;
&lt;p&gt;Â·       Cã€100~500&lt;/p&gt;
&lt;p&gt;Â·       Dã€100ä»¥ä¸‹&lt;/p&gt;
&lt;p&gt;16ã€æ›´æ–°é¢‘ç‡&lt;/p&gt;
&lt;p&gt;Â·       Aã€æœˆæ›´æ–°&lt;/p&gt;
&lt;p&gt;Â·       Bã€å‘¨æ›´æ–°&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ—¥æ›´æ–°&lt;/p&gt;
&lt;p&gt;Â·       Dã€æ¯æ—¥å¤šæ¬¡&lt;/p&gt;
&lt;p&gt;17ã€æ›´æ–°æ–¹å¼&lt;/p&gt;
&lt;p&gt;Â·       Aã€å…¨é‡æ›´æ–°&lt;/p&gt;
&lt;p&gt;Â·       Bã€å±€éƒ¨æ›´æ–°&lt;/p&gt;
&lt;p&gt;18ã€éƒ¨ç½²å·¥ä½œé‡&lt;/p&gt;
&lt;p&gt;Â·       Aã€æ¯”ä»¥å‰å¤æ‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€è¾ƒä»¥å‰ç®€å•&lt;/p&gt;
&lt;p&gt;Â·       Cã€éå¸¸ç®€å•&lt;/p&gt;
&lt;p&gt;Â·       Dã€å‡ ä¹è‡ªåŠ¨åŒ–&lt;/p&gt;
&lt;p&gt;19ã€æœ€å¤§éšœç¢&lt;/p&gt;
&lt;p&gt;Â·       Aã€åˆ†æå¤æ‚&lt;/p&gt;
&lt;p&gt;Â·       Bã€æŠ€æœ¯å¤æ‚&lt;/p&gt;
&lt;p&gt;Â·       Cã€è¿ç»´å¤æ‚&lt;/p&gt;
&lt;p&gt;Â·       Dã€æˆæœ¬æé«˜&lt;/p&gt;
&lt;p&gt;Â·       Eã€å…¶ä»–&lt;/p&gt;
&lt;p&gt;20ã€ç»¼åˆæ•ˆæœ&lt;/p&gt;
&lt;p&gt;Â·       Aã€ä¸æ˜æ˜¾&lt;/p&gt;
&lt;p&gt;Â·       Bã€æ˜æ˜¾æé«˜&lt;/p&gt;
&lt;p&gt;Â·       Cã€æ•ˆæœå˜å·®&lt;/p&gt;
&lt;p&gt;Â·       Dã€éƒ¨åˆ†æé«˜&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sat, 30 Mar 2019 19:43:07 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-03-30:/devops-questionnaire.html</guid><category>DevOps</category></item><item><title>è‹¹æœATSåˆè§„å¯¹WebæœåŠ¡å™¨çš„å½±å“</title><link>https://www.EWhisper.cn/apple-ats-effect-on-web-server.html</link><description>&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#_1"&gt;ä¸€ å‰è¨€&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#11-ats"&gt;1.1 ATSè¦æ±‚&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#_2"&gt;äºŒ æ£€æŸ¥é¡¹&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#21-apache"&gt;2.1 Apache æ£€æŸ¥é¡¹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#22-nginx"&gt;2.2 NGINXæ£€æŸ¥é¡¹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#23-weblogic"&gt;2.3 WebLogic æ£€æŸ¥é¡¹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#_3"&gt;ä¸‰ ä¿®æ”¹é…ç½®é¡¹&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#31-apache"&gt;3.1 Apache é…ç½®é¡¹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#32-nginx"&gt;3.2 NGINX é…ç½®é¡¹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#33-weblogic"&gt;3.3 WebLogic é…ç½®é¡¹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#_4"&gt;å›› æ³¨æ„é¡¹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id="_1"&gt;ä¸€ å‰è¨€&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« æ˜¯åœ¨å¤ªå¹³ä¿é™©æœŸé—´, æˆ‘å’ŒåŒæ—¶Huang Wentaoä¸€èµ·æ”¶é›†èµ„æ–™å¹¶å®éªŒååä½œå®Œæˆçš„.&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å†™äº2å¹´å‰, æ—¶è‡³ä»Šæ—¥å¯èƒ½è§„èŒƒ, è½¯ä»¶ç‰ˆæœ¬æˆ–é…ç½®é¡¹éƒ½å‘ç”Ÿå˜åŒ–. å¦‚æœè¦åº”ç”¨, è¯·åº”ç”¨å‰è¿›è¡Œå®Œå–„æµ‹è¯•.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="11-ats"&gt;1.1 ATSè¦æ±‚&lt;a class="headerlink" href="#11-ats" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åå•†çš„ä¼ è¾“å±‚å®‰å…¨ï¼ˆTLSï¼‰ç‰ˆæœ¬å¿…é¡»ä¸ºTLS 1.2;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¿æ¥å¿…é¡»ä½¿ç”¨AES-128æˆ–AES-256å¯¹ç§°å¯†ç ï¼Œåå•†çš„ç§˜é’¥äº¤æ¢åè®®å¿…é¡»æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384&lt;/li&gt;
&lt;li&gt;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256&lt;/li&gt;
&lt;li&gt;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384&lt;/li&gt;
&lt;li&gt;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA&lt;/li&gt;
&lt;li&gt;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256&lt;/li&gt;
&lt;li&gt;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA&lt;/li&gt;
&lt;li&gt;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384&lt;/li&gt;
&lt;li&gt;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256&lt;/li&gt;
&lt;li&gt;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384&lt;/li&gt;
&lt;li&gt;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256&lt;/li&gt;
&lt;li&gt;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Leaf serverï¼ˆè®¾å¤‡æœåŠ¡å™¨ï¼‰è¯ä¹¦å¿…é¡»ä½¿ç”¨ä»¥ä¸‹ç±»å‹çš„å¯†é’¥ä¹‹ä¸€ç­¾å&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Rivest-Shamir-Adleman (RSA)ç§˜é’¥ï¼Œé•¿åº¦è‡³å°‘ä¸º2048ä½&lt;/li&gt;
&lt;li&gt;Elliptic-Curve Cryptography (ECC) ç§˜é’¥ï¼Œé•¿åº¦è‡³å°‘ä¸º256ä½&lt;/li&gt;
&lt;li&gt;æ­¤å¤–ï¼Œleaf serverè¯ä¹¦æ•£åˆ—ç®—æ³•å¿…é¡»æ˜¯å…·æœ‰è‡³å°‘256ï¼ˆå³SHA-256æˆ–æ›´å¤§ï¼‰çš„æ‘˜è¦é•¿åº¦ï¼ˆæœ‰æ—¶ç§°ä¸ºâ€œæŒ‡çº¹â€ï¼‰çš„å®‰å…¨æ•£åˆ—ç®—æ³•2ï¼ˆSHA-2ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="_2"&gt;äºŒ æ£€æŸ¥é¡¹&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="21-apache"&gt;2.1 Apache æ£€æŸ¥é¡¹&lt;a class="headerlink" href="#21-apache" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;OpenSSLç‰ˆæœ¬: éœ€è¦å¤§äº &lt;a href="https://www.openssl.org/news/changelog.txt"&gt;1.0.1&lt;/a&gt; (OpenSSLä»1.0.1ä»¥åå¼€å§‹æ”¯æŒTLS 1.2)&lt;/li&gt;
&lt;li&gt;å½“å‰åŠ å¯†å¥—ä»¶ä½¿ç”¨çš„å¯†é’¥äº¤æ¢åè®®.&lt;ol&gt;
&lt;li&gt;æŸ¥çœ‹å½“å‰åŠ å¯†å¥—ä»¶æ”¯æŒçš„åè®®. è¦ä¿è¯æ”¯æŒçš„åè®®ä¸­æœ‰ä»¥ä¸ŠATS ä¸­æ‰€è¦æ±‚çš„.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;å½“å‰å¯†é’¥é•¿åº¦/æŒ‡çº¹ç®—æ³•æ˜¯å¦æ»¡è¶³:&lt;ol&gt;
&lt;li&gt;å¦‚æœæ˜¯RSAå¯†é’¥, åˆ™è‡³å°‘è¦ä¸º2048ä½;&lt;/li&gt;
&lt;li&gt;å¦‚æœæ˜¯ECCå¯†é’¥, åˆ™è‡³å°‘ä¸º256ä½.&lt;/li&gt;
&lt;li&gt;æŒ‡çº¹å®‰å…¨æ•£åˆ—ç®—æ³•è¦ä¸º SHA-2&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Apacheç‰ˆæœ¬:&lt;ol&gt;
&lt;li&gt;&lt;a href="http://svn.apache.org/repos/asf/httpd/httpd/branches/2.2.x/CHANGES"&gt;Apache 2.2.23&lt;/a&gt; æˆ–&lt;a href="http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/CHANGES"&gt;2.4.0&lt;/a&gt; ä»¥ä¸Šç‰ˆæœ¬éƒ½æ˜¯æ”¯æŒçš„.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="22-nginx"&gt;2.2 NGINXæ£€æŸ¥é¡¹&lt;a class="headerlink" href="#22-nginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;OpenSSL ç‰ˆæœ¬: éœ€è¦å¤§äº1.0.1&lt;/li&gt;
&lt;li&gt;å½“å‰åŠ å¯†å¥—ä»¶ä½¿ç”¨çš„å¯†é’¥äº¤æ¢åè®®.&lt;ol&gt;
&lt;li&gt;æŸ¥çœ‹å½“å‰åŠ å¯†å¥—ä»¶æ”¯æŒçš„åè®®. è¦ä¿è¯æ”¯æŒçš„åè®®ä¸­æœ‰ä»¥ä¸ŠATS ä¸­æ‰€è¦æ±‚çš„.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;å½“å‰å¯†é’¥é•¿åº¦/æŒ‡çº¹ç®—æ³•æ˜¯å¦æ»¡è¶³:&lt;ol&gt;
&lt;li&gt;å¦‚æœæ˜¯RSAå¯†é’¥, åˆ™è‡³å°‘è¦ä¸º2048ä½;&lt;/li&gt;
&lt;li&gt;å¦‚æœæ˜¯ECCå¯†é’¥, åˆ™è‡³å°‘ä¸º256ä½.&lt;/li&gt;
&lt;li&gt;æŒ‡çº¹å®‰å…¨æ•£åˆ—ç®—æ³•è¦ä¸º SHA-2&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;NGINXç‰ˆæœ¬: å»ºè®®ä½¿ç”¨&lt;a href="http://nginx.org/en/CHANGES-1.12"&gt;1.1.13&lt;/a&gt;ä»¥ä¸Šç‰ˆæœ¬.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="23-weblogic"&gt;2.3 WebLogic æ£€æŸ¥é¡¹&lt;a class="headerlink" href="#23-weblogic" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;JDKç‰ˆæœ¬: éœ€è¦ç‰ˆæœ¬ä¸ºJDK 7 ä»¥ä¸Š.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="_3"&gt;ä¸‰ ä¿®æ”¹é…ç½®é¡¹&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;é™¤äº†ä»¥ä¸Šæ£€æŸ¥é¡¹ä¸­ç‰ˆæœ¬ä¸ç¬¦åˆçš„éœ€è¦å‡çº§ã€è¯ä¹¦çš„ç®—æ³•ã€ç§˜é’¥é•¿åº¦éœ€è¦è¾¾åˆ°è¦æ±‚å¤–ï¼Œè¿˜æœ‰å…¶ä»–é…ç½®é¡¹è¦è¿›è¡Œé…ç½®.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="31-apache"&gt;3.1 Apache é…ç½®é¡¹&lt;a class="headerlink" href="#31-apache" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ç¤ºä¾‹: Apacheç‰ˆæœ¬2.2.23(~~å¾…ç¡®å®š~~)ï¼ŒOpenSSLç‰ˆæœ¬1.0.1e. (æœ€å¤§å…¼å®¹æ€§é…ç½®)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;VirtualHost&lt;/span&gt; &lt;span class="err"&gt;*:443&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    ...
    SSLEngine on
    SSLCertificateFile      /path/to/signed_certificate
    SSLCertificateChainFile /path/to/intermediate_certificate
    SSLCertificateKeyFile   /path/to/private/key

    # Uncomment the following directive when using client certificate authentication
    #SSLCACertificateFile    /path/to/ca_certs_for_client_authentication


    # HSTS (mod_headers is required) (15768000 seconds = 6 months)
    Header always set Strict-Transport-Security &amp;quot;max-age=15768000&amp;quot;
    ...
&lt;span class="nt"&gt;&amp;lt;/VirtualHost&amp;gt;&lt;/span&gt;

# old configuration, tweak to your needs
SSLProtocol             all -SSLv2
SSLCipherSuite          ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:ECDHE-RSA-DES-CBC3-SHA:ECDHE-ECDSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:DES-CBC3-SHA:HIGH:SEED:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!RSAPSK:!aDH:!aECDH:!EDH-DSS-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA:!SRP
SSLHonorCipherOrder     on
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="32-nginx"&gt;3.2 NGINX é…ç½®é¡¹&lt;a class="headerlink" href="#32-nginx" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ä¸¾ä¾‹ï¼šNginxç‰ˆæœ¬1.11.0ï¼ŒOpenSSLç‰ˆæœ¬1.0.1e (æœ€å¤§å…¼å®¹æ€§é…ç½®)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt; &lt;span class="s"&gt;default_server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="s"&gt;[::]:80&lt;/span&gt; &lt;span class="s"&gt;default_server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# Redirect all HTTP requests to HTTPS with a 301 Moved Permanently response.&lt;/span&gt;
    &lt;span class="kn"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;301&lt;/span&gt; &lt;span class="s"&gt;https://&lt;/span&gt;&lt;span class="nv"&gt;$host$request_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;443&lt;/span&gt; &lt;span class="s"&gt;ssl&lt;/span&gt; &lt;span class="s"&gt;http2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="s"&gt;[::]:443&lt;/span&gt; &lt;span class="s"&gt;ssl&lt;/span&gt; &lt;span class="s"&gt;http2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# certs sent to the client in SERVER HELLO are concatenated in ssl_certificate&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_certificate&lt;/span&gt; &lt;span class="s"&gt;/path/to/signed_cert_plus_intermediates&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_certificate_key&lt;/span&gt; &lt;span class="s"&gt;/path/to/private_key&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_session_timeout&lt;/span&gt; &lt;span class="s"&gt;1d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_session_cache&lt;/span&gt; &lt;span class="s"&gt;shared:SSL:50m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_session_tickets&lt;/span&gt; &lt;span class="no"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# Diffie-Hellman parameter for DHE ciphersuites, recommended 2048 bits&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_dhparam&lt;/span&gt; &lt;span class="s"&gt;/path/to/dhparam.pem&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# old configuration. tweak to your needs.&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_protocols&lt;/span&gt; &lt;span class="s"&gt;SSLv3&lt;/span&gt; &lt;span class="s"&gt;TLSv1&lt;/span&gt; &lt;span class="s"&gt;TLSv1.1&lt;/span&gt; &lt;span class="s"&gt;TLSv1.2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_ciphers&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:ECDHE-RSA-DES-CBC3-SHA:ECDHE-ECDSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:DES-CBC3-SHA:HIGH:SEED:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!RSAPSK:!aDH:!aECDH:!EDH-DSS-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA:!SRP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_prefer_server_ciphers&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months)&lt;/span&gt;
    &lt;span class="kn"&gt;add_header&lt;/span&gt; &lt;span class="s"&gt;Strict-Transport-Security&lt;/span&gt; &lt;span class="s"&gt;max-age=15768000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# OCSP Stapling ---&lt;/span&gt;
    &lt;span class="c1"&gt;# fetch OCSP records from URL in ssl_certificate and cache them&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_stapling&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_stapling_verify&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;## verify chain of trust of OCSP response using Root CA and Intermediate certs&lt;/span&gt;
    &lt;span class="kn"&gt;ssl_trusted_certificate&lt;/span&gt; &lt;span class="s"&gt;/path/to/root_CA_cert_plus_intermediates&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;resolver&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;IP&lt;/span&gt; &lt;span class="s"&gt;DNS&lt;/span&gt; &lt;span class="s"&gt;resolver&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;....&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="33-weblogic"&gt;3.3 WebLogic é…ç½®é¡¹&lt;a class="headerlink" href="#33-weblogic" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;éœ€è¦åœ¨Oracleå®˜ç½‘ä¸‹è½½java 7ç›¸å…³çš„policyfile&lt;br&gt;
è§£å‹åï¼Œæ›¿æ¢&lt;code&gt;JAVA_HOME/jre/lib/security&lt;/code&gt;ä¸‹çš„&lt;code&gt;local_policy.jar&lt;/code&gt;ã€&lt;code&gt;US_export_policy.jar&lt;/code&gt;æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h2 id="_4"&gt;å›› æ³¨æ„é¡¹&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;å‡çº§OpenSSLï¼Œå¯èƒ½ä¼šå½±å“sftpã€sshç­‰å’Œsslæœ‰å…³çš„åè®®ï¼Œéœ€è°¨æ…æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘åˆ°æ—§çš„sslç‰ˆæœ¬æ¼æ´ï¼Œä»¥åŠå…¼å®¹æ€§ï¼Œå»ºè®®éƒ½è¦ç¦ç”¨æ‰ssl V2åŠä»¥ä¸‹ç‰ˆæœ¬åè®®ã€‚(æœ€æ–°çš„å»ºè®®æ˜¯SSL v3ä¹Ÿç¦ç”¨)&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sat, 30 Mar 2019 19:37:41 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-03-30:/apple-ats-effect-on-web-server.html</guid><category>ATS</category><category>apple</category><category>ssl</category><category>nginx</category><category>apache</category><category>tls</category><category>openssl</category></item><item><title>ä½¿ç”¨ Ansible æ‰¹é‡ç®¡ç† Windows</title><link>https://www.EWhisper.cn/use-ansible-manage-multi-windows.html</link><description>&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#_1"&gt;æ¦‚è¿°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_2"&gt;å®‰è£…æŒ‡å—&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#_3"&gt;æœåŠ¡å™¨ç«¯çš„è¦æ±‚&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#ansible"&gt;æœåŠ¡å™¨ç«¯å®‰è£…Ansible&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#windows"&gt;Windows æŒ‡å—&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#windows_1"&gt;è®¾ç½®Windowsä¸»æœº&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#ansiblewindows"&gt;AnsibleæœåŠ¡å™¨ç«¯é…ç½®å¹¶ç®¡ç†Windows&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#ping-windows"&gt;ping è¿œç¨‹windowsä¸»æœº&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_4"&gt;åˆ›å»ºç›®å½•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_5"&gt;ä¸‹å‘æ–‡ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_6"&gt;åˆ é™¤æ–‡ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_7"&gt;åˆ é™¤ç›®å½•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#cmd"&gt;æ‰§è¡Œcmdå‘½ä»¤&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#windows_2"&gt;é‡å¯windows&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_8"&gt;åˆ›å»ºç”¨æˆ·&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#windows_3"&gt;windowsæœåŠ¡ç®¡ç†&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id="_1"&gt;æ¦‚è¿°&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Ansibleæ˜¯è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ï¼ŒåŸºäºPythonå¼€å‘ï¼Œå®ç°äº†æ‰¹é‡ç³»ç»Ÿé…ç½®ã€æ‰¹é‡ç¨‹åºéƒ¨ç½²ã€æ‰¹é‡è¿è¡Œå‘½ä»¤ç­‰åŠŸèƒ½ã€‚Ansibleæ˜¯åŸºäºæ¨¡å—(module)å’Œå‰§æœ¬(playbook)å·¥ä½œã€‚&lt;/p&gt;
&lt;h2 id="_2"&gt;å®‰è£…æŒ‡å—&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬æ¬¡åœ¨Ubuntuä¸Šå®‰è£…Ansible 2.7 . æ›´è¯¦ç»†å®‰è£…æ–¹å¼å‚è§: &lt;a href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html"&gt;Ansible å®‰è£…æŒ‡å—&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="_3"&gt;æœåŠ¡å™¨ç«¯çš„è¦æ±‚&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ç›®å‰Ansibleå¯ä»¥ä»å®‰è£…äº†Python 2ï¼ˆ2.7ç‰ˆï¼‰æˆ–Python 3ï¼ˆ3.5åŠæ›´é«˜ç‰ˆæœ¬ï¼‰çš„ä»»ä½•æœºå™¨ä¸Šè¿è¡Œã€‚æ§åˆ¶è®¡ç®—æœº&lt;strong&gt;ä¸æ”¯æŒWindows&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™åŒ…æ‹¬Red Hatï¼ŒDebianï¼ŒCentOSï¼ŒmacOSï¼Œä»»ä½•BSDç­‰ç­‰ã€‚&lt;/p&gt;
&lt;h3 id="ansible"&gt;æœåŠ¡å™¨ç«¯å®‰è£…Ansible&lt;a class="headerlink" href="#ansible" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;é€šè¿‡Apt (Ubuntu)å®‰è£…æœ€æ–°ç‰ˆæœ¬&lt;/h4&gt;
&lt;p&gt;è¿™é‡Œæœ‰&lt;a href="https://launchpad.net/~ansible/+archive/ubuntu/ansible"&gt;ä¸€ä¸ªPPA&lt;/a&gt;ç‰ˆæœ¬çš„Ubuntuæºã€‚&lt;/p&gt;
&lt;p&gt;è¦åœ¨æ‚¨çš„è®¡ç®—æœºä¸Šé…ç½®PPAå¹¶å®‰è£…ansibleï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get update
sudo apt-get install software-properties-common
sudo apt-add-repository --yes --update ppa:ansible/ansible
sudo apt-get install ansible
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;æ³¨æ„:&lt;/p&gt;
&lt;p&gt;åœ¨è¾ƒæ—§çš„Ubuntuå‘è¡Œç‰ˆä¸­ï¼Œâ€œsoftware-properties-commonâ€è¢«ç§°ä¸ºâ€œpython-software-propertiesâ€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="windows"&gt;Windows æŒ‡å—&lt;a class="headerlink" href="#windows" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="windows_1"&gt;è®¾ç½®Windowsä¸»æœº&lt;a class="headerlink" href="#windows_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;ä¸»æœºè¦æ±‚&lt;/h4&gt;
&lt;p&gt;è¦ä½¿Ansibleä¸Windowsä¸»æœºé€šä¿¡å¹¶ä½¿ç”¨Windowsæ¨¡å—ï¼ŒWindowsä¸»æœºå¿…é¡»æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ansibleæ”¯æŒçš„Windowsç‰ˆæœ¬é€šå¸¸ä¸Microsoftå½“å‰å’Œæ‰©å±•æ”¯æŒä¸‹çš„ç‰ˆæœ¬ç›¸åŒ¹é…ã€‚æ”¯æŒçš„æ¡Œé¢æ“ä½œç³»ç»ŸåŒ…æ‹¬&lt;strong&gt;Windows 7,8.1å’Œ10&lt;/strong&gt;ï¼Œå—æ”¯æŒçš„æœåŠ¡å™¨æ“ä½œç³»ç»ŸåŒ…æ‹¬&lt;strong&gt;Windows Server 2008,2008 R2,2012,2012 R2å’Œ2016&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Ansibleéœ€è¦&lt;strong&gt;PowerShell 3.0&lt;/strong&gt;æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå¹¶ä¸”è‡³å°‘è¦åœ¨Windowsä¸»æœºä¸Šå®‰è£…&lt;strong&gt;.NET 4.0&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åº”åˆ›å»ºå¹¶æ¿€æ´»&lt;strong&gt;WinRM listener &lt;/strong&gt;ã€‚æ›´å¤šç»†èŠ‚å¯ä»¥åœ¨ä¸‹é¢æ‰¾åˆ°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;æ³¨æ„:&lt;/p&gt;
&lt;p&gt;è™½ç„¶è¿™äº›æ˜¯Ansibleè¿æ¥çš„åŸºæœ¬è¦æ±‚ï¼Œä½†æ˜¯ä¸€äº›Ansibleæ¨¡å—è¿˜æœ‰å…¶ä»–è¦æ±‚ï¼Œä¾‹å¦‚è¾ƒæ–°çš„OSæˆ–PowerShellç‰ˆæœ¬ã€‚è¯·å‚é˜…æ¨¡å—çš„æ–‡æ¡£é¡µé¢ä»¥ç¡®å®šä¸»æœºæ˜¯å¦æ»¡è¶³è¿™äº›è¦æ±‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4&gt;å‡çº§PowerShellå’Œ.NETæ¡†æ¶&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å‡çº§powershelléœ€è¦&lt;strong&gt;é‡å¯æœåŠ¡å™¨&lt;/strong&gt;æ‰èƒ½ç”Ÿæ•ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ansibleéœ€è¦PowerShell 3.0ç‰ˆå’Œ.NET Framework 4.0æˆ–æ›´é«˜ç‰ˆæœ¬æ‰èƒ½åœ¨è¾ƒæ—§çš„æ“ä½œç³»ç»Ÿï¼ˆå¦‚Server 2008å’ŒWindows 7ï¼‰ä¸Šè¿è¡Œã€‚åŸºæœ¬OSé•œåƒä¸ç¬¦åˆæ­¤è¦æ±‚ã€‚æ‚¨å¯ä»¥ä½¿ç”¨&lt;a href="https://github.com/jborean93/ansible-windows/blob/master/scripts/Upgrade-PowerShell.ps1"&gt;Upgrade-PowerShell.ps1&lt;/a&gt;è„šæœ¬æ¥æ›´æ–°è¿™äº›è„šæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯å¦‚ä½•ä»PowerShellè¿è¡Œæ­¤è„šæœ¬çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;$url&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;https://raw.githubusercontent.com/jborean93/ansible-windows/master/scripts/Upgrade-PowerShell.ps1&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;$file&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;$env:temp\Upgrade-PowerShell.ps1&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;$username&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Administrator&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;$password&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Password&amp;quot;&lt;/span&gt;

&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;New-Object&lt;/span&gt; &lt;span class="n"&gt;-TypeName&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;WebClient&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;DownloadFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;Set-ExecutionPolicy&lt;/span&gt; &lt;span class="n"&gt;-ExecutionPolicy&lt;/span&gt; &lt;span class="n"&gt;Unrestricted&lt;/span&gt; &lt;span class="n"&gt;-Force&lt;/span&gt;

&lt;span class="c"&gt;# version can be 3.0, 4.0 or 5.1&lt;/span&gt;
&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nv"&gt;$file&lt;/span&gt; &lt;span class="n"&gt;-Version&lt;/span&gt; &lt;span class="n"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt; &lt;span class="n"&gt;-Username&lt;/span&gt; &lt;span class="nv"&gt;$username&lt;/span&gt; &lt;span class="n"&gt;-Password&lt;/span&gt; &lt;span class="nv"&gt;$password&lt;/span&gt; &lt;span class="n"&gt;-Verbose&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å®Œæˆåï¼Œæ‚¨å°†éœ€è¦åˆ é™¤è‡ªåŠ¨ç™»å½•å¹¶å°†æ‰§è¡Œç­–ç•¥è®¾ç½®å›é»˜è®¤å€¼&lt;code&gt;Restricted&lt;/code&gt;ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹PowerShellå‘½ä»¤æ‰§è¡Œæ­¤æ“ä½œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;# this isn&amp;#39;t needed but is a good security practice to complete&lt;/span&gt;
&lt;span class="nb"&gt;Set-ExecutionPolicy&lt;/span&gt; &lt;span class="n"&gt;-ExecutionPolicy&lt;/span&gt; &lt;span class="n"&gt;Restricted&lt;/span&gt; &lt;span class="n"&gt;-Force&lt;/span&gt;

&lt;span class="nv"&gt;$reg_winlogon_path&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;Set-ItemProperty&lt;/span&gt; &lt;span class="n"&gt;-Path&lt;/span&gt; &lt;span class="nv"&gt;$reg_winlogon_path&lt;/span&gt; &lt;span class="n"&gt;-Name&lt;/span&gt; &lt;span class="n"&gt;AutoAdminLogon&lt;/span&gt; &lt;span class="n"&gt;-Value&lt;/span&gt; &lt;span class="n"&gt;0&lt;/span&gt;
&lt;span class="nb"&gt;Remove-ItemProperty&lt;/span&gt; &lt;span class="n"&gt;-Path&lt;/span&gt; &lt;span class="nv"&gt;$reg_winlogon_path&lt;/span&gt; &lt;span class="n"&gt;-Name&lt;/span&gt; &lt;span class="n"&gt;DefaultUserName&lt;/span&gt; &lt;span class="n"&gt;-ErrorAction&lt;/span&gt; &lt;span class="n"&gt;SilentlyContinue&lt;/span&gt;
&lt;span class="nb"&gt;Remove-ItemProperty&lt;/span&gt; &lt;span class="n"&gt;-Path&lt;/span&gt; &lt;span class="nv"&gt;$reg_winlogon_path&lt;/span&gt; &lt;span class="n"&gt;-Name&lt;/span&gt; &lt;span class="n"&gt;DefaultPassword&lt;/span&gt; &lt;span class="n"&gt;-ErrorAction&lt;/span&gt; &lt;span class="n"&gt;SilentlyContinue&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¯¥è„šæœ¬çš„å·¥ä½œåŸç†æ˜¯æ£€æŸ¥éœ€è¦å®‰è£…å“ªäº›ç¨‹åºï¼ˆä¾‹å¦‚.NET Framework 4.5.2ï¼‰ä»¥åŠéœ€è¦ä»€ä¹ˆæ ·çš„PowerShellç‰ˆæœ¬ã€‚å¦‚æœ&lt;strong&gt;éœ€è¦é‡æ–°å¯åŠ¨&lt;/strong&gt;å¹¶ä¸”è®¾ç½®äº†&lt;code&gt;username&lt;/code&gt;å’Œ&lt;code&gt;password&lt;/code&gt;å‚æ•°ï¼Œåˆ™è„šæœ¬å°†åœ¨é‡æ–°å¯åŠ¨æ—¶è‡ªåŠ¨é‡æ–°å¯åŠ¨å¹¶ç™»å½•ã€‚è¯¥è„šæœ¬å°†ç»§ç»­ï¼Œç›´åˆ°ä¸å†éœ€è¦æ‰§è¡Œä»»ä½•æ“ä½œä¸”PowerShellç‰ˆæœ¬ä¸ç›®æ ‡ç‰ˆæœ¬åŒ¹é…ä¸ºæ­¢ã€‚å¦‚æœæœªè®¾ç½®&lt;code&gt;username&lt;/code&gt;å’Œ &lt;code&gt;password&lt;/code&gt;å‚æ•°ï¼Œè„šæœ¬å°†æç¤ºç”¨æˆ·æ‰‹åŠ¨é‡æ–°å¼•å¯¼å¹¶åœ¨éœ€è¦æ—¶ç™»å½•ã€‚å½“ç”¨æˆ·ä¸‹æ¬¡ç™»å½•æ—¶ï¼Œè„šæœ¬å°†ä»åœæ­¢çš„ä½ç½®ç»§ç»­ï¼Œå¹¶ä¸”è¯¥è¿‡ç¨‹å°†ç»§ç»­ï¼Œç›´åˆ°ä¸å†éœ€è¦å…¶ä»–æ“ä½œä¸ºæ­¢ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;æ³¨æ„:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœåœ¨Server 2008ä¸Šè¿è¡Œï¼Œåˆ™å¿…é¡»å®‰è£…SP2ã€‚å¦‚æœåœ¨Server 2008 R2æˆ–Windows 7ä¸Šè¿è¡Œï¼Œåˆ™å¿…é¡»å®‰è£…SP1ã€‚&lt;/li&gt;
&lt;li&gt;Windows Server 2008åªèƒ½å®‰è£…PowerShell 3.0; æŒ‡å®šè¾ƒæ–°çš„ç‰ˆæœ¬å°†å¯¼è‡´è„šæœ¬å¤±è´¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;username&lt;/code&gt;å’Œ&lt;code&gt;password&lt;/code&gt;å‚æ•°éƒ½æ˜¯å­˜å‚¨åœ¨æ³¨å†Œè¡¨ä¸­çš„çº¯æ–‡æœ¬ã€‚ç¡®ä¿åœ¨è„šæœ¬å®Œæˆåè¿è¡Œæ¸…ç†å‘½ä»¤ï¼Œä»¥ç¡®ä¿ä¸»æœºä¸Šä»æœªå­˜å‚¨å‡­æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h4&gt;WinRMå†…å­˜è¡¥ä¸&lt;/h4&gt;
&lt;p&gt;åœ¨PowerShell v3.0ä¸Šè¿è¡Œæ—¶ï¼ŒWinRMæœåŠ¡å­˜åœ¨ä¸€ä¸ªé”™è¯¯ï¼Œå®ƒé™åˆ¶äº†WinRMå¯ç”¨çš„å†…å­˜é‡ã€‚å¦‚æœæœªå®‰è£…æ­¤è¡¥ä¸ï¼ŒAnsibleå°†æ— æ³•åœ¨Windowsä¸»æœºä¸Šæ‰§è¡ŒæŸäº›å‘½ä»¤ã€‚è¿™äº›è¡¥ä¸åº”ä½œä¸ºç³»ç»Ÿå¼•å¯¼æˆ–æ˜ åƒè¿‡ç¨‹çš„ä¸€éƒ¨åˆ†å®‰è£…ã€‚&lt;a href="https://github.com/jborean93/ansible-windows/blob/master/scripts/Install-WMF3Hotfix.ps1"&gt;Install-WMF3Hotfix.ps1&lt;/a&gt;è„šæœ¬å¯ç”¨äºåœ¨å—å½±å“çš„ä¸»æœºä¸Šå®‰è£…æ­¤ä¿®è¡¥ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹PowerShellå‘½ä»¤å°†å®‰è£…æ­¤ä¿®è¡¥ç¨‹åºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;$url&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;https://raw.githubusercontent.com/jborean93/ansible-windows/master/scripts/Install-WMF3Hotfix.ps1&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;$file&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;$env:temp\Install-WMF3Hotfix.ps1&amp;quot;&lt;/span&gt;

&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;New-Object&lt;/span&gt; &lt;span class="n"&gt;-TypeName&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;WebClient&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;DownloadFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;powershell&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exe&lt;/span&gt; &lt;span class="n"&gt;-ExecutionPolicy&lt;/span&gt; &lt;span class="n"&gt;ByPass&lt;/span&gt; &lt;span class="o"&gt;-File&lt;/span&gt; &lt;span class="nv"&gt;$file&lt;/span&gt; &lt;span class="n"&gt;-Verbose&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;WinRMè®¾ç½®&lt;/h4&gt;
&lt;p&gt;ä¸€æ—¦Powershellå‡çº§åˆ°è‡³å°‘3.0ç‰ˆæœ¬ï¼Œæœ€åä¸€æ­¥æ˜¯é…ç½®WinRMæœåŠ¡ï¼Œä»¥ä¾¿Ansibleå¯ä»¥è¿æ¥åˆ°å®ƒã€‚WinRMæœåŠ¡æœ‰ä¸¤ä¸ªä¸»è¦ç»„ä»¶ï¼Œç”¨äºç®¡ç†Ansibleå¦‚ä½•ä¸Windowsä¸»æœºè¿æ¥ï¼š&lt;code&gt;listener&lt;/code&gt;å’Œ&lt;code&gt;service&lt;/code&gt;é…ç½®è®¾ç½®ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥åœ¨ä¸‹é¢é˜…è¯»æœ‰å…³æ¯ä¸ªç»„ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è„šæœ¬&lt;a href="https://github.com/ansible/ansible/blob/devel/examples/scripts/ConfigureRemotingForAnsible.ps1"&gt;ConfigureRemotingForAnsible.ps1&lt;/a&gt;æ¥è¿›è¡ŒåŸºæœ¬è®¾ç½®ã€‚æ­¤è„šæœ¬ä½¿ç”¨è‡ªç­¾åè¯ä¹¦è®¾ç½®HTTPå’ŒHTTPSä¾¦å¬å™¨ï¼Œå¹¶åœ¨æœåŠ¡ä¸Šå¯ç”¨&lt;code&gt;Basic&lt;/code&gt; èº«ä»½éªŒè¯é€‰é¡¹ã€‚&lt;/p&gt;
&lt;p&gt;è¦ä½¿ç”¨æ­¤è„šæœ¬ï¼Œè¯·åœ¨PowerShellä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;$url&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;https://raw.githubusercontent.com/ansible/ansible/devel/examples/scripts/ConfigureRemotingForAnsible.ps1&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;$file&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;$env:temp\ConfigureRemotingForAnsible.ps1&amp;quot;&lt;/span&gt;

&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;New-Object&lt;/span&gt; &lt;span class="n"&gt;-TypeName&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;WebClient&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;DownloadFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;powershell&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exe&lt;/span&gt; &lt;span class="n"&gt;-ExecutionPolicy&lt;/span&gt; &lt;span class="n"&gt;ByPass&lt;/span&gt; &lt;span class="o"&gt;-File&lt;/span&gt; &lt;span class="nv"&gt;$file&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;æ³¨æ„:&lt;/p&gt;
&lt;p&gt;ConfigureRemotingForAnsible.ps1è„šæœ¬ä»…ç”¨äºåŸ¹è®­å’Œå¼€å‘ç›®çš„ï¼Œä¸åº”åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå› ä¸ºå®ƒå¯ç”¨äº†&lt;code&gt;Basic&lt;/code&gt; è¿™æœ¬è´¨ä¸Šä¸å®‰å…¨ï¼ˆå¦‚èº«ä»½éªŒè¯ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4&gt;WinRM Listener&lt;/h4&gt;
&lt;p&gt;WinRMæœåŠ¡ä¾¦å¬ä¸€ä¸ªæˆ–å¤šä¸ªç«¯å£ä¸Šçš„è¯·æ±‚ã€‚æ¯ä¸ªç«¯å£éƒ½å¿…é¡»åˆ›å»ºå¹¶é…ç½®ä¸€ä¸ªä¾¦å¬å™¨ã€‚&lt;/p&gt;
&lt;p&gt;è¦æŸ¥çœ‹åœ¨WinRMæœåŠ¡ä¸Šè¿è¡Œçš„å½“å‰ä¾¦å¬å™¨ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;winrm&lt;/span&gt; &lt;span class="n"&gt;quickconfig&lt;/span&gt;
&lt;span class="n"&gt;winrm&lt;/span&gt; &lt;span class="n"&gt;enumerate&lt;/span&gt; &lt;span class="n"&gt;winrm&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Listener&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿è¡Œåè¾“å‡ºå¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Listener&lt;/span&gt;
    &lt;span class="n"&gt;Address&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="p"&gt;*&lt;/span&gt;
    &lt;span class="n"&gt;Transport&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HTTP&lt;/span&gt;
    &lt;span class="n"&gt;Port&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;5985&lt;/span&gt;
    &lt;span class="n"&gt;Hostname&lt;/span&gt;
    &lt;span class="n"&gt;Enabled&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;true&lt;/span&gt;
    &lt;span class="n"&gt;URLPrefix&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;wsman&lt;/span&gt;
    &lt;span class="n"&gt;CertificateThumbprint&lt;/span&gt;
    &lt;span class="n"&gt;ListeningOn&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;10&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;127&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;192&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;168&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;56&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;155&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fe80&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;5efe&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;10&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;15&lt;/span&gt;&lt;span class="k"&gt;%&lt;/span&gt;&lt;span class="n"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fe80&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;5efe&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;192&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;168&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;56&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;155&lt;/span&gt;&lt;span class="k"&gt;%&lt;/span&gt;&lt;span class="n"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fe80&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;
&lt;span class="n"&gt;ffff&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ffff&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;fffe&lt;/span&gt;&lt;span class="k"&gt;%&lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fe80&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;203d&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;7d97&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;c2ed&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ec78&lt;/span&gt;&lt;span class="k"&gt;%&lt;/span&gt;&lt;span class="n"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fe80&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;e8ea&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;d765&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;2c69&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;7756&lt;/span&gt;&lt;span class="k"&gt;%&lt;/span&gt;&lt;span class="n"&gt;7&lt;/span&gt;

&lt;span class="n"&gt;Listener&lt;/span&gt;
    &lt;span class="n"&gt;Address&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="p"&gt;*&lt;/span&gt;
    &lt;span class="n"&gt;Transport&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HTTPS&lt;/span&gt;
    &lt;span class="n"&gt;Port&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;5986&lt;/span&gt;
    &lt;span class="n"&gt;Hostname&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SERVER2016&lt;/span&gt;
    &lt;span class="n"&gt;Enabled&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;true&lt;/span&gt;
    &lt;span class="n"&gt;URLPrefix&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;wsman&lt;/span&gt;
    &lt;span class="n"&gt;CertificateThumbprint&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;E6CDAA82EEAF2ECE8546E05DB7F3E01AA47D76CE&lt;/span&gt;
    &lt;span class="n"&gt;ListeningOn&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;10&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;127&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;192&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;168&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;56&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;155&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fe80&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;5efe&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;10&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;15&lt;/span&gt;&lt;span class="k"&gt;%&lt;/span&gt;&lt;span class="n"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fe80&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;5efe&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;192&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;168&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;56&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;155&lt;/span&gt;&lt;span class="k"&gt;%&lt;/span&gt;&lt;span class="n"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fe80&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;
&lt;span class="n"&gt;ffff&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ffff&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;fffe&lt;/span&gt;&lt;span class="k"&gt;%&lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fe80&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;203d&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;7d97&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;c2ed&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ec78&lt;/span&gt;&lt;span class="k"&gt;%&lt;/span&gt;&lt;span class="n"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fe80&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;e8ea&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;d765&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;2c69&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;7756&lt;/span&gt;&lt;span class="k"&gt;%&lt;/span&gt;&lt;span class="n"&gt;7&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¿®æ”¹winrmé…ç½®ï¼Œå¯ç”¨è¿œç¨‹è¿æ¥è®¤è¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;winrm&lt;/span&gt; &lt;span class="nb"&gt;set &lt;/span&gt;&lt;span class="n"&gt;winrm&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;auth&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;@{Basic=&amp;quot;true&amp;quot;}&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;winrm&lt;/span&gt; &lt;span class="nb"&gt;set &lt;/span&gt;&lt;span class="n"&gt;winrm&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;@{AllowUnencrypted=&amp;quot;true&amp;quot;}&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;windows é˜²ç«å¢™é…ç½®&lt;/h4&gt;
&lt;p&gt;é…ç½®é˜²ç«å¢™:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ·»åŠ é˜²ç«å¢™ä¿¡ä»»è§„åˆ™ï¼Œå…è®¸5985-5986ç«¯å£é€šè¿‡&lt;/li&gt;
&lt;li&gt;æ‰“å¼€é˜²ç«å¢™é«˜çº§é…ç½®ï¼Œé€‰æ‹©&lt;strong&gt;å…¥ç«™è§„åˆ™&lt;/strong&gt;ï¼Œåœ¨ç‚¹å‡»æ–°å»ºè§„åˆ™&lt;/li&gt;
&lt;li&gt;å¡«å†™ä¸€ä¸‹ä¿¡æ¯&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;TCP&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;ä¿¡ä»»ç«¯å£&lt;strong&gt;5985-5986&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;å¡«å†™æ–°å»ºè§„åˆ™åç§°&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="ansiblewindows"&gt;AnsibleæœåŠ¡å™¨ç«¯é…ç½®å¹¶ç®¡ç†Windows&lt;a class="headerlink" href="#ansiblewindows" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æ·»åŠ windowså®¢æˆ·ç«¯è¿æ¥ä¿¡æ¯: ç¼–è¾‘&lt;code&gt;/etc/ansible/hosts&lt;/code&gt;, æ·»åŠ å®¢æˆ·ç«¯ä¸»æœºä¿¡æ¯(ansibleæœåŠ¡ç«¯çš„é…ç½®)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[windows]&lt;/span&gt;

&lt;span class="na"&gt;192.168.2.2 ansible_user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Administrator&amp;quot; ansible_password=&amp;quot;Password&amp;quot; ansible_port=5986 ansible_connection=&amp;quot;winrm&amp;quot; ansible_winrm_server_cert_validation=ignore ansible_winrm_transport=basic&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="ping-windows"&gt;ping è¿œç¨‹windowsä¸»æœº&lt;a class="headerlink" href="#ping-windows" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ansible &lt;span class="m"&gt;192&lt;/span&gt;.168.2.2 -m win_ping
&lt;span class="m"&gt;192&lt;/span&gt;.168.2.2 &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="nv"&gt;SUCCESS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;changed&amp;quot;&lt;/span&gt;: false,
    &lt;span class="s2"&gt;&amp;quot;ping&amp;quot;&lt;/span&gt;: &lt;span class="s2"&gt;&amp;quot;pong&amp;quot;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_4"&gt;åˆ›å»ºç›®å½•&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ansible &lt;span class="m"&gt;192&lt;/span&gt;.168.2.2 -m win_file -a &lt;span class="s1"&gt;&amp;#39;path=D:\\test state=directory&amp;#39;&lt;/span&gt;
&lt;span class="m"&gt;192&lt;/span&gt;.168.2.2 &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="nv"&gt;CHANGED&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;changed&amp;quot;&lt;/span&gt;: &lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_5"&gt;ä¸‹å‘æ–‡ä»¶&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ansible &lt;span class="m"&gt;192&lt;/span&gt;.168.2.2 -m win_copy -a &lt;span class="s1"&gt;&amp;#39;src=/etc/hosts dest=D:\\hosts.txt&amp;#39;&lt;/span&gt;
&lt;span class="m"&gt;192&lt;/span&gt;.168.2.2 &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="nv"&gt;CHANGED&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;changed&amp;quot;&lt;/span&gt;: true,
    &lt;span class="s2"&gt;&amp;quot;checksum&amp;quot;&lt;/span&gt;: &lt;span class="s2"&gt;&amp;quot;f6d471689e1233342a8e43a130ff40a6ea0b9f51&amp;quot;&lt;/span&gt;,
    &lt;span class="s2"&gt;&amp;quot;dest&amp;quot;&lt;/span&gt;: &lt;span class="s2"&gt;&amp;quot;D:\\hosts.txt&amp;quot;&lt;/span&gt;,
    &lt;span class="s2"&gt;&amp;quot;operation&amp;quot;&lt;/span&gt;: &lt;span class="s2"&gt;&amp;quot;file_copy&amp;quot;&lt;/span&gt;,
    &lt;span class="s2"&gt;&amp;quot;original_basename&amp;quot;&lt;/span&gt;: &lt;span class="s2"&gt;&amp;quot;hosts&amp;quot;&lt;/span&gt;,
    &lt;span class="s2"&gt;&amp;quot;size&amp;quot;&lt;/span&gt;: &lt;span class="m"&gt;635&lt;/span&gt;,
    &lt;span class="s2"&gt;&amp;quot;src&amp;quot;&lt;/span&gt;: &lt;span class="s2"&gt;&amp;quot;/etc/hosts&amp;quot;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_6"&gt;åˆ é™¤æ–‡ä»¶&lt;a class="headerlink" href="#_6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# ansible 192.168.2.2 -m win_file -a &amp;#39;dest=d:\\config_dir\\hosts.txt state=absent&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_7"&gt;åˆ é™¤ç›®å½•&lt;a class="headerlink" href="#_7" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# ansible 192.168.2.2 -m win_file -a &amp;#39;dest=d:\\config_dir2 state=absent&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="cmd"&gt;æ‰§è¡Œcmdå‘½ä»¤&lt;a class="headerlink" href="#cmd" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# ansible 192.168.2.2 -m win_shell -a &amp;#39;ipconfig&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="windows_2"&gt;é‡å¯windows&lt;a class="headerlink" href="#windows_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# ansible 192.168.2.2 -m win_reboot&lt;/span&gt;
&lt;span class="c1"&gt;# ansible 192.168.2.2 -m win_shell -a &amp;#39;shutdown -r -t 0&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_8"&gt;åˆ›å»ºç”¨æˆ·&lt;a class="headerlink" href="#_8" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;è¿œç¨‹åœ¨windowså®¢æˆ·ç«¯ä¸Šåˆ›å»ºç”¨æˆ·&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# ansible 192.168.2.2 -m win_user -a &amp;quot;name=testuser1 passwd=123456&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="windows_3"&gt;windowsæœåŠ¡ç®¡ç†&lt;a class="headerlink" href="#windows_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# ansible 192.168.2.2 -m win_shell -a â€œnet stop|start zabbix_agentâ€&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt;è¯´æ˜:&lt;/p&gt;
&lt;p&gt;å®Œæ•´çš„windows moduleè§: &lt;a href="https://docs.ansible.com/ansible/latest/modules/list_of_windows_modules.html"&gt;Windows modules&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sat, 30 Mar 2019 19:37:41 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-03-30:/use-ansible-manage-multi-windows.html</guid><category>ansible</category><category>windows</category><category>devops</category></item><item><title>HTTPSåŸºç¡€åŸç†å’Œé…ç½® - åŠ å¯†åè®®SSLå’ŒTLS</title><link>https://www.EWhisper.cn/https-101-chapter-1.html</link><description>&lt;blockquote&gt;
&lt;p&gt;è¿‘æœŸåˆç¢°åˆ°äº†SSLç›¸å…³çš„äº‹æƒ…, å°±å¿ƒè¡€æ¥æ½®å¼€ä¸ªæ–°ä¸“é¢˜ - ã€ŠHTTPSåŸºç¡€åŸç†å’Œé…ç½®ã€‹&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æ˜¯ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œ ä¸»è¦ä»‹ç»SSL TLSåŠ å¯†åè®®çš„ç›¸å…³å†…å®¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="_1"&gt;åŠ å¯†åè®®å†å²æ¦‚è¦&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;SSL TLSåŠ å¯†åè®®å…¶å®å¹¶æ²¡æœ‰å¾ˆé•¿çš„å†å²ï¼Œ1995å¹´&lt;strong&gt;ç½‘æ™¯&lt;/strong&gt;å‘å¸ƒäº†SSL v2.0ï¼Œè¿™ä¹Ÿæ˜¯webåŠ å¯†çš„å¼€å§‹ã€‚è¿™ä½¿å¾—ç”µå­å•†åŠ¡é¢†åŸŸï¼Œäººä»¬å¯ä»¥åœ¨çº¿æäº¤å¯†ç å’Œä¿¡ç”¨å¡ï¼Œå¹¶ä¸”è‡³å°‘æ˜¯ç›¸å½“å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;SSLv3.0å¾ˆå¿«å‘å¸ƒï¼Œè¿™ç‰ˆè¢«ä¿ç½—Â·æŸ¯å…‹ï¼ˆPaul Cokerï¼‰åŠå…¶ä»–äººå®Œå…¨é‡å†™ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸åšå®çš„åè®®ã€‚äº‹å®ä¸Šï¼ŒIETFé‡‡ç”¨SSL v3.0ï¼Œå¹¶ä½¿å®ƒæˆä¸ºå¹¶ä¸æ˜¯ç½‘æ™¯ç‹¬æœ‰çš„åè®®ï¼Œå«åšTLSï¼ˆTransport Layer Securityï¼‰ã€‚SSLæ„æ€æ˜¯å®‰å…¨å¥—æ¥å­—å±‚ï¼Œä½†ç°åœ¨å«ä¼ è¾“å±‚å®‰å…¨ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼ŒTLS v1.0å‡ ä¹å’ŒSSL v3.0 ä¸€æ¨¡ä¸€æ ·ï¼Œåªæ˜¯è¿›è¡Œäº†ä¸€ä¸¤ä¸ªå°ä¼˜åŒ–ï¼Œå¹¶ä¸”IAFä½¿ä¹‹æ ‡å‡†åŒ–ã€‚å¦‚æœä½ æ·±ç©¶è¿™äº›åè®®ï¼ŒTLS v1.0å®é™…ä¸Šå°±æ˜¯SSL v3.1ï¼›æ‰€ä»¥ä½ å¯ä»¥è®¤ä¸ºä»–ä»¬æ˜¯è¿ç»­çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æœ€ç»ˆIETFæå‡ºäº†æ–°ç‰ˆæœ¬v1.1ï¼ˆä¸€äº›å°ä¼˜åŒ–ï¼‰ï¼Œç„¶åæ˜¯v1.2ï¼Œå¼•å…¥äº†ä¸€äº›æ–°çš„åŠ å¯†ç®—æ³•ã€‚ä½†æ˜¯çœ‹åˆ°è¿™ä½ å¯èƒ½ä¼šæƒ³â€œå¥½å§ï¼Œæœ‰äº›å®¢æˆ·ç«¯æ”¯æŒè¿™äº›ï¼Œæœ‰äº›å®¢æˆ·ç«¯æ”¯æŒæ›´æ–°çš„ï¼Œè¿™å–å†³äºå®ƒä»¬å‘å¸ƒçš„æ—¶é—´. å®‰å…¨æ€§ä¸Šå¯èƒ½å·®ä¸å¤ªå¤š". ä½†å®é™…åœ¨å®‰å…¨æ„ä¹‰ä¸Šï¼Œè¿™äº›ä¸­çš„å¤§å¤šæ•°å·²ç»ä»¥è¢«ç ´è§£äº†ã€‚&lt;/p&gt;
&lt;h3 id="_2"&gt;å…³é”®å†å²èŠ‚ç‚¹&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;SSL v2.0 1995å¹´ ç½‘æ™¯ å‘å¸ƒ&lt;/li&gt;
&lt;li&gt;SSL v3.0 1996å¹´å‘å¸ƒ ä¿®å¤v2çš„ä¸»è¦é—®é¢˜&lt;/li&gt;
&lt;li&gt;TLS v1.0 1999å¹´ IETFå‘å¸ƒï¼›å¯¹SSLv3å°ä¼˜åŒ–&lt;/li&gt;
&lt;li&gt;TLS v1.1 2006å¹´ å‘å¸ƒ å°ä¼˜åŒ–&lt;/li&gt;
&lt;li&gt;TLS v1.2 2008å¹´å‘å¸ƒ æ”¹è¿›hashå’ŒAEADæ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="_3"&gt;&lt;img align="absmiddle" alt="ğŸ˜‚" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f602.png" title=":joy:" width="20px"&gt;è¢«ç ´è§£å†å²æ¦‚è¦&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆæ˜¯SSL v2.0, è®¾è®¡ä¹‹åˆå°±è¢«ç ´è§£&lt;img align="absmiddle" alt="ğŸ˜‚" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f602.png" title=":joy:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ˜‚" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f602.png" title=":joy:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ˜‚" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f602.png" title=":joy:" width="20px"&gt;, æ‰€ä»¥ï¼Œssl v2.0ç¡®å®ä¸æ¨èä½¿ç”¨ï¼›å·²ç»è¢«ç ´è§£å¾ˆé•¿å¾ˆé•¿æ—¶é—´äº†ï¼Œä¸å®‰å…¨ã€‚ æˆ‘ä»¬ç»å¸¸å¬åˆ°çš„æ”¯æŒçš„SSLç‰ˆæœ¬ä¸€èˆ¬ä¹Ÿæ˜¯ä»SSL v3.0å¼€å§‹çš„.&lt;/p&gt;
&lt;p&gt;SSL v3.0å‘¢, ä¹‹å‰ä¸€ç›´åœ¨ç”¨ï¼Œç›´åˆ°2014å¹´11æœˆè¢«ç ´è§£ã€‚&lt;/p&gt;
&lt;p&gt;TLSå‘¢, v1.0å’Œv1.1åŸºæœ¬å®‰å…¨ã€‚&lt;/p&gt;
&lt;p&gt;æœ€æ–°çš„v1.2(å…¶å®ç°åœ¨å·²ç»ä¸ç®—æœ€æ–°çš„äº†, TLS v1.3å·²ç»å‡ºæ¥äº†, ä½†æ˜¯ç›®å‰ä¸»æµçš„æœ€æ–°åè®®è¿˜æ˜¯1.2), æ˜¯å”¯ä¸€ä¸€ä¸ªè¿˜æ²¡æœ‰é’ˆå¯¹æ€§æ”»å‡»çš„ç‰ˆæœ¬(PS: å½“ç„¶, è¿‘æœŸä¹Ÿæœ‰é’ˆå¯¹TLS v1.2çš„æ¼æ´çˆ†å‡º, ä½†è¿˜ç®—OK)ã€‚&lt;/p&gt;
&lt;p&gt;TLSæœ‰ä¸€ä¸ªæ··ä¹±çš„å†å²ï¼Œå¹¶æ²¡æœ‰çœŸæ­£æœ€å¥½çš„å®‰å…¨è®°å½•ï¼Œä½†TLS v1.2ä¸€ç›´è¿˜æ˜¯æœ€å¥½çš„ï¼Œå½“æ¶‰åŠåˆ°ä¸æµè§ˆå™¨å’ŒæœåŠ¡çš„äº¤äº’ï¼Œå®ƒå†…ç½®åœ¨å‡ ä¹ä¸€åˆ‡çš„æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¸­(æœ€æ–°çš„)ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼ŒTLS v1.2æ˜¯å¤§åŠ¿æ‰€è¶‹, å¦‚æœæ¶‰åŠåˆ°å…³é”®ä¸šåŠ¡æ•°æ®äº¤äº’, å¦‚&lt;strong&gt;ç”¨æˆ·å…³é”®ä¿¡æ¯&lt;/strong&gt; &lt;strong&gt;æ”¯ä»˜&lt;/strong&gt; &lt;strong&gt;é‡‘è&lt;/strong&gt;ç­‰åœºæ™¯, TLS v1.2æ‰èƒ½çœŸæ­£æœ‰ä¿éšœ, è€Œå…¶ä»–è€çš„åŠ å¯†åè®®, éƒ½å·²ç»è¢«ç ´è§£äº†, é»‘å®¢æƒ³æ‹¿åˆ°ä½ çš„æ•°æ®(å¦‚æœä½ ç”¨è€çš„åŠ å¯†åè®®)åªæ˜¯æ—¶é—´é—®é¢˜, å¹¶ä¸å­˜åœ¨æŠ€æœ¯ä¸Šçš„éš¾ç‚¹ã€‚æ‰€ä»¥è¯„ä¼°ATS(è‹¹æœçš„å®‰å…¨ç›¸å…³è¦æ±‚)åˆè§„ä¹Ÿè¦æ±‚è¯¥ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;h3 id="_4"&gt;&lt;img align="absmiddle" alt="ğŸ˜‚" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f602.png" title=":joy:" width="20px"&gt;è¢«ç ´è§£å…³é”®å†å²èŠ‚ç‚¹&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;SSL v2.0 1995å‘å¸ƒ - è®¾è®¡ä¹‹åˆè¢«ç ´è§£&lt;/li&gt;
&lt;li&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;SSL v3.0 1996å‘å¸ƒ â€“ è¢«POODLEç ´è§£ï¼ˆ2014 .11ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;TSL v1.0 1999å‘å¸ƒ â€“ BEAST(2011)å’ŒLucky 13(2013)å‘ç°æ¼æ´&lt;/li&gt;
&lt;li&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;Tâ€‹LS v1.1 2006å‘å¸ƒ â€“ è¢«Lucky 13(2013)å’ŒRC4(2013,2015)å‘ç°æ¼æ´&lt;/li&gt;
&lt;li&gt;TLS v1.2 2008å‘å¸ƒ â€“ åªæœ‰åœ¨AEADæ¨¡å¼ä¸‹æ˜¯å®‰å…¨çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="_5"&gt;å®¢æˆ·ç«¯å…¼å®¹æ€§&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt; æ³¨æ„:&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰æ¡ä»¶, å¼ºçƒˆå»ºè®®&lt;strong&gt;åªé€‰æ‹© TLS v1.2&lt;/strong&gt;ç‰ˆæœ¬. (å¯¹äºä¼ ç»Ÿä¼ä¸š, çœŸçš„æŒºéš¾åšåˆ°çš„)â€‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ ¹æ®ä»¥ä¸Šçš„å†…å®¹æ¥çœ‹, é‚£æˆ‘åªé€‰æ‹©TLS v1.2åè®®å¥½äº†, ä½†å®é™…æƒ…å†µæ˜¯, TLS v1.2 æ˜¯&lt;strong&gt;2008&lt;/strong&gt;å¹´æ‰å‘å¸ƒçš„(æ ‡æ³¨å‘å¸ƒ), è€ŒçœŸæ­£è¦è½åˆ°å®å¤„æ‰€éœ€è¦çš„æ—¶é—´æ›´é•¿. æ‰€ä»¥å¾ˆå¤šå®¢æˆ·ç«¯å¹¶ä¸æ”¯æŒTLS v1.2. &lt;/p&gt;
&lt;p&gt;è¿™äº›å®¢æˆ·ç«¯, æ˜¯&lt;strong&gt;å¹¿ä¹‰&lt;/strong&gt;çš„å®¢æˆ·ç«¯, åŒ…æ‹¬: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ“ä½œç³»ç»Ÿ&lt;/li&gt;
&lt;li&gt;æµè§ˆå™¨&lt;/li&gt;
&lt;li&gt;æ‰‹æœº&lt;/li&gt;
&lt;li&gt;èƒ–å®¢æˆ·ç«¯(å¦‚Javaå®¢æˆ·ç«¯)&lt;/li&gt;
&lt;li&gt;...&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œå¦‚æœä½ è®¡åˆ’æœåŠ¡å™¨åªé€‰æ‹©1.2ç‰ˆæœ¬ï¼Œä½ å°±å¯èƒ½å¤±å»äº†å¾ˆå¤šæ½œåœ¨å®¢æˆ·(è¿˜åœ¨ç”¨æ—§çš„å®¢æˆ·ç«¯çš„å®¢æˆ·, å½“ç„¶, è¯´ä¸å®šç”¨ç€æ—§ç”µè„‘çš„å‘˜å·¥ä¹Ÿè¢«æ‹’ä¹‹é—¨å¤–äº†...)ã€‚è¿™å¹¶ä¸æ˜¯æœ€å¥½çš„ä¸¾åŠ¨ï¼Œé™¤éå¯¹ç»å¯¹å®‰å…¨éå¸¸æ•æ„Ÿã€‚å¦åˆ™çš„è¯, è¿˜æ˜¯å»ºè®®æ”¯æŒæ›´å¤šçš„å®‰å…¨åè®®è®©æ›´å¤šçš„å®¢æˆ·å¯ä»¥å…¼å®¹. æ˜¯å§? æ¯•ç«Ÿæ¯”èµ·httpè¿™ç§è£¸å¥”, å…¶ä»–æ—§çš„åè®®å¥½æ­¹è¿˜æ˜¯ç©¿ç€è¡£æœçš„.&lt;img align="absmiddle" alt="ğŸ˜" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f60f.png" title=":smirk:" width="20px"&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯, å¦ä¸€äº›å¤§å¹³å°, å·²ç»å¼€å§‹å€¾å‘äºv1.2ã€‚æ¯”å¦‚iosä¹‹å‰çš„&lt;a href="https://developer.apple.com/news/?id=12212016b&amp;amp;1482372961"&gt;ATSåˆè§„è¦æ±‚&lt;/a&gt;, æ¯”å¦‚&lt;a href="https://www.microsoft.com/security/blog/2017/06/20/tls-1-2-support-at-microsoft/"&gt;å¾®è½¯å»ºè®®ä½ æ”¾å¼ƒTLS v1.0å’Œ TLS v1.1çš„æ”¯æŒ&lt;/a&gt;ã€‚å› æ­¤ï¼Œè¡Œä¸šæ­£åœ¨æœç€æ ‡å‡†è¿ˆè¿›ã€‚&lt;/p&gt;
&lt;h3 id="tls-v12"&gt;æ”¯æŒTLS v1.2å®¢æˆ·ç«¯åˆ—è¡¨&lt;a class="headerlink" href="#tls-v12" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Windows 8 ä»¥ä¸Š (Windows Server 2008ä»¥ä¸Š - 2017å¹´ä¸‹åŠå¹´æ‰æ”¯æŒ) (&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt; win7ä¸æ”¯æŒ! æ›´åˆ«æwin xpäº†)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://access.redhat.com/blogs/766093/posts/1976123"&gt;RHEL æˆ– CentOS â‰¥ 6.5&lt;/a&gt; (&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;ç”¨CentOS 5.Xçš„æ³¨æ„äº†å•Š, ä¸æ”¯æŒTLS v1.2 â€‹)&lt;/li&gt;
&lt;li&gt;Chrome â‰¥ 30&lt;/li&gt;
&lt;li&gt;å®‰å“ â‰¥ 5.0&lt;/li&gt;
&lt;li&gt;ç«ç‹æµè§ˆå™¨ â‰¥ 27&lt;/li&gt;
&lt;li&gt;IE/Edge â‰¥ 11 (&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;ä¸»æµçš„IE8 9 10éƒ½ä¸æ”¯æŒ!)&lt;/li&gt;
&lt;li&gt;iOS â‰¥ 5&lt;ul&gt;
&lt;li&gt;æ³¨æ„ï¼šiOS 9åº”ç”¨éœ€è¦TLS 1.2æ”¯æŒã€‚(ATSåˆè§„è¦æ±‚, å½“æ—¶åæ¥å¥½åƒå¾ˆéš¾æ¨ä¸‹å»)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="tls-10"&gt;æ”¯æŒTLS 1.0 å®¢æˆ·ç«¯åˆ—è¡¨&lt;a class="headerlink" href="#tls-10" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;TLS 1.0 ï¼ˆçœŸæ­£å®‰å…¨çš„æœ€è€ç‰ˆæœ¬ï¼‰å‡ ä¹éƒ½æ”¯æŒï¼ˆé™¤äº†win xp sp2)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="win xp sp2" src="./images/winxpsp2.png"&gt;&lt;/p&gt;
&lt;h2 id="_6"&gt;é…ç½®å»ºè®®&lt;a class="headerlink" href="#_6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;å†æ¬¡æ¨è&lt;a href="https://www.ssllabs.com/"&gt;SSL Labs&lt;/a&gt;, æ‰“åˆ†å¦‚ä¸‹:&lt;/p&gt;
&lt;p&gt;&lt;img alt="SSL Labsæ‰“åˆ†ç¤ºä¾‹" src="./images/ssl-labs-example.png"&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="_7"&gt;é«˜å®‰å…¨æ€§ ä½å…¼å®¹æ€§&lt;a class="headerlink" href="#_7" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;SSLProtocol             all -SSLv3 -TLSv1 -TLSv1.1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åªæ”¯æŒTLS v1.2.&lt;/strong&gt; å½“ä½ é…ç½®åŠ å¯†åè®®æ—¶ï¼Œå¦‚æœåªé€‰æ‹©TLS&lt;br&gt;
1.2,å¾—åˆ†ä¼šæ˜¯&lt;strong&gt;A&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id="_8"&gt;ä¸­å®‰å…¨æ€§ é«˜å…¼å®¹æ€§&lt;a class="headerlink" href="#_8" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;SSLProtocol             all -SSLv3&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åªæ”¯æŒ&lt;strong&gt;TLS&lt;/strong&gt;åè®®, å¾—åˆ†ä¹Ÿä¼šæ˜¯&lt;strong&gt;A&lt;/strong&gt;. (ä¹‹å‰çš„, è¿‘æœŸä¸ç¡®å®š, æ„Ÿå…´è¶£çš„å¯ä»¥æµ‹ä¸€ä¸‹).&lt;/p&gt;
&lt;h3 id="_9"&gt;ä½å®‰å…¨æ€§ æœ€å¤§å…¼å®¹æ€§&lt;a class="headerlink" href="#_9" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;SSLProtocol             all&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨SSLv3.0ï¼Œæœ‰é£é™©ï¼Œå¾—Cã€‚&lt;/p&gt;
&lt;h2 id="_10"&gt;æ€»ç»“&lt;a class="headerlink" href="#_10" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;é€‰æ‹©åŠ å¯†åè®®, è¦æ ¹æ®å…·ä½“çš„éœ€æ±‚, æœ‰ä¾§é‡, ä¹Ÿè¦åšåˆ°å®‰å…¨æ€§å’Œå…¼å®¹æ€§çš„å…¼é¡¾.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘ä¹‹å‰æœ‰ä¸ªç›¸å…³çš„PPT, æ„Ÿå…´è¶£çš„è¯åç»­å‘ä¸Šæ¥.&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Sat, 30 Mar 2019 00:08:23 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-03-30:/https-101-chapter-1.html</guid><category>linux</category><category>openssl</category><category>ssl</category><category>nginx</category><category>centos</category></item><item><title>CentOS 7.5 å®‰è£…X11æ¡Œé¢å’Œä¸­æ–‡æ”¯æŒ</title><link>https://www.EWhisper.cn/centos-7-install-x11-desktop-and-chinese-support.html</link><description>&lt;h1 id="_1"&gt;æ¦‚è¿°&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;é€šè¿‡åœ¨CentOS 7.5 ä¸Šå®‰è£…X11æ¡Œé¢ç¯å¢ƒå’Œä¸­æ–‡è¯­è¨€ã€å­—ä½“ã€è¾“å…¥æ³•æ¥å°†äº‘æœåŠ¡å™¨æ‰“é€ æˆ Python é›†æˆå¼€å‘ç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦å®‰è£…çš„è½¯ä»¶æˆ–è½¯ä»¶åŒ…æœ‰:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;X Window System&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Fonts&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;input-methods&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="x11"&gt;å®‰è£… X11 æ¡Œé¢ç³»ç»Ÿ&lt;a class="headerlink" href="#x11" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;è½¯ä»¶åŒ…ç»„: X Window System åŒ…å«çš„ä¿¡æ¯å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo yum group info &lt;span class="s2"&gt;&amp;quot;X Window System&amp;quot;&lt;/span&gt;
Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile

Group: X Window System
 Group-Id: x11
 Description: X Window System Support.
 Mandatory Packages:
   &lt;span class="o"&gt;=&lt;/span&gt;glx-utils
   &lt;span class="o"&gt;=&lt;/span&gt;initial-setup-gui
   &lt;span class="o"&gt;=&lt;/span&gt;mesa-dri-drivers
   &lt;span class="o"&gt;=&lt;/span&gt;plymouth-system-theme
   &lt;span class="o"&gt;=&lt;/span&gt;spice-vdagent
   &lt;span class="o"&gt;=&lt;/span&gt;xorg-x11-drivers
   &lt;span class="o"&gt;=&lt;/span&gt;xorg-x11-server-Xorg
   &lt;span class="o"&gt;=&lt;/span&gt;xorg-x11-utils
   &lt;span class="o"&gt;=&lt;/span&gt;xorg-x11-xauth
   &lt;span class="o"&gt;=&lt;/span&gt;xorg-x11-xinit
   &lt;span class="o"&gt;=&lt;/span&gt;xvattr
 Optional Packages:
   mesa-libGLES
   tigervnc-server
   wayland-protocols-devel
   xorg-x11-drv-keyboard
   xorg-x11-drv-libinput
   xorg-x11-drv-mouse
   xorg-x11-drv-openchrome
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo yum group install -y &lt;span class="s2"&gt;&amp;quot;X Window System&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1 id="_2"&gt;å®‰è£…å­—ä½“&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;è½¯ä»¶åŒ…ç»„: "Fonts"åŒ…å«ä»¥ä¸‹åŒ…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo yum group info &lt;span class="s2"&gt;&amp;quot;Fonts&amp;quot;&lt;/span&gt;
Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile

Group: Fonts
 Group-Id: fonts
 Description: Fonts &lt;span class="k"&gt;for&lt;/span&gt; rendering text in a variety of languages and scripts.
 Default Packages:
   &lt;span class="o"&gt;=&lt;/span&gt;cjkuni-uming-fonts
    dejavu-sans-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;dejavu-sans-mono-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;dejavu-serif-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;gnu-free-mono-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;gnu-free-sans-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;gnu-free-serif-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;google-crosextra-caladea-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;google-crosextra-carlito-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;google-noto-emoji-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;jomolhari-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;khmeros-base-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;liberation-mono-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;liberation-sans-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;liberation-serif-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lklug-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-assamese-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-bengali-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-devanagari-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-gujarati-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-kannada-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-malayalam-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-marathi-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-nepali-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-oriya-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-punjabi-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-tamil-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;lohit-telugu-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;madan-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;nhn-nanum-gothic-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;open-sans-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;overpass-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;paktype-naskh-basic-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;paratype-pt-sans-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;sil-abyssinica-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;sil-nuosu-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;sil-padauk-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;smc-meera-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;stix-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;thai-scalable-waree-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;ucs-miscfixed-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;vlgothic-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;wqy-microhei-fonts
   &lt;span class="o"&gt;=&lt;/span&gt;wqy-zenhei-fonts
 Optional Packages:
   aajohan-comfortaa-fonts
   bitmap-fixed-fonts
   bitmap-lucida-typewriter-fonts
   bpg-chveulebrivi-fonts
   bpg-courier-fonts
   bpg-glaho-fonts
   cjkuni-ukai-fonts
   comic-neue-fonts
   culmus-aharoni-clm-fonts
   culmus-caladings-clm-fonts
   culmus-david-clm-fonts
   culmus-drugulin-clm-fonts
   culmus-ellinia-clm-fonts
   culmus-frank-ruehl-clm-fonts
   culmus-hadasim-clm-fonts
   culmus-keteryg-fonts
   culmus-miriam-clm-fonts
   culmus-miriam-mono-clm-fonts
   culmus-nachlieli-clm-fonts
   culmus-simple-clm-fonts
   culmus-stamashkenaz-clm-fonts
   culmus-stamsefarad-clm-fonts
   culmus-yehuda-clm-fonts
   freefont
   ghostscript-chinese
   google-noto-sans-armenian-fonts
   google-noto-sans-devanagari-fonts
   google-noto-sans-devanagari-ui-fonts
   google-noto-sans-ethiopic-fonts
   google-noto-sans-fonts
   google-noto-sans-georgian-fonts
   google-noto-sans-hebrew-fonts
   google-noto-sans-khmer-fonts
   google-noto-sans-khmer-ui-fonts
   google-noto-sans-lao-fonts
   google-noto-sans-lao-ui-fonts
   google-noto-sans-tamil-fonts
   google-noto-sans-tamil-ui-fonts
   google-noto-sans-thai-fonts
   google-noto-sans-thai-ui-fonts
   google-noto-sans-ui-fonts
   google-noto-serif-armenian-fonts
   google-noto-serif-fonts
   google-noto-serif-georgian-fonts
   google-noto-serif-lao-fonts
   google-noto-serif-thai-fonts
   gubbi-fonts
   horai-ume-gothic-fonts
   horai-ume-mincho-fonts
   horai-ume-pgothic-fonts
   horai-ume-pmincho-fonts
   horai-ume-uigothic-fonts
   ipa-gothic-fonts
   ipa-mincho-fonts
   ipa-pgothic-fonts
   ipa-pmincho-fonts
   kacst-art-fonts
   kacst-book-fonts
   kacst-decorative-fonts
   kacst-digital-fonts
   kacst-farsi-fonts
   kacst-letter-fonts
   kacst-naskh-fonts
   kacst-office-fonts
   kacst-one-fonts
   kacst-pen-fonts
   kacst-poster-fonts
   kacst-qurn-fonts
   kacst-screen-fonts
   kacst-title-fonts
   kacst-titlel-fonts
   khmeros-battambang-fonts
   khmeros-bokor-fonts
   khmeros-handwritten-fonts
   khmeros-metal-chrieng-fonts
   khmeros-muol-fonts
   khmeros-siemreap-fonts
   kurdit-unikurd-web-fonts
   liberation-narrow-fonts
   nafees-web-naskh-fonts
   navilu-fonts
   nhn-nanum-brush-fonts
   nhn-nanum-myeongjo-fonts
   nhn-nanum-pen-fonts
   paktype-naqsh-fonts
   paktype-tehreer-fonts
   pothana2000-fonts
   saab-fonts
   samyak-devanagari-fonts
   samyak-gujarati-fonts
   samyak-malayalam-fonts
   samyak-oriya-fonts
   samyak-tamil-fonts
   smc-anjalioldlipi-fonts
   smc-dyuthi-fonts
   smc-kalyani-fonts
   smc-rachana-fonts
   smc-raghumalayalam-fonts
   smc-suruma-fonts
   thai-scalable-garuda-fonts
   thai-scalable-kinnari-fonts
   thai-scalable-loma-fonts
   thai-scalable-norasi-fonts
   thai-scalable-purisa-fonts
   thai-scalable-sawasdee-fonts
   thai-scalable-tlwgmono-fonts
   thai-scalable-tlwgtypewriter-fonts
   thai-scalable-tlwgtypist-fonts
   thai-scalable-tlwgtypo-fonts
   thai-scalable-umpush-fonts
   tibetan-machine-uni-fonts
   vemana2000-fonts
   vlgothic-p-fonts
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo yum group install -y &lt;span class="s2"&gt;&amp;quot;Fonts&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; å¤‡æ³¨:&lt;/p&gt;
&lt;p&gt;å®‰è£…å®Œæˆåå¯ä»¥æ‰‹åŠ¨åˆ·æ–°å­—ä½“ç¼“å­˜:&lt;/p&gt;
&lt;p&gt;å®‰è£…å­—ä½“ç›¸å…³çš„åŒ…:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$ sudo yum install -y fontconfig mkfontscale&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ‰§è¡Œä¸‹é¢3æ¡å‘½ä»¤åˆ·æ–°å­—ä½“ç¼“å­˜:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$ mkfontscale&lt;/code&gt;&lt;br&gt;
&lt;code&gt;$ mkfontdir&lt;/code&gt;&lt;br&gt;
&lt;code&gt;$ fc-cache -fv&lt;/code&gt;&lt;br&gt;
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id="_3"&gt;å®‰è£…è¾“å…¥æ³•&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;è½¯ä»¶åŒ…ç»„: "input-methods"åŒ…å«:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo yum group info &lt;span class="s2"&gt;&amp;quot;input-methods&amp;quot;&lt;/span&gt;
Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile

Group: Input Methods
 Group-Id: input-methods
 Description: Software &lt;span class="k"&gt;for&lt;/span&gt; the input of international text.
 Default Packages:
   &lt;span class="o"&gt;=&lt;/span&gt;ibus-chewing
   &lt;span class="o"&gt;=&lt;/span&gt;ibus-hangul
   &lt;span class="o"&gt;=&lt;/span&gt;ibus-kkc
   &lt;span class="o"&gt;=&lt;/span&gt;ibus-libpinyin
   &lt;span class="o"&gt;=&lt;/span&gt;ibus-m17n
   &lt;span class="o"&gt;=&lt;/span&gt;ibus-rawcode
   &lt;span class="o"&gt;=&lt;/span&gt;ibus-sayura
   &lt;span class="o"&gt;=&lt;/span&gt;ibus-table
   &lt;span class="o"&gt;=&lt;/span&gt;ibus-table-chinese
   &lt;span class="o"&gt;=&lt;/span&gt;m17n-contrib
   &lt;span class="o"&gt;=&lt;/span&gt;m17n-db
 Optional Packages:
   ibus-typing-booster
   iok
 Conditional Packages:
    gtk2-immodule-xim
    gtk3-immodule-xim
    ibus-gtk2
    ibus-gtk3
   -ibus-qt
   -imsettings-cinnamon
   -imsettings-gsettings
   -imsettings-qt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$  sudo yum group install -y &lt;span class="s2"&gt;&amp;quot;input-methods&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1 id="x11forwarding"&gt;å¯ç”¨ X11Forwarding&lt;a class="headerlink" href="#x11forwarding" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;ä¿®æ”¹&lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt; :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;X11Forwarding yes
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é‡å¯æœåŠ¡ç”Ÿæ•ˆ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo systemctl restart sshd.service
&lt;/pre&gt;&lt;/div&gt;


&lt;h1 id="_4"&gt;é…ç½®è¾“å…¥æ³•&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;å¯ç”¨äº† X11Forwardingä¹‹å, å°±å¯ä»¥é…ç½®è¾“å…¥æ³• ibus äº†, é€‰æ‹©ä½¿ç”¨ä¸­æ–‡pinyinè¾“å…¥æ³•.&lt;/p&gt;
&lt;h2 id="_5"&gt;è‹±æ–‡ç¯å¢ƒä¸‹ä½¿ç”¨ä¸­æ–‡è¾“å…¥æ³•&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä¸ªäººä¹°ä¸ªäº†æœåŠ¡å™¨, æ‰“ç®—æ—¢ä½œä¸ºå¼€å‘ç¯å¢ƒ, åˆä½œä¸ºç½‘ç«™åšå®¢ä½¿ç”¨. æ‰€ä»¥è¯­è¨€ç¯å¢ƒå°±é€‰æ‹©é»˜è®¤çš„: &lt;em&gt;en_US.utf8&lt;/em&gt; . è€Œå¹¶æ²¡æœ‰æ”¹ä¸ºä¸­æ–‡ç¯å¢ƒ. è‹±æ–‡ç¯å¢ƒä¸‹ä½¿ç”¨ä¸­æ–‡è¾“å…¥æ³•æ­¥éª¤å¦‚ä¸‹:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å°†å®‰è£…åˆ°æ–‡ä»¶å¤åˆ¶åˆ°è‹±æ–‡ç¯å¢ƒä¸‹: (æ³¨æ„æ˜¯&lt;code&gt;ibus*&lt;/code&gt;)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$ sudo cp /usr/share/locale/zh_CN/LC_MESSAGES/ibus* /usr/share/locale/en_US/LC_MESSAGES&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å°†ibusè®¾ç½®ä¸ºè‹±æ–‡ç¯å¢ƒçš„å¼€æœºå¯åŠ¨é¡¹, ç¼–è¾‘æ–‡ä»¶&lt;code&gt;/etc/X11/xinit/xinputrc&lt;/code&gt;, åŠ å…¥å¦‚ä¸‹ä¸€è¡Œ:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;_im_language_list=â€en zhâ€&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="ibus"&gt;è¾“å…¥æ³• ibus é…ç½®&lt;a class="headerlink" href="#ibus" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;è¾“å…¥å¦‚ä¸‹ibus è¾“å…¥æ³•å‘½ä»¤&lt;br&gt;
&lt;code&gt;$ ibus-setup&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœ&lt;code&gt;ibus-deamon&lt;/code&gt; æ²¡æœ‰è¿è¡Œ, ä¼šå¼¹å‡ºå¦‚ä¸‹ç•Œé¢æç¤º, ç‚¹å‡»&lt;em&gt;Yes&lt;/em&gt;. ä¼šåå°æ‰§è¡Œå‘½ä»¤: &lt;code&gt;ibus-daemon --xim&lt;/code&gt;&lt;br&gt;
&lt;img alt="ibus-daemon æç¤ºè¿è¡Œ" src="images/1552980351961.png"&gt;&lt;/li&gt;
&lt;li&gt;å¯åŠ¨åä¼šå¼¹å‡ºå¦‚ä¸‹æç¤º:&lt;br/&gt;&lt;br&gt;
&lt;img alt="ibusåŠ å…¥bashrc" src="images/1552981039781.png"&gt;&lt;br/&gt;&lt;br&gt;
    ä»¥ä¸‹éœ€è¦åŠ å…¥åˆ°&lt;code&gt;~/.bashrc&lt;/code&gt;  æˆ– &lt;code&gt;~/.zshrc&lt;/code&gt;ä¸­:&lt;br&gt;
&lt;code&gt;export GTK_IM_MODULE=ibus&lt;/code&gt;&lt;br&gt;
&lt;code&gt;export XMODIFIERS=@im=ibus&lt;/code&gt;&lt;br&gt;
&lt;code&gt;export QT_IM_MODULE=ibus&lt;/code&gt;&lt;br&gt;
&lt;code&gt;ibus-daemon -rdx&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç‚¹å‡»&lt;em&gt;OK&lt;/em&gt;åä¼šå¼¹å‡º ibus çš„é…ç½®ç•Œé¢, å¦‚ä¸‹:&lt;br&gt;
&lt;img alt="ibus é¦–é€‰é¡¹" src="images/1552981185401.png"&gt;&lt;/li&gt;
&lt;li&gt;ç‚¹å‡»&lt;em&gt;è¾“å…¥æ³•&lt;/em&gt; â†’ &lt;em&gt;æ·»åŠ &lt;/em&gt; â†’ &lt;em&gt;Chinese&lt;/em&gt; â†’ &lt;em&gt;pinyin&lt;/em&gt; æ¥æ·»åŠ æ‹¼éŸ³è¾“å…¥æ³•, å¦‚ä¸‹å›¾:&lt;br&gt;
&lt;img alt="æ·»åŠ è¾“å…¥æ³•" src="images/1552981294294.png"&gt;&lt;br&gt;
&lt;img alt="æ·»åŠ æ‹¼éŸ³è¾“å…¥æ³•" src="images/1552981424476.png"&gt;&lt;/li&gt;
&lt;li&gt;æ·»åŠ å®Œæˆå, å¯ä»¥é€šè¿‡X11å¯åŠ¨, firefox æˆ– pycharmç­‰æ¥æµ‹è¯•æ‹¼éŸ³è¾“å…¥æ³•æ˜¯å¦ç”Ÿæ•ˆ. é»˜è®¤å¯ä»¥é€šè¿‡: &lt;code&gt;&amp;lt;Super&amp;gt;+&amp;lt;Space&amp;gt;&lt;/code&gt;æŒ‰é”®æ¥åˆ‡æ¢è¾“å…¥æ³•.&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹åå° ibusç›¸å…³è¿›ç¨‹, å¦‚ä¸‹:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ibus ç›¸å…³è¿›ç¨‹" src="images/1552981628167.png"&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–, å¦‚æœæŸäº›é…ç½®ä¸ç”Ÿæ•ˆ, å¯ä»¥é€šè¿‡ä»¥ä¸‹æ“ä½œæ¥ä½¿ä¹‹ç”Ÿæ•ˆ:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;source&lt;/code&gt; å¯¹åº”çš„æ–‡ä»¶. å¦‚: &lt;code&gt;source ~/.bashrc&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é‡æ–°ç™»é™†&lt;/li&gt;
&lt;li&gt;é‡å¯ç›¸å…³æœåŠ¡, å¦‚: &lt;code&gt;ibus-daemon -rdx&lt;/code&gt; æˆ– &lt;code&gt;sudo systemctl restart sshd.service&lt;/code&gt;ç­‰&lt;/li&gt;
&lt;li&gt;é‡å¯ä¸»æœº.&lt;br&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;æœ€å, å°±æ˜¯å®‰è£…è‡ªå·±å–œæ¬¢çš„ç¼–è¾‘å™¨å’ŒIDEäº†, æ¨èVSCODEå’ŒPyCharm.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Fri, 29 Mar 2019 11:01:50 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-03-29:/centos-7-install-x11-desktop-and-chinese-support.html</guid><category>linux</category><category>è…¾è®¯äº‘</category><category>äº‘</category></item><item><title>è…¾è®¯äº‘ç”³è¯·å…è´¹SSLè¯ä¹¦</title><link>https://www.EWhisper.cn/tencentyun-apply-ssl-certificate.html</link><description>&lt;h2 id="_1"&gt;å‰è¨€&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ç°åœ¨ç”³è¯·SSLè¯ä¹¦çš„é—¨æ§›å’Œè´¹ç”¨éƒ½å¤§å¤§é™ä½äº†. å‡ºç°äº†å¾ˆå¤šå…è´¹æä¾›åŠ å¯†è¯ä¹¦çš„æœºæ„, æ¯”è¾ƒçŸ¥åçš„æ˜¯å›½å¤–çš„&lt;a href="https://letsencrypt.org/"&gt;Letâ€™s Encrypt&lt;/a&gt;, å…è´¹, è‡ªåŠ¨åŒ–, å¼€æ”¾. å›½å†…çš„äº‘æœåŠ¡å•†ä¹Ÿä¼šæä¾›å…è´¹çš„SSLè¯ä¹¦. ä¸‹é¢æ˜¯æˆ‘åœ¨è…¾è®¯äº‘ä¸Šç”³è¯·SSLè¯ä¹¦çš„æ­¥éª¤.&lt;/p&gt;
&lt;p&gt;&lt;img alt="SSL" src="./images/SSL-Certificate.png"&gt;&lt;/p&gt;
&lt;h2 id="_2"&gt;æ­¥éª¤&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è¿›å…¥è…¾è®¯äº‘&lt;a href="https://console.cloud.tencent.com/ssl"&gt;SSLè¯ä¹¦ç®¡ç†é¡µé¢&lt;/a&gt;, ç‚¹å‡» &lt;strong&gt;ç”³è¯·å…è´¹è¯ä¹¦&lt;/strong&gt;, å¦‚ä¸‹å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ç”³è¯·å…è´¹è¯ä¹¦" src="./images/tencentyun_app_ssl_1.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›®å‰è…¾è®¯äº‘ä¸Šæä¾›çš„å…è´¹è¯ä¹¦æ˜¯ &lt;strong&gt;TRUSTAsia&lt;/strong&gt;å®¶çš„, é€‰æ‹©å¹¶ç¡®å®š. å¦‚ä¸‹å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img alt="TRUSTAsia" src="./images/tencentyun_app_ssl_2.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¥ä¸‹æ¥å°±å¡«å†™è¯ä¹¦éœ€è¦çš„ç›¸å…³ä¿¡æ¯, å¾ˆç®€å•, åªæœ‰2é¡¹å¿…å¡«é¡¹:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€šç”¨åç§°, å…·ä½“çš„&lt;strong&gt;å•åŸŸå&lt;/strong&gt;. (&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt; å¦‚: www.ewhisper.cn, blog.ewhisper.cn. ä¸èƒ½æ˜¯*.ewhisper.cn è¿™ç§é€šç”¨åŸŸå.)&lt;/li&gt;
&lt;li&gt;ç”³è¯·é‚®ç®±&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img alt="è¯ä¹¦ä¿¡æ¯" src="./images/tencentyun_app_ssl_3.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¥ä¸‹æ¥æ˜¯åŸŸåèº«ä»½éªŒè¯. è…¾è®¯äº‘ä¸€å¥—çš„è¯, ç›´æ¥é€‰æ‹© &lt;strong&gt;è‡ªåŠ¨DNSéªŒè¯&lt;/strong&gt;. &lt;/p&gt;
&lt;p&gt;&lt;img alt="åŸŸåèº«ä»½éªŒè¯" src="./images/tencentyun_app_ssl_4.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¿™æ ·å°±å®Œæˆç”³è¯·äº†, æ¥ä¸‹æ¥å°±æ˜¯ç­‰å¾…å®¡æ ¸äº†. æˆ‘çš„sslå®¡æ ¸çš„éå¸¸å¿«, ä¹Ÿå°±åå‡ åˆ†é’Ÿå°±ä¸‹æ¥äº†. å¦‚ä¸‹å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ç­‰å¾…å®¡æ ¸" src="./images/tencentyun_app_ssl_5.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¯ä¹¦è¯¦æƒ…å¦‚ä¸‹:&lt;/p&gt;
&lt;p&gt;&lt;img alt="è¯ä¹¦è¯¦æƒ…" src="./images/tencentyun_app_ssl_6.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¯ä¹¦ä¿¡æ¯åˆ—è¡¨å¦‚ä¸‹, è¯ä¹¦æœ‰æ•ˆæœŸä¸€å¹´. å¯ä»¥é€‰æ‹©éƒ¨ç½²åˆ°CDNå’Œè´Ÿè½½å‡è¡¡ä¸Š. (å¦‚æœæœ‰çš„è¯) ä¹Ÿå¯ä»¥ä¸‹è½½éƒ¨ç½²åˆ°nginxä¸Š.&lt;/p&gt;
&lt;p&gt;&lt;img alt="è¯ä¹¦ä¿¡æ¯åˆ—è¡¨" src="./images/tencentyun_app_ssl_7.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸‹è½½çš„æ˜¯ä¸ªè¯ä¹¦å‹ç¼©åŒ…. åŒ…æ‹¬å„ç±»web serverçš„è¯ä¹¦ç±»å‹:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Apache: key, crt, å’Œbundle.crt&lt;/li&gt;
&lt;li&gt;IIS: pfx&lt;/li&gt;
&lt;li&gt;Nginx: crt, key&lt;/li&gt;
&lt;li&gt;Tomcat: jks&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¥ä¸‹æ¥å°±æ˜¯NGINXé…ç½®çš„äº‹æƒ…äº†. &lt;a href="https://www.EWhisper.cn/nginx-conf-add-ssl-support.html"&gt;æˆ³è¿™å„¿æŸ¥çœ‹&lt;img align="absmiddle" alt="ğŸ‘‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f449.png" title=":point_right:" width="20px"&gt;&lt;/a&gt; &lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ‰" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f389.png" title=":tada:" width="20px"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Fri, 29 Mar 2019 10:41:49 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-03-29:/tencentyun-apply-ssl-certificate.html</guid><category>SSL</category><category>è…¾è®¯äº‘</category><category>äº‘</category><category>å®‰å…¨</category></item><item><title>Docker å­¦ä¹ ç¬”è®° - é•œåƒ</title><link>https://www.EWhisper.cn/docker-handbook-image.html</link><description>&lt;h2 id="_1"&gt;è·å–é•œåƒ&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;docker pull&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="_2"&gt;æŸ¥çœ‹é•œåƒä¿¡æ¯&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;docker images&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;docker inspect &amp;lt;images id&amp;gt;  # è·å–é•œåƒçš„è¯¦ç»†ä¿¡æ¯&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="_3"&gt;æœå¯»é•œåƒ&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;docker search&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="_4"&gt;åˆ é™¤é•œåƒ&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;docker rmi&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ä¸€ä¸ªé•œåƒæ‹¥æœ‰å¤šä¸ªæ ‡ç­¾ï¼Œ&lt;code&gt;docker rmi&lt;/code&gt;åªæ˜¯åˆ é™¤è¯¥é•œåƒæŒ‡å®šçš„æ ‡ç­¾ï¼Œå¹¶ä¸å½±å“é•œåƒæ–‡ä»¶&lt;br&gt;
å½“é•œåƒåªå‰©ä¸‹ä¸€ä¸ªæ ‡ç­¾æ—¶ï¼Œå†ä½¿ç”¨ä¼šå½»åº•åˆ é™¤è¯¥é•œåƒ&lt;br&gt;
å…ˆåˆ é™¤è¯¥é•œåƒçš„æ‰€æœ‰å®¹å™¨ï¼Œå†åˆ é™¤é•œåƒ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="_5"&gt;åˆ›å»ºé•œåƒ&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;3ç§æ–¹æ³•ï¼š&lt;br&gt;
- åŸºäºå·²æœ‰é•œåƒçš„&lt;strong&gt;å®¹å™¨&lt;/strong&gt;åˆ›å»º&lt;br&gt;
- åŸºäºæœ¬åœ°æ¨¡æ¿å¯¼å…¥&lt;br&gt;
- åŸºäºDockerfileåˆ›å»º&lt;/p&gt;
&lt;h3 id="_6"&gt;åŸºäºå·²æœ‰é•œåƒçš„å®¹å™¨åˆ›å»º&lt;a class="headerlink" href="#_6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;docker commit&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;-a: ä½œè€…ä¿¡æ¯&lt;br&gt;
-m: æäº¤ä¿¡æ¯&lt;br&gt;
-p æäº¤æ—¶æš‚åœå®¹å™¨è¿è¡Œ&lt;br&gt;
-c changelist&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="_7"&gt;åŸºäºæœ¬åœ°æ¨¡æ¿çš„å¯¼å…¥&lt;a class="headerlink" href="#_7" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;æ¨èä½¿ç”¨OpenVZ æä¾›çš„æ¨¡æ¿æ¥åˆ›å»ºã€‚ä¸‹è½½åœ°å€ï¼šhttps://openvz.org/Download/template/precreated&lt;br&gt;
&lt;code&gt;sudo cat ubuntu-16.04-x86_64.tar.gz | docker import - ubuntu:16.04&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="_8"&gt;å¯¼å‡ºå’Œè½½å…¥é•œåƒ&lt;a class="headerlink" href="#_8" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å¯¼å‡º&lt;/strong&gt;ï¼š&lt;code&gt;sudo docker save -o ubuntu_16.04.tar ubuntu:16.04&lt;/code&gt;&lt;br&gt;
&lt;strong&gt;è½½å…¥&lt;/strong&gt;ï¼š&lt;code&gt;sudo docker load --input ubuntu_16.04.tar&lt;/code&gt; æˆ–è€… &lt;code&gt;sudo docker load &amp;lt; ubuntu_16.04.tar&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯¥æŒ‡ä»¤ä¼šè½½å…¥é•œåƒï¼Œä»¥åŠå…¶ç›¸å…³çš„å…ƒæ•°æ®ä¿¡æ¯ï¼ˆåŒ…æ‹¬æ ‡ç­¾ç­‰ï¼‰. å…³äº&lt;code&gt;docker load&lt;/code&gt;å’Œ&lt;code&gt;docker import&lt;/code&gt;æŒ‡ä»¤çš„åŒºåˆ«è§ä¸‹ä¸€ç« .&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Thu, 28 Mar 2019 22:17:48 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-03-28:/docker-handbook-image.html</guid><category>docker</category></item><item><title>åœ¨äº‘æœåŠ¡å™¨ä¸Šæ­å»ºé›†æˆå¼€å‘ç¯å¢ƒ</title><link>https://www.EWhisper.cn/build-ide-on-tencentyun.html</link><description>&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#python"&gt;pythonä¼˜åŒ–é…ç½®&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#python-36"&gt;å®‰è£…python 3.6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#pipenv-python-36"&gt;å®‰è£…pipenv: (ä¸»è¦ä½¿ç”¨python 3.6)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#python-37"&gt;ç¼–è¯‘å®‰è£…Python 3.7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#docker"&gt;Docker é…ç½®&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#_1"&gt;å®‰è£…&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_2"&gt;ä¿®æ”¹ä»“åº“æº&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_3"&gt;å¼€æœºå¯åŠ¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_4"&gt;ä½¿ç”¨è…¾è®¯äº‘å®¹å™¨çš„ç›¸å…³æœåŠ¡&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id="python"&gt;pythonä¼˜åŒ–é…ç½®&lt;a class="headerlink" href="#python" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;å®‰è£…ç›¸å…³è½¯ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo yum install -y --setopt&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;tsflags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;nodocs gcc make patch  &lt;span class="c1"&gt;# å®‰è£…ç¼–è¯‘è½¯ä»¶&lt;/span&gt;
sudo yum group install -y development  &lt;span class="c1"&gt;# å®‰è£…å¼€å‘åŒ…ç»„&lt;/span&gt;
sudo yum install -y --setopt&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;tsflags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;nodocs gdbm-devel openssl-libs openssl-devel openssl-devel ncurses-devel libsqlite3x-devel sqlite-devel readline-devel zlib-devel bzip2-devel python2-bz2file db4-devel libpcap-devel xz-devel libffi-devel sqlite3 sqlite python-ujson  &lt;span class="c1"&gt;# å®‰è£…ä¾èµ–&lt;/span&gt;

sudo yum install -y mariadb mariadb-server redis memcached &lt;span class="c1"&gt;# å®‰è£…mariadb&lt;/span&gt;
sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; mariadb.service redis.service  &lt;span class="c1"&gt;# mariadb redis å¼€æœºå¯åŠ¨&lt;/span&gt;
sudo systemctl start mariadb.service redis.service  &lt;span class="c1"&gt;# å¯åŠ¨mariadbæœåŠ¡&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="python-36"&gt;å®‰è£…python 3.6&lt;a class="headerlink" href="#python-36" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo yum install -y python36
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å®‰è£…pip:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo yum -y install python-pip python34-pip python36-pip
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;pip conf: &lt;/p&gt;
&lt;p&gt;åœ¨æ–‡ä»¶&lt;code&gt;~/.pip/pip.conf&lt;/code&gt;ä¸­æ·»åŠ æˆ–ä¿®æ”¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[global]&lt;/span&gt;
&lt;span class="na"&gt;index-url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;http://mirrors.tencentyun.com/pypi/simple&lt;/span&gt;
&lt;span class="na"&gt;trusted-host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;mirrors.tencentyun.com&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒæ–‡ç« :&lt;/p&gt;
&lt;p&gt;&lt;a href="https://cloud.tencent.com/document/product/213/8623"&gt;è…¾è®¯äº‘è½¯ä»¶æºåŠ é€Ÿè½¯ä»¶åŒ…ä¸‹è½½å’Œæ›´æ–°&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="pipenv-python-36"&gt;å®‰è£…pipenv: (ä¸»è¦ä½¿ç”¨python 3.6)&lt;a class="headerlink" href="#pipenv-python-36" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip3.6 install pipenv --user
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç¼–è¾‘&lt;code&gt;~/.zshrc&lt;/code&gt;, åŠ å…¥ä»¥ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/home/casey/.local/bin:&lt;span class="nv"&gt;$PATH&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åç»­ä½¿ç”¨&lt;code&gt;pipenv&lt;/code&gt;ç®¡ç†æ–‡ä»¶, æœ‰ä»¥ä¸‹å‡ ä¸ªè¦ç‚¹:&lt;br&gt;
1. å®‰è£…æ—¶å€™æ ¹æ®éœ€è¦, æ ¹æ®OSç°æœ‰pythonæŒ‡å®š, å¦‚: &lt;code&gt;pipenv install --python /usr/bin/python36&lt;/code&gt;&lt;br&gt;
2. å¯ä»¥ä¿®æ”¹&lt;code&gt;Pipfile&lt;/code&gt;çš„ä»¥ä¸‹é…ç½®, åŠ å¿«ä¾èµ–ä¸‹è½½:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[[source]]&lt;/span&gt;
&lt;span class="na"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;http://mirrors.tencentyun.com/pypi/simple --trusted-host mirrors.tencentyun.com&amp;quot;&lt;/span&gt;
&lt;span class="na"&gt;verify_ssl&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;false&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="python-37"&gt;ç¼–è¯‘å®‰è£…Python 3.7&lt;a class="headerlink" href="#python-37" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;éœ€è¦å…ˆyumå®‰è£…&lt;code&gt;libffi-devel&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# ä¸‹è½½æºç åŒ…å¹¶è§£å‹&lt;/span&gt;
wget https://www.python.org/ftp/python/3.7.2/Python-3.7.2.tgz
tar -xvzf Python-3.7.2.tgz
&lt;span class="nb"&gt;cd&lt;/span&gt; Python-3.7.2
&lt;span class="c1"&gt;# configure &lt;/span&gt;
sudo mkdir -p /usr/lib64/python3.7
sudo ./configure --prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/lib64/python3.7
&lt;span class="c1"&gt;# install&lt;/span&gt;
sudo make &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo make install
&lt;span class="c1"&gt;# åˆ›å»ºè½¯è¿æ¥&lt;/span&gt;
sudo rm -f /usr/bin/python3
sudo ln -s /usr/lib64/python3.7/bin/python3 /usr/bin/python3
&lt;span class="c1"&gt;# åŠ å…¥PATH&lt;/span&gt;
vi ~/.zshrc
&lt;span class="c1"&gt;# .zshrcä¿®æ”¹ä¸ºä»¥ä¸‹å†…å®¹&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/usr/lib64/python3.7/bin:/home/casey/.local/bin:&lt;span class="nv"&gt;$PATH&lt;/span&gt;
&lt;span class="c1"&gt;# ä½¿å¾—é…ç½®ç”Ÿæ•ˆ&lt;/span&gt;
&lt;span class="nb"&gt;source&lt;/span&gt; ~/.zshrc
&lt;span class="c1"&gt;# éªŒè¯&lt;/span&gt;
python3 -V 
&lt;span class="c1"&gt;# è¾“å‡º: Python 3.7.2&lt;/span&gt;
pip3 -V                     
&lt;span class="c1"&gt;# è¾“å‡º: pip 18.1 from /usr/lib64/python3.7/lib/python3.7/site-packages/pip (python 3.7)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2 id="docker"&gt;Docker é…ç½®&lt;a class="headerlink" href="#docker" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="_1"&gt;å®‰è£…&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo yum install -y --setopt&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;tsflags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;nodocs docker docker-compose docker-distribution docker-logrotate docker-lvm-plugin 
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_2"&gt;ä¿®æ”¹ä»“åº“æº&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;é€‚ç”¨äº CentOS 7 ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ Docker é…ç½®æ–‡ä»¶ &lt;code&gt;sudo vi /etc/sysconfig/docker&lt;/code&gt;ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;OPTIONS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--registry-mirror=https://mirror.ccs.tencentyun.com&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒæ–‡ç« :&lt;/p&gt;
&lt;p&gt;&lt;a href="https://cloud.tencent.com/document/product/457/9113"&gt;ä½¿ç”¨ DockerHub åŠ é€Ÿå™¨&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="_3"&gt;å¼€æœºå¯åŠ¨&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; docker
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_4"&gt;ä½¿ç”¨è…¾è®¯äº‘å®¹å™¨çš„ç›¸å…³æœåŠ¡&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ§åˆ¶å°, è¿›å…¥&lt;strong&gt;å®¹å™¨æœåŠ¡&lt;/strong&gt; â†’ &lt;strong&gt;é•œåƒä»“åº“&lt;/strong&gt; â†’ &lt;strong&gt;æˆ‘çš„é•œåƒ&lt;/strong&gt; , è¾“å…¥é•œåƒä»“åº“çš„ä¸ªäººå¯†ç . (è´¦å·æ˜¯AppID)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(å¯é€‰): åœ¨&lt;strong&gt;è®¿é—®ç®¡ç†&lt;/strong&gt; â†’ &lt;strong&gt;ç”¨æˆ·ç»„&lt;/strong&gt; â†’ &lt;strong&gt;å½“å‰ç”¨æˆ·ç»„&lt;/strong&gt;é‡Œ â†’ &lt;strong&gt;å…³è”ç­–ç•¥&lt;/strong&gt; : &lt;a href="https://console.cloud.tencent.com/cam/policy/detail/419082&amp;amp;QcloudCCRFullAccess&amp;amp;2"&gt;QcloudCCRFullAccess&lt;/a&gt; (é•œåƒä»“åº“å…¨è¯»å†™æƒé™)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;äº‘æœåŠ¡å™¨ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç™»å½•:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo docker login --username=appid ccr.ccs.tencentyun.com&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸‹è½½é•œåƒ:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo docker pull ccr.ccs.tencentyun.com/[namespace]/[ImageName]:[é•œåƒç‰ˆæœ¬å·]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Wed, 27 Mar 2019 09:00:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-03-27:/build-ide-on-tencentyun.html</guid><category>è…¾è®¯äº‘</category><category>äº‘</category><category>python</category><category>pipenv</category><category>docker</category></item><item><title>è…¾è®¯äº‘æœåŠ¡å™¨åˆå§‹åŒ–æ“ä½œ</title><link>https://www.EWhisper.cn/initialize-my-tencentyun-server.html</link><description>&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#_1"&gt;é‡è£…ç³»ç»Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_2"&gt;è®¾ç½®ç›‘æ§å‘Šè­¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_3"&gt;åˆ›å»ºå¯†é’¥å¹¶ç»‘å®šä¸»æœº&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_4"&gt;å®‰å…¨ç»„é…ç½®&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#centos-75"&gt;CentOS 7.5 ä¼˜åŒ–é…ç½®&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#_5"&gt;ç”¨æˆ·/ç™»å½•ç›¸å…³ä¼˜åŒ–&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#_6"&gt;æ›´æ–°ç³»ç»Ÿå’Œè½¯ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#git"&gt;å®‰è£…åŠé…ç½® Git&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#shell"&gt;ä¼˜åŒ–é…ç½®shell&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#using-oh-my-zsh"&gt;Using Oh My Zsh&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#plugins"&gt;Plugins&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#themes"&gt;Themes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id="_1"&gt;é‡è£…ç³»ç»Ÿ&lt;a class="headerlink" href="#_1" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; è¯´æ˜:&lt;/p&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä¹°çš„æ—¶å€™, CentOSæœ€æ–°åªæä¾›åˆ°7.3, æˆ‘å¸Œæœ›ä½¿ç”¨CentOS 7.5. çœ‹åˆ°é•œåƒåº“é‡Œæœ‰(ä»€ä¹ˆæ¯›ç—…, ä¹°çš„æ—¶å€™ä¸ºå•¥ä¸æä¾›&lt;img align="absmiddle" alt="ğŸ˜•" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f615.png" title=":confused:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ˜•" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f615.png" title=":confused:" width="20px"&gt;&lt;img align="absmiddle" alt="ğŸ˜•" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f615.png" title=":confused:" width="20px"&gt;), æ‰€ä»¥é‡æ–°å®‰è£…ä¸‹ç³»ç»Ÿ.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é€‰ä¸­å®ä¾‹, ç‚¹å‡»&lt;strong&gt;æ›´å¤š&lt;/strong&gt;, é€‰æ‹©&lt;strong&gt;é‡è£…ç³»ç»Ÿ&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img alt="é‡è£…ç³»ç»Ÿ" src="./images/init_tencentyun_install_os_1.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é€‰æ‹©&lt;strong&gt;å…¬å…±é•œåƒ&lt;/strong&gt; -&amp;gt; &lt;strong&gt;CentOS&lt;/strong&gt; -&amp;gt; &lt;strong&gt;CentOS 7.5 64ä½&lt;/strong&gt; -&amp;gt; è¾“å…¥rootå¯†ç . ç‚¹å‡»&lt;strong&gt;å¼€å§‹é‡è£…&lt;/strong&gt;. å¦‚ä¸‹å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img alt="é‡è£…ç³»ç»Ÿå…·ä½“é€‰é¡¹" src="./images/init_tencentyun_install_os_2.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç­‰å¾…é‡è£…å®Œæ¯•å³å¯.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="_2"&gt;è®¾ç½®ç›‘æ§å‘Šè­¦&lt;a class="headerlink" href="#_2" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç‚¹å‡»&lt;strong&gt;ç›‘æ§&lt;/strong&gt;å›¾æ ‡:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ç‚¹å‡»ç›‘æ§" src="./images/init_tencentyun_monitor_1.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœ‰ä»¥ä¸‹ç›‘æ§æŒ‡æ ‡, å¦‚ä¸‹å›¾, ç‚¹å‡»&lt;strong&gt;è®¾ç½®å‘Šè­¦&lt;/strong&gt;:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CPU&lt;/li&gt;
&lt;li&gt;å†…å­˜&lt;/li&gt;
&lt;li&gt;å®½å¸¦(å†…å¤–ç½‘)&lt;/li&gt;
&lt;li&gt;ç£ç›˜IO&lt;/li&gt;
&lt;li&gt;åˆ†åŒºä½¿ç”¨è¯·çœ‹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img alt="è®¾ç½®å‘Šè­¦" src="./images/init_tencentyun_monitor_2.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ ¹æ®è‡ªå·±çš„éœ€è¦, å®šåˆ¶å‘Šè­¦ç­–ç•¥. ç¤ºä¾‹å¦‚ä¸‹:&lt;/p&gt;
&lt;p&gt;&lt;img alt="å‘Šè­¦ç­–ç•¥" src="./images/init_tencentyun_monitor_3.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¦é…ç½®å‘Šè­¦é€šçŸ¥æ¸ é“, éœ€è¦å…ˆ&lt;strong&gt;æ–°å¢ç”¨æˆ·ç»„&lt;/strong&gt;. å¦‚ä¸‹(æˆ‘å’Œå…¶ä»–äººåˆç”¨, æ‰€ä»¥å»ºç«‹ä¸€ä¸ªç”¨æˆ·ç»„è¿˜æ˜¯æœ‰å¿…è¦çš„):&lt;/p&gt;
&lt;p&gt;&lt;img alt="æ–°å¢ç”¨æˆ·ç»„" src="./images/init_tencentyun_monitor_4.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ–°å¢ç”¨æˆ·ç»„çš„æ“ä½œå¦‚ä¸‹, å…ˆç›´æ¥ä½¿ç”¨é¢„è®¾ç­–ç•¥ - ç®¡ç†å‘˜å°±å¯ä»¥äº†.&lt;/p&gt;
&lt;p&gt;&lt;img alt="æ–°å¢ç”¨æˆ·ç»„" src="./images/init_tencentyun_groupuser_3.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¥ä¸‹æ¥å…³è”åˆ°å…·ä½“çš„ç”¨æˆ·ç»„&lt;/p&gt;
&lt;p&gt;&lt;img alt="å…³è”æ¥å—ç»„" src="./images/init_tencentyun_monitor_5.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç‚¹å‡»&lt;strong&gt;å®Œæˆ&lt;/strong&gt;, é…ç½®å®Œæˆåå¦‚ä¸‹æ‰€ç¤º: (å¯ä»¥æŠŠé»˜è®¤çš„ç¦ç”¨æ‰äº†)&lt;/p&gt;
&lt;p&gt;&lt;img alt="å‘Šè­¦ç­–ç•¥" src="./images/init_tencentyun_monitor_6.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="_3"&gt;åˆ›å»ºå¯†é’¥å¹¶ç»‘å®šä¸»æœº&lt;a class="headerlink" href="#_3" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;åœ¨&lt;strong&gt;SSHå¯†é’¥&lt;/strong&gt; èœå•, ç‚¹å‡»&lt;strong&gt;åˆ›å»ºå¯†é’¥&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img alt="åˆ›å»ºå¯†é’¥" src="./images/init_tencentyun_key_1.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ›å»ºå¯†é’¥(&lt;img align="absmiddle" alt="â—" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/2757.png" title=":exclamation:" width="20px"&gt;  å¯†é’¥è¯·å¦¥å–„ä¿å­˜, å‹¿å¤–ä¼ ).&lt;/p&gt;
&lt;p&gt;&lt;img alt="åˆ›å»ºå¯†é’¥" src="./images/init_tencentyun_key_2.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ›å»ºå, å…ˆå…³é—­ä¸»æœº(å…³é—­åçš„ä¸»æœºæ‰èƒ½ç»‘å®šå¯†é’¥, å¾ˆå¥½, å…³æœºä¹Ÿå—åˆ°å‘Šè­¦äº†ğŸ‘Œ), å†é€‰æ‹©&lt;strong&gt;ç»‘å®š/è§£ç»‘å®ä¾‹&lt;/strong&gt;, å¦‚ä¸‹å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ç»‘å®šå®ä¾‹" src="./images/init_tencentyun_key_3.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="_4"&gt;å®‰å…¨ç»„é…ç½®&lt;a class="headerlink" href="#_4" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; å¤‡æ³¨:&lt;/p&gt;
&lt;p&gt;ç±»ä¼¼äºé˜²ç«å¢™æƒé™.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç‚¹å‡»&lt;strong&gt;å®‰å…¨ç»„&lt;/strong&gt; -&amp;gt; &lt;strong&gt;æ–°å»º&lt;/strong&gt;. å¦‚ä¸‹å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img alt="æ–°å»ºå®‰å…¨ç»„" src="./images/init_tencentyun_securegroup_1.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é€‰æ‹©&lt;strong&gt;ç«‹å³è®¾ç½®è§„åˆ™&lt;/strong&gt;. å…·ä½“åŸå› å¦‚ä¸‹å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img alt="è®¾ç½®è§„åˆ™" src="./images/init_tencentyun_securegroup_2.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥å…ˆå…³è”åˆ°æˆ‘è‡ªå·±çš„äº‘ä¸»æœºå®ä¾‹. å¦‚ä¸‹å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img alt="å…³è”åˆ°å®ä¾‹" src="./images/init_tencentyun_securegroup_3.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç„¶åå†é…ç½®å‡º/å…¥ç«™è§„åˆ™, å…ˆé…ç½®å…¥ç«™, å…ˆé€‰æ‹©&lt;strong&gt;ä¸€é”®æ”¾é€š&lt;/strong&gt;. æ”¾é€šä»¥ä¸‹:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Linux SSHç™»å½•: 22ç«¯å£&lt;/li&gt;
&lt;li&gt;Windowsç™»å½•: 3389&lt;/li&gt;
&lt;li&gt;ping: ICMPåè®®&lt;/li&gt;
&lt;li&gt;HTTP: 80&lt;/li&gt;
&lt;li&gt;HTTPS: 443&lt;/li&gt;
&lt;li&gt;FTP: 20å’Œ21&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img alt="ä¸€é”®æ”¾é€šå…¥ç«™" src="./images/init_tencentyun_securegroup_4.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å†æ ¹æ®è‡ªå·±éœ€è¦æ·»åŠ è§„åˆ™, å¦‚ä¸‹: (æ”¾é€šTCPçš„8000ç«¯å£)&lt;/p&gt;
&lt;p&gt;&lt;img alt="è‡ªå®šä¹‰è§„åˆ™" src="./images/init_tencentyun_securegroup_5.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœ€åé…ç½®å‡ºç«™è§„åˆ™, é€‰æ‹©&lt;strong&gt;ä¸€é”®æ”¾é€š&lt;/strong&gt;. ä»¥åå†æ…¢æ…¢ç»†åŒ–, å¦‚ä¸‹:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ä¸€é”®æ”¾é€šå‡ºæ ˆ" src="./images/init_tencentyun_securegroup_6.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è‡³æ­¤, æ§åˆ¶å°ä¸Šè¯¥é…ç½®çš„å°±é…ç½®çš„å·®ä¸å¤šäº†, æ¥ä¸‹æ¥ç™»å½•ä¸»æœºè¿›è¡Œé…ç½®.&lt;/p&gt;
&lt;h2 id="centos-75"&gt;CentOS 7.5 ä¼˜åŒ–é…ç½®&lt;a class="headerlink" href="#centos-75" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="_5"&gt;ç”¨æˆ·/ç™»å½•ç›¸å…³ä¼˜åŒ–&lt;a class="headerlink" href="#_5" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;åˆ›å»ºæ™®é€šç”¨æˆ· åŸºäºå…¬é’¥ç™»å½•&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;åˆ›å»ºæ™®é€šç”¨æˆ·: &lt;code&gt;useradd -m  -p yourpassword casey&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ™®é€šç”¨æˆ·åŸºäºå…¬é’¥ç™»å½•: (å› ä¸ºä¹‹å‰&lt;strong&gt;åˆ›å»ºå¯†é’¥å¹¶ç»‘å®šä¸»æœº&lt;/strong&gt;, å…¬é’¥å·²ç»å­˜åœ¨äºä¸»æœºä¸Šäº†, æ‰€ä»¥ä¸éœ€è¦keygenäº†, ç›´æ¥å¤åˆ¶å°±å¯ä»¥äº†)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;cp /root/.ssh/authorized_keys /home/casey/.ssh &amp;amp;&amp;amp; chown -R casey:casey /home/casey/.ssh/&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¡®è®¤åŸºäºsshå…¬é’¥çš„ç™»å½•æ˜¯å¦å·¥ä½œ&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img align="absmiddle" alt="ğŸ““" class="emojione" height="20px" src="https://cdn.jsdelivr.net/emojione/assets/4.0/png/64/1f4d3.png" title=":notebook:" width="20px"&gt; å¤‡æ³¨:&lt;/p&gt;
&lt;p&gt;å®Œæ•´çš„&lt;strong&gt;åŸºäºå…¬é’¥&lt;/strong&gt;ç™»å½•çš„æ­¥éª¤å¦‚ä¸‹: (å‰ææ˜¯åˆšå¼€å§‹è¯¥è´¦æˆ·èƒ½é€šè¿‡è´¦å·å¯†ç æ–¹å¼ç™»å½•)&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨äº‘ä¸»æœºä¸Šåˆ›å»ºæ™®é€šç”¨æˆ·: &lt;code&gt;useradd -m -p yourpassword hellowordomain&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ ssh-keygenå‘½ä»¤åœ¨äº‘ä¸»æœºä¸Šåˆ›å»ºå¯†åŒ™å¯¹: &lt;code&gt;ssh-keygen -t rsa -b 4096 -f ~/.ssh/id_rsa_tencent_$(date +%Y-%m-%d) -C "tencent key for hellowordomain"&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ ssh-copy-id å‘½ä»¤å®‰è£…å…¬åŒ™ï¼š&lt;code&gt;ssh-copy-id -i /path/to/public-key-file user@host&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç¡®è®¤åŸºäºsshå…¬é’¥çš„ç™»å½•æ˜¯å¦å·¥ä½œ&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h4&gt;æ™®é€šç”¨æˆ·é…ç½®sudoæƒé™&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;åœ¨ CentOS/RHEL ç³»ç»Ÿä¸­å¦‚ä½•å°†ç”¨æˆ· vivek æ·»åŠ åˆ° sudo ç»„ä¸­&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ CentOS/RHEL å’Œ Fedora ç³»ç»Ÿä¸­å…è®¸ wheel ç»„ä¸­çš„ç”¨æˆ·æ‰§è¡Œæ‰€æœ‰çš„å‘½ä»¤ã€‚ä½¿ç”¨ usermod å‘½ä»¤å°†ç”¨æˆ· vivek æ·»åŠ åˆ° wheel ç»„ä¸­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo usermod -aG wheel vivek
$ id vivek
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;sudoæ— éœ€è¾“å…¥å¯†ç &lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# rootç”¨æˆ·&lt;/span&gt;
visudo

&lt;span class="c1"&gt;# ä¿®æ”¹å¦‚ä¸‹å†…å®¹åä¿å­˜é€€å‡º&lt;/span&gt;
&lt;span class="c1"&gt;## Allows people in group wheel to run all commands&lt;/span&gt;
&lt;span class="c1"&gt;# %wheel        ALL=(ALL)       ALL&lt;/span&gt;

&lt;span class="c1"&gt;## Same thing without a password&lt;/span&gt;
%wheel  &lt;span class="nv"&gt;ALL&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;ALL&lt;span class="o"&gt;)&lt;/span&gt;       NOPASSWD: ALL
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æµ‹è¯•å¹¶ç¡®ä¿ç”¨æˆ· vivek å¯ä»¥ä»¥ root èº«ä»½ç™»å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo -i  &lt;span class="c1"&gt;# åˆ‡æ¢åˆ°rootç”¨æˆ·&lt;/span&gt;
sudo systemctl status sshd  &lt;span class="c1"&gt;# æŸ¥çœ‹sshdçš„çŠ¶æ€&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;&lt;code&gt;sshd_config&lt;/code&gt; ä¼˜åŒ–&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# ç¦ç”¨rootç™»å½•
PermitRootLogin no
ChallengeResponseAuthentication no
PasswordAuthentication no
UsePAM no
# ç¦ç”¨å¯†ç ç™»å½• ä»…ç•™ä¸‹å…¬åŒ™ç™»å½•
AuthenticationMethods publickey
PubkeyAuthentication yes
# ç¦ç”¨ç©ºå¯†ç 
PermitEmptyPasswords no
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æœ€åæµ‹è¯• &lt;code&gt;sshd_config&lt;/code&gt; æ–‡ä»¶å¹¶é‡å¯/é‡æ–°åŠ è½½ SSH æœåŠ¡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo sshd -t
sudo systemctl restart sshd.service
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="_6"&gt;æ›´æ–°ç³»ç»Ÿå’Œè½¯ä»¶&lt;a class="headerlink" href="#_6" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo yum upgrade -y  &lt;span class="c1"&gt;# å‡çº§æ‰€æœ‰è½¯ä»¶&lt;/span&gt;
sudo yum clean all -y  &lt;span class="c1"&gt;# æ¸…ç†ç¼“å­˜&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3 id="git"&gt;å®‰è£…åŠé…ç½® Git&lt;a class="headerlink" href="#git" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å®‰è£…Git&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo yum install -y --setopt=tsflags=nodocs git&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é…ç½®git&lt;/p&gt;
&lt;p&gt;&lt;code&gt;git config --global user.name "east4ming"&lt;/code&gt;&lt;br&gt;
&lt;code&gt;git config --global user.email "cuikaidong@foxmail.com"&lt;/code&gt;&lt;br&gt;
&lt;code&gt;ssh-keygen -t rsa -b 4096 -C "cuikaidong@foxmail.com"  # å·²æœ‰ç§é’¥ä¹Ÿå¯ä»¥é‡å¤ä½¿ç”¨&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;cat .ssh/id_rsa.pub&lt;/code&gt; å¹¶å¤åˆ¶ (id_rsa.pubæ˜¯å¯¹åº”çš„å…¬é’¥ä¿¡æ¯)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;æ‰“å¼€githubç½‘é¡µç™»å…¥è´¦æˆ·è¿›å…¥è´¦æˆ·settingså·¦è¾¹æ‰¾åˆ°SSHï¼Œå¯ä»¥æ¸…ç†ä¸€ä¸‹æ²¡ç”¨çš„SSH keysï¼Œç„¶åæ–°å»ºä¸€ä¸ª ï¼Œå–åä»»æ„ï¼Œç²˜è´´è¿›å»catäº§ç”Ÿçš„æ‰€æœ‰å­—ç¬¦ã€‚ä¿å­˜å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¼“å­˜HTTPSæ–¹å¼çš„å¯†ç : &lt;/p&gt;
&lt;p&gt;&lt;code&gt;$ git config --global credential.helper 'cache --timeout=3600'  # Set the cache to timeout after 1 hour (setting is in seconds)&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="shell"&gt;ä¼˜åŒ–é…ç½®shell&lt;a class="headerlink" href="#shell" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;å®‰è£…zsh&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo yum install -y --setopt&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;tsflags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;nodocs zsh
zsh --version
sudo chsh -s &lt;span class="k"&gt;$(&lt;/span&gt;which zsh&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# æ³¨é”€&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å®‰è£…powerline&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install powerline-status --user
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;å®‰è£…&lt;a href="https://github.com/robbyrussell/oh-my-zsh"&gt;&lt;strong&gt;oh-my-zsh&lt;/strong&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sh -c &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;wget https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2 id="using-oh-my-zsh"&gt;Using Oh My Zsh&lt;a class="headerlink" href="#using-oh-my-zsh" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹å†…å®¹æ¥è‡ª oh-my-zsh github&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="plugins"&gt;Plugins&lt;a class="headerlink" href="#plugins" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Oh My Zsh comes with a shitload of plugins to take advantage of. You can take a look in the &lt;a href="https://github.com/robbyrussell/oh-my-zsh/tree/master/plugins"&gt;plugins&lt;/a&gt; directory and/or the &lt;a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins"&gt;wiki&lt;/a&gt;to see what's currently available.&lt;/p&gt;
&lt;h4&gt;Enabling Plugins&lt;/h4&gt;
&lt;p&gt;Once you spot a plugin (or several) that you'd like to use with Oh My Zsh, you'll need to enable them in the &lt;code&gt;.zshrc&lt;/code&gt; file. You'll find the zshrc file in your &lt;code&gt;$HOME&lt;/code&gt; directory. Open it with your favorite text editor and you'll see a spot to list all the plugins you want to load.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;vi ~/.zshrc
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;For example, this might begin to look like this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;plugins=(
git
bundler
dotenv
osx
rake
rbenv
ruby
)
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Using Plugins&lt;/h4&gt;
&lt;p&gt;Most plugins (should! we're working on this) include a &lt;strong&gt;README&lt;/strong&gt;, which documents how to use them.&lt;/p&gt;
&lt;h3 id="themes"&gt;Themes&lt;a class="headerlink" href="#themes" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We'll admit it. Early in the Oh My Zsh world, we may have gotten a bit too theme happy. We have over one hundred themes now bundled. Most of them have &lt;a href="https://wiki.github.com/robbyrussell/oh-my-zsh/themes"&gt;screenshots&lt;/a&gt; on the wiki. Check them out!&lt;/p&gt;
&lt;h4&gt;Selecting a Theme&lt;/h4&gt;
&lt;p&gt;&lt;em&gt;Robby's theme is the default one. It's not the fanciest one. It's not the simplest one. It's just the right one (for him).&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Once you find a theme that you'd like to use, you will need to edit the &lt;code&gt;~/.zshrc&lt;/code&gt; file. You'll see an environment variable (all caps) in there that looks like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;ZSH_THEME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;robbyrussell&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To use a different theme, simply change the value to match the name of your desired theme. For example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;ZSH_THEME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;agnoster&amp;quot;&lt;/span&gt; &lt;span class="c1"&gt;# (this is one of the fancy ones)&lt;/span&gt;
&lt;span class="c1"&gt;# see https://github.com/robbyrussell/oh-my-zsh/wiki/Themes#agnoster&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;em&gt;Note: many themes require installing the Powerline Fonts in order to render properly.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Open up a new terminal window and your prompt should look something like this:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Agnoster theme" src="https://cloud.githubusercontent.com/assets/2618447/6316862/70f58fb6-ba03-11e4-82c9-c083bf9a6574.png"&gt;&lt;/p&gt;
&lt;p&gt;In case you did not find a suitable theme for your needs, please have a look at the wiki for &lt;a href="https://github.com/robbyrussell/oh-my-zsh/wiki/External-themes"&gt;more of them&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;If you're feeling feisty, you can let the computer select one randomly for you each time you open a new terminal window.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ZSH_THEME=&amp;quot;random&amp;quot; # (...please let it be pie... please be some pie..)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And if you want to pick random theme from a list of your favorite themes:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ZSH_THEME_RANDOM_CANDIDATES=(
&amp;quot;robbyrussell&amp;quot;
&amp;quot;agnoster&amp;quot;
)
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">ä¸œé£å¾®é¸£</dc:creator><pubDate>Tue, 26 Mar 2019 21:09:00 +0800</pubDate><guid isPermaLink="false">tag:www.ewhisper.cn,2019-03-26:/initialize-my-tencentyun-server.html</guid><category>è…¾è®¯äº‘</category><category>äº‘</category><category>centos</category><category>ç›‘æ§</category><category>å‘Šè­¦</category><category>å¯è§‚å¯Ÿæ€§</category><category>å®‰å…¨</category><category>å¯†é’¥</category><category>git</category><category>shell</category></item></channel></rss>